(self.webpackChunkwebpack_boilerplate=self.webpackChunkwebpack_boilerplate||[]).push([[736],{614:(e,t,i)=>{"use strict";var s=i(1192);e.exports=function(r,n){return void 0===n&&(n=!1),function(e,t,i){if(e)r(e);else if(400<=t.statusCode&&t.statusCode<=599){e=i;if(n)if(s.TextDecoder){t=(t=void 0===(t=t.headers&&t.headers["content-type"])?"":t).toLowerCase().split(";").reduce(function(e,t){var t=t.split("="),i=t[0],t=t[1];return"charset"===i.trim()?t.trim():e},"utf-8");try{e=new TextDecoder(t).decode(i)}catch(e){}}else e=String.fromCharCode.apply(null,new Uint8Array(i));r({cause:e})}else r(null,i)}}},3065:(e,t,i)=>{"use strict";var r=i(1192),n=i(9894),s=i(6534),g=(v.httpHandler=i(614),function(e){var r={};return e&&e.trim().split("\n").forEach(function(e){var t=e.indexOf(":"),i=e.slice(0,t).trim().toLowerCase(),e=e.slice(t+1).trim();void 0===r[i]?r[i]=e:Array.isArray(r[i])?r[i].push(e):r[i]=[r[i],e]}),r});function a(e,t,i){var r=e;return s(t)?(i=t,"string"==typeof e&&(r={uri:e})):r=n({},t,{uri:e}),r.callback=i,r}function v(e,t,i){return o(t=a(e,t,i))}function o(r){if(void 0===r.callback)throw new Error("callback argument missing");function n(e,t,i){s||(s=!0,r.callback(e,t,i))}var s=!1;function t(e){return clearTimeout(o),(e=e instanceof Error?e:new Error(""+(e||"Unknown XMLHttpRequest Error"))).statusCode=0,n(e,m)}function e(){var e,t,i;if(!a)return clearTimeout(o),e=r.useXDR&&void 0===l.status?200:1223===l.status?204:l.status,t=m,i=null,0!==e?(t={body:function(){var e=void 0,e=l.response||l.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(l);if(f)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:e,method:u,headers:{},url:h,rawRequest:l},l.getAllResponseHeaders&&(t.headers=g(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,t,t.body)}var i,a,o,l=r.xhr||null,h=(l=l||new(r.cors||r.useXDR?v.XDomainRequest:v.XMLHttpRequest)).url=r.uri||r.url,u=l.method=r.method||"GET",c=r.body||r.data,d=l.headers=r.headers||{},p=!!r.sync,f=!1,m={body:void 0,headers:{},statusCode:0,method:u,url:h,rawRequest:l};if("json"in r&&!1!==r.json&&(f=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==u)&&"HEAD"!==u&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),c=JSON.stringify(!0===r.json?c:r.json)),l.onreadystatechange=function(){4===l.readyState&&setTimeout(e,0)},l.onload=e,l.onerror=t,l.onprogress=function(){},l.onabort=function(){a=!0},l.ontimeout=t,l.open(u,h,!p,r.username,r.password),p||(l.withCredentials=!!r.withCredentials),!p&&0<r.timeout&&(o=setTimeout(function(){var e;a||(a=!0,l.abort("timeout"),(e=new Error("XMLHttpRequest timeout")).code="ETIMEDOUT",t(e))},r.timeout)),l.setRequestHeader)for(i in d)d.hasOwnProperty(i)&&l.setRequestHeader(i,d[i]);else if(r.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return;return 1}(r.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in r&&(l.responseType=r.responseType),"beforeSend"in r&&"function"==typeof r.beforeSend&&r.beforeSend(l),l.send(c||null),l}e.exports=v,(e.exports.default=v).XMLHttpRequest=r.XMLHttpRequest||function(){},v.XDomainRequest="withCredentials"in new v.XMLHttpRequest?v.XMLHttpRequest:r.XDomainRequest;for(var l=["get","put","post","patch","head","delete"],h=0;h<l.length;h++)!function(r){v["delete"===r?"del":r]=function(e,t,i){return(t=a(e,t,i)).method=r.toUpperCase(),o(t)}}(l[h])},7453:(e,t)=>{"use strict";function i(e,t){return(t=void 0===t?Object:t)&&"function"==typeof t.freeze?t.freeze(e):e}var r=i({HTML:"text/html",isHTML:function(e){return e===r.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),n=i({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===n.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.find=function(e,t,i){if(void 0===i&&(i=Array.prototype),e&&"function"==typeof i.find)return i.find.call(e,t);for(var r=0;r<e.length;r++)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r];if(t.call(void 0,n,r,e))return n}},t.freeze=i,t.MIME_TYPE=r,t.NAMESPACE=n},3161:(e,t,i)=>{var r=i(7453),n=i(7080),h=i(8057),i=i(8868),s=n.DOMImplementation,u=r.NAMESPACE,a=i.ParseError,c=i.XMLReader;function d(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function o(e){this.options=e||{locator:{}}}function p(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function m(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function l(e,t,i){return"string"==typeof e?e.substr(t,i):e.length>=t+i||t?new java.lang.String(e,t,i)+"":e}function g(e,t){(e.currentElement||e.doc).appendChild(t)}o.prototype.parseFromString=function(e,t){var i=this.options,r=new c,a=i.domBuilder||new p,n=i.errorHandler,s=i.locator,o=i.xmlns||{},t=/\/x?html?$/.test(t),l=t?h.HTML_ENTITIES:h.XML_ENTITIES,n=(s&&a.setDocumentLocator(s),r.errorHandler=function(r,n){if(!r){if(a instanceof p)return a;r=a}var e={},s=r instanceof Function;function t(t){var i=r[t];!i&&s&&(i=2==r.length?function(e){r(t,e)}:r),e[t]=i?function(e){i("[xmldom "+t+"]\t"+e+m(n))}:function(){}}return n=n||{},t("warning"),t("error"),t("fatalError"),e}(n,s),r.domBuilder=i.domBuilder||a,t&&(o[""]=u.HTML),o.xml=o.xml||u.XML,i.normalizeLineEndings||d);return e&&"string"==typeof e?r.parse(n(e),o,l):r.errorHandler.error("invalid doc source"),a.doc},p.prototype={startDocument:function(){this.doc=(new s).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,i,r){var n=this.doc,s=n.createElementNS(e,i||t),a=r.length;g(this,s),this.currentElement=s,this.locator&&f(this.locator,s);for(var o=0;o<a;o++){e=r.getURI(o);var l=r.getValue(o),h=(i=r.getQName(o),n.createAttributeNS(e,i));this.locator&&f(r.getLocator(o),h),h.value=h.nodeValue=l,s.setAttributeNode(h)}},endElement:function(e,t,i){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){e=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,e),g(this,e)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){var r;(e=l.apply(this,arguments))&&(r=this.cdata?this.doc.createCDATASection(e):this.doc.createTextNode(e),this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator)&&f(this.locator,r)},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,i){e=l.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&f(this.locator,r),g(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,i){var r=this.doc.implementation;r&&r.createDocumentType&&(r=r.createDocumentType(e,t,i),this.locator&&f(this.locator,r),g(this,r),this.doc.doctype=r)},warning:function(e){console.warn("[xmldom warning]\t"+e,m(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,m(this.locator))},fatalError:function(e){throw new a(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){p.prototype[e]=function(){return null}}),t.DOMParser=o},7080:(N,e,t)=>{var t=t(7453),a=t.find,b=t.NAMESPACE;function U(e){return""!==e}function B(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function l(e){return e?(e=e?e.split(/[\t\n\f\r ]+/).filter(U):[],Object.keys(e.reduce(B,{}))):[]}function n(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function i(e,t){var i=e.prototype;function r(){}i instanceof t||(r.prototype=t.prototype,n(i,r=new r),e.prototype=i=r),i.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),i.constructor=e)}var t={},r=(t.ELEMENT_NODE=1,t.ATTRIBUTE_NODE=2,t.TEXT_NODE=3,t.CDATA_SECTION_NODE=4,t.ENTITY_REFERENCE_NODE=5,t.ENTITY_NODE=6,t.PROCESSING_INSTRUCTION_NODE=7,t.COMMENT_NODE=8,t.DOCUMENT_NODE=9,t.DOCUMENT_TYPE_NODE=10,t.DOCUMENT_FRAGMENT_NODE=11,t.NOTATION_NODE=12,{}),s={},h=(r.INDEX_SIZE_ERR=(s[1]="Index size error",1),r.DOMSTRING_SIZE_ERR=(s[2]="DOMString size error",2),r.HIERARCHY_REQUEST_ERR=(s[3]="Hierarchy request error",3));r.WRONG_DOCUMENT_ERR=(s[4]="Wrong document",4),r.INVALID_CHARACTER_ERR=(s[5]="Invalid character",5),r.NO_DATA_ALLOWED_ERR=(s[6]="No data allowed",6),r.NO_MODIFICATION_ALLOWED_ERR=(s[7]="No modification allowed",7),r.NOT_FOUND_ERR=(s[8]="Not found",8),r.NOT_SUPPORTED_ERR=(s[9]="Not supported",9),r.INUSE_ATTRIBUTE_ERR=(s[10]="Attribute in use",10);function u(e,t){var i;return t instanceof Error?i=t:(i=this,Error.call(this,s[e]),this.message=s[e],Error.captureStackTrace&&Error.captureStackTrace(this,u)),i.code=e,t&&(this.message=this.message+": "+t),i}function d(){}function c(e,t){this._node=e,this._refresh=t,o(this)}function o(e){var t,i=e._node._inc||e._node.ownerDocument._inc;e._inc!=i&&(t=e._refresh(e._node),ee(e,"length",t.length),n(t,e),e._inc=i)}function p(){}function f(e,t){for(var i=e.length;i--;)if(e[i]===t)return i}function F(e,t,i,r){r?t[f(t,r)]=i:t[t.length++]=i,e&&(t=(i.ownerElement=e).ownerDocument)&&(r&&G(t,e,r),r=e,e=i,t&&t._inc++,e.namespaceURI===b.XMLNS)&&(r._nsMap[e.prefix?e.localName:""]=e.value)}function H(e,t,i){var r=f(t,i);if(!(0<=r))throw new u(8,new Error(e.tagName+"@"+i));for(var n,s=t.length-1;r<s;)t[r]=t[++r];t.length=s,e&&(n=e.ownerDocument)&&(G(n,e,i),i.ownerElement=null)}function z(){}function m(){}function V(e){return("<"==e?"&lt;":">"==e&&"&gt;")||("&"==e?"&amp;":'"'==e&&"&quot;")||"&#"+e.charCodeAt()+";"}function g(e,t){if(t(e))return 1;if(e=e.firstChild)do{if(g(e,t))return 1}while(e=e.nextSibling)}function v(){this.ownerDocument=this}function G(e,t,i){e&&e._inc++,i.namespaceURI===b.XMLNS&&delete t._nsMap[i.prefix?i.localName:""]}function y(e,t,i){if(e&&e._inc){e._inc++;var r=t.childNodes;if(i)r[r.length++]=i;else{for(var n=t.firstChild,s=0;n;)n=(r[s++]=n).nextSibling;r.length=s,delete r[r.length]}}}function W(e,t){var i=t.previousSibling,r=t.nextSibling;return i?i.nextSibling=r:e.firstChild=r,r?r.previousSibling=i:e.lastChild=i,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,y(e.ownerDocument,e),t}function _(e){return e&&e.nodeType===m.DOCUMENT_TYPE_NODE}function T(e){return e&&e.nodeType===m.ELEMENT_NODE}function x(e){return e&&e.nodeType===m.TEXT_NODE}function j(e,t){var i,e=e.childNodes||[];if(!a(e,T)&&!_(t))return i=a(e,_),!(t&&i&&e.indexOf(i)>e.indexOf(t))}function q(e,t){var i,e=e.childNodes||[];if(!a(e,function(e){return T(e)&&e!==t}))return i=a(e,_),!(t&&i&&e.indexOf(i)>e.indexOf(t))}function X(e,t,i){var r=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===m.DOCUMENT_FRAGMENT_NODE){var s=n.filter(T);if(1<s.length||a(n,x))throw new u(h,"More than one element or text in fragment");if(1===s.length&&!j(e,i))throw new u(h,"Element in fragment can not be inserted before doctype")}if(T(t)&&!j(e,i))throw new u(h,"Only one element can be added and only after doctype");if(_(t)){if(a(r,_))throw new u(h,"Only one doctype is allowed");n=a(r,T);if(i&&r.indexOf(n)<r.indexOf(i))throw new u(h,"Doctype can only be inserted before an element");if(!i&&n)throw new u(h,"Doctype can not be appended since element is present")}}function Y(e,t,i){var r=e.childNodes||[],n=t.childNodes||[];if(t.nodeType===m.DOCUMENT_FRAGMENT_NODE){var s=n.filter(T);if(1<s.length||a(n,x))throw new u(h,"More than one element or text in fragment");if(1===s.length&&!q(e,i))throw new u(h,"Element in fragment can not be inserted before doctype")}if(T(t)&&!q(e,i))throw new u(h,"Only one element can be added and only after doctype");if(_(t)){if(a(r,function(e){return _(e)&&e!==i}))throw new u(h,"Only one doctype is allowed");n=a(r,T);if(i&&r.indexOf(n)<r.indexOf(i))throw new u(h,"Doctype can only be inserted before an element")}}function w(e,t,i,r){var n=e,s=t,a=i;if(!n||n.nodeType!==m.DOCUMENT_NODE&&n.nodeType!==m.DOCUMENT_FRAGMENT_NODE&&n.nodeType!==m.ELEMENT_NODE)throw new u(h,"Unexpected parent node type "+n.nodeType);if(a&&a.parentNode!==n)throw new u(8,"child not in parent");if(!s||!(T(s)||x(s)||_(s)||s.nodeType===m.DOCUMENT_FRAGMENT_NODE||s.nodeType===m.COMMENT_NODE||s.nodeType===m.PROCESSING_INSTRUCTION_NODE)||_(s)&&n.nodeType!==m.DOCUMENT_NODE)throw new u(h,"Unexpected node type "+s.nodeType+" for parent node type "+n.nodeType);e.nodeType===m.DOCUMENT_NODE&&(r||X)(e,t,i);a=t.parentNode;if(a&&a.removeChild(t),11===t.nodeType){var o=t.firstChild;if(null==o)return t;var l=t.lastChild}else o=l=t;s=i?i.previousSibling:e.lastChild;for(o.previousSibling=s,l.nextSibling=i,s?s.nextSibling=o:e.firstChild=o,null==i?e.lastChild=l:i.previousSibling=l;o.parentNode=e,o!==l&&(o=o.nextSibling););return y(e.ownerDocument||e,e),11==t.nodeType&&(t.firstChild=t.lastChild=null),t}function S(){this._nsMap={}}function E(){}function M(){}function C(){}function A(){}function L(){}function I(){}function $(){}function K(){}function P(){}function R(){}function k(){}function J(){}function Z(e,t){var i,r=[],n=9==this.nodeType&&this.documentElement||this,s=n.prefix,a=n.namespaceURI;return O(this,r,e,t,i=a&&null==s&&null==n.lookupPrefix(a)?[{namespace:a,prefix:null}]:i),r.join("")}function Q(e,t,i){var r=e.prefix||"",n=e.namespaceURI;if(n&&("xml"!==r||n!==b.XML)&&n!==b.XMLNS){for(var s=i.length;s--;){var a=i[s];if(a.prefix===r)return a.namespace!==n}return 1}}function D(e,t,i){e.push(" ",t,'="',i.replace(/[<>&"\t\n\r]/g,V),'"')}function O(e,t,i,r,n){if(n=n||[],r){if(!(e=r(e)))return;if("string"==typeof e)return t.push(e)}switch(e.nodeType){case 1:var s=e.attributes,a=s.length,o=e.firstChild,l=e.tagName,h=l;if(!(i=b.isHTML(e.namespaceURI)||i)&&!e.prefix&&e.namespaceURI){for(var u,c,d=0;d<s.length;d++)if("xmlns"===s.item(d).name){u=s.item(d).value;break}if(!u)for(var p=n.length-1;0<=p;p--)if(""===(c=n[p]).prefix&&c.namespace===e.namespaceURI){u=c.namespace;break}if(u!==e.namespaceURI)for(p=n.length-1;0<=p;p--)if((c=n[p]).namespace===e.namespaceURI){c.prefix&&(h=c.prefix+":"+l);break}}t.push("<",h);for(var f,m,g,v=0;v<a;v++)"xmlns"==(f=s.item(v)).prefix?n.push({prefix:f.localName,namespace:f.value}):"xmlns"==f.nodeName&&n.push({prefix:"",namespace:f.value});for(v=0;v<a;v++)Q(f=s.item(v),0,n)&&(D(t,(m=f.prefix||"")?"xmlns:"+m:"xmlns",g=f.namespaceURI),n.push({prefix:m,namespace:g})),O(f,t,i,r,n);if(l===h&&Q(e,0,n)&&(D(t,(m=e.prefix||"")?"xmlns:"+m:"xmlns",g=e.namespaceURI),n.push({prefix:m,namespace:g})),o||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(">"),i&&/^script$/i.test(l))for(;o;)o.data?t.push(o.data):O(o,t,i,r,n.slice()),o=o.nextSibling;else for(;o;)O(o,t,i,r,n.slice()),o=o.nextSibling;t.push("</",h,">")}else t.push("/>");return;case 9:case 11:for(o=e.firstChild;o;)O(o,t,i,r,n.slice()),o=o.nextSibling;return;case 2:return D(t,e.name,e.value);case 3:return t.push(e.data.replace(/[<&>]/g,V));case 4:return t.push("<![CDATA[",e.data,"]]>");case 8:return t.push("\x3c!--",e.data,"--\x3e");case 10:var y=e.publicId,_=e.systemId;return t.push("<!DOCTYPE ",e.name),void(y?(t.push(" PUBLIC ",y),_&&"."!=_&&t.push(" ",_),t.push(">")):_&&"."!=_?t.push(" SYSTEM ",_,">"):((y=e.internalSubset)&&t.push(" [",y,"]"),t.push(">")));case 7:return t.push("<?",e.target," ",e.data,"?>");case 5:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ee(e,t,i){e[t]=i}r.INVALID_STATE_ERR=(s[11]="Invalid state",11),r.SYNTAX_ERR=(s[12]="Syntax error",12),r.INVALID_MODIFICATION_ERR=(s[13]="Invalid modification",13),r.NAMESPACE_ERR=(s[14]="Invalid namespace",14),r.INVALID_ACCESS_ERR=(s[15]="Invalid access",15),u.prototype=Error.prototype,n(r,u),d.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var i=[],r=0;r<this.length;r++)O(this[r],i,e,t);return i.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},c.prototype.item=function(e){return o(this),this[e]},i(c,d),p.prototype={length:0,item:d.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var i=this[t];if(i.nodeName==e)return i}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new u(10);t=this.getNamedItem(e.nodeName);return F(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new u(10);return t=this.getNamedItemNS(e.namespaceURI,e.localName),F(this._ownerElement,this,e,t),t},removeNamedItem:function(e){e=this.getNamedItem(e);return H(this._ownerElement,this,e),e},removeNamedItemNS:function(e,t){e=this.getNamedItemNS(e,t);return H(this._ownerElement,this,e),e},getNamedItemNS:function(e,t){for(var i=this.length;i--;){var r=this[i];if(r.localName==t&&r.namespaceURI==e)return r}return null}},z.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,i){var r=new v;return r.implementation=this,r.childNodes=new d,r.doctype=i||null,i&&r.appendChild(i),t&&(i=r.createElementNS(e,t),r.appendChild(i)),r},createDocumentType:function(e,t,i){var r=new I;return r.name=e,r.nodeName=e,r.publicId=t||"",r.systemId=i||"",r}},m.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return w(this,e,t)},replaceChild:function(e,t){w(this,e,t,Y),t&&this.removeChild(t)},removeChild:function(e){return W(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,i,r){var n,s,a=new i.constructor;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&"object"!=typeof(s=i[n])&&s!=a[n]&&(a[n]=s);switch(i.childNodes&&(a.childNodes=new d),a.ownerDocument=t,a.nodeType){case 1:var o=i.attributes,l=a.attributes=new p,h=o.length;l._ownerElement=a;for(var u=0;u<h;u++)a.setAttributeNode(e(t,o.item(u),!0));break;case 2:r=!0}if(r)for(var c=i.firstChild;c;)a.appendChild(e(t,c,r)),c=c.nextSibling;return a}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&3==t.nodeType&&3==e.nodeType?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var i=t._nsMap;if(i)for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)&&i[r]===e)return r;t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var i=t._nsMap;if(i&&Object.prototype.hasOwnProperty.call(i,e))return i[e];t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(t,m),n(t,m.prototype),v.prototype={nodeName:"#document",nodeType:9,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(11==e.nodeType)for(var i=e.firstChild;i;){var r=i.nextSibling;this.insertBefore(i,t),i=r}else w(this,e,t),null===(e.ownerDocument=this).documentElement&&1===e.nodeType&&(this.documentElement=e);return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),W(this,e)},replaceChild:function(e,t){w(this,e,t,Y),e.ownerDocument=this,t&&this.removeChild(t),T(e)&&(this.documentElement=e)},importNode:function(e,t){return function e(t,i,r){var n;switch(i.nodeType){case 1:(n=i.cloneNode(!1)).ownerDocument=t;case 11:break;case 2:r=!0}if((n=n||i.cloneNode(!1)).ownerDocument=t,n.parentNode=null,r)for(var s=i.firstChild;s;)n.appendChild(e(t,s,r)),s=s.nextSibling;return n}(this,e,t)},getElementById:function(t){var i=null;return g(this.documentElement,function(e){if(1==e.nodeType&&e.getAttribute("id")==t)return i=e,!0}),i},getElementsByClassName:function(a){var o=l(a);return new c(this,function(n){var s=[];return 0<o.length&&g(n.documentElement,function(e){var t,i,r;e!==n&&1===e.nodeType&&(t=e.getAttribute("class"))&&((i=a===t)||(t=l(t),i=o.every((r=t,function(e){return r&&-1!==r.indexOf(e)}))),i)&&s.push(e)}),s})},createElement:function(e){var t=new S;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new d,(t.attributes=new p)._ownerElement=t},createDocumentFragment:function(){var e=new R;return e.ownerDocument=this,e.childNodes=new d,e},createTextNode:function(e){var t=new C;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new A;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new L;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var i=new k;return i.ownerDocument=this,i.tagName=i.target=e,i.nodeValue=i.data=t,i},createAttribute:function(e){var t=new E;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new P;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var i=new S,r=t.split(":"),n=i.attributes=new p;return i.childNodes=new d,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=e,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,n._ownerElement=i},createAttributeNS:function(e,t){var i=new E,r=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=e,i.specified=!0,2==r.length?(i.prefix=r[0],i.localName=r[1]):i.localName=t,i}},i(v,m),v.prototype.getElementsByTagName=(S.prototype={nodeType:1,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){e=this.getAttributeNode(e);return e&&e.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){e=this.ownerDocument.createAttribute(e);e.value=e.nodeValue=""+t,this.setAttributeNode(e)},removeAttribute:function(e){e=this.getAttributeNode(e);e&&this.removeAttributeNode(e)},appendChild:function(e){return 11===e.nodeType?this.insertBefore(e,null):(t=this,(e=e).parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,y(t.ownerDocument,t,e),e);var t},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){e=this.getAttributeNodeNS(e,t);e&&this.removeAttributeNode(e)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){e=this.getAttributeNodeNS(e,t);return e&&e.value||""},setAttributeNS:function(e,t,i){e=this.ownerDocument.createAttributeNS(e,t);e.value=e.nodeValue=""+i,this.setAttributeNode(e)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(r){return new c(this,function(t){var i=[];return g(t,function(e){e===t||1!=e.nodeType||"*"!==r&&e.tagName!=r||i.push(e)}),i})},getElementsByTagNameNS:function(r,n){return new c(this,function(t){var i=[];return g(t,function(e){e===t||1!==e.nodeType||"*"!==r&&e.namespaceURI!==r||"*"!==n&&e.localName!=n||i.push(e)}),i})}}).getElementsByTagName,v.prototype.getElementsByTagNameNS=S.prototype.getElementsByTagNameNS,i(S,m),E.prototype.nodeType=2,i(E,m),M.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(s[h])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){i=this.data.substring(0,e)+i+this.data.substring(e+t),this.nodeValue=this.data=i,this.length=i.length}},i(M,m),C.prototype={nodeName:"#text",nodeType:3,splitText:function(e){var t=(i=this.data).substring(e),i=i.substring(0,e),e=(this.data=this.nodeValue=i,this.length=i.length,this.ownerDocument.createTextNode(t));return this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling),e}},i(C,M),A.prototype={nodeName:"#comment",nodeType:8},i(A,M),L.prototype={nodeName:"#cdata-section",nodeType:4},i(L,M),I.prototype.nodeType=10,i(I,m),$.prototype.nodeType=12,i($,m),K.prototype.nodeType=6,i(K,m),P.prototype.nodeType=5,i(P,m),R.prototype.nodeName="#document-fragment",R.prototype.nodeType=11,i(R,m),k.prototype.nodeType=7,i(k,m),J.prototype.serializeToString=function(e,t,i){return Z.call(e,t,i)},m.prototype.toString=Z;try{Object.defineProperty&&(Object.defineProperty(c.prototype,"length",{get:function(){return o(this),this.$$length}}),Object.defineProperty(m.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case 1:case 11:var i=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&i.push(e(t)),t=t.nextSibling;return i.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ee=function(e,t,i){e["$$"+t]=i})}catch(e){}e.DocumentType=I,e.DOMException=u,e.DOMImplementation=z,e.Element=S,e.Node=m,e.NodeList=d,e.XMLSerializer=J},8057:(e,t,i)=>{i=i(7453).freeze;t.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=i({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),t.entityMap=t.HTML_ENTITIES},8903:(e,t,i)=>{var r=i(7080);r.DOMImplementation,r.XMLSerializer,t.DOMParser=i(3161).DOMParser},8868:(e,t,i)=>{var q=i(7453).NAMESPACE,i=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+i.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),n=new RegExp("^"+i.source+r.source+"*(?::"+i.source+r.source+"*)?$");function X(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,X)}function s(){}function Y(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function $(e,t,i){for(var r,n=e.tagName,s=null,a=e.length;a--;){var o,l=e[a],h=l.qName,u=l.value,h=0<(r=h.indexOf(":"))?(o=l.prefix=h.slice(0,r),c=h.slice(r+1),"xmlns"===o&&c):(o=null,"xmlns"===(c=h)&&"");l.localName=c,!1!==h&&(null==s&&(s={},p(i,i={})),i[h]=s[h]=u,l.uri=q.XMLNS,t.startPrefixMapping(h,u))}for(a=e.length;a--;)(o=(l=e[a]).prefix)&&("xml"===o&&(l.uri=q.XML),"xmlns"!==o)&&(l.uri=i[o||""]);var c=0<(r=n.indexOf(":"))?(o=e.prefix=n.slice(0,r),e.localName=n.slice(r+1)):(o=null,e.localName=n),d=e.uri=i[o||""];if(t.startElement(d,c,n,e),!e.closed)return e.currentNSMap=i,e.localNSMap=s,1;if(t.endElement(d,c,n),s)for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&t.endPrefixMapping(o)}function p(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}function K(){this.attributeNames={}}(X.prototype=new Error).name=X.name,s.prototype={parse:function(e,t,i){var r=this.domBuilder;r.startDocument(),p(t,t={}),function(i,N,r,n,s){function a(e){var t,i=e.slice(1,-1);return Object.hasOwnProperty.call(r,i)?r[i]:"#"===i.charAt(0)?65535<(i=parseInt(i.substr(1).replace("x","0x")))?(t=55296+((i-=65536)>>10),String.fromCharCode(t,56320+(1023&i))):String.fromCharCode(i):(s.error("entity not found:"+e),e)}function e(e){var t;M<e&&(t=i.substring(M,e).replace(/&#?\w+;/g,a),S&&o(M),n.characters(t,0,e-M),M=e)}function o(e,t){for(;U<=e&&(t=B.exec(i));)w=t.index,U=w+t[0].length,S.lineNumber++;S.columnNumber=e-w+1}for(var t,l,h,u,c,d,p,f,m,g,v,y,_,b,T,x,w=0,U=0,B=/.*(?:\r\n?|\n)|.*$/g,S=n.locator,E=[{currentNSMap:N}],F={},M=0;;){try{var H,C,A=i.indexOf("<",M);if(A<0)return i.substr(M).match(/^\s*$/)||(C=(H=n.doc).createTextNode(i.substr(M)),H.appendChild(C),n.currentElement=C);switch(M<A&&e(A),i.charAt(A+1)){case"/":var L=i.indexOf(">",A+3),I=i.substring(A+2,L).replace(/[ \t\n\r]+$/g,""),P=E.pop(),R=(L<0?(I=i.substring(A+2).replace(/[\s<].*/,""),s.error("end tag name: "+I+" is not complete:"+P.tagName),L=A+1+I.length):I.match(/\s</)&&(I=I.replace(/[\s<].*/,""),s.error("end tag name: "+I+" maybe not complete"),L=A+1+I.length),P.localNSMap),z=P.tagName==I;if(z||P.tagName&&P.tagName.toLowerCase()==I.toLowerCase()){if(n.endElement(P.uri,P.localName,I),R)for(var V in R)Object.prototype.hasOwnProperty.call(R,V)&&n.endPrefixMapping(V);z||s.fatalError("end tag name: "+I+" is not match the current start tagName:"+P.tagName)}else E.push(P);L++;break;case"?":S&&o(A),b=A,T=n,x=void 0,L=(x=(_=i).indexOf("?>",b))&&(_=_.substring(b,x).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/))?(_[0].length,T.processingInstruction(_[1],_[2]),x+2):-1;break;case"!":S&&o(A),p=A,f=n,m=s,y=v=g=void 0,L="-"===(d=i).charAt(p+2)?"-"===d.charAt(p+3)?(g=d.indexOf("--\x3e",p+4))>p?(f.comment(d,p+4,g-p-4),g+3):(m.error("Unclosed comment"),-1):-1:"CDATA["==d.substr(p+3,6)?(g=d.indexOf("]]>",p+9),f.startCDATA(),f.characters(d,p+9,g-p-9),f.endCDATA(),g+3):1<(g=(m=function(e){var t,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=p,r.exec(e);t=r.exec(e);)if(i.push(t),t[1])return i}(d)).length)&&/!doctype/i.test(m[0][0])?(d=m[1][0],y=v=!1,3<g&&(/^public$/i.test(m[2][0])?(v=m[3][0],y=4<g&&m[4][0]):/^system$/i.test(m[2][0])&&(y=m[3][0])),m=m[g-1],f.startDTD(d,v,y),f.endDTD(),m.index+m[0].length):-1;break;default:S&&o(A);var k=new K,D=E[E.length-1].currentNSMap,G=(L=function(e,t,r,i,n,s){function a(e,t,i){r.attributeNames.hasOwnProperty(e)&&s.fatalError("Attribute "+e+" redefined"),r.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,n),i)}for(var o,l=++t,h=0;;){var u=e.charAt(l);switch(u){case"=":if(1===h)o=e.slice(t,l);else if(2!==h)throw new Error("attribute equal must after attrName");h=3;break;case"'":case'"':if(3===h||1===h){if(1===h&&(s.warning('attribute value must after "="'),o=e.slice(t,l)),!(0<(l=e.indexOf(u,t=l+1))))throw new Error("attribute value no end '"+u+"' match");a(o,c=e.slice(t,l),t-1)}else{if(4!=h)throw new Error('attribute value must after "="');a(o,c=e.slice(t,l),t),s.warning('attribute "'+o+'" missed start quot('+u+")!!"),t=l+1}h=5;break;case"/":switch(h){case 0:r.setTagName(e.slice(t,l));case 5:case 6:case 7:h=7,r.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),0==h&&r.setTagName(e.slice(t,l)),l;case">":switch(h){case 0:r.setTagName(e.slice(t,l));case 5:case 6:case 7:break;case 4:case 1:"/"===(c=e.slice(t,l)).slice(-1)&&(r.closed=!0,c=c.slice(0,-1));case 2:2===h&&(c=o),4==h?(s.warning('attribute "'+c+'" missed quot(")!'),a(o,c,t)):(q.isHTML(i[""])&&c.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),a(c,c,t));break;case 3:throw new Error("attribute value missed!!")}return l;case"":u=" ";default:if(u<=" ")switch(h){case 0:r.setTagName(e.slice(t,l)),h=6;break;case 1:o=e.slice(t,l),h=2;break;case 4:var c=e.slice(t,l);s.warning('attribute "'+c+'" missed quot(")!!'),a(o,c,t);case 5:h=6}else switch(h){case 2:r.tagName,q.isHTML(i[""])&&o.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,t),t=l,h=1;break;case 5:s.warning('attribute space is required"'+o+'"!!');case 6:h=1,t=l;break;case 3:h=4,t=l;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}(i,A,k,D,a,s),k.length);if(!k.closed&&(t=i,l=L,h=k.tagName,c=void 0,null==(c=(u=F)[h])&&((c=t.lastIndexOf("</"+h+">"))<l&&(c=t.lastIndexOf("</"+h)),u[h]=c),c<l)&&(k.closed=!0,r.nbsp||s.warning("unclosed xml attribute")),S&&G){for(var W=Y(S,{}),O=0;O<G;O++){var j=k[O];o(j.offset),j.locator=Y(S,{})}n.locator=W,$(k,n,D)&&E.push(k),n.locator=S}else $(k,n,D)&&E.push(k);q.isHTML(k.uri)&&!k.closed?L=function(e,t,i,r,n){if(/^(?:script|textarea)$/i.test(i)){var s=e.indexOf("</"+i+">",t),e=e.substring(t+1,s);if(/[&<]/.test(e))return/^script$/i.test(i)||(e=e.replace(/&#?\w+;/g,r)),n.characters(e,0,e.length),s}return t+1}(i,L,k.tagName,a,n):L++}}catch(i){if(i instanceof X)throw i;s.error("element parse error: "+i),L=-1}M<L?M=L:e(Math.max(A,M)+1)}}(e,t,i,r,this.errorHandler),r.endDocument()}},K.prototype={setTagName:function(e){if(!n.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,i){if(!n.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=s,t.ParseError=X},6717:(e,t)=>{"use strict";t.byteLength=function(e){var e=u(e),t=e[0],e=e[1];return 3*(t+e)/4-e},t.toByteArray=function(e){for(var t,i=u(e),r=i[0],i=i[1],n=new h(3*(r+i)/4-i),s=0,a=0<i?r-4:r,o=0;o<a;o+=4)t=l[e.charCodeAt(o)]<<18|l[e.charCodeAt(o+1)]<<12|l[e.charCodeAt(o+2)]<<6|l[e.charCodeAt(o+3)],n[s++]=t>>16&255,n[s++]=t>>8&255,n[s++]=255&t;return 2===i&&(t=l[e.charCodeAt(o)]<<2|l[e.charCodeAt(o+1)]>>4,n[s++]=255&t),1===i&&(t=l[e.charCodeAt(o)]<<10|l[e.charCodeAt(o+1)]<<4|l[e.charCodeAt(o+2)]>>2,n[s++]=t>>8&255,n[s++]=255&t),n},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,n=[],s=0,a=i-r;s<a;s+=16383)n.push(function(e,t,i){for(var r,n=[],s=t;s<i;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),n.push(o[(r=r)>>18&63]+o[r>>12&63]+o[r>>6&63]+o[63&r]);return n.join("")}(e,s,a<s+16383?a:s+16383));return 1==r?(t=e[i-1],n.push(o[t>>2]+o[t<<4&63]+"==")):2==r&&(t=(e[i-2]<<8)+e[i-1],n.push(o[t>>10]+o[t>>4&63]+o[t<<2&63]+"=")),n.join("")};for(var o=[],l=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)o[r]=i[r],l[i.charCodeAt(r)]=r;function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");return[e=-1===e?t:e,e===t?0:4-e%4]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},5851:(e,i,t)=>{"use strict";var S=t(6717),s=t(9350),t="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,r=(i.lW=c,i.h2=50,2147483647);function h(e){if(r<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,c.prototype),e}function c(e,t,i){if("number"!=typeof e)return n(e,t,i);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return o(e)}function n(e,t,i){if("string"==typeof e){var r=e,n=t;if(c.isEncoding(n="string"==typeof n&&""!==n?n:"utf8"))return(r=(a=h(s=0|f(r,n))).write(r,n))!==s?a.slice(0,r):a;throw new TypeError("Unknown encoding: "+n)}if(ArrayBuffer.isView(e))return I(s=e,Uint8Array)?d((r=new Uint8Array(s)).buffer,r.byteOffset,r.byteLength):u(s);var s;if(null!=e){if(I(e,ArrayBuffer)||e&&I(e.buffer,ArrayBuffer))return d(e,t,i);if("undefined"!=typeof SharedArrayBuffer&&(I(e,SharedArrayBuffer)||e&&I(e.buffer,SharedArrayBuffer)))return d(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return c.from(a,t,i);var o,l=c.isBuffer(n=e)?(0!==(o=h(l=0|p(n.length))).length&&n.copy(o,0,0,l),o):void 0!==n.length?"number"!=typeof n.length||P(n.length)?h(0):u(n):"Buffer"===n.type&&Array.isArray(n.data)?u(n.data):void 0;if(l)return l;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,i)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function o(e){return a(e),h(e<0?0:0|p(e))}function u(e){for(var t=e.length<0?0:0|p(e.length),i=h(t),r=0;r<t;r+=1)i[r]=255&e[r];return i}function d(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');e=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i);return Object.setPrototypeOf(e,c.prototype),e}function p(e){if(r<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||I(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return A(e).length;default:if(n)return r?-1:C(e).length;t=(""+t).toLowerCase(),n=!0}}function l(e,t,i){var r,n=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((i=void 0===i||i>this.length?this.length:i)<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var s=this,a=t,o=i,l=s.length;(!o||o<0||l<o)&&(o=l);for(var h="",u=a=!a||a<0?0:a;u<o;++u)h+=R[s[u]];return h;case"utf8":case"utf-8":return E(this,t,i);case"ascii":var c=this,l=t,d=i,p="";d=Math.min(c.length,d);for(var f=l;f<d;++f)p+=String.fromCharCode(127&c[f]);return p;case"latin1":case"binary":var m=this,a=t,g=i,v="";g=Math.min(m.length,g);for(var y=a;y<g;++y)v+=String.fromCharCode(m[y]);return v;case"base64":return _=this,r=i,0===(b=t)&&r===_.length?S.fromByteArray(_):S.fromByteArray(_.slice(b,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var _=t,b=i,T=this.slice(_,b),x="",w=0;w<T.length-1;w+=2)x+=String.fromCharCode(T[w]+256*T[w+1]);return x;default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function g(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),(i=(i=P(i=+i)?n?0:e.length-1:i)<0?e.length+i:i)>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,i,r,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(n?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,i):v(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,i,r,n){var s=1,a=e.length,o=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a/=s=2,o/=2,i/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n)for(var h=-1,u=i;u<a;u++)if(l(e,u)===l(t,-1===h?0:u-h)){if(u-(h=-1===h?u:h)+1===o)return h*s}else-1!==h&&(u-=u-h),h=-1;else for(u=i=a<i+o?a-o:i;0<=u;u--){for(var c=!0,d=0;d<o;d++)if(l(e,u+d)!==l(t,d)){c=!1;break}if(c)return u}return-1}function E(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var s,a,o,l,h=e[n],u=null,c=239<h?4:223<h?3:191<h?2:1;if(n+c<=i)switch(c){case 1:h<128&&(u=h);break;case 2:128==(192&(s=e[n+1]))&&127<(l=(31&h)<<6|63&s)&&(u=l);break;case 3:s=e[n+1],a=e[n+2],128==(192&s)&&128==(192&a)&&2047<(l=(15&h)<<12|(63&s)<<6|63&a)&&(l<55296||57343<l)&&(u=l);break;case 4:s=e[n+1],a=e[n+2],o=e[n+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&65535<(l=(15&h)<<18|(63&s)<<12|(63&a)<<6|63&o)&&l<1114112&&(u=l)}null===u?(u=65533,c=1):65535<u&&(r.push((u-=65536)>>>10&1023|55296),u=56320|1023&u),r.push(u),n+=c}var d=r,p=d.length;if(p<=y)return String.fromCharCode.apply(String,d);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,d.slice(m,m+=y));return f}(c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=n,Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,i){return t=t,i=i,a(e=e),!(e<=0)&&void 0!==t?"string"==typeof i?h(e).fill(t,i):h(e).fill(t):h(e)},c.allocUnsafe=o,c.allocUnsafeSlow=o,c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(I(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),I(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,r=t.length,n=0,s=Math.min(i,r);n<s;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;for(var i=c.allocUnsafe(t),r=0,n=0;n<e.length;++n){var s=e[n];if(I(s,Uint8Array))r+s.length>i.length?c.from(s).copy(i,r):Uint8Array.prototype.set.call(i,s,r);else{if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r)}r+=s.length}return i},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toLocaleString=c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):l.apply(this,arguments)},c.prototype.equals=function(e){if(c.isBuffer(e))return this===e||0===c.compare(this,e);throw new TypeError("Argument must be a Buffer")},c.prototype.inspect=function(){var e="",t=i.h2,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t&&(c.prototype[t]=c.prototype.inspect),c.prototype.compare=function(e,t,i,r,n){if(I(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),(t=void 0===t?0:t)<0||i>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(n<=r&&i<=t)return 0;if(n<=r)return-1;if(i<=t)return 1;if(this===e)return 0;for(var s=(n>>>=0)-(r>>>=0),a=(i>>>=0)-(t>>>=0),o=Math.min(s,a),l=this.slice(r,n),h=e.slice(t,i),u=0;u<o;++u)if(l[u]!==h[u]){s=l[u],a=h[u];break}return s<a?-1:a<s?1:0},c.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},c.prototype.indexOf=function(e,t,i){return g(this,e,t,i,!0)},c.prototype.lastIndexOf=function(e,t,i){return g(this,e,t,i,!1)},c.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||n<i)&&(i=n),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var s,a,o,l,h,u,c=!1;;)switch(r){case"hex":var d=this,p=e,f=t,m=i,g=(f=Number(f)||0,d.length-f);(!m||(m=Number(m))>g)&&(m=g),(g=p.length)/2<m&&(m=g/2);for(var v=0;v<m;++v){var y=parseInt(p.substr(2*v,2),16);if(P(y))return v;d[f+v]=y}return v;case"utf8":case"utf-8":return g=t,u=i,L(C(e,(h=this).length-g),h,g,u);case"ascii":case"latin1":case"binary":return h=this,u=t,l=i,L(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(e),h,u,l);case"base64":return l=this,a=t,o=i,L(A(e),l,a,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=t,o=i,L(function(e,t){for(var i,r,n=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(i=e.charCodeAt(s))>>8,n.push(i%256),n.push(r);return n}(e,(s=this).length-a),s,a,o);default:if(c)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),c=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var y=4096;function _(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function b(e,t,i,r,n,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<t||t<s)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function T(e,t,i,r){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function x(e,t,i,r,n){return t=+t,i>>>=0,n||T(e,0,i,4),s.write(e,t,i,r,23,4),i+4}function w(e,t,i,r,n){return t=+t,i>>>=0,n||T(e,0,i,8),s.write(e,t,i,r,52,8),i+8}c.prototype.slice=function(e,t){var i=this.length,i=((e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(i,c.prototype),i},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||_(e,t,this.length);for(var r=this[e],n=1,s=0;++s<t&&(n*=256);)r+=this[e+s]*n;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||_(e,t,this.length);for(var r=this[e+--t],n=1;0<t&&(n*=256);)r+=this[e+--t]*n;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||_(e,t,this.length);for(var r=this[e],n=1,s=0;++s<t&&(n*=256);)r+=this[e+s]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||_(e,t,this.length);for(var r=t,n=1,s=this[e+--r];0<r&&(n*=256);)s+=this[e+--r]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||_(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt16BE=function(e,t){e>>>=0,t||_(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||_(e,4,this.length),s.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||_(e,4,this.length),s.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||_(e,8,this.length),s.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||_(e,8,this.length),s.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||b(this,e,t,i,Math.pow(2,8*i)-1,0);var n=1,s=0;for(this[t]=255&e;++s<i&&(n*=256);)this[t+s]=e/n&255;return t+i},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,i,r){e=+e,t>>>=0,i>>>=0,r||b(this,e,t,i,Math.pow(2,8*i)-1,0);var n=i-1,s=1;for(this[t+n]=255&e;0<=--n&&(s*=256);)this[t+n]=e/s&255;return t+i},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,i,r){e=+e,t>>>=0,r||b(this,e,t,i,(r=Math.pow(2,8*i-1))-1,-r);var n=0,s=1,a=0;for(this[t]=255&e;++n<i&&(s*=256);)e<0&&0===a&&0!==this[t+n-1]&&(a=1),this[t+n]=(e/s>>0)-a&255;return t+i},c.prototype.writeIntBE=function(e,t,i,r){e=+e,t>>>=0,r||b(this,e,t,i,(r=Math.pow(2,8*i-1))-1,-r);var n=i-1,s=1,a=0;for(this[t+n]=255&e;0<=--n&&(s*=256);)e<0&&0===a&&0!==this[t+n+1]&&(a=1),this[t+n]=(e/s>>0)-a&255;return t+i},c.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},c.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||b(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,i){return x(this,e,t,!0,i)},c.prototype.writeFloatBE=function(e,t,i){return x(this,e,t,!1,i)},c.prototype.writeDoubleLE=function(e,t,i){return w(this,e,t,!0,i)},c.prototype.writeDoubleBE=function(e,t,i){return w(this,e,t,!1,i)},c.prototype.copy=function(e,t,i,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i=i||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<i?i:r)===i)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var n=(r=e.length-t<r-i?e.length-t+i:r)-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),n},c.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var n;1===e.length&&(n=e.charCodeAt(0),"utf8"===r&&n<128||"latin1"===r)&&(e=n)}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");var s;if(!(i<=t))if(t>>>=0,i=void 0===i?this.length:i>>>0,"number"==typeof(e=e||0))for(s=t;s<i;++s)this[s]=e;else{var a=c.isBuffer(e)?e:c.from(e,r),o=a.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=a[s%o]}return this};var M=/[^+/0-9A-Za-z-_]/g;function C(e,t){var i;t=t||1/0;for(var r=e.length,n=null,s=[],a=0;a<r;++a){if(55295<(i=e.charCodeAt(a))&&i<57344){if(!n){if(56319<i){-1<(t-=3)&&s.push(239,191,189);continue}if(a+1===r){-1<(t-=3)&&s.push(239,191,189);continue}n=i;continue}if(i<56320){-1<(t-=3)&&s.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&-1<(t-=3)&&s.push(239,191,189);if(n=null,i<128){if(--t<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function A(e){return S.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function L(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function I(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function P(e){return e!=e}var R=function(){for(var e="0123456789abcdef",t=new Array(256),i=0;i<16;++i)for(var r=16*i,n=0;n<16;++n)t[r+n]=e[i]+e[n];return t}()},930:(e,t,i)=>{var r=void 0!==i.g?i.g:"undefined"!=typeof window?window:{},i=i(5893),n="undefined"!=typeof document?document:(n=r["__GLOBAL_DOCUMENT_CACHE@4"])||(r["__GLOBAL_DOCUMENT_CACHE@4"]=i);e.exports=n},1192:(e,t,i)=>{i="undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};e.exports=i},6608:(e,t,i)=>{"use strict";i.d(t,{L:()=>b});function r(){return c||y()&&(c=window.gsap)&&c.registerPlugin&&c}function o(e){return"string"==typeof e}function l(e){return"function"==typeof e}function f(e,t){var i="scroll"+(t="x"===t?"Width":"Height"),r="client"+t;return e===m||e===n||e===a?Math.max(n[i],a[i])-(m["inner"+t]||n[r]||a[r]):e[i]-e["offset"+t]}function s(e,t){var i,r;return(e=p(e)[0])&&e.getBoundingClientRect?(e=e.getBoundingClientRect(),r=(i=!t||t===m||t===a)?{top:n.clientTop-(m.pageYOffset||n.scrollTop||a.scrollTop||0),left:n.clientLeft-(m.pageXOffset||n.scrollLeft||a.scrollLeft||0)}:t.getBoundingClientRect(),e={x:e.left-r.left,y:e.top-r.top},!i&&t&&(e.x+=_(t,"x")(),e.y+=_(t,"y")()),e):console.warn("scrollTo target doesn't exist. Using 0")||{x:0,y:0}}function h(e,t,i,r,n){return isNaN(e)||"object"==typeof e?o(e)&&"="===e.charAt(1)?parseFloat(e.substr(2))*("-"===e.charAt(0)?-1:1)+r-n:"max"===e?f(t,i)-n:Math.min(f(t,i),s(e,t)[i]-n):parseFloat(e)-n}function u(){c=r(),y()&&c&&"undefined"!=typeof document&&document.body&&(m=window,a=document.body,n=document.documentElement,p=c.utils.toArray,c.config({autoKillThreshold:7}),g=c.config(),d=1)}var c,d,m,n,a,p,g,v,y=function(){return"undefined"!=typeof window},_=function(e,t){var i="scroll"+("x"===t?"Left":"Top");return e===m&&(null!=e.pageXOffset?i="page"+t.toUpperCase()+"Offset":e=null!=n[i]?n:a),function(){return e[i]}},b={version:"3.11.4",name:"scrollTo",rawVars:1,register:function(e){c=e,u()},init:function(e,t,i,r,n){d||u();var s=this,a=c.getProperty(e,"scrollSnapType");s.isWin=e===m,s.target=e,s.tween=i,t=function(e,t,i,r){if("object"!=typeof(e=l(e)?e(t,i,r):e))return o(e)&&"max"!==e&&"="!==e.charAt(1)?{x:e,y:e}:{y:e};if(e.nodeType)return{y:e,x:e};var n,s={};for(n in e)s[n]="onAutoKill"!==n&&l(e[n])?e[n](t,i,r):e[n];return s}(t,r,e,n),s.vars=t,s.autoKill=!!t.autoKill,s.getX=_(e,"x"),s.getY=_(e,"y"),s.x=s.xPrev=s.getX(),s.y=s.yPrev=s.getY(),v=v||c.core.globals().ScrollTrigger,"smooth"===c.getProperty(e,"scrollBehavior")&&c.set(e,{scrollBehavior:"auto"}),a&&"none"!==a&&(s.snap=1,s.snapInline=e.style.scrollSnapType,e.style.scrollSnapType="none"),null!=t.x?(s.add(s,"x",s.x,h(t.x,e,"x",s.x,t.offsetX||0),r,n),s._props.push("scrollTo_x")):s.skipX=1,null!=t.y?(s.add(s,"y",s.y,h(t.y,e,"y",s.y,t.offsetY||0),r,n),s._props.push("scrollTo_y")):s.skipY=1},render:function(e,t){for(var i,r,n,s=t._pt,a=t.target,o=t.tween,l=t.autoKill,h=t.xPrev,u=t.yPrev,c=t.isWin,d=t.snap,p=t.snapInline;s;)s.r(e,s.d),s=s._next;i=c||!t.skipX?t.getX():h,u=(r=c||!t.skipY?t.getY():u)-u,h=i-h,n=g.autoKillThreshold,t.x<0&&(t.x=0),t.y<0&&(t.y=0),l&&(!t.skipX&&(n<h||h<-n)&&i<f(a,"x")&&(t.skipX=1),!t.skipY&&(n<u||u<-n)&&r<f(a,"y")&&(t.skipY=1),t.skipX)&&t.skipY&&(o.kill(),t.vars.onAutoKill)&&t.vars.onAutoKill.apply(o,t.vars.onAutoKillParams||[]),c?m.scrollTo(t.skipX?i:t.x,t.skipY?r:t.y):(t.skipY||(a.scrollTop=t.y),t.skipX||(a.scrollLeft=t.x)),!d||1!==e&&0!==e||(r=a.scrollTop,i=a.scrollLeft,p?a.style.scrollSnapType=p:a.style.removeProperty("scroll-snap-type"),a.scrollTop=r+1,a.scrollLeft=i+1,a.scrollTop=r,a.scrollLeft=i),t.xPrev=t.x,t.yPrev=t.y,v&&v.update()},kill:function(e){var t="scrollTo"===e;!t&&"scrollTo_x"!==e||(this.skipX=1),!t&&"scrollTo_y"!==e||(this.skipY=1)}};b.max=f,b.getOffset=s,b.buildGetter=_,r()&&c.registerPlugin(b)},1605:(e,t,r)=>{"use strict";r.d(t,{i:()=>I});function n(){return Ce||"undefined"!=typeof window&&(Ce=window.gsap)&&Ce.registerPlugin&&Ce}function rt(e,t){return~ke.indexOf(e)&&ke[ke.indexOf(e)+1][t]}function nt(e){return!!~s.indexOf(e)}function Ee(e,t,i,r,n){e.addEventListener(t,i,{passive:!r,capture:!!n})}function Me(e,t,i,r){e.removeEventListener(t,i,!!r)}function st(){return Le&&Le.isPressed||Re.cache++}function a(i,r){function n(e){var t;return e||0===e?(o&&(Ae.history.scrollRestoration="manual"),t=Le&&Le.isPressed,e=n.v=Math.round(e)||(Le&&Le.iOS?1:0),i(e),n.cacheID=Re.cache,t&&l("ss",e)):(r||Re.cache!==n.cacheID||l("ref"))&&(n.cacheID=Re.cache,n.v=i()),n.v+n.offset}return n.offset=0,i&&n}function Pe(e){return Ce.utils.toArray(e)[0]||("string"==typeof e&&!1!==Ce.config().nullTargetWarn?console.warn("Element not found:",e):null)}function at(t,e){var i=e.s,e=e.sc,r=(nt(t)&&(t=pt.scrollingElement||ft),Re.indexOf(t)),n=e===Oe.sc?1:2,s=(~r||(r=Re.push(t)-1),Re[r+n]||t.addEventListener("scroll",st),Re[r+n]);return(r=s||(Re[r+n]=a(rt(t,i),!0)||(nt(t)?e:a(function(e){return arguments.length?t[i]=e:t[i]})))).target=t,s||(r.smooth="smooth"===Ce.getProperty(t,"scrollBehavior")),r}function ot(e,t,n){function s(e,t){var i=Tt();t||r<i-l?(o=a,a=e,h=l,l=i):n?a+=e:a=o+(e-o)/(i-h)*(l-h)}var a=e,o=e,l=Tt(),h=l,r=t||50,u=Math.max(500,3*r);return{update:s,reset:function(){o=a=n?0:a,h=l=0},getVelocity:function(e){var t=h,i=o,r=Tt();return!e&&0!==e||e===a||s(e),l===h||u<r-h?0:(a+(n?i:-i))/((n?r:l)-t)*1e3}}}function lt(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e}function ht(e){var t=Math.max.apply(Math,e),e=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(e)?t:e}function ut(){var i,e,t;(yt=Ce.core.globals().ScrollTrigger)&&yt.core&&(t=yt.core,i=t.bridge||{},e=t._scrollers,t=t._proxies,e.push.apply(e,Re),t.push.apply(t,ke),Re=e,ke=t,l=function(e,t){return i[e](t)})}function ct(e){return(Ce=e||n())&&"undefined"!=typeof document&&document.body&&(Ae=window,ft=(pt=document).documentElement,mt=pt.body,s=[Ae,pt,ft,mt],Ce.utils.clamp,_t=Ce.core.context||function(){},vt="onpointerenter"in mt?"pointer":"mouse",gt=A.isTouch=Ae.matchMedia&&Ae.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Ae||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints?2:0,Ie=A.eventTypes=("ontouchstart"in ft?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in ft?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return o=0},500),ut(),dt=1),dt}var Ce,dt,Ae,pt,ft,mt,gt,vt,yt,s,Le,Ie,_t,o=1,bt=[],Re=[],ke=[],Tt=Date.now,l=function(e,t){return t},h="scrollLeft",u="scrollTop",De={s:h,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:a(function(e){return arguments.length?Ae.scrollTo(e,Oe.sc()):Ae.pageXOffset||pt[h]||ft[h]||mt[h]||0})},Oe={s:u,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:De,sc:a(function(e){return arguments.length?Ae.scrollTo(De.sc(),e):Ae.pageYOffset||pt[u]||ft[u]||mt[u]||0})},A=(De.op=Oe,Re.cache=0,function(){function e(e){this.init(e)}e.prototype.init=function(e){dt||ct(Ce)||console.warn("Please gsap.registerPlugin(Observer)"),yt||ut();function t(){return xe=Tt()}function i(t){var e,i,r;P(t,1)||(Me(_?p:A,Ie[1],k,!0),e=!isNaN(x.y-x.startY),i=x.isDragging&&(3<Math.abs(x.x-x.startX)||3<Math.abs(x.y-x.startY)),r=lt(t),!i&&e&&(x._vx.reset(),x._vy.reset(),m)&&ge&&Ce.delayedCall(.08,function(){var e;300<Tt()-xe&&!t.defaultPrevented&&(t.target.click?t.target.click():A.createEvent&&((e=A.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,Ae,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(e)))}),x.isDragging=x.isGesturing=x.isPressed=!1,g&&!_&&O.restart(!0),Y&&i&&Y(x),J&&J(x,i))}function r(e){return e.touches&&1<e.touches.length&&(x.isGesturing=!0,ue(e,x.isDragging))}function N(){return x.isGesturing=!1,ce(x)}function U(e){var t;P(e)||(e=E(),t=M(),we((e-_e)*b,(t-be)*b,1),_e=e,be=t,g&&O.restart(!0))}function B(e){var t;P(e)||(e=lt(e,m),de&&(o=!0),t=(1===e.deltaMode?G:2===e.deltaMode?Ae.innerHeight:1)*j,we(e.deltaX*t,e.deltaY*t,0),g&&!_&&O.restart(!0))}function F(e){var t,i,r;!P(e)&&(t=e.clientX,e=e.clientY,i=t-x.x,r=e-x.y,x.x=t,x.y=e,a=!0,i||r)&&Se(i,r)}function H(e){x.event=e,oe(x)}function z(e){x.event=e,le(x)}function V(e){return P(e)||lt(e,m)&&me(x)}var n,s,a,o,l,h,u=e.tolerance,c=e.dragMinimum,d=e.type,p=e.target,G=e.lineHeight,f=e.debounce,m=e.preventDefault,g=e.onStop,W=e.onStopDelay,v=e.ignore,j=e.wheelSpeed,q=e.event,X=e.onDragStart,Y=e.onDragEnd,$=e.onDrag,K=e.onPress,J=e.onRelease,Z=e.onRight,Q=e.onLeft,ee=e.onUp,te=e.onDown,ie=e.onChangeX,re=e.onChangeY,ne=e.onChange,se=e.onToggleX,ae=e.onToggleY,oe=e.onHover,le=e.onHoverEnd,y=e.onMove,he=e.ignoreCheck,_=e.isNormalizer,ue=e.onGestureStart,ce=e.onGestureEnd,de=e.onWheel,pe=e.onEnable,fe=e.onDisable,me=e.onClick,b=e.scrollSpeed,T=e.capture,ge=e.allowClicks,ve=e.lockAxis,ye=e.onLockAxis,v=(this.target=p=Pe(p)||ft,this.vars=e,v&&Ce.utils.toArray(v)),u=u||1e-9,c=c||0,j=j||1,b=b||1,d=d||"wheel,touch,pointer",f=!1!==f,G=G||parseFloat(Ae.getComputedStyle(mt).lineHeight)||22,x=this,w=0,S=0,E=at(p,De),M=at(p,Oe),_e=E(),be=M(),Te=~d.indexOf("touch")&&!~d.indexOf("pointer")&&"pointerdown"===Ie[0],C=nt(p),A=p.ownerDocument||pt,L=[0,0,0],I=[0,0,0],xe=0,P=function(e,t){return(x.event=e)&&v&&~v.indexOf(e.target)||t&&Te&&"touch"!==e.pointerType||he&&he(e,t)},R=function(){var e=x.deltaX=ht(L),t=x.deltaY=ht(I),i=Math.abs(e)>=u,r=Math.abs(t)>=u;ne&&(i||r)&&ne(x,e,t,L,I),i&&(Z&&0<x.deltaX&&Z(x),Q&&x.deltaX<0&&Q(x),ie&&ie(x),se&&x.deltaX<0!=w<0&&se(x),w=x.deltaX,L[0]=L[1]=L[2]=0),r&&(te&&0<x.deltaY&&te(x),ee&&x.deltaY<0&&ee(x),re&&re(x),ae&&x.deltaY<0!=S<0&&ae(x),S=x.deltaY,I[0]=I[1]=I[2]=0),(a||s)&&(y&&y(x),s&&($(x),s=!1),a=!1),l&&(l=!1,ye)&&ye(x),o&&(de(x),o=!1),n=0},we=function(e,t,i){L[i]+=e,I[i]+=t,x._vx.update(e),x._vy.update(t),f?n=n||requestAnimationFrame(R):R()},Se=function(e,t){ve&&!h&&(x.axis=h=Math.abs(e)>Math.abs(t)?"x":"y",l=!0),"y"!==h&&(L[2]+=e,x._vx.update(e,!0)),"x"!==h&&(I[2]+=t,x._vy.update(t,!0)),f?n=n||requestAnimationFrame(R):R()},k=function(e){var t,i,r,n;!P(e,1)&&(t=(e=lt(e,m)).clientX,e=e.clientY,i=t-x.x,r=e-x.y,n=x.isDragging,x.x=t,x.y=e,n||Math.abs(x.startX-t)>=c||Math.abs(x.startY-e)>=c)&&($&&(s=!0),n||(x.isDragging=!0),Se(i,r),n||X&&X(x))},D=x.onPress=function(e){P(e,1)||(x.axis=h=null,O.pause(),x.isPressed=!0,e=lt(e),w=S=0,x.startX=x.x=e.clientX,x.startY=x.y=e.clientY,x._vx.reset(),x._vy.reset(),Ee(_?p:A,Ie[1],k,m,!0),x.deltaX=x.deltaY=0,K&&K(x))},O=x._dc=Ce.delayedCall(W||.25,function(){x._vx.reset(),x._vy.reset(),O.pause(),g&&g(x)}).pause();x.deltaX=x.deltaY=0,x._vx=ot(0,50,!0),x._vy=ot(0,50,!0),x.scrollX=E,x.scrollY=M,x.isDragging=x.isGesturing=x.isPressed=!1,_t(this),x.enable=function(e){return x.isEnabled||(Ee(C?A:p,"scroll",st),0<=d.indexOf("scroll")&&Ee(C?A:p,"scroll",U,m,T),0<=d.indexOf("wheel")&&Ee(p,"wheel",B,m,T),(0<=d.indexOf("touch")&&gt||0<=d.indexOf("pointer"))&&(Ee(p,Ie[0],D,m,T),Ee(A,Ie[2],i),Ee(A,Ie[3],i),ge&&Ee(p,"click",t,!1,!0),me&&Ee(p,"click",V),ue&&Ee(A,"gesturestart",r),ce&&Ee(A,"gestureend",N),oe&&Ee(p,vt+"enter",H),le&&Ee(p,vt+"leave",z),y)&&Ee(p,vt+"move",F),x.isEnabled=!0,e&&e.type&&D(e),pe&&pe(x)),x},x.disable=function(){x.isEnabled&&(bt.filter(function(e){return e!==x&&nt(e.target)}).length||Me(C?A:p,"scroll",st),x.isPressed&&(x._vx.reset(),x._vy.reset(),Me(_?p:A,Ie[1],k,!0)),Me(C?A:p,"scroll",U,T),Me(p,"wheel",B,T),Me(p,Ie[0],D,T),Me(A,Ie[2],i),Me(A,Ie[3],i),Me(p,"click",t,!0),Me(p,"click",V),Me(A,"gesturestart",r),Me(A,"gestureend",N),Me(p,vt+"enter",H),Me(p,vt+"leave",z),Me(p,vt+"move",F),x.isEnabled=x.isPressed=x.isDragging=!1,fe)&&fe(x)},x.kill=x.revert=function(){x.disable();var e=bt.indexOf(x);0<=e&&bt.splice(e,1),Le===x&&(Le=0)},bt.push(x),_&&nt(p)&&(Le=x),x.enable(q)};for(var t=e.prototype,i=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}],r=0;r<i.length;r++){var n=i[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}return e}());A.version="3.11.4",A.create=function(e){return new A(e)},A.register=ct,A.getAll=function(){return bt.slice()},A.getById=function(t){return bt.filter(function(e){return e.vars.id===t})[0]},n()&&Ce.registerPlugin(A);function c(){return Xt=1}function d(){return Xt=0}function Ne(e){return e}function xt(e){return Math.round(1e5*e)/1e5||0}function p(){return"undefined"!=typeof window}function f(){return Be||p()&&(Be=window.gsap)&&Be.registerPlugin&&Be}function wt(e){return rt(e,"getBoundingClientRect")||(ii(e)?function(){return yi.width=Fe.innerWidth,yi.height=Fe.innerHeight,yi}:function(){return Lt(e)})}function m(e,t){for(var i=0;i<R.length;i+=3)t&&!~t.indexOf(R[i+1])||e(R[i],R[i+1],R[i+2])}function St(e){return"number"==typeof e}function Et(e){return"object"==typeof e}function Mt(e,t,i){e&&e.progress(t?0:1)&&i&&e.pause()}function Ct(e,t){e.enabled&&(t=t(e))&&t.totalTime&&(e.callbackAnimation=t)}function At(e,t){for(var i in t)i in e||(e[i]=t[i]);return e}function Lt(e,t){return t=t&&"matrix(1, 0, 0, 1, 0, 0)"!==Qe(e)[M]&&Be.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),e=e.getBoundingClientRect(),t&&t.progress(0).kill(),e}function It(e,t){return t=t.d2,e["offset"+t]||e["client"+t]||0}function Pt(e){var t,i=[],r=e.labels,n=e.duration();for(t in r)i.push(r[t]/n);return i}function Rt(n){var s=Be.utils.snap(n),a=Array.isArray(n)&&n.slice(0).sort(function(e,t){return e-t});return a?function(e,t,i){var r;if(void 0===i&&(i=.001),!t)return s(e);if(0<t){for(e-=i,r=0;r<a.length;r++)if(a[r]>=e)return a[r];return a[r-1]}for(r=a.length,e+=i;r--;)if(a[r]<=e)return a[r];return a[0]}:function(e,t,i){void 0===i&&(i=.001);var r=s(e);return!t||Math.abs(r-e)<i||r-e<0==t<0?r:s(t<0?e-n:e+n)}}function g(t,i,e,r){e.split(",").forEach(function(e){return t(i,e,r)})}function Ue(e,t,i,r){return e.removeEventListener(t,i,!!r)}function v(e,t,i){i&&i.wheelHandler&&e(t,"wheel",i)}function kt(e,t){var i,r;return Ye(e)&&(r=~(i=e.indexOf("="))?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0,~i&&(e.indexOf("%")>i&&(r*=t/100),e=e.substr(0,i-1)),e=r+(e in G?G[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)),e}function Dt(e,t,i,r,n,s,a,o){var l=n.startColor,h=n.endColor,u=n.fontSize,c=n.indent,n=n.fontWeight,d=He.createElement("div"),p=ii(i)||"fixed"===rt(i,"pinType"),f=-1!==e.indexOf("scroller"),i=p?Ve:i,m=-1!==e.indexOf("start"),h="border-color:"+(l=m?l:h)+";font-size:"+u+";color:"+l+";font-weight:"+n+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return h+="position:"+((f||o)&&p?"fixed;":"absolute;"),!f&&!o&&p||(h+=(r===Oe?z:V)+":"+(s+parseFloat(c))+"px;"),a&&(h+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),d._isStart=m,d.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),d.style.cssText=h,d.innerText=t||0===t?e+"-"+t:e,i.children[0]?i.insertBefore(d,i.children[0]):i.appendChild(d),d._offset=d["offset"+r.op.d2],y(d,0,r,m),d}function y(e,t,i,r){var n={display:"block"},s=i[r?"os2":"p2"],a=i[r?"p2":"os2"];e._isFlipped=r,n[i.a+"Percent"]=r?-100:0,n[i.a]=r?"1px":0,n["border"+s+ci]=1,n["border"+a+ci]=0,n[i.p]=t+"px",Be.set(e,n)}function _(){return 34<qe()-Xe&&(F=F||requestAnimationFrame(K))}function Ot(){L&&L.isPressed&&!(L.startX>Ve.clientWidth)||(Re.cache++,L?F=F||requestAnimationFrame(K):K(),Xe||q("scrollStart"),Xe=qe())}function b(){N=Fe.innerWidth,O=Fe.innerHeight}function Nt(){Re.cache++,Ge||k||He.fullscreenElement||He.webkitFullscreenElement||D&&N===Fe.innerWidth&&!(Math.abs(Fe.innerHeight-O)>.25*Fe.innerHeight)||S.restart(!0)}function T(e){for(var t=0;t<i.length;t+=5)(!e||i[t+4]&&i[t+4].query===e)&&(i[t].style.cssText=i[t+1],i[t].getBBox&&i[t].setAttribute("transform",i[t+2]||""),i[t+3].uncache=1)}function Ut(e,t){!Xe||e?(je=I.isRefreshing=!0,Re.forEach(function(e){return $e(e)&&e.cacheID++&&(e.rec=e())}),e=q("refreshInit"),Yt&&I.sort(),t||X(),Re.forEach(function(e){$e(e)&&(e.smooth&&(e.target.style.scrollBehavior="auto"),e(0))}),tt.slice(0).forEach(function(e){return e.refresh()}),tt.forEach(function(e,t){var i,r;e._subPinOffset&&e.pin&&(i=e.vars.horizontal?"offsetWidth":"offsetHeight",r=e.pin[i],e.revert(!0,1),e.adjustPinSpacing(e.pin[i]-r),e.revert(!1,1))}),tt.forEach(function(e){return"max"===e.vars.end&&e.setPositions(e.start,Math.max(e.start+1,ri(e.scroller,e._dir)))}),e.forEach(function(e){return e&&e.render&&e.render(-1)}),Re.forEach(function(e){$e(e)&&(e.smooth&&requestAnimationFrame(function(){return e.target.style.scrollBehavior="smooth"}),e.rec)&&e(e.rec)}),Y(B,1),S.pause(),gi++,K(2),tt.forEach(function(e){return $e(e.vars.onRefresh)&&e.vars.onRefresh(e)}),je=I.isRefreshing=!1,q("refresh")):et(I,"scrollEnd",mi)}function Bt(e,t,i,r){if(!e._gsap.swappedIn){for(var n,s=J.length,a=t.style,o=e.style;s--;)a[n=J[s]]=i[n];a.position="absolute"===i.position?"absolute":"relative","inline"===i.display&&(a.display="inline-block"),o[V]=o[z]="auto",a.flexBasis=i.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[si]=It(e,De)+Ze,a[ai]=It(e,Oe)+Ze,a[Ke]=o[Je]=o.top=o.left="0",Ft(r),o[si]=o["max"+ci]=i[si],o[ai]=o.maxHeight=i[ai],o[Ke]=i[Ke],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}}function Ft(e){if(e){var t,i,r=e.t.style,n=e.length,s=0;for((e.t._gsap||Be.core.getCache(e.t)).uncache=1;s<n;s+=2)i=e[s+1],t=e[s],i?r[t]=i:r[t]&&r.removeProperty(t.replace(Q,"-$1").toLowerCase())}}function Ht(e){for(var t=Z.length,i=e.style,r=[],n=0;n<t;n++)r.push(Z[n],i[Z[n]]);return r.t=e,r}function zt(e,t,i,r,n,s,a,o,l,h,u,c,d){$e(e)&&(e=e(o)),Ye(e)&&"max"===e.substr(0,3)&&(e=c+("="===e.charAt(4)?kt("0"+e.substr(3),i):0));var p,f,m,g=d?d.time():0;return d&&d.seek(0),St(e)?a&&y(a,i,r,!0):($e(t)&&(t=t(o)),o=(e||"0").split(" "),f=Pe(t)||Ve,(t=Lt(f)||{})&&(t.left||t.top)||"none"!==Qe(f).display||(p=f.style.display,f.style.display="block",t=Lt(f),p?f.style.display=p:f.style.removeProperty("display")),p=kt(o[0],t[r.d]),o=kt(o[1]||"0",i),e=t[r.p]-l[r.p]-h+p+n-o,a&&y(a,o,r,i-o<20||a._isStart&&20<o),i-=i-o),s&&(t=s._isStart,m="scroll"+r.d2,y(s,h=e+i,r,t&&20<h||!t&&(u?Math.max(Ve[m],ze[m]):s.parentNode[m])<=h+1),u)&&(l=Lt(a),u)&&(s.style[r.op.p]=l[r.op.p]-r.op.m-s._offset+Ze),d&&f&&(m=Lt(f),d.seek(c),p=Lt(f),d._caScrollDist=m[r.p]-p[r.p],e=e/d._caScrollDist*c),d&&d.seek(g),d?e:Math.round(e)}function Vt(e,t,i,r){if(e.parentNode!==t){var n,s,a=e.style;if(t===Ve){for(n in e._stOrig=a.cssText,s=Qe(e))+n||ee.test(n)||!s[n]||"string"!=typeof a[n]||"0"===n||(a[n]=s[n]);a.top=i,a.left=r}else a.cssText=e._stOrig;Be.core.getCache(e).uncache=1,t.appendChild(e)}}function Gt(l,e){function h(e,t,i,r,n){var s=h.tween,a=t.onComplete,o={};return i=i||d(),n=r&&n||0,r=r||e-i,s&&s.kill(),u=Math.round(i),t[p]=e,(t.modifiers=o)[p]=function(e){return(e=Math.round(d()))!==u&&e!==c&&3<Math.abs(e-u)&&3<Math.abs(e-c)?(s.kill(),h.tween=0):e=i+r*s.ratio+n*s.ratio*s.ratio,c=u,u=Math.round(e)},t.onUpdate=function(){Re.cache++,K()},t.onComplete=function(){h.tween=0,a&&a.call(s)},s=h.tween=Be.to(l,t)}var u,c,d=at(l,e),p="_scroll"+e.p2;return(l[p]=d).wheelHandler=function(){return h.tween&&h.tween.kill()&&(h.tween=0)},et(l,"wheel",d.wheelHandler),h}var Be,x,Fe,He,ze,Ve,w,S,Wt,jt,qt,E,Ge,Xt,M,We,C,P,R,Yt,$t,k,L,D,O,N,U,Kt,B,Jt,F,je,Zt,Qt,ei=1,qe=Date.now,H=qe(),Xe=0,ti=0,ii=function(e){return!!~w.indexOf(e)},ri=function(e,t){t.s;var i,r=t.d2,n=t.d,t=t.a;return(i="scroll"+r)&&(t=rt(e,i))?t()-wt(e)()[n]:ii(e)?(ze[i]||Ve[i])-(Fe["inner"+r]||ze["client"+r]||Ve["client"+r]):e[i]-e["offset"+r]},Ye=function(e){return"string"==typeof e},$e=function(e){return"function"==typeof e},ni=Math.abs,z="right",V="bottom",si="width",ai="height",oi="Right",li="Left",hi="Top",ui="Bottom",Ke="padding",Je="margin",ci="Width",r="Height",Ze="px",Qe=function(e){return Fe.getComputedStyle(e)},et=function(e,t,i,r,n){return e.addEventListener(t,i,{passive:!r,capture:!!n})},di={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},pi={toggleActions:"play",anticipatePin:0},G={top:0,left:0,center:.5,bottom:1,right:1},tt=[],fi={},W={},j=[],mi=function e(){return Ue(I,"scrollEnd",e)||Ut(!0)},q=function(e){return W[e]&&W[e].map(function(e){return e()})||j},i=[],X=function(e,t){var i;for(We=0;We<tt.length;We++)!(i=tt[We])||t&&i._ctx!==t||(e?i.kill(1):i.revert(!0,!0));t&&T(t),t||q("revert")},Y=function(e,t){Re.cache++,!t&&je||Re.forEach(function(e){return $e(e)&&e.cacheID++&&(e.rec=0)}),Ye(e)&&(Fe.history.scrollRestoration=B=e)},gi=0,$=0,vi=1,K=function(e){if(!je||2===e){I.isUpdating=!0,Qt&&Qt.update(0);var t=tt.length,e=qe(),i=50<=e-H,r=t&&tt[0].scroll();if(vi=r<$?-1:1,$=r,i&&(Xe&&!Xt&&200<e-Xe&&(Xe=0,q("scrollEnd")),qt=H,H=e),vi<0){for(We=t;0<We--;)tt[We]&&tt[We].update(0,i);vi=1}else for(We=0;We<t;We++)tt[We]&&tt[We].update(0,i);I.isUpdating=!1}F=0},J=["left","top",V,z,Je+ui,Je+oi,Je+hi,Je+li,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Z=J.concat([si,ai,"boxSizing","max"+ci,"max"+r,"position",Je,Ke,Ke+hi,Ke+oi,Ke+ui,Ke+li]),Q=/([A-Z])/g,yi={left:0,top:0},ee=/(webkit|moz|length|cssText|inset)/i,I=(it.prototype.init=function(v,y){var _,r,m,b,W,T,x,w,j,q,X,S,Y,g,$,E,K,M,J,Z,Q,ee,te,C,a,p,A,L,I,ie,re,o,d,ne,n,se,ae,oe,P,R,k,le,he,l,ue,ce,f,de,D,pe,fe,O,N,U,B,F,me,ge,ve,H,ye,_e,be,Te,xe,z,e,V,we,t,i,G,Se,h,u,c,Ee,Me,Ce,s,Ae,Le,Ie;this.progress=this.start=0,this.vars&&this.kill(!0,!0),ti?(t=v=At(Ye(v)||St(v)||v.nodeType?{trigger:v}:v,pi),d=t.onUpdate,ne=t.toggleClass,n=t.id,se=t.onToggle,ae=t.onRefresh,oe=t.scrub,P=t.trigger,R=t.pin,k=t.pinSpacing,le=t.invalidateOnRefresh,he=t.anticipatePin,l=t.onScrubComplete,ue=t.onSnapComplete,ce=t.once,f=t.snap,de=t.pinReparent,e=t.pinSpacer,D=t.containerAnimation,pe=t.fastScrollEnd,fe=t.preventOverlaps,O=v.horizontal||v.containerAnimation&&!1!==v.horizontal?De:Oe,N=!oe&&0!==oe,U=Pe(v.scroller||Fe),t=Be.core.getCache(U),B=ii(U),F="fixed"===("pinType"in v?v.pinType:rt(U,"pinType")||B&&"fixed"),me=[v.onEnter,v.onLeave,v.onEnterBack,v.onLeaveBack],ge=N&&v.toggleActions.split(" "),i=("markers"in v?v:pi).markers,ve=!B&&parseFloat(Qe(U)["border"+O.p2+ci])||0,H=this,ye=v.onRefreshInit&&function(){return v.onRefreshInit(H)},Me=U,Ce=B,Ae=(s=O).d,Le=s.d2,Ie=s.a,_e=(Ie=rt(Me,"getBoundingClientRect"))?function(){return Ie()[Ae]}:function(){return(Ce?Fe["inner"+Le]:Me["client"+Le])||0},s=U,be=!B||~ke.indexOf(s)?wt(s):function(){return yi},xe=Te=0,z=at(U,O),Kt(H),H._dir=O,he*=45,H.scroller=U,H.scroll=D?D.time.bind(D):z,b=z(),H.vars=v,y=y||v.animation,"refreshPriority"in v&&(Yt=1,-9999===v.refreshPriority)&&(Qt=H),t.tweenScroll=t.tweenScroll||{top:Gt(U,Oe),left:Gt(U,De)},H.tweenTo=_=t.tweenScroll[O.p],H.scrubDuration=function(e){(a=St(e)&&e)?C?C.duration(e):C=Be.to(y,{ease:"expo",totalProgress:"+=0.001",duration:a,paused:!0,onComplete:function(){return l&&l(H)}}):(C&&C.progress(1).kill(),C=0)},y&&(y.vars.lazy=!1,y._initted||!1!==y.vars.immediateRender&&!1!==v.immediateRender&&y.duration()&&y.render(0,!0,!0),H.animation=y.pause(),(y.scrollTrigger=H).scrubDuration(oe),ee=0,n=n||y.vars.id),tt.push(H),f&&(Et(f)&&!f.push||(f={snapTo:f}),"scrollBehavior"in Ve.style&&Be.set(B?[Ve,ze]:U,{scrollBehavior:"auto"}),Re.forEach(function(e){return $e(e)&&e.target===(B?He.scrollingElement||ze:U)&&(e.smooth=!1)}),m=$e(f.snapTo)?f.snapTo:"labels"===f.snapTo?(Ee=y,function(e){return Be.utils.snap(Pt(Ee),e)}):"labelsDirectional"===f.snapTo?(o=y,function(e,t){return Rt(Pt(o))(e,t.direction)}):!1!==f.directional?function(e,t){return Rt(f.snapTo)(e,qe()-xe<500?0:t.direction)}:Be.utils.snap(f.snapTo),p=f.duration||{min:.1,max:2},p=Et(p)?jt(p.min,p.max):jt(p,p),A=Be.delayedCall(f.delay||a/2||.1,function(){var e,t,i,r,n,s,a,o,l,h,u=z(),c=qe()-xe<500,d=_.tween;!(c||Math.abs(H.getVelocity())<10)||d||Xt||Te===u?H.isActive&&Te!==u&&A.restart(!0):(e=(u-T)/w,t=y&&!N?y.totalProgress():e,c=!c&&(t-te)/(qe()-qt)*1e3||0,i=Be.utils.clamp(-e,1-e,ni(c/2)*c/.185),r=e+(!1===f.inertia?0:i),n=jt(0,1,m(r,H)),s=Math.round(T+n*w),o=(a=f).onStart,l=a.onInterrupt,h=a.onComplete,u<=x&&T<=u&&s!==u&&(d&&!d._initted&&d.data<=ni(s-u)||(!1===f.inertia&&(i=n-e),_(s,{duration:p(ni(.185*Math.max(ni(r-t),ni(n-t))/c/.05||0)),ease:f.ease||"power3",data:ni(s-u),onInterrupt:function(){return A.restart(!0)&&l&&l(H)},onComplete:function(){H.update(),Te=z(),ee=te=y&&!N?y.totalProgress():H.progress,ue&&ue(H),h&&h(H)}},u,i*w,s-u-i*w),o&&o(H,_.tween))))}).pause()),n&&(fi[n]=H),s=(s=(P=H.trigger=Pe(P||R))&&P._gsap&&P._gsap.stRevert)&&s(H),R=!0===R?P:Pe(R),Ye(ne)&&(ne={targets:P,className:ne}),R&&(!1!==k&&k!==Je&&(k=!(!k&&R.parentNode&&R.parentNode.style&&"flex"===Qe(R.parentNode).display)&&Ke),H.pin=R,(r=Be.core.getCache(R)).spacer?j=r.pinState:(e&&((e=Pe(e))&&!e.nodeType&&(e=e.current||e.nativeElement),r.spacerIsNative=!!e,e)&&(r.spacerState=Ht(e)),r.spacer=S=e||He.createElement("div"),S.classList.add("pin-spacer"),n&&S.classList.add("pin-spacer-"+n),r.pinState=j=Ht(R)),!1!==v.force3D&&Be.set(R,{force3D:!0}),H.spacer=S=r.spacer,t=Qe(R),K=t[k+O.os2],Y=Be.getProperty(R),g=Be.quickSetter(R,O.a,Ze),Bt(R,S,t),X=Ht(R)),i&&(e=Et(i)?At(i,di):di,V=Dt("scroller-start",n,U,O,e,0),we=Dt("scroller-end",n,U,O,e,0,V),t=V["offset"+O.op.d2],i=Pe(rt(U,"content")||U),G=this.markerStart=Dt("start",n,i,O,e,t,0,D),Se=this.markerEnd=Dt("end",n,i,O,e,t,0,D),D&&(re=Be.quickSetter([G,Se],O.a,Ze)),F||ke.length&&!0===rt(U,"fixedMarkers")||(e=Qe(i=B?Ve:U).position,i.style.position="absolute"===e||"fixed"===e?e:"relative",Be.set([V,we],{force3D:!0}),J=Be.quickSetter(V,O.a,Ze),Q=Be.quickSetter(we,O.a,Ze))),D&&(h=D.vars.onUpdate,u=D.vars.onUpdateParams,D.eventCallback("onUpdate",function(){H.update(0,0,1),h&&h.apply(u||[])})),H.previous=function(){return tt[tt.indexOf(H)-1]},H.next=function(){return tt[tt.indexOf(H)+1]},H.revert=function(e,t){if(!t)return H.kill(!0);var i,r,n=!1!==e||!H.enabled,t=Ge;n!==H.isReverted&&(n&&(I=Math.max(z(),H.scroll.rec||0),L=H.progress,ie=y&&y.progress()),G&&[G,Se,V,we].forEach(function(e){return e.style.display=n?"none":"block"}),n&&(Ge=1,H.update(n)),!R||de&&H.isActive||(n?(e=R,i=S,Ft(j),(r=e._gsap).spacerIsNative?Ft(r.spacerState):e._gsap.swappedIn&&(r=i.parentNode)&&(r.insertBefore(e,i),r.removeChild(i)),e._gsap.swappedIn=!1):Bt(R,S,Qe(R),M)),n||H.update(n),Ge=t,H.isReverted=n)},H.refresh=function(e,t){if(!Ge&&H.enabled||t)if(R&&e&&Xe)et(it,"scrollEnd",mi);else{!je&&ye&&ye(H),Ge=1,xe=qe(),_.tween&&(_.tween.kill(),_.tween=0),C&&C.pause(),le&&y&&y.revert({kill:!1}).invalidate(),H.isReverted||H.revert(!0,!0),H._subPinOffset=!1;for(var i,r,n,s,a,o,t=_e(),e=be(),l=D?D.duration():ri(U,O),h=0,u=0,c=v.end,d=v.endTrigger||P,p=v.start||(0!==v.start&&P?R?"0 0":"0 100%":0),f=H.pinnedContainer=v.pinnedContainer&&Pe(v.pinnedContainer),m=P&&Math.max(0,tt.indexOf(H))||0,g=m;g--;)(n=tt[g]).end||n.refresh(0,1)||(Ge=1),!(s=n.pin)||s!==P&&s!==R||n.isReverted||((a=a||[]).unshift(n),n.revert(!0,!0)),n!==tt[g]&&(m--,g--);for($e(p)&&(p=p(H)),T=zt(p,P,t,O,z(),G,V,H,e,ve,F,l,D)||(R?-.001:0),$e(c)&&(c=c(H)),Ye(c)&&!c.indexOf("+=")&&(~c.indexOf(" ")?c=(Ye(p)?p.split(" ")[0]:"")+c:(h=kt(c.substr(2),t),c=Ye(p)?p:T+h,d=P)),x=Math.max(T,zt(c||(d?"100% 0":l),d,t,O,z()+h,Se,we,H,e,ve,F,l,D))||-.001,w=x-T||(T-=.01)&&.001,h=0,g=m;g--;)(s=(n=tt[g]).pin)&&n.start-n._pinPush<=T&&!D&&0<n.end&&(i=n.end-n.start,(s===P&&n.start-n._pinPush<T||s===f)&&!St(p)&&(h+=i*(1-n.progress)),s===R)&&(u+=i);if(T+=h,x+=h,H._pinPush=u,G&&h&&((i={})[O.a]="+="+h,f&&(i[O.p]="-="+z()),Be.set([G,Se],i)),R)i=Qe(R),c=O===Oe,d=z(),$=parseFloat(Y(O.a))+u,!l&&1<x&&((o={style:o=(B?He.scrollingElement||ze:U).style,value:o["overflow"+O.a.toUpperCase()]})["overflow"+O.a.toUpperCase()]="scroll"),Bt(R,S,i),X=Ht(R),r=Lt(R,!0),t=F&&at(U,c?De:Oe)(),k&&((M=[k+O.os2,w+u+Ze]).t=S,(g=k===Ke?It(R,O)+w+u:0)&&M.push(O.d,g+Ze),Ft(M),f&&tt.forEach(function(e){e.pin===f&&!1!==e.vars.pinSpacing&&(e._subPinOffset=!0)}),F)&&z(I),F&&((e={top:r.top+(c?d-T:t)+Ze,left:r.left+(c?t:d-T)+Ze,boxSizing:"border-box",position:"fixed"})[si]=e["max"+ci]=Math.ceil(r.width)+Ze,e[ai]=e.maxHeight=Math.ceil(r.height)+Ze,e[Je]=e[Je+hi]=e[Je+oi]=e[Je+ui]=e[Je+li]="0",e[Ke]=i[Ke],e[Ke+hi]=i[Ke+hi],e[Ke+oi]=i[Ke+oi],e[Ke+ui]=i[Ke+ui],e[Ke+li]=i[Ke+li],q=function(e,t){for(var i,r=[],n=e.length,s=de?8:0;s<n;s+=2)i=e[s],r.push(i,i in t?t[i]:e[s+1]);return r.t=e.t,r}(j,e),je)&&z(0),y?(l=y._initted,$t(1),y.render(y.duration(),!0,!0),E=Y(O.a)-$+w+u,Z=1<Math.abs(w-E),F&&Z&&q.splice(q.length-2,2),y.render(0,!0,!0),l||y.invalidate(!0),y.parent||y.totalTime(y.totalTime()),$t(0)):E=w,o&&(o.value?o.style["overflow"+O.a.toUpperCase()]=o.value:o.style.removeProperty("overflow-"+O.a));else if(P&&z()&&!D)for(r=P.parentNode;r&&r!==Ve;)r._pinOffset&&(T-=r._pinOffset,x-=r._pinOffset),r=r.parentNode;a&&a.forEach(function(e){return e.revert(!1,!0)}),H.start=T,H.end=x,b=W=je?I:z(),D||je||(b<I&&z(I),H.scroll.rec=0),H.revert(!1,!0),A&&(Te=-1,H.isActive&&z(T+w*L),A.restart(!0)),Ge=0,y&&N&&(y._initted||ie)&&y.progress()!==ie&&y.progress(ie,!0).render(y.time(),!0,!0),L===H.progress&&!D||(y&&!N&&y.totalProgress(L,!0),H.progress=(b-T)/w===L?0:L),R&&k&&(S._pinOffset=Math.round(H.progress*E)),ae&&!je&&ae(H)}},H.getVelocity=function(){return(z()-W)/(qe()-qt)*1e3||0},H.endAnimation=function(){Mt(H.callbackAnimation),y&&(C?C.progress(1):y.paused()?N||Mt(y,H.direction<0,1):Mt(y,y.reversed()))},H.labelToScroll=function(e){return y&&y.labels&&(T||H.refresh()||T)+y.labels[e]/y.duration()*w||0},H.getTrailing=function(t){var e=tt.indexOf(H),e=0<H.direction?tt.slice(0,e).reverse():tt.slice(e+1);return(Ye(t)?e.filter(function(e){return e.vars.preventOverlaps===t}):e).filter(function(e){return 0<H.direction?e.end<=T:e.start>=x})},H.update=function(e,t,i){var r,n,s,a,o,l,h,u,c;(!D||i||e)&&(i=je?I:H.scroll(),o=(o=e?0:(i-T)/w)<0?0:1<o?1:o||0,h=H.progress,t&&(W=b,b=D?z():i,f)&&(te=ee,ee=y&&!N?y.totalProgress():o),(o=he&&!o&&R&&!Ge&&!ei&&Xe&&T<i+(i-W)/(qe()-qt)*he?1e-4:o)!==h&&H.enabled&&(u=(t=(r=H.isActive=!!o&&o<1)!=(!!h&&h<1))||!!o!=!!h,H.direction=h<o?1:-1,H.progress=o,u&&!Ge&&(n=o&&!h?0:1===o?1:1===h?2:3,N)&&(s=!t&&"none"!==ge[n+1]&&ge[n+1]||ge[n],a=y&&("complete"===s||"reset"===s||s in y)),fe&&(t||a)&&(a||oe||!y)&&($e(fe)?fe(H):H.getTrailing(fe).forEach(function(e){return e.endAnimation()})),N||(!C||Ge||ei?y&&y.totalProgress(o,!!Ge):(C._dp._time-C._start!==C._time&&C.render(C._dp._time-C._start),C.resetTo?C.resetTo("totalProgress",o,y._tTime/y._tDur):(C.vars.totalProgress=o,C.invalidate().restart()))),R&&(e&&k&&(S.style[k+O.os2]=K),F?u&&(h=!e&&h<o&&i<x+1&&i+1>=ri(U,O),de&&(e||!r&&!h?Vt(R,S):(c=Lt(R,!0),l=i-T,Vt(R,Ve,c.top+(O===Oe?l:0)+Ze,c.left+(O===Oe?0:l)+Ze))),Ft(r||h?q:X),Z&&o<1&&r||g($+(1!==o||h?0:E))):g(xt($+E*o))),!f||_.tween||Ge||ei||A.restart(!0),ne&&(t||ce&&o&&(o<1||!Jt))&&Wt(ne.targets).forEach(function(e){return e.classList[r||ce?"add":"remove"](ne.className)}),!d||N||e||d(H),u&&!Ge?(N&&(a&&("complete"===s?y.pause().totalProgress(1):"reset"===s?y.restart(!0).pause():"restart"===s?y.restart(!0):y[s]()),d)&&d(H),!t&&Jt||(se&&t&&Ct(H,se),me[n]&&Ct(H,me[n]),ce&&(1===o?H.kill(!1,1):me[n]=0),t)||me[n=1===o?1:3]&&Ct(H,me[n]),pe&&!r&&Math.abs(H.getVelocity())>(St(pe)?pe:2500)&&(Mt(H.callbackAnimation),C?C.progress(1):Mt(y,"reverse"===s?1:!o,1))):N&&d&&!Ge&&d(H)),Q&&(c=D?i/D.duration()*(D._caScrollDist||0):i,J(c+(V._isFlipped?1:0)),Q(c)),re)&&re(-i/D.duration()*(D._caScrollDist||0))},H.enable=function(e,t){H.enabled||(H.enabled=!0,et(U,"resize",Nt),et(B?He:U,"scroll",Ot),ye&&et(it,"refreshInit",ye),!1!==e&&(H.progress=L=0,b=W=Te=z()),!1!==t&&H.refresh())},H.getTween=function(e){return e&&_?_.tween:C},H.setPositions=function(e,t){R&&($+=e-T,E+=t-e-w,k===Ke)&&H.adjustPinSpacing(t-e-w),H.start=T=e,H.end=x=t,w=t-e,H.update()},H.adjustPinSpacing=function(e){var t;M&&(t=M.indexOf(O.d)+1,M[t]=parseFloat(M[t])+e+Ze,M[1]=parseFloat(M[1])+e+Ze,Ft(M))},H.disable=function(e,t){if(H.enabled&&(!1!==e&&H.revert(!0,!0),H.enabled=H.isActive=!1,t||C&&C.pause(),I=0,r&&(r.uncache=1),ye&&Ue(it,"refreshInit",ye),A&&(A.pause(),_.tween)&&_.tween.kill()&&(_.tween=0),!B)){for(var i=tt.length;i--;)if(tt[i].scroller===U&&tt[i]!==H)return;Ue(U,"resize",Nt),Ue(U,"scroll",Ot)}},H.kill=function(e,t){H.disable(e,t),C&&!t&&C.kill(),n&&delete fi[n];var i=tt.indexOf(H);0<=i&&tt.splice(i,1),i===We&&0<vi&&We--,i=0,tt.forEach(function(e){return e.scroller===H.scroller&&(i=1)}),i||je||(H.scroll.rec=0),y&&(y.scrollTrigger=null,e&&y.revert({kill:!1}),t||y.kill()),G&&[G,Se,V,we].forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),Qt===H&&(Qt=0),R&&(r&&(r.uncache=1),i=0,tt.forEach(function(e){return e.pin===R&&i++}),i||(r.spacer=0)),v.onKill&&v.onKill(H)},H.enable(!1,!1),s&&s(H),y&&y.add&&!w?Be.delayedCall(.01,function(){return T||x||H.refresh()})&&(w=.01,T=x=0):H.refresh(),R&&Zt!==gi&&(c=Zt=gi,requestAnimationFrame(function(){return c===gi&&Ut(!0)}))):this.update=this.refresh=this.kill=Ne},it.register=function(e){return x||(Be=e||f(),p()&&window.document&&it.enable(),x=ti),x},it.defaults=function(e){if(e)for(var t in e)pi[t]=e[t];return pi},it.disable=function(t,i){ti=0,tt.forEach(function(e){return e[i?"kill":"disable"](t)}),Ue(Fe,"wheel",Ot),Ue(He,"scroll",Ot),clearInterval(E),Ue(He,"touchcancel",Ne),Ue(Ve,"touchstart",Ne),g(Ue,He,"pointerdown,touchstart,mousedown",c),g(Ue,He,"pointerup,touchend,mouseup",d),S.kill(),m(Ue);for(var e=0;e<Re.length;e+=3)v(Ue,Re[e],Re[e+1]),v(Ue,Re[e],Re[e+2])},it.enable=function(){if(Fe=window,He=document,ze=He.documentElement,Ve=He.body,Be&&(Wt=Be.utils.toArray,jt=Be.utils.clamp,Kt=Be.core.context||Ne,$t=Be.core.suppressOverwrites||Ne,B=Fe.history.scrollRestoration||"auto",Be.core.globals("ScrollTrigger",it),Ve)){ti=1,A.register(Be),it.isTouch=A.isTouch,U=A.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),et(Fe,"wheel",Ot),w=[Fe,He,ze,Ve],Be.matchMedia?(it.matchMedia=function(e){var t,i=Be.matchMedia();for(t in e)i.add(t,e[t]);return i},Be.addEventListener("matchMediaInit",function(){return X()}),Be.addEventListener("matchMediaRevert",function(){return T()}),Be.addEventListener("matchMedia",function(){Ut(0,1),q("matchMedia")}),Be.matchMedia("(orientation: portrait)",function(){return b(),b})):console.warn("Requires GSAP 3.11.0 or later"),b(),et(He,"scroll",Ot);var e,t=Ve.style,i=t.borderTopStyle,r=Be.core.Animation.prototype;for(r.revert||Object.defineProperty(r,"revert",{value:function(){return this.time(-.01,!0)}}),t.borderTopStyle="solid",r=Lt(Ve),Oe.m=Math.round(r.top+Oe.sc())||0,De.m=Math.round(r.left+De.sc())||0,i?t.borderTopStyle=i:t.removeProperty("border-top-style"),E=setInterval(_,250),Be.delayedCall(.5,function(){return ei=0}),et(He,"touchcancel",Ne),et(Ve,"touchstart",Ne),g(et,He,"pointerdown,touchstart,mousedown",c),g(et,He,"pointerup,touchend,mouseup",d),M=Be.utils.checkPrefix("transform"),Z.push(M),x=qe(),S=Be.delayedCall(.2,Ut).pause(),R=[He,"visibilitychange",function(){var e=Fe.innerWidth,t=Fe.innerHeight;He.hidden?(C=e,P=t):C===e&&P===t||Nt()},He,"DOMContentLoaded",Ut,Fe,"load",Ut,Fe,"resize",Nt],m(et),tt.forEach(function(e){return e.enable(0,1)}),e=0;e<Re.length;e+=3)v(Ue,Re[e],Re[e+1]),v(Ue,Re[e],Re[e+2])}},it.config=function(e){"limitCallbacks"in e&&(Jt=!!e.limitCallbacks);var t=e.syncInterval;t&&clearInterval(E)||(E=t)&&setInterval(_,t),"ignoreMobileResize"in e&&(D=1===it.isTouch&&e.ignoreMobileResize),"autoRefreshEvents"in e&&(m(Ue),m(et,e.autoRefreshEvents||"none"),k=-1===(e.autoRefreshEvents+"").indexOf("resize"))},it.scrollerProxy=function(e,t){var e=Pe(e),i=Re.indexOf(e),r=ii(e);~i&&Re.splice(i,r?6:2),t&&(r?ke.unshift(Fe,t,Ve,t,ze,t):ke.unshift(e,t))},it.clearMatchMedia=function(t){tt.forEach(function(e){return e._ctx&&e._ctx.query===t&&e._ctx.kill(!0,!0)})},it.isInViewport=function(e,t,i){e=(Ye(e)?Pe(e):e).getBoundingClientRect(),t=e[i?si:ai]*t||0;return i?0<e.right-t&&e.left+t<Fe.innerWidth:0<e.bottom-t&&e.top+t<Fe.innerHeight},it.positionInViewport=function(e,t,i){var e=(e=Ye(e)?Pe(e):e).getBoundingClientRect(),r=e[i?si:ai],r=null==t?r/2:t in G?G[t]*r:~t.indexOf("%")?parseFloat(t)*r/100:parseFloat(t)||0;return i?(e.left+r)/Fe.innerWidth:(e.top+r)/Fe.innerHeight},it.killAll=function(e){tt.slice(0).forEach(function(e){return"ScrollSmoother"!==e.vars.id&&e.kill()}),!0!==e&&(e=W.killAll||[],W={},e.forEach(function(e){return e()}))},it);function it(e,t){x||it.register(Be)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(e,t)}I.version="3.11.4",I.saveStyles=function(e){return e?Wt(e).forEach(function(e){var t;e&&e.style&&(0<=(t=i.indexOf(e))&&i.splice(t,5),i.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),Be.core.getCache(e),Kt()))}):i},I.revert=function(e,t){return X(!e,t)},I.create=function(e,t){return new I(e,t)},I.refresh=function(e){return e?Nt():(x||I.register())&&Ut(!0)},I.update=function(e){return++Re.cache&&K(!0===e?2:0)},I.clearScrollMemory=Y,I.maxScroll=function(e,t){return ri(e,t?De:Oe)},I.getScrollFunc=function(e,t){return at(Pe(e),t?De:Oe)},I.getById=function(e){return fi[e]},I.getAll=function(){return tt.filter(function(e){return"ScrollSmoother"!==e.vars.id})},I.isScrolling=function(){return!!Xe},I.snapDirectional=Rt,I.addEventListener=function(e,t){e=W[e]||(W[e]=[]);~e.indexOf(t)||e.push(t)},I.removeEventListener=function(e,t){e=W[e],t=e&&e.indexOf(t);0<=t&&e.splice(t,1)},I.batch=function(e,t){var i,r=[],n={},s=t.interval||.016,a=t.batchMax||1e9;for(i in t)n[i]="on"===i.substr(0,2)&&$e(t[i])&&"onRefreshInit"!==i?function(e){var t=[],i=[],r=Be.delayedCall(s,function(){e(t,i),t=[],i=[]}).pause();return function(e){t.length||r.restart(!0),t.push(e.trigger),i.push(e),a<=t.length&&r.progress(1)}}(t[i]):t[i];return $e(a)&&(a=a(),et(I,"refresh",function(){return a=t.batchMax()})),Wt(e).forEach(function(e){var t={};for(i in n)t[i]=n[i];t.trigger=e,r.push(I.create(t))}),r};function te(e,t,i,r){return r<t?e(r):t<0&&e(0),r<i?(r-t)/(i-t):i<0?t/(t-i):1}function ie(e,t){!0===t?e.style.removeProperty("touch-action"):e.style.touchAction=!0===t?"auto":t?"pan-"+t+(A.isTouch?" pinch-zoom":""):"none",e===ze&&ie(Ve,t)}function re(e){var t,i=e.event,r=e.target,e=e.axis,n=(i.changedTouches?i.changedTouches[0]:i).target,s=n._gsap||Be.core.getCache(n),a=qe();if(!s._isScrollT||2e3<a-s._isScrollT){for(;n&&n!==Ve&&(n.scrollHeight<=n.clientHeight&&n.scrollWidth<=n.clientWidth||!oe[(t=Qe(n)).overflowY]&&!oe[t.overflowX]);)n=n.parentNode;s._isScroll=n&&n!==r&&!ii(n)&&(oe[(t=Qe(n)).overflowY]||oe[t.overflowX]),s._isScrollT=a}!s._isScroll&&"x"!==e||(i.stopPropagation(),i._gsapAllow=!0)}function ne(e,t,i,r){return A.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:r=r&&re,onPress:r,onDrag:r,onScroll:r,onEnable:function(){return i&&et(He,A.eventTypes[0],se,!1,!0)},onDisable:function(){return Ue(He,A.eventTypes[0],se,!0)}})}function se(e){var t=le.test(e.target.tagName);(t||ae)&&(e._gsapAllow=!0,ae=t)}var ae,oe={auto:1,scroll:1},le=/(input|label|select|textarea)/i;I.sort=function(e){return tt.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+e.start-(t.start+-1e6*(t.vars.refreshPriority||0))})},I.observe=function(e){return new A(e)},I.normalizeScroll=function(e){var i,n,s,r,a,o,l,h,t,u,c,d,p,f,m,g,v,y,_,b,T,x,w;return void 0===e?L:!0===e&&L?L.enable():!1===e?L&&L.kill():(p=e instanceof A?e:((e=Et(e=e)?e:{}).preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer",u=(t=e).normalizeScrollX,c=t.momentum,t=t.allowNestedScroll,d=Pe(e.target)||ze,p=(p=Be.core.globals().ScrollSmoother)&&p.get(),f=U&&(e.content&&Pe(e.content)||p&&!1!==e.content&&!p.smooth()&&p.content()),m=at(d,Oe),g=at(d,De),v=1,y=(A.isTouch&&Fe.visualViewport?Fe.visualViewport.scale*Fe.visualViewport.width:Fe.outerWidth)/Fe.innerWidth,_=0,b=$e(c)?function(){return c(i)}:function(){return c||2.8},T=ne(d,e.type,!0,t),w=x=Ne,f&&Be.set(f,{y:"+=0"}),e.ignoreCheck=function(e){return U&&"touchmove"===e.type&&(r?(requestAnimationFrame(S),t=xt(i.deltaY/2),t=w(m.v-t),f&&t!==m.v+m.offset&&(m.offset=t-m.v,t=xt((parseFloat(f&&f._gsap.y)||0)-m.offset),f.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+t+", 0, 1)",f._gsap.y=t+"px",m.cacheID=Re.cache,K()),!0):(m.offset&&M(),void(r=!0)))||1.05<v&&"touchstart"!==e.type||i.isGesturing||e.touches&&1<e.touches.length;var t},e.onPress=function(){var e=v;v=xt((Fe.visualViewport&&Fe.visualViewport.scale||1)/y),a.pause(),e!==v&&ie(d,1.01<v||!u&&"x"),o=g(),l=m(),E(),s=gi},e.onRelease=e.onGestureStart=function(e,t){var i,r;m.offset&&M(),t?(Re.cache++,t=b(),u&&(r=(i=g())+.05*t*-e.velocityX/.227,t*=te(g,i,r,ri(d,De)),a.vars.scrollX=x(r)),r=(i=m())+.05*t*-e.velocityY/.227,t*=te(m,i,r,ri(d,Oe)),a.vars.scrollY=w(r),a.invalidate().duration(t).play(.01),(U&&a.vars.scrollY>=n||n-1<=i)&&Be.to({},{onUpdate:C,duration:t})):h.restart(!0)},e.onWheel=function(){a._ts&&a.pause(),1e3<qe()-_&&(s=0,_=qe())},e.onChange=function(e,t,i,r,n){gi!==s&&E(),t&&u&&g(x(r[2]===t?o+(e.startX-e.x):g()+t-r[1])),i&&(m.offset&&M(),e=(r=n[2]===i)?l+e.startY-e.y:m()+i-n[1],n=w(e),r&&e!==n&&(l+=n-e),m(n)),(i||t)&&K()},e.onEnable=function(){ie(d,!u&&"x"),I.addEventListener("refresh",C),et(Fe,"resize",C),m.smooth&&(m.target.style.scrollBehavior="auto",m.smooth=g.smooth=!1),T.enable()},e.onDisable=function(){ie(d,!0),Ue(Fe,"resize",C),I.removeEventListener("refresh",C),T.kill()},e.lockAxis=!1!==e.lockAxis,((i=new A(e)).iOS=U)&&!m()&&m(1),U&&Be.ticker.add(Ne),h=i._dc,a=Be.to(i,{ease:"power4",paused:!0,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",onComplete:h.vars.onComplete}),i),L&&L.target===p.target&&L.kill(),ii(p.target)&&(L=p),p);function S(){return r=!1}function E(){n=ri(d,Oe),w=jt(U?1:0,n),u&&(x=jt(0,ri(d,De))),s=gi}function M(){f._gsap.y=xt(parseFloat(f._gsap.y)+m.offset)+"px",f.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(f._gsap.y)+", 0, 1)",m.offset=m.cacheID=0}function C(){E(),a.isActive()&&a.vars.scrollY>n&&(m()>n?a.progress(1)&&m(n):a.resetTo("scrollY",n))}},I.core={_getVelocityProp:ot,_inputObserver:ne,_scrollers:Re,_proxies:ke,bridge:{ss:function(){Xe||q("scrollStart"),Xe=qe()},ref:function(){return Ge}}},f()&&Be.registerPlugin(I)},7043:(i,e,t)=>{"use strict";function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}t.d(e,{p8:()=>en});function s(){return"undefined"!=typeof window}function J(e){return c(e)||H(e)}function m(e){return(ft=Z(e,a))&&u}function g(e,t){return e&&(a[e]=t)&&ft&&(ft[e]=t)||a}function v(){return 0}function p(e,t){return(e=e.split(",")).forEach(t)||e}function y(e,t,i,r){Tt.length&&!O&&Pt(),e.render(t,i,r||O&&t<0&&(e._initted||e._startAt)),Tt.length&&!O&&Pt()}function _(e){return e}function Z(e,t){for(var i in t)e[i]=t[i];return e}function b(e,t){for(var i in t)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=A(t[i])?b(e[i]||(e[i]={}),t[i]):t[i]);return e}function Q(e){var r,t=e.parent||N,i=e.keyframes?(r=L(e.keyframes),function(e,t){for(var i in t)i in e||"duration"===i&&r||"ease"===i||(e[i]=t[i])}):G;if(z(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e}function x(e,t,i,r,n){void 0===i&&(i="_first");var s,a=e[r=void 0===r?"_last":r];if(n)for(s=t[n];a&&a[n]>s;)a=a._prev;a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=a,t.parent=t._dp=e}function w(e,t,i,r){void 0===i&&(i="_first"),void 0===r&&(r="_last");var n=t._prev,s=t._next;n?n._next=s:e[i]===t&&(e[i]=s),s?s._prev=n:e[r]===t&&(e[r]=n),t._next=t._prev=t.parent=null}function S(e,t,i,r){e._startAt&&(O?e._startAt.revert(yt):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))}function ee(e){return!e||e._ts&&ee(e.parent)}function E(e){return e._repeat?M(e._tTime,e=e.duration()+e._rDelay)*e:0}function M(e,t){return t=Math.floor(e/=t),e&&t===e?t-1:t}function te(e,t){return(e-t._start)*t._ts+(0<=t._ts?0:t._dirty?t.totalDuration():t._tDur)}function ie(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=te(e.rawTime(),t),!t._dur||ce(0,t.totalDuration(),i)-t._tTime>B)&&t.render(i,!0),Ot(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)0<=i.rawTime()&&i.totalTime(i._tTime),i=i._dp;e._zTime=-B}}function C(e,t,i,r){return t.parent&&Dt(t),t._start=I((nt(i)?i:i||e!==N?h(e,i,t):e._time)+t._delay),t._end=I(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),x(e,t,"_first","_last",e._sort?"_start":0),ae(t)||(e._recent=t),r||ie(e,t),e._ts<0&&Ut(e,e._tTime),e}function re(e,t){(a.ScrollTrigger||mt("scrollTrigger",t))&&a.ScrollTrigger.create(t,e)}function ne(e,t,i,r,n){return ai(e,t,n),e._initted?!i&&e._pt&&!O&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&ke!==f.frame?(Tt.push(e),e._lazy=[n,r]):void 0:1}function se(e){return(e=e.parent)&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||se(e))}function ae(e){return"isFromStart"===(e=e.data)||"isStart"===e}function oe(e,t,i,r){var n=e._repeat,t=I(t)||0,s=e._tTime/e._tDur;return s&&!r&&(e._time*=t/e._dur),e._dur=t,e._tDur=n?n<0?1e10:I(t*(n+1)+e._rDelay*n):t,0<s&&!r&&Ut(e,e._tTime=e._tDur*s),e.parent&&Nt(e),i||Ot(e.parent,e),e}function le(e){return e instanceof k?Ot(e):oe(e,e._dur)}function h(e,t,i){var r,n,s,a=e.labels,o=e._recent||Bt,l=e.duration()>=U?o.endTime(!1):e._dur;return H(t)&&(isNaN(t)||t in a)?(n=t.charAt(0),s="%"===t.substr(-1),r=t.indexOf("="),"<"===n||">"===n?(0<=r&&(t=t.replace(/=/,"")),("<"===n?o._start:o.endTime(0<=o._repeat))+(parseFloat(t.substr(1))||0)*(s?(r<0?o:i).totalDuration()/100:1)):r<0?(t in a||(a[t]=l),a[t]):(n=parseFloat(t.charAt(r-1)+t.substr(r+1)),s&&i&&(n=n/100*(L(i)?i[0]:i).totalDuration()),1<r?h(e,t.substr(0,r-1),i)+n:l+n)):null==t?l:+t}function he(e,t,i){var r,n,s=nt(t[1]),a=(s?2:1)+(e<2?0:1),o=t[a];if(s&&(o.duration=t[1]),o.parent=i,e){for(r=o,n=i;n&&!("immediateRender"in r);)r=n.vars.defaults||{},n=z(n.vars.inherit)&&n.parent;o.immediateRender=z(r.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return new j(t[0],o,t[1+a])}function ue(e,t){return e||0===e?t(e):t}function ce(e,t,i){return i<e?e:t<i?t:i}function de(e,t){return e&&A(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&A(e[0]))&&!e.nodeType&&e!==l}function pe(i){return i=P(i)[0]||gt("Invalid scope")||{},function(e){var t=i.current||i.nativeElement||i;return P(e,t.querySelectorAll?t:t===i?gt("Invalid scope")||Pe.createElement("div"):i)}}function fe(e){var p,f,m,g,v,y,_,b,T;return c(e)?e:(p=A(e)?e:{each:e},f=Qt(p.ease),m=p.from||0,g=parseFloat(p.base)||0,v={},e=0<m&&m<1,y=isNaN(m)||e,_=p.axis,H(T=b=m)?b=T={center:.5,edges:.5,end:1}[m]||0:!e&&y&&(b=m[0],T=m[1]),function(e,t,i){var r,n,s,a,o,l,h,u,c=(i||p).length,d=v[c];if(!d){if(!(u="auto"===p.grid?0:(p.grid||[1,U])[1])){for(l=-U;l<(l=i[u++].getBoundingClientRect().left)&&u<c;);u--}for(d=v[c]=[],r=y?Math.min(u,c)*b-.5:m%u,n=u===U?0:y?c*T/u-.5:m/u|0,h=U,o=l=0;o<c;o++)a=o%u-r,s=n-(o/u|0),d[o]=a=_?Math.abs("y"===_?s:a):tt(a*a+s*s),l<a&&(l=a),a<h&&(h=a);"random"===m&&Ht(d),d.max=l-h,d.min=h,d.v=c=(parseFloat(p.amount)||parseFloat(p.each)*(c<u?c-1:_?"y"===_?c/u:u:Math.max(u,c/u))||0)*("edges"===m?-1:1),d.b=c<0?g-c:g,d.u=W(p.amount||p.each)||0,f=f&&c<0?Zt(f):f}return c=(d[e]-d.min)/d.max||0,I(d.b+(f?f(c):c)*d.v)+d.u})}function me(i){var r=Math.pow(10,((i+"").split(".")[1]||"").length);return function(e){var t=I(Math.round(parseFloat(e)/i)*i*r);return(t-t%1)/r+(nt(e)?0:W(e))}}function ge(l,e){var h,u,t=L(l);return!t&&A(l)&&(h=t=l.radius||U,l.values?(l=P(l.values),(u=!nt(l[0]))&&(h*=h)):l=me(l.increment)),ue(e,t?c(l)?function(e){return u=l(e),Math.abs(u-e)<=h?u:e}:function(e){for(var t,i,r=parseFloat(u?e.x:e),n=parseFloat(u?e.y:0),s=U,a=0,o=l.length;o--;)(t=u?(t=l[o].x-r)*t+(i=l[o].y-n)*i:Math.abs(l[o]-r))<s&&(s=t,a=o);return a=!h||s<=h?l[a]:e,u||a===e||nt(e)?a:a+W(e)}:me(l))}function ve(t,i,e){return ue(e,function(e){return t[~~i(e)]})}function ye(t,e,i,r,n){var s=e-t,a=r-i;return ue(n,function(e){return i+((e-t)/s*a||0)})}function _e(e,t,i){var r,n,s,a=e.labels,o=U;for(r in a)(n=a[r]-t)<0==!!i&&n&&o>(n=Math.abs(n))&&(s=r,o=n);return s}function T(e,t,i){var r=e.vars,n=r[t],s=o,a=e._ctx;if(n)t=r[t+"Params"],r=r.callbackScope||e,i&&Tt.length&&Pt(),a&&(o=a),e=t?n.apply(r,t):n.call(r),o=s}function be(e){return Dt(e),e.scrollTrigger&&e.scrollTrigger.kill(!!O),e.progress()<1&&T(e,"onInterrupt"),e}function Te(e,t,i){return(6*(e+=e<0?1:1<e?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*d+.5|0}function xe(e,t,i){var r,n,s,a,o="",l=(e+o).match(qt),h=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=Wt(e,t,1))&&h+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),i&&(s=jt(e),(r=i.c).join(o)!==s.c.join(o)))for(a=(n=e.replace(qt,"1").split(ht)).length-1;u<a;u++)o+=n[u]+(~r.indexOf(u)?l.shift()||h+"0,0,0,0)":(s.length?s:l.length?l:i).shift());if(!n)for(a=(n=e.split(qt)).length-1;u<a;u++)o+=n[u]+l[u];return o+n[a]}function we(e){var t=e.join(" ");if(qt.lastIndex=0,qt.test(t))return t=Xt.test(t),e[1]=xe(e[1],t),e[0]=xe(e[0],t,jt(e[1])),!0}function Se(e,t){for(var i,r=e._first;r;)r instanceof k?Se(r,t):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===t||(r.timeline?Se(r.timeline,t):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=t)),r=r._next}function Ee(e,t,i,r){var n,s={easeIn:t,easeOut:i=void 0===i?function(e){return 1-t(1-e)}:i,easeInOut:r=void 0===r?function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2}:r};p(e,function(e){for(var t in R[e]=a[e]=s,R[n=e.toLowerCase()]=i,s)R[n+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=R[e+"."+t]=s[t]})}function Me(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}}function Ce(i,e,t){function r(e){return 1===e?1:n*Math.pow(2,-10*e)*rt((e-s)*a)+1}var n=1<=e?e:1,s=(a=(t||(i?.3:.45))/(e<1?e:1))/Ze*(Math.asin(1/n)||0),t="out"===i?r:"in"===i?function(e){return 1-r(1-e)}:Me(r),a=Ze/a;return t.config=function(e,t){return Ce(i,e,t)},t}function Ae(t,i){function r(e){return e?--e*e*((i+1)*e+i)+1:0}void 0===i&&(i=1.70158);var e="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:Me(r);return e.config=function(e){return Ae(t,e)},e}var Le,O,o,N,l,Ie,Pe,Re,ke,De,Oe,Ne,Ue,Be,Fe,He,ze,Ve,Ge,We,je,qe,Xe,Ye,$e,Ke,F={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Je={duration:.5,overwrite:!1,delay:0},U=1e8,B=1/U,Ze=2*Math.PI,Qe=Ze/4,et=0,tt=Math.sqrt,it=Math.cos,rt=Math.sin,H=function(e){return"string"==typeof e},c=function(e){return"function"==typeof e},nt=function(e){return"number"==typeof e},st=function(e){return void 0===e},A=function(e){return"object"==typeof e},z=function(e){return!1!==e},at="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},L=Array.isArray,ot=/(?:-?\.?\d|\.)+/gi,lt=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ht=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ut=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ct=/[+-]=-?[.\d]+/,dt=/[^,'"\[\]\s]+/gi,pt=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,a={},ft={},mt=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},gt=function(e,t){return!t&&console.warn(e)},vt={suppressEvents:!0,isStart:!0,kill:!1},yt={suppressEvents:!0,kill:!1},_t={suppressEvents:!0},bt={},Tt=[],xt={},V={},wt={},St=30,Et=[],Mt="",Ct=function(e){var t,i,r=e[0];if(A(r)||c(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(i=Et.length;i--&&!Et[i].targetTest(r););t=Et[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new ti(e[i],t)))||e.splice(i,1);return e},At=function(e){return e._gsap||Ct(P(e))[0]._gsap},Lt=function(e,t,i){return(i=e[t])&&c(i)?e[t]():st(i)&&e.getAttribute&&e.getAttribute(t)||i},D=function(e){return Math.round(1e5*e)/1e5||0},I=function(e){return Math.round(1e7*e)/1e7||0},It=function(e,t){var i=t.charAt(0),t=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+t:"-"===i?e-t:"*"===i?e*t:e/t},Pt=function(){var e,t,i=Tt.length,r=Tt.slice(0);for(xt={},e=Tt.length=0;e<i;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Rt=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(dt).length<2?t:H(e)?e.trim():e},G=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},kt=function(e,t){var i,r={};for(i in e)i in t||(r[i]=e[i]);return r},Dt=function(e,t){!e.parent||t&&!e.parent.autoRemoveChildren||e.parent.remove(e),e._act=0},Ot=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Nt=function(e){return e._end=I(e._start+(e._tDur/Math.abs(e._ts||e._rts||B)||0))},Ut=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=I(i._time-(0<e._ts?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Nt(e),i._dirty||Ot(i,e)),e},Bt={_start:0,endTime:v,totalDuration:v},W=function(e,t){return H(e)&&(t=pt.exec(e))?t[1]:""},Ft=[].slice,P=function(e,t,i){return o&&!t&&o.selector?o.selector(e):!H(e)||i||!Ie&&Yt()?L(e)?(r=i,void 0===n&&(n=[]),e.forEach(function(e){return H(e)&&!r||de(e,1)?n.push.apply(n,P(e)):n.push(e)})||n):de(e)?Ft.call(e,0):e?[e]:[]:Ft.call((t||Pe).querySelectorAll(e),0);var r,n},Ht=function(e){return e.sort(function(){return.5-Math.random()})},zt=function(e,t,i,r){return ue(L(e)?!t:!0===i?!!(i=0):!r,function(){return L(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*r)/r})},Vt=function(e){for(var t,i,r,n,s=0,a="";~(t=e.indexOf("random(",s));)r=e.indexOf(")",t),n="["===e.charAt(t+7),i=e.substr(t+7,r-t-7).match(n?dt:ot),a+=e.substr(s,t-s)+zt(n?i:+i[0],n?0:+i[1],+i[2]||1e-5),s=r+1;return a+e.substr(s,e.length-s)},d=255,Gt={aqua:[0,d,d],lime:[0,d,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,d],navy:[0,0,128],white:[d,d,d],olive:[128,128,0],yellow:[d,d,0],orange:[d,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[d,0,0],pink:[d,192,203],cyan:[0,d,d],transparent:[d,d,d,0]},Wt=function(e,t,i){var r,n,s,a,o,l,h,u=e?nt(e)?[e>>16,e>>8&d,e&d]:0:Gt.black;if(!u){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Gt[e])u=Gt[e];else if("#"===e.charAt(0)){if(9===(e=e.length<6?"#"+(r=e.charAt(1))+r+(n=e.charAt(2))+n+(s=e.charAt(3))+s+(5===e.length?e.charAt(4)+e.charAt(4):""):e).length)return[(u=parseInt(e.substr(1,6),16))>>16,u>>8&d,u&d,parseInt(e.substr(7),16)/255];u=[(e=parseInt(e.substr(1),16))>>16,e>>8&d,e&d]}else if("hsl"===e.substr(0,3))if(u=h=e.match(ot),t){if(~e.indexOf("="))return u=e.match(lt),i&&u.length<4&&(u[3]=1),u}else a=+u[0]%360/360,o=+u[1]/100,r=2*(l=+u[2]/100)-(n=l<=.5?l*(o+1):l+o-l*o),3<u.length&&(u[3]*=1),u[0]=Te(a+1/3,r,n),u[1]=Te(a,r,n),u[2]=Te(a-1/3,r,n);else u=e.match(ot)||Gt.transparent;u=u.map(Number)}return t&&!h&&(r=u[0]/d,n=u[1]/d,s=u[2]/d,l=((e=Math.max(r,n,s))+(t=Math.min(r,n,s)))/2,e===t?a=o=0:(h=e-t,o=.5<l?h/(2-e-t):h/(e+t),a=e===r?(n-s)/h+(n<s?6:0):e===n?(s-r)/h+2:(r-n)/h+4,a*=60),u[0]=~~(a+.5),u[1]=~~(100*o+.5),u[2]=~~(100*l+.5)),i&&u.length<4&&(u[3]=1),u},jt=function(e){var t=[],i=[],r=-1;return e.split(qt).forEach(function(e){e=e.match(ht)||[];t.push.apply(t,e),i.push(r+=e.length+1)}),t.c=i,t},qt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Gt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Xt=/hsl[a]?\(/,f=(Ge=Date.now,We=500,je=33,qe=Ge(),Xe=qe,$e=Ye=1e3/240,He={time:0,frame:0,tick:function(){ei(!0)},deltaRatio:function(e){return ze/(1e3/(e||60))},wake:function(){Re&&(!Ie&&s()&&(l=Ie=window,Pe=l.document||{},a.gsap=u,(l.gsapVersions||(l.gsapVersions=[])).push(u.version),m(ft||l.GreenSockGlobals||!l.gsap&&l||{}),Fe=l.requestAnimationFrame),Ue&&He.sleep(),Be=Fe||function(e){return setTimeout(e,$e-1e3*He.time+1|0)},De=1,ei(2))},sleep:function(){(Fe?l.cancelAnimationFrame:clearTimeout)(Ue),De=0,Be=v},lagSmoothing:function(e,t){We=e||1/0,je=Math.min(t||33,We)},fps:function(e){Ye=1e3/(e||240),$e=1e3*He.time+Ye},add:function(n,e,t){var s=e?function(e,t,i,r){n(e,t,i,r),He.remove(s)}:n;return He.remove(n),Ke[t?"unshift":"push"](s),Yt(),s},remove:function(e,t){~(t=Ke.indexOf(e))&&Ke.splice(t,1)&&t<=Ve&&Ve--},_listeners:Ke=[]}),Yt=function(){return!De&&f.wake()},R={},$t=/^[\d.\-M][\d.\-,\s]/,Kt=/["']/g,Jt=function(e){for(var t,i,r,n={},s=e.substr(1,e.length-3).split(":"),a=s[0],o=1,l=s.length;o<l;o++)i=s[o],t=o!==l-1?i.lastIndexOf(","):i.length,r=i.substr(0,t),n[a]=isNaN(r)?r.replace(Kt,"").trim():+r,a=i.substr(t+1).trim();return n},Zt=function(t){return function(e){return 1-t(1-e)}},Qt=function(e,t){return e&&(c(e)?e:R[e]||(s=((e=e)+"").split("("),(a=R[s[0]])&&1<s.length&&a.config?a.config.apply(null,~e.indexOf("{")?[Jt(s[1])]:(i=(s=e).indexOf("(")+1,r=s.indexOf(")"),n=s.indexOf("(",i),s.substring(i,~n&&n<r?s.indexOf(")",r+1):r).split(",").map(Rt))):R._CE&&$t.test(e)?R._CE("",e):a))||t;var i,r,n,s,a};function ei(e){var t,i,r,n=Ge()-Xe,s=!0===e;if(We<n&&(qe+=n-je),(0<(n=(i=(Xe+=n)-qe)-$e)||s)&&(r=++He.frame,ze=i-1e3*He.time,He.time=i/=1e3,$e+=n+(Ye<=n?4:Ye-n),t=1),s||(Ue=Be(ei)),t)for(Ve=0;Ve<Ke.length;Ve++)Ke[Ve](i,ze,r,e)}p("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var i=t<5?t+1:t;Ee(e+",Power"+(i-1),t?function(e){return Math.pow(e,i)}:function(e){return e},function(e){return 1-Math.pow(1-e,i)},function(e){return e<.5?Math.pow(2*e,i)/2:1-Math.pow(2*(1-e),i)/2})}),R.Linear.easeNone=R.none=R.Linear.easeIn,Ee("Elastic",Ce("in"),Ce("out"),Ce()),Oe=7.5625,Ee("Bounce",function(e){return 1-Ne(1-e)},Ne=function(e){return e<.36363636363636365?Oe*e*e:e<.7272727272727273?Oe*Math.pow(e-1.5/2.75,2)+.75:e<.9090909090909092?Oe*(e-=2.25/2.75)*e+.9375:Oe*Math.pow(e-2.625/2.75,2)+.984375}),Ee("Expo",function(e){return e?Math.pow(2,10*(e-1)):0}),Ee("Circ",function(e){return-(tt(1-e*e)-1)}),Ee("Sine",function(e){return 1===e?1:1-it(e*Qe)}),Ee("Back",Ae("in"),Ae("out"),Ae()),R.SteppedEase=R.steps=a.SteppedEase={config:function(e,t){var i=1/(e=void 0===e?1:e),r=e+(t?0:1),n=t?1:0;return function(e){return((r*ce(0,.99999999,e)|0)+n)*i}}},Je.ease=R["quad.out"],p("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return Mt+=e+","+e+"Params,"});var ti=function(e,t){this.id=et++,(e._gsap=this).target=e,this.harness=t,this.get=t?t.get:Lt,this.set=t?t.getSetter:Ei},ii=((t=ri.prototype).delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(0<this._repeat?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,oe(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Yt(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Ut(this,e),i._dp&&!i.parent&&ie(i,this);i&&i.parent;)i.parent._time!==i._start+(0<=i._ts?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(0<this._ts&&e<this._tDur||this._ts<0&&0<e||!this._tDur&&!e)&&C(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===B||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),y(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+E(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+E(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*i,t):this._repeat?M(this._tTime,i)+1:1},t.timeScale=function(e){if(!arguments.length)return this._rts===-B?0:this._rts;if(this._rts===e)return this;for(var t=this.parent&&this._ts?te(this.parent._time,this):this._tTime,e=(this._rts=+e||0,this._ts=this._ps||e===-B?0:this._rts,this.totalTime(ce(-this._delay,this._tDur,t),!0),Nt(this),this),i=e.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return e},t.paused=function(e){return arguments.length?(this._ps!==e&&((this._ps=e)?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Yt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==B&&(this._tTime-=B)))),this):this._ps},t.startTime=function(e){var t;return arguments.length?(this._start=e,!(t=this.parent||this._dp)||!t._sort&&this.parent||C(t,this,e-this._delay),this):this._start},t.endTime=function(e){return this._start+(z(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?te(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){var t=O;return O=e=void 0===e?_t:e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),O=t,this},t.globalTime=function(e){for(var t=this,i=arguments.length?e:t.rawTime();t;)i=t._start+i/(t._ts||1),t=t._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(e):i},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,le(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){var t;return arguments.length?(t=this._time,this._rDelay=e,le(this),t?this.time(t):this):this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(h(this,e),z(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,z(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-B:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-B,this},t.isActive=function(){var e=this.parent||this._dp,t=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(e=e.rawTime(!0))>=t&&e<this.endTime(!0)-B))},t.eventCallback=function(e,t,i){var r=this.vars;return 1<arguments.length?(t?(r[e]=t,i&&(r[e+"Params"]=i),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(r){var n=this;return new Promise(function(t){function e(){var e=n.then;n.then=null,c(i)&&(i=i(n))&&(i.then||i===n)&&(n.then=e),t(i),n.then=e}var i=c(r)?r:_;n._initted&&1===n.totalProgress()&&0<=n._ts||!n._tTime&&n._ts<0?e():n._prom=e})},t.kill=function(){be(this)},ri);function ri(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,oe(this,+e.duration,1,1),this.data=e.data,o&&(this._ctx=o).data.push(this),De||f.wake()}G(ii.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-B,_prom:0,_ps:!1,_rts:1});r(si,ni=ii),(e=si.prototype).to=function(e,t,i){return he(0,arguments,this),this},e.from=function(e,t,i){return he(1,arguments,this),this},e.fromTo=function(e,t,i,r){return he(2,arguments,this),this},e.set=function(e,t,i){return t.duration=0,t.parent=this,Q(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new j(e,t,h(this,i),1),this},e.call=function(e,t,i){return C(this,j.delayedCall(0,e,t),i)},e.staggerTo=function(e,t,i,r,n,s,a){return i.duration=t,i.stagger=i.stagger||r,i.onComplete=s,i.onCompleteParams=a,i.parent=this,new j(e,i,h(this,n)),this},e.staggerFrom=function(e,t,i,r,n,s,a){return i.runBackwards=1,Q(i).immediateRender=z(i.immediateRender),this.staggerTo(e,t,i,r,n,s,a)},e.staggerFromTo=function(e,t,i,r,n,s,a,o){return r.startAt=i,Q(r).immediateRender=z(r.immediateRender),this.staggerTo(e,t,r,n,s,a,o)},e.render=function(e,t,i){var r,n,s,a,o,l,h,u,c,d,p=this._time,f=this._dirty?this.totalDuration():this._tDur,m=this._dur,g=e<=0?0:I(e),v=this._zTime<0!=e<0&&(this._initted||!m);if((g=this!==N&&f<g&&0<=e?f:g)!==this._tTime||i||v){if(p!==this._time&&m&&(g+=this._time-p,e+=this._time-p),r=g,u=this._start,o=!(h=this._ts),v&&(m||(p=this._zTime),e||!t)&&(this._zTime=e),this._repeat){if(v=this._yoyo,a=m+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,i);if(r=I(g%a),g===f?(s=this._repeat,r=m):((s=~~(g/a))&&s===g/a&&(r=m,s--),m<r&&(r=m)),c=M(this._tTime,a),v&&1&s&&(r=m-r,d=1),s!==(c=!p&&this._tTime&&c!==s?s:c)&&!this._lock){var y=v&&1&c,v=y===(v&&1&s),p=(y=s<c?!y:y)?0:m;if(this._lock=1,this.render(p||(d?0:I(s*a)),t,!m)._lock=0,this._tTime=g,!t&&this.parent&&T(this,"onRepeat"),this.vars.repeatRefresh&&!d&&(this.invalidate()._lock=1),p&&p!==this._time||o!=!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(m=this._dur,f=this._tDur,v&&(this._lock=2,this.render(p=y?m:-1e-4,!0),this.vars.repeatRefresh)&&!d&&this.invalidate(),this._lock=0,!this._ts&&!o)return this;Se(this,d)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(e,t,i){var r;if(t<i)for(r=e._first;r&&r._start<=i;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,I(p),I(r)))&&(g-=r-(r=l._start)),this._tTime=g,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,p=0),!p&&r&&!t&&(T(this,"onStart"),this._tTime!==g))return this;if(p<=r&&0<=e)for(_=this._first;_;){if(n=_._next,(_._act||r>=_._start)&&_._ts&&l!==_){if(_.parent!==this)return this.render(e,t,i);if(_.render(0<_._ts?(r-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(r-_._start)*_._ts,t,i),r!==this._time||!this._ts&&!o){l=0,n&&(g+=this._zTime=-B);break}}_=n}else for(var _=this._last,b=e<0?e:r;_;){if(n=_._prev,(_._act||b<=_._end)&&_._ts&&l!==_){if(_.parent!==this)return this.render(e,t,i);if(_.render(0<_._ts?(b-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(b-_._start)*_._ts,t,i||O&&(_._initted||_._startAt)),r!==this._time||!this._ts&&!o){l=0,n&&(g+=this._zTime=b?-B:B);break}}_=n}if(l&&!t&&(this.pause(),l.render(p<=r?0:-B)._zTime=p<=r?1:-1,this._ts))return this._start=u,Nt(this),this.render(e,t,i);this._onUpdate&&!t&&T(this,"onUpdate",!0),!(g===f&&this._tTime>=this.totalDuration()||!g&&p)||u!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||(!e&&m||!(g===f&&0<this._ts||!g&&this._ts<0)||Dt(this,1),t)||e<0&&!p||!g&&!p&&f||(T(this,g===f&&0<=e?"onComplete":"onReverseComplete",!0),!this._prom)||g<f&&0<this.timeScale()||this._prom()}return this},e.add=function(e,t){var i=this;if(nt(t)||(t=h(this,t,e)),!(e instanceof ii)){if(L(e))return e.forEach(function(e){return i.add(e,t)}),this;if(H(e))return this.addLabel(e,t);if(!c(e))return this;e=j.delayedCall(0,e)}return this!==e?C(this,e,t):this},e.getChildren=function(e,t,i,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===r&&(r=-U);for(var n=[],s=this._first;s;)s._start>=r&&(s instanceof j?t&&n.push(s):(i&&n.push(s),e&&n.push.apply(n,s.getChildren(!0,t,i)))),s=s._next;return n},e.getById=function(e){for(var t=this.getChildren(1,1,1),i=t.length;i--;)if(t[i].vars.id===e)return t[i]},e.remove=function(e){return H(e)?this.removeLabel(e):c(e)?this.killTweensOf(e):(w(this,e),e===this._recent&&(this._recent=this._last),Ot(this))},e.totalTime=function(e,t){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=I(f.time-(0<this._ts?e/this._ts:(this.totalDuration()-e)/-this._ts))),ni.prototype.totalTime.call(this,e,t),this._forcing=0,this):this._tTime},e.addLabel=function(e,t){return this.labels[e]=h(this,t),this},e.removeLabel=function(e){return delete this.labels[e],this},e.addPause=function(e,t,i){t=j.delayedCall(0,t||v,i);return t.data="isPause",this._hasPause=1,C(this,t,h(this,e))},e.removePause=function(e){var t=this._first;for(e=h(this,e);t;)t._start===e&&"isPause"===t.data&&Dt(t),t=t._next},e.killTweensOf=function(e,t,i){for(var r=this.getTweensOf(e,i),n=r.length;n--;)li!==r[n]&&r[n].kill(e,t);return this},e.getTweensOf=function(e,t){for(var i,r=[],n=P(e),s=this._first,a=nt(t);s;)s instanceof j?function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i}(s._targets,n)&&(a?(!li||s._initted&&s._ts)&&s.globalTime(0)<=t&&s.globalTime(s.totalDuration())>t:!t||s.isActive())&&r.push(s):(i=s.getTweensOf(n,t)).length&&r.push.apply(r,i),s=s._next;return r},e.tweenTo=function(e,t){t=t||{};var i,r=this,n=h(r,e),e=t,s=e.startAt,a=e.onStart,o=e.onStartParams,e=e.immediateRender,l=j.to(r,G({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:n,overwrite:"auto",duration:t.duration||Math.abs((n-(s&&"time"in s?s.time:r._time))/r.timeScale())||B,onStart:function(){var e;r.pause(),i||(e=t.duration||Math.abs((n-(s&&"time"in s?s.time:r._time))/r.timeScale()),l._dur!==e&&oe(l,e,0,1).render(l._time,!0,!0),i=1),a&&a.apply(l,o||[])}},t));return e?l.render(0):l},e.tweenFromTo=function(e,t,i){return this.tweenTo(t,G({startAt:{time:h(this,e)}},i))},e.recent=function(){return this._recent},e.nextLabel=function(e){return void 0===e&&(e=this._time),_e(this,h(this,e))},e.previousLabel=function(e){return void 0===e&&(e=this._time),_e(this,h(this,e),1)},e.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+B)},e.shiftChildren=function(e,t,i){void 0===i&&(i=0);for(var r,n=this._first,s=this.labels;n;)n._start>=i&&(n._start+=e,n._end+=e),n=n._next;if(t)for(r in s)s[r]>=i&&(s[r]+=e);return Ot(this)},e.invalidate=function(e){var t=this._first;for(this._lock=0;t;)t.invalidate(e),t=t._next;return ni.prototype.invalidate.call(this,e)},e.clear=function(e){void 0===e&&(e=!0);for(var t,i=this._first;i;)t=i._next,this.remove(i),i=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Ot(this)},e.totalDuration=function(e){var t,i,r,n=0,s=this,a=s._last,o=U;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-e:e));if(s._dirty){for(r=s.parent;a;)t=a._prev,a._dirty&&a.totalDuration(),(i=a._start)>o&&s._sort&&a._ts&&!s._lock?(s._lock=1,C(s,a,i-a._delay,1)._lock=0):o=i,i<0&&a._ts&&(n-=i,(!r&&!s._dp||r&&r.smoothChildTiming)&&(s._start+=i/s._ts,s._time-=i,s._tTime-=i),s.shiftChildren(-i,!1,-1/0),o=0),a._end>n&&a._ts&&(n=a._end),a=t;oe(s,s===N&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},si.updateRoot=function(e){if(N._ts&&(y(N,te(e,N)),ke=f.frame),f.frame>=St){St+=F.autoSleep||120;var t=N._first;if((!t||!t._ts)&&F.autoSleep&&f._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||f.sleep()}}};var ni,k=si;function si(e,t){var i;return(i=ni.call(this,e=void 0===e?{}:e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=z(e.sortChildren),N&&C(e.parent||N,K(i),t),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&re(K(i),e.scrollTrigger),i}G(k.prototype,{_lock:0,_hasPause:0,_forcing:0});function ai(e,t,i){var r,n,s,a,o,l,h,u,c,d,p,f,m,g=e.vars,v=g.ease,y=g.startAt,_=g.immediateRender,b=g.lazy,T=g.onUpdate,x=g.onUpdateParams,w=g.callbackScope,S=g.runBackwards,E=g.yoyoEase,M=g.keyframes,C=g.autoRevert,A=e._dur,L=e._startAt,I=e._targets,P=e.parent,R=P&&"nested"===P.data?P.vars.targets:I,k="auto"===e._overwrite&&!Le,D=e.timeline;if(e._ease=Qt(v=!D||M&&v?v:"none",Je.ease),e._yEase=E?Zt(Qt(!0===E?v:E,Je.ease)):0,E&&e._yoyo&&!e._repeat&&(E=e._yEase,e._yEase=e._ease,e._ease=E),e._from=!D&&!!g.runBackwards,!D||M&&!g.stagger){if(f=(u=I[0]?At(I[0]).harness:0)&&g[u.prop],r=kt(g,bt),L&&(L._zTime<0&&L.progress(1),t<0&&S&&_&&!C?L.render(-1,!0):L.revert(S&&A?yt:vt),L._lazy=0),y){if(Dt(e._startAt=j.set(I,G({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:!L&&z(b),startAt:null,delay:0,onUpdate:T,onUpdateParams:x,callbackScope:w,stagger:0},y))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(O||!_&&!C)&&e._startAt.revert(yt),_&&A&&t<=0&&i<=0)return void(t&&(e._zTime=t))}else if(S&&A&&!L)if(s=G({overwrite:!1,data:"isFromStart",lazy:(_=t?!1:_)&&!L&&z(b),immediateRender:_,stagger:0,parent:P},r),f&&(s[u.prop]=f),Dt(e._startAt=j.set(I,s)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(O?e._startAt.revert(yt):e._startAt.render(-1,!0)),e._zTime=t,_){if(!t)return}else ai(e._startAt,B,B);for(e._pt=e._ptCache=0,b=A&&z(b)||b&&!A,n=0;n<I.length;n++){if(h=(o=I[n])._gsap||Ct(I)[n]._gsap,e._ptLookup[n]=d={},xt[h.id]&&Tt.length&&Pt(),p=R===I?n:R.indexOf(o),u&&!1!==(c=new u).init(o,f||r,e,p,R)&&(e._pt=a=new q(e._pt,o,c.name,0,1,c.render,c,0,c.priority),c._props.forEach(function(e){d[e]=a}),c.priority)&&(l=1),!u||f)for(s in r)V[s]&&(c=di(s,r,e,p,o,R))?c.priority&&(l=1):d[s]=a=ci.call(e,o,s,"get",r[s],p,R,0,g.stringFilter);e._op&&e._op[n]&&e.kill(o,e._op[n]),k&&e._pt&&(li=e,N.killTweensOf(o,d,e.globalTime(t)),m=!e.parent,li=0),e._pt&&b&&(xt[h.id]=1)}l&&Ci(e),e._onInit&&e._onInit(e)}e._onUpdate=T,e._initted=(!e._op||e._pt)&&!m,M&&t<=0&&D.render(U,!0,!0)}function oi(e,t,i,r,n){return c(e)?e.call(t,i,r,n):H(e)&&~e.indexOf("random(")?Vt(e):e}var li,hi,ui,ci=function(e,t,i,r,n,s,a,o,l,h){c(r)&&(r=r(n||0,e,s));var u,n=e[t],s="get"!==i?i:c(n)?l?e[t.indexOf("set")||!c(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():n,i=c(n)?l?vi:gi:mi;if(H(r)&&"="===(r=~r.indexOf("random(")?Vt(r):r).charAt(1)&&((u=It(s,r)+(W(s)||0))||0===u)&&(r=u),!h||s!==r||hi)return isNaN(s*r)||""===r?(n||t in e||mt(t,r),function(e,t,i,r,n,s,a){var o,l,h,u,c,d=new q(this._pt,e,t,0,1,Mi,null,n),p=0,f=0;for(d.b=i,d.e=r,i+="",(n=~(r+="").indexOf("random("))&&(r=Vt(r)),s&&(s(s=[i,r],e,t),i=s[0],r=s[1]),o=i.match(ut)||[];u=ut.exec(r);)h=u[0],u=r.substring(p,u.index),l?l=(l+1)%5:"rgba("===u.substr(-5)&&(l=1),h!==o[f++]&&(c=parseFloat(o[f-1])||0,d._pt={_next:d._pt,p:u||1===f?u:",",s:c,c:"="===h.charAt(1)?It(c,h)-c:parseFloat(h)-c,m:l&&l<4?Math.round:0},p=ut.lastIndex);return d.c=p<r.length?r.substring(p,r.length):"",d.fp=a,(ct.test(r)||n)&&(d.e=0),this._pt=d}.call(this,e,t,s,r,i,o||F.stringFilter,l)):(u=new q(this._pt,e,t,+s||0,r-(s||0),"boolean"==typeof n?bi:_i,0,i),l&&(u.fp=l),a&&u.modifier(a,this,e),this._pt=u)},di=function(e,t,i,r,n,s){var a,o,l,h;if(V[e]&&!1!==(a=new V[e]).init(n,a.rawVars?t[e]:function(e,t,i,r,n){if(c(e)&&(e=oi(e,n,t,i,r)),!A(e)||e.style&&e.nodeType||L(e)||at(e))return H(e)?oi(e,n,t,i,r):e;var s,a={};for(s in e)a[s]=oi(e[s],n,t,i,r);return a}(t[e],r,n,s,i),i,r,s)&&(i._pt=o=new q(i._pt,n,e,0,1,a.render,a,0,a.priority),i!==zi))for(l=i._ptLookup[i._targets.indexOf(n)],h=a._props.length;h--;)l[a._props[h]]=o;return a},pi=Mt+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",fi={},j=(p(pi+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return fi[e]=1}),r(n,ui=ii),(t=n.prototype).render=function(e,t,i){var r,n,s,a=this._time,o=this._tDur,l=this._dur,h=e<0,u=o-B<e&&!h?o:e<B?0:e;if(l){if(u!==this._tTime||!e||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=h){if(f=u,p=this.timeline,this._repeat){if(c=l+this._rDelay,this._repeat<-1&&h)return this.totalTime(100*c+e,t,i);if(f=I(u%c),u===o?(v=this._repeat,f=l):((v=~~(u/c))&&v===u/c&&(f=l,v--),l<f&&(f=l)),(n=this._yoyo&&1&v)&&(d=this._yEase,f=l-f),_=M(this._tTime,c),f===a&&!i&&this._initted)return this._tTime=u,this;v!==_&&(p&&this._yEase&&Se(p,n),!this.vars.repeatRefresh||n||this._lock||(this._lock=i=1,this.render(I(c*v),!0).invalidate()._lock=0))}if(!this._initted){if(ne(this,h?e:f,i,t,u))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(e,t,i)}if(this._tTime=u,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=s=(d||this._ease)(f/l),this._from&&(this.ratio=s=1-s),f&&!a&&!t&&(T(this,"onStart"),this._tTime!==u))return this;for(r=this._pt;r;)r.r(s,r.d),r=r._next;p&&p.render(e<0?e:!f&&n?-B:p._dur*p._ease(f/this._dur),t,i)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(h&&S(this,e,0,i),T(this,"onUpdate")),this._repeat&&v!==_&&this.vars.onRepeat&&!t&&this.parent&&T(this,"onRepeat"),u!==this._tDur&&u||this._tTime!==u||(h&&!this._onUpdate&&S(this,e,0,!0),!e&&l||!(u===this._tDur&&0<this._ts||!u&&this._ts<0)||Dt(this,1),t)||h&&!a||!(u||a||n)||(T(this,u===o?"onComplete":"onReverseComplete",!0),!this._prom)||u<o&&0<this.timeScale()||this._prom()}}else{var c=this;var d=e;var p=t;var f=i;var m,g,v=c.ratio,y=d<0||!d&&(!c._start&&se(c)&&(c._initted||!ae(c))||(c._ts<0||c._dp._ts<0)&&!ae(c))?0:1,_=c._rDelay,l=0;if(_&&c._repeat&&(l=ce(0,c._tDur,d),g=M(l,_),c._yoyo&&1&g&&(y=1-y),g!==M(c._tTime,_))&&(v=1-y,c.vars.repeatRefresh)&&c._initted&&c.invalidate(),y!==v||O||f||c._zTime===B||!d&&c._zTime){if(c._initted||!ne(c,d,f,p,l)){for(g=c._zTime,c._zTime=d||(p?B:0),p=p||d&&!g,c.ratio=y,c._from&&(y=1-y),c._time=0,c._tTime=l,m=c._pt;m;)m.r(y,m.d),m=m._next;d<0&&S(c,d,0,!0),c._onUpdate&&!p&&T(c,"onUpdate"),l&&c._repeat&&!p&&c.parent&&T(c,"onRepeat"),(d>=c._tDur||d<0)&&c.ratio===y&&(y&&Dt(c,1),p||O||(T(c,y?"onComplete":"onReverseComplete",!0),c._prom&&c._prom()))}}else c._zTime||(c._zTime=d)}return this},t.targets=function(){return this._targets},t.invalidate=function(e){return e&&this.vars.runBackwards||(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),ui.prototype.invalidate.call(this,e)},t.resetTo=function(e,t,i,r){De||f.wake(),this._ts||this.play();var n=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||ai(this,n),function(e,t,i,r,n,s,a){var o,l,h,u,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],h=e._ptLookup,u=e._targets.length;u--;){if((o=h[u][t])&&o.d&&o.d._pt)for(o=o.d._pt;o&&o.p!==t&&o.fp!==t;)o=o._next;if(!o)return hi=1,e.vars[t]="+=0",ai(e,a),hi=0,1;c.push(o)}for(u=c.length;u--;)(o=(l=c[u])._pt||l).s=!r&&0!==r||n?o.s+(r||0)+s*o.c:r,o.c=i-o.s,l.e&&(l.e=D(i)+W(l.e)),l.b&&(l.b=o.s+W(l.b))}(this,e,t,i,r,this._ease(n/this._dur),n)?this.resetTo(e,t,i,r):(Ut(this,0),this.parent||x(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?be(this):this;if(this.timeline)d=this.timeline.totalDuration(),this.timeline.killTweensOf(e,t,li&&!0!==li.vars.overwrite)._first||be(this),this.parent&&d!==this.timeline.totalDuration()&&oe(this,this._dur*this.timeline._tDur/d,0,1);else{var i,r,n,s,a,o,l,h=this._targets,u=e?P(e):h,c=this._ptLookup,d=this._pt;if((!t||"all"===t)&&function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0}(h,u))return"all"===t&&(this._pt=0),be(this);for(i=this._op=this._op||[],"all"!==t&&(H(t)&&(a={},p(t,function(e){return a[e]=1}),t=a),t=function(e){var t,i,r,n,s=h[0]?At(h[0]).harness:0,a=s&&s.aliases;if(!a)return e;for(i in t=Z({},e),a)if(i in t)for(r=(n=a[i].split(",")).length;r--;)t[n[r]]=t[i];return t}(t)),l=h.length;l--;)if(~u.indexOf(h[l]))for(a in r=c[l],"all"===t?(i[l]=t,s=r,n={}):(n=i[l]=i[l]||{},s=t),s)(o=r&&r[a])&&("kill"in o.d&&!0!==o.d.kill(a)||w(this,o,"_pt"),delete r[a]),"all"!==n&&(n[a]=1);this._initted&&!this._pt&&d&&be(this)}return this},n.to=function(e,t){return new n(e,t,arguments[2])},n.from=function(e,t){return he(1,arguments)},n.delayedCall=function(e,t,i,r){return new n(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},n.fromTo=function(e,t,i){return he(2,arguments)},n.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new n(e,t)},n.killTweensOf=function(e,t,i){return N.killTweensOf(e,t,i)},n);function n(e,t,i,r){var n;"number"==typeof t&&(i.duration=t,t=i,i=null);var s,a,o,l,h,u,c,d,r=(n=ui.call(this,r?t:Q(t))||this).vars,p=r.duration,f=r.delay,m=r.immediateRender,g=r.stagger,v=r.overwrite,y=r.keyframes,_=r.defaults,b=r.scrollTrigger,T=r.yoyoEase,r=t.parent||N,x=(L(e)||at(e)?nt(e[0]):"length"in t)?[e]:P(e);if(n._targets=x.length?Ct(x):gt("GSAP target "+e+" not found. https://greensock.com",!F.nullTargetWarn)||[],n._ptLookup=[],n._overwrite=v,y||g||J(p)||J(f)){if(t=n.vars,(s=n.timeline=new k({data:"nested",defaults:_||{},targets:r&&"nested"===r.data?r.vars.targets:x})).kill(),s.parent=s._dp=K(n),s._start=0,g||J(p)||J(f)){if(l=x.length,c=g&&fe(g),A(g))for(h in g)~pi.indexOf(h)&&(d=d||{},d[h]=g[h]);for(a=0;a<l;a++)(o=kt(t,fi)).stagger=0,T&&(o.yoyoEase=T),d&&Z(o,d),u=x[a],o.duration=+oi(p,K(n),a,u,x),o.delay=(+oi(f,K(n),a,u,x)||0)-n._delay,!g&&1===l&&o.delay&&(n._delay=f=o.delay,n._start+=f,o.delay=0),s.to(u,o,c?c(a,u,x):0),s._ease=R.none;s.duration()?p=f=0:n.timeline=0}else if(y){Q(G(s.vars.defaults,{ease:"none"})),s._ease=Qt(y.ease||t.ease||"none");var w,S,E,M=0;if(L(y))y.forEach(function(e){return s.to(x,e,">")}),s.duration();else{for(h in o={},y)"ease"!==h&&"easeEach"!==h&&function(e,i,t,r){var n,s,a=i.ease||r||"power1.inOut";if(L(i))s=t[e]||(t[e]=[]),i.forEach(function(e,t){return s.push({t:t/(i.length-1)*100,v:e,e:a})});else for(n in i)s=t[n]||(t[n]=[]),"ease"!==n&&s.push({t:parseFloat(e),v:i[n],e:a})}(h,y[h],o,y.easeEach);for(h in o)for(w=o[h].sort(function(e,t){return e.t-t.t}),M=0,a=0;a<w.length;a++)(E={ease:(S=w[a]).e,duration:(S.t-(a?w[a-1].t:0))/100*p})[h]=S.v,s.to(x,E,M),M+=E.duration;s.duration()<p&&s.to({},{duration:p-s.duration()})}}p||n.duration(p=s.duration())}else n.timeline=0;return!0!==v||Le||(li=K(n),N.killTweensOf(x),li=0),C(r,K(n),i),t.reversed&&n.reverse(),t.paused&&n.paused(!0),(m||!p&&!y&&n._start===I(r._time)&&z(m)&&ee(K(n))&&"nested"!==r.data)&&(n._tTime=-B,n.render(Math.max(0,-f)||0)),b&&re(K(n),b),n}G(j.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),p("staggerTo,staggerFrom,staggerFromTo",function(i){j[i]=function(){var e=new k,t=Ft.call(arguments,0);return t.splice("staggerFromTo"===i?5:4,0,0),e[i].apply(e,t)}});function mi(e,t,i){return e[t]=i}function gi(e,t,i){return e[t](i)}function vi(e,t,i,r){return e[t](r.fp,i)}function yi(e,t,i){return e.setAttribute(t,i)}function _i(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)}function bi(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)}function Ti(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next}function xi(e,t,i,r){for(var n,s=this._pt;s;)n=s._next,s.p===r&&s.modifier(e,t,i),s=n}function wi(e){for(var t,i,r=this._pt;r;)i=r._next,r.p===e&&!r.op||r.op===e?w(this,r,"_pt"):r.dep||(t=1),r=i;return!t}function Si(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)}var Ei=function(e,t){return c(e[t])?gi:st(e[t])&&e.setAttribute?yi:mi},Mi=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},Ci=function(e){for(var t,i,r,n,s=e._pt;s;){for(t=s._next,i=r;i&&i.pr>s.pr;)i=i._next;(s._prev=i?i._prev:n)?s._prev._next=s:r=s,(s._next=i)?i._prev=s:n=s,s=t}e._pt=r},q=(Ai.prototype.modifier=function(e,t,i){this.mSet=this.mSet||this.set,this.set=Si,this.m=e,this.mt=i,this.tween=t},Ai);function Ai(e,t,i,r,n,s,a,o,l){this.t=t,this.s=r,this.c=n,this.p=i,this.r=s||_i,this.d=a||this,this.set=o||mi,this.pr=l||0,(this._next=e)&&(e._prev=this)}p(Mt+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return bt[e]=1}),a.TweenMax=a.TweenLite=j,a.TimelineLite=a.TimelineMax=k,N=new k({sortChildren:!1,defaults:Je,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),F.stringFilter=we;function Li(e){(Ri[e]||ki).map(function(e){return e()})}function Ii(){var e=Date.now(),o=[];2<e-Di&&(Li("matchMediaInit"),Pi.forEach(function(e){var t,i,r,n,s=e.queries,a=e.conditions;for(i in s)(t=l.matchMedia(s[i]).matches)&&(r=1),t!==a[i]&&(a[i]=t,n=1);n&&(e.revert(),r)&&o.push(e)}),Li("matchMediaRevert"),o.forEach(function(e){return e.onMatch(e)}),Di=e,Li("matchMedia"))}var Pi=[],Ri={},ki=[],Di=0,Oi=((e=Fi.prototype).add=function(e,r,n){c(e)&&(n=r,r=e,e=c);function t(){var e,t=o,i=s.selector;return t&&t!==s&&t.data.push(s),n&&(s.selector=pe(n)),o=s,e=r.apply(s,arguments),c(e)&&s._r.push(e),o=t,s.selector=i,s.isReverted=!1,e}var s=this;return s.last=t,e===c?t(s):e?s[e]=t:t},e.ignore=function(e){var t=o;o=null,e(this),o=t},e.getTweens=function(){var t=[];return this.data.forEach(function(e){return e instanceof Fi?t.push.apply(t,e.getTweens()):e instanceof j&&!(e.parent&&"nested"===e.parent.data)&&t.push(e)}),t},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var i,r=this;t?(i=this.getTweens(),this.data.forEach(function(e){"isFlip"===e.data&&(e.revert(),e.getChildren(!0,!0,!1).forEach(function(e){return i.splice(i.indexOf(e),1)}))}),i.map(function(e){return{g:e.globalTime(0),t:e}}).sort(function(e,t){return t.g-e.g||-1}).forEach(function(e){return e.t.revert(t)}),this.data.forEach(function(e){return!(e instanceof ii)&&e.revert&&e.revert(t)}),this._r.forEach(function(e){return e(t,r)}),this.isReverted=!0):this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),e&&~(e=Pi.indexOf(this))&&Pi.splice(e,1)},e.revert=function(e){this.kill(e||{})},Fi),Ni=((t=Bi.prototype).add=function(e,t,i){A(e)||(e={matches:e});var r,n,s,a=new Oi(0,i||this.scope),o=a.conditions={};for(n in this.contexts.push(a),t=a.add("onMatch",t),a.queries=e)"all"===n?s=1:(r=l.matchMedia(e[n]))&&(Pi.indexOf(a)<0&&Pi.push(a),(o[n]=r.matches)&&(s=1),r.addListener?r.addListener(Ii):r.addEventListener("change",Ii));return s&&t(a),this},t.revert=function(e){this.kill(e||{})},t.kill=function(t){this.contexts.forEach(function(e){return e.kill(t,!0)})},Bi),Ui={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(e){var t=(e=!e.name&&e.default||e).name,i=c(e),i=t&&!i&&e.init?function(){this._props=[]}:e,r={init:v,render:Ti,add:ci,kill:wi,modifier:xi,rawVars:0},n={targetTest:0,get:0,getSetter:Ei,aliases:{},register:0};if(Yt(),e!==i){if(V[t])return;G(i,G(kt(e,r),n)),Z(i.prototype,Z(r,kt(e,n))),V[i.prop=t]=i,e.targetTest&&(Et.push(i),bt[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}g(t,i),e.register&&e.register(u,i,q)})},timeline:function(e){return new k(e)},getTweensOf:function(e,t){return N.getTweensOf(e,t)},getProperty:function(r,e,t,i){H(r)&&(r=P(r)[0]);var n=At(r||{}).get,s=t?_:Rt;return"native"===t&&(t=""),r&&(e?s((V[e]&&V[e].get||n)(r,e,t,i)):function(e,t,i){return s((V[e]&&V[e].get||n)(r,e,t,i))})},quickSetter:function(i,t,r){var n,s;if(1<(i=P(i)).length)return n=i.map(function(e){return u.quickSetter(e,t,r)}),s=n.length,function(e){for(var t=s;t--;)n[t](e)};i=i[0]||{};var a=V[t],o=At(i),l=o.harness&&(o.harness.aliases||{})[t]||t,h=a?function(e){var t=new a;zi._pt=0,t.init(i,r?e+r:e,zi,0,[i]),t.render(1,t),zi._pt&&Ti(1,zi)}:o.set(i,l);return a?h:function(e){return h(i,l,r?e+r:e,o,1)}},quickTo:function(e,r,t){function i(e,t,i){return n.resetTo(r,e,t,i)}var n=u.to(e,Z(((e={})[r]="+=0.1",e.paused=!0,e),t||{}));return i.tween=n,i},isTweening:function(e){return 0<N.getTweensOf(e,!0).length},defaults:function(e){return e&&e.ease&&(e.ease=Qt(e.ease,Je.ease)),b(Je,e||{})},config:function(e){return b(F,e||{})},registerEffect:function(e){var r=e.name,n=e.effect,t=e.plugins,s=e.defaults,e=e.extendTimeline;(t||"").split(",").forEach(function(e){return e&&!V[e]&&!a[e]&&gt(r+" effect requires "+e+" plugin.")}),wt[r]=function(e,t,i){return n(P(e),G(t||{},s),i)},e&&(k.prototype[r]=function(e,t,i){return this.add(wt[r](e,A(t)?t:(i=t)&&{},this),i)})},registerEase:function(e,t){R[e]=Qt(t)},parseEase:function(e,t){return arguments.length?Qt(e,t):R},getById:function(e){return N.getById(e)},exportRoot:function(e,t){var i,r,n=new k(e=void 0===e?{}:e);for(n.smoothChildTiming=z(e.smoothChildTiming),N.remove(n),n._dp=0,n._time=n._tTime=N._time,i=N._first;i;)r=i._next,!t&&!i._dur&&i instanceof j&&i.vars.onComplete===i._targets[0]||C(n,i,i._start-i._delay),i=r;return C(N,n,0),n},context:function(e,t){return e?new Oi(e,t):o},matchMedia:function(e){return new Ni(e)},matchMediaRefresh:function(){return Pi.forEach(function(e){var t,i,r=e.conditions;for(i in r)r[i]&&(r[i]=!1,t=1);t&&e.revert()})||Ii()},addEventListener:function(e,t){e=Ri[e]||(Ri[e]=[]);~e.indexOf(t)||e.push(t)},removeEventListener:function(e,t){e=Ri[e],t=e&&e.indexOf(t);0<=t&&e.splice(t,1)},utils:{wrap:function e(t,i,r){var n=i-t;return L(t)?ve(t,e(0,t.length),i):ue(r,function(e){return(n+(e-t)%n)%n+t})},wrapYoyo:function e(t,i,r){var n=i-t,s=2*n;return L(t)?ve(t,e(0,t.length-1),i):ue(r,function(e){return t+((e=(s+(e-t)%s)%s||0)>n?s-e:e)})},distribute:fe,random:zt,snap:ge,normalize:function(e,t,i){return ye(e,t,0,1,i)},getUnit:W,clamp:function(t,i,e){return ue(e,function(e){return ce(t,i,e)})},splitColor:Wt,toArray:P,selector:pe,mapRange:ye,pipe:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return t.reduce(function(e,t){return t(e)},e)}},unitize:function(t,i){return function(e){return t(parseFloat(e))+(i||W(e))}},interpolate:function e(t,i,r,n){var s=isNaN(t+i)?0:function(e){return(1-e)*t+e*i};if(!s){var a,o,l,h,u,c=H(t),d={};if(!0===r&&(n=1,r=null),c)t={p:t},i={p:i};else if(L(t)&&!L(i)){for(l=[],h=t.length,u=h-2,o=1;o<h;o++)l.push(e(t[o-1],t[o]));h--,s=function(e){e*=h;var t=Math.min(u,~~e);return l[t](e-t)},r=i}else n||(t=Z(L(t)?[]:{},t));if(!l){for(a in i)ci.call(d,t,a,"get",i[a]);s=function(e){return Ti(e,d),c?t.p:t}}}return ue(r,s)},shuffle:Ht},install:m,effects:wt,ticker:f,updateRoot:k.updateRoot,plugins:V,globalTimeline:N,core:{PropTween:q,globals:g,Tween:j,Timeline:k,Animation:ii,getCache:At,_removeLinkedListItem:w,reverting:function(){return O},context:function(e){return e&&o&&(o.data.push(e),e._ctx=o),o},suppressOverwrites:function(e){return Le=e}}};function Bi(e){this.contexts=[],this.scope=e}function Fi(e,t){this.selector=t&&pe(t),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}p("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return Ui[e]=j[e]}),f.add(k.updateRoot);function Hi(e,u){return{name:e,rawVars:1,init:function(e,h,t){t._onInit=function(e){var t,i;if(H(h)&&(t={},p(h,function(e){return t[e]=1}),h=t),u){for(i in t={},h)t[i]=u(h[i]);h=t}var r,n,s,a=e,o=h,l=a._targets;for(r in o)for(n=l.length;n--;)(s=(s=a._ptLookup[n][r])&&s.d)&&(s._pt&&(s=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i}(s,r)),s)&&s.modifier&&s.modifier(o[r],a,l[n],r)}}}}var zi=Ui.to({},{duration:0}),u=Ui.registerPlugin({name:"attr",init:function(e,t,i,r,n){var s,a,o;for(s in this.tween=i,t)o=e.getAttribute(s)||"",(a=this.add(e,"setAttribute",(o||0)+"",t[s],r,n,0,0,s)).op=s,a.b=o,this._props.push(s)},render:function(e,t){for(var i=t._pt;i;)O?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Hi("roundProps",me),Hi("modifiers"),Hi("snap",ge))||Ui;j.version=k.version=u.version="3.11.4",Re=1,s()&&Yt(),R.Power0,R.Power1,R.Power2,R.Power3,R.Power4,R.Linear,R.Quad,R.Cubic,R.Quart,R.Quint,R.Strong,R.Elastic,R.Back,R.SteppedEase,R.Bounce,R.Sine,R.Expo,R.Circ;function Vi(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)}function Gi(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)}function Wi(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)}function ji(e,t){e=t.s+t.c*e,t.set(t.t,t.p,~~(e+(e<0?-.5:.5))+t.u,t)}function qi(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)}function Xi(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)}function Yi(e,t,i){return e.style[t]=i}function $i(e,t,i){return e.style.setProperty(t,i)}function Ki(e,t,i){return e._gsap[t]=i}function Ji(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i}function Zi(e,t,i,r,n){(e=e._gsap).scaleX=e.scaleY=i,e.renderTransform(n,e)}function Qi(e,t,i,r,n){(e=e._gsap)[t]=i,e.renderTransform(n,e)}function er(e,t){var i=this,r=this.target,n=r.style;if(e in _r){if(this.tfm=this.tfm||{},"transform"!==e&&(~(e=Mr[e]||e).indexOf(",")?e.split(",").forEach(function(e){return i.tfm[e]=Br(r,e)}):this.tfm[e]=r._gsap.x?r._gsap[e]:Br(r,e)),0<=this.props.indexOf(X))return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Y,t,"")),e=X}(n||t)&&this.props.push(e,t,n[e])}function tr(){for(var e,t=this.props,i=this.target,r=i.style,n=i._gsap,s=0;s<t.length;s+=3)t[s+1]?i[t[s]]=t[s+2]:t[s+2]?r[t[s]]=t[s+2]:r.removeProperty(t[s].replace(wr,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)n[e]=this.tfm[e];n.svg&&(n.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),!(s=vr())||s.isStart||r[X]||(Cr(r),n.uncache=1)}}function ir(e,t){var i={target:e,props:[],revert:tr,save:er};return t&&t.split(",").forEach(function(e){return i.save(e)}),i}function rr(){"undefined"!=typeof window&&window.document&&(pr=(dr=window.document).documentElement,mr=Ar("div")||{style:{}},Ar("div"),X=Ir(X),Y=X+"Origin",mr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",yr=!!Ir("perspective"),vr=u.core.reverting,fr=1)}function nr(e){var t,i=Ar("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,n=this.nextSibling,s=this.style.cssText;if(pr.appendChild(i),i.appendChild(this),this.style.display="block",e)try{t=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=nr}catch(e){}else this._gsapBBox&&(t=this._gsapBBox());return r&&(n?r.insertBefore(this,n):r.appendChild(this)),pr.removeChild(i),this.style.cssText=s,t}function sr(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])}function ar(e,t,i,r){var n;i&&"none"!==i||((n=(s=Ir(t,e,1))&&$(e,s,1))&&n!==i?(t=s,i=n):"borderColor"===t&&(i=$(e,"borderTopColor")));var s,a,o,l,h,u,c,d,p,f=new q(this._pt,e.style,t,0,1,Mi),m=0,g=0;if(f.b=i,f.e=r,i+="","auto"==(r+="")&&(e.style[t]=r,r=$(e,t)||r,e.style[t]=i),we(s=[i,r]),r=s[1],a=(i=s[0]).match(ht)||[],(r.match(ht)||[]).length){for(;c=ht.exec(r);)d=c[0],c=r.substring(m,c.index),l?l=(l+1)%5:"rgba("!==c.substr(-5)&&"hsla("!==c.substr(-5)||(l=1),d!==(h=a[g++]||"")&&(o=parseFloat(h)||0,p=h.substr((o+"").length),"="===d.charAt(1)&&(d=It(o,d)+p),u=parseFloat(d),d=d.substr((u+"").length),m=ht.lastIndex-d.length,d||(d=d||F.units[t]||p,m===r.length&&(r+=d,f.e+=d)),p!==d&&(o=Ur(e,t,h,d)||0),f._pt={_next:f._pt,p:c||1===g?c:",",s:o,c:u-o,m:l&&l<4||"zIndex"===t?Math.round:0});f.c=m<r.length?r.substring(m,r.length):""}else f.r="display"===t&&"none"===r?Xi:qi;return ct.test(r)&&(f.e=0),this._pt=f}function or(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i,r,n,s=t.t,a=s.style,o=t.u,t=s._gsap;if("all"===o||!0===o)a.cssText="",r=1;else for(n=(o=o.split(",")).length;-1<--n;)i=o[n],_r[i]&&(r=1,i="transformOrigin"===i?Y:X),kr(s,i);r&&(kr(s,X),t)&&(t.svg&&s.removeAttribute("transform"),jr(s,1),t.uncache=1,Cr(a))}}function lr(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e}function hr(e,t,i,r,n,s){var a,o=e._gsap,n=n||Wr(e,!0),l=o.xOrigin||0,h=o.yOrigin||0,u=o.xOffset||0,c=o.yOffset||0,d=n[0],p=n[1],f=n[2],m=n[3],g=n[4],v=n[5],y=t.split(" "),_=parseFloat(y[0])||0,b=parseFloat(y[1])||0;i?n!==zr&&(n=d*m-p*f)&&(a=_*(-p/n)+b*(d/n)-(d*v-p*g)/n,_=_*(m/n)+b*(-f/n)+(f*v-m*g)/n,b=a):(_=(n=Pr(e)).x+(~y[0].indexOf("%")?_/100*n.width:_),b=n.y+(~(y[1]||y[0]).indexOf("%")?b/100*n.height:b)),r||!1!==r&&o.smooth?(o.xOffset=u+((g=_-l)*d+(v=b-h)*f)-g,o.yOffset=c+(g*p+v*m)-v):o.xOffset=o.yOffset=0,o.xOrigin=_,o.yOrigin=b,o.smooth=!!r,o.origin=t,o.originIsAbsolute=!!i,e.style[Y]="0px 0px",s&&(Dr(s,o,"xOrigin",l,_),Dr(s,o,"yOrigin",h,b),Dr(s,o,"xOffset",u,o.xOffset),Dr(s,o,"yOffset",c,o.yOffset)),e.setAttribute("data-svg-origin",_+" "+b)}function ur(e,t,i){var r=W(t);return D(parseFloat(t)+parseFloat(Ur(e,"x",i+"px",r)))+r}function cr(e,t){for(var i in t)e[i]=t[i];return e}var dr,pr,fr,mr,gr,vr,yr,_r={},br=180/Math.PI,Tr=Math.PI/180,xr=Math.atan2,wr=/([A-Z])/g,Sr=/(left|right|width|margin|padding|x)/i,Er=/[\s,\(]\S/,Mr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},X="transform",Y=X+"Origin",Cr=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Ar=function(e,t){t=dr.createElementNS?dr.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):dr.createElement(e);return t.style?t:dr.createElement(e)},$=function e(t,i,r){var n=getComputedStyle(t);return n[i]||n.getPropertyValue(i.replace(wr,"-$1").toLowerCase())||n.getPropertyValue(i)||!r&&e(t,Ir(i)||i,1)||""},Lr="O,Moz,ms,Ms,Webkit".split(","),Ir=function(e,t,i){var r=(t||mr).style,n=5;if(e in r&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(Lr[n]+e in r););return n<0?null:(3===n?"ms":0<=n?Lr[n]:"")+e},Pr=function(t){var i;try{i=t.getBBox()}catch(e){i=nr.call(t,!0)}return!(i=i&&(i.width||i.height)||t.getBBox===nr?i:nr.call(t,!0))||i.width||i.x||i.y?i:{x:+sr(t,["x","cx","x1"])||0,y:+sr(t,["y","cy","y1"])||0,width:0,height:0}},Rr=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Pr(e))},kr=function(e,t){t&&(e=e.style,t in _r&&t!==Y&&(t=X),e.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),e.removeProperty(t.replace(wr,"-$1").toLowerCase())):e.removeAttribute(t))},Dr=function(e,t,i,r,n,s){t=new q(e._pt,t,i,0,1,s?Xi:qi);return(e._pt=t).b=r,t.e=n,e._props.push(i),t},Or={deg:1,rad:1,turn:1},Nr={grid:1,flex:1},Ur=function e(t,i,r,n){var s,a=parseFloat(r)||0,o=(r+"").trim().substr((a+"").length)||"px",l=mr.style,h=Sr.test(i),u="svg"===t.tagName.toLowerCase(),c=(u?"client":"offset")+(h?"Width":"Height"),d="px"===n,p="%"===n;return n===o||!a||Or[n]||Or[o]?a:("px"===o||d||(a=e(t,i,r,"px")),r=t.getCTM&&Rr(t),!p&&"%"!==o||!_r[i]&&!~i.indexOf("adius")?(l[h?"width":"height"]=100+(d?o:n),i=~i.indexOf("adius")||"em"===n&&t.appendChild&&!u?t:t.parentNode,(n=(i=(i=r?(t.ownerSVGElement||{}).parentNode:i)&&i!==dr&&i.appendChild?i:dr.body)._gsap)&&p&&n.width&&h&&n.time===f.time&&!n.uncache?D(a/n.width*100):(!p&&"%"!==o||Nr[$(i,"display")]||(l.position=$(t,"position")),i===t&&(l.position="static"),i.appendChild(mr),s=mr[c],i.removeChild(mr),l.position="absolute",h&&p&&((n=At(i)).time=f.time,n.width=i[c]),D(d?s*a/100:s&&a?100/s*a:0))):(s=r?t.getBBox()[h?"width":"height"]:t[c],D(p?a/s*100:a/100*s)))},Br=function(e,t,i,r){var n;return fr||rr(),t in Mr&&"transform"!==t&&~(t=Mr[t]).indexOf(",")&&(t=t.split(",")[0]),_r[t]&&"transform"!==t?(n=jr(e,r),n="transformOrigin"!==t?n[t]:n.svg?n.origin:qr($(e,Y))+" "+n.zOrigin+"px"):(n=e.style[t])&&"auto"!==n&&!r&&!~(n+"").indexOf("calc(")||(n=Hr[t]&&Hr[t](e,t,i)||$(e,t)||Lt(e,t)||("opacity"===t?1:0)),i&&!~(n+"").trim().indexOf(" ")?Ur(e,t,n,i)+i:n},Fr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Hr={clearProps:function(e,t,i,r,n){if("isFromStart"!==n.data)return(t=e._pt=new q(e._pt,t,i,0,0,or)).u=r,t.pr=-10,t.tween=n,e._props.push(i),1}},zr=[1,0,0,1,0,0],Vr={},Gr=function(e){e=$(e,X);return lr(e)?zr:e.substr(7).match(lt).map(D)},Wr=function(e,t){var i,r,n,s=e._gsap||At(e),a=e.style,o=Gr(e);return s.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(o=[(r=e.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?zr:o:(o!==zr||e.offsetParent||e===pr||s.svg||(r=a.display,a.display="block",(s=e.parentNode)&&e.offsetParent||(n=1,i=e.nextElementSibling,pr.appendChild(e)),o=Gr(e),r?a.display=r:kr(e,"display"),n&&(i?s.insertBefore(e,i):s?s.appendChild(e):pr.removeChild(e))),t&&6<o.length?[o[0],o[1],o[4],o[5],o[12],o[13]]:o)},jr=function(e,t){var i,r,n,s,a,o,l,h,u,c,d,p,f,m,g,v,y,_,b,T,x,w,S,E,M,C,A,L,I,P,R,k=e._gsap||new ti(e);return"x"in k&&!t&&!k.uncache||(C=e.style,A=k.scaleX<0,L=getComputedStyle(e),I=$(e,Y)||"0",P=i=r=s=a=o=l=h=0,R=n=1,k.svg=!(!e.getCTM||!Rr(e)),L.translate&&("none"===L.translate&&"none"===L.scale&&"none"===L.rotate||(C[X]=("none"!==L.translate?"translate3d("+(L.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==L.rotate?"rotate("+L.rotate+") ":"")+("none"!==L.scale?"scale("+L.scale.split(" ").join(",")+") ":"")+("none"!==L[X]?L[X]:"")),C.scale=C.rotate=C.translate="none"),L=Wr(e,k.svg),k.svg&&(y=k.uncache?(_=e.getBBox(),I=k.xOrigin-_.x+"px "+(k.yOrigin-_.y)+"px",""):!t&&e.getAttribute("data-svg-origin"),hr(e,y||I,!!y||k.originIsAbsolute,!1!==k.smooth,L)),M=k.xOrigin||0,S=k.yOrigin||0,L!==zr&&(d=L[0],p=L[1],f=L[2],m=L[3],P=g=L[4],i=v=L[5],6===L.length?(R=Math.sqrt(d*d+p*p),n=Math.sqrt(m*m+f*f),s=d||p?xr(p,d)*br:0,(l=f||m?xr(f,m)*br+s:0)&&(n*=Math.abs(Math.cos(l*Tr))),k.svg&&(P-=M-(M*d+S*f),i-=S-(M*p+S*m))):(M=L[6],S=L[7],T=L[8],x=L[9],w=L[10],E=L[11],P=L[12],i=L[13],r=L[14],a=(L=xr(M,w))*br,L&&(y=g*(u=Math.cos(-L))+T*(c=Math.sin(-L)),_=v*u+x*c,b=M*u+w*c,T=g*-c+T*u,x=v*-c+x*u,w=M*-c+w*u,E=S*-c+E*u,g=y,v=_,M=b),o=(L=xr(-f,w))*br,L&&(u=Math.cos(-L),E=m*(c=Math.sin(-L))+E*u,d=y=d*u-T*c,p=_=p*u-x*c,f=b=f*u-w*c),s=(L=xr(p,d))*br,L&&(y=d*(u=Math.cos(L))+p*(c=Math.sin(L)),_=g*u+v*c,p=p*u-d*c,v=v*u-g*c,d=y,g=_),a&&359.9<Math.abs(a)+Math.abs(s)&&(a=s=0,o=180-o),R=D(Math.sqrt(d*d+p*p+f*f)),n=D(Math.sqrt(v*v+M*M)),L=xr(g,v),l=2e-4<Math.abs(L)?L*br:0,h=E?1/(E<0?-E:E):0),k.svg)&&(y=e.getAttribute("transform"),k.forceCSS=e.setAttribute("transform","")||!lr($(e,X)),y)&&e.setAttribute("transform",y),90<Math.abs(l)&&Math.abs(l)<270&&(A?(R*=-1,l+=s<=0?180:-180,s+=s<=0?180:-180):(n*=-1,l+=l<=0?180:-180)),t=t||k.uncache,k.x=P-((k.xPercent=P&&(!t&&k.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-P)?-50:0)))?e.offsetWidth*k.xPercent/100:0)+"px",k.y=i-((k.yPercent=i&&(!t&&k.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*k.yPercent/100:0)+"px",k.z=r+"px",k.scaleX=D(R),k.scaleY=D(n),k.rotation=D(s)+"deg",k.rotationX=D(a)+"deg",k.rotationY=D(o)+"deg",k.skewX=l+"deg",k.skewY="0deg",k.transformPerspective=h+"px",(k.zOrigin=parseFloat(I.split(" ")[2])||0)&&(C[Y]=qr(I)),k.xOffset=k.yOffset=0,k.force3D=F.force3D,k.renderTransform=k.svg?Zr:yr?Jr:Xr,k.uncache=0),k},qr=function(e){return(e=e.split(" "))[0]+" "+e[1]},Xr=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Jr(e,t)},Yr="0deg",$r="0px",Kr=") ",Jr=function(e,t){var i,r,n,t=t||this,s=t.xPercent,a=t.yPercent,o=t.x,l=t.y,h=t.z,u=t.rotation,c=t.rotationY,d=t.rotationX,p=t.skewX,f=t.skewY,m=t.scaleX,g=t.scaleY,v=t.transformPerspective,y=t.force3D,_=t.target,t=t.zOrigin,b="",e="auto"===y&&e&&1!==e||!0===y;!t||d===Yr&&c===Yr||(y=parseFloat(c)*Tr,i=Math.sin(y),r=Math.cos(y),y=parseFloat(d)*Tr,n=Math.cos(y),o=ur(_,o,i*n*-t),l=ur(_,l,-Math.sin(y)*-t),h=ur(_,h,r*n*-t+t)),v!==$r&&(b+="perspective("+v+Kr),(s||a)&&(b+="translate("+s+"%, "+a+"%) "),!e&&o===$r&&l===$r&&h===$r||(b+=h!==$r||e?"translate3d("+o+", "+l+", "+h+") ":"translate("+o+", "+l+Kr),u!==Yr&&(b+="rotate("+u+Kr),c!==Yr&&(b+="rotateY("+c+Kr),d!==Yr&&(b+="rotateX("+d+Kr),p===Yr&&f===Yr||(b+="skew("+p+", "+f+Kr),1===m&&1===g||(b+="scale("+m+", "+g+Kr),_.style[X]=b||"translate(0, 0)"},Zr=function(e,t){var i,r,n,s,a,t=t||this,o=t.xPercent,l=t.yPercent,h=t.x,u=t.y,c=t.rotation,d=t.skewX,p=t.skewY,f=t.scaleX,m=t.scaleY,g=t.target,v=t.xOrigin,y=t.yOrigin,_=t.xOffset,b=t.yOffset,t=t.forceCSS,T=parseFloat(h),x=parseFloat(u),c=parseFloat(c),d=parseFloat(d);(p=parseFloat(p))&&(d+=p=parseFloat(p),c+=p),c||d?(c*=Tr,d*=Tr,i=Math.cos(c)*f,r=Math.sin(c)*f,n=Math.sin(c-d)*-m,s=Math.cos(c-d)*m,d&&(p*=Tr,a=Math.tan(d-p),n*=a=Math.sqrt(1+a*a),s*=a,p)&&(a=Math.tan(p),i*=a=Math.sqrt(1+a*a),r*=a),i=D(i),r=D(r),n=D(n),s=D(s)):(i=f,s=m,r=n=0),(T&&!~(h+"").indexOf("px")||x&&!~(u+"").indexOf("px"))&&(T=Ur(g,"x",h,"px"),x=Ur(g,"y",u,"px")),(v||y||_||b)&&(T=D(T+v-(v*i+y*n)+_),x=D(x+y-(v*r+y*s)+b)),(o||l)&&(a=g.getBBox(),T=D(T+o/100*a.width),x=D(x+l/100*a.height)),g.setAttribute("transform",a="matrix("+i+","+r+","+n+","+s+","+T+","+x+")"),t&&(g.style[X]=a)};p("padding,margin,Width,Radius",function(t,i){var e="Bottom",o=(i<3?["Top","Right",e,"Left"]:["TopLeft","TopRight",e+"Right",e+"Left"]).map(function(e){return i<2?t+e:"border"+e+t});Hr[1<i?"border"+t:t]=function(t,e,i,r,n){var s,a;if(arguments.length<4)return s=o.map(function(e){return Br(t,e,i)}),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(r+"").split(" "),a={},o.forEach(function(e,t){return a[e]=s[t]=s[t]||s[(t-1)/2|0]}),t.init(e,a,n)}});var Qr,e={name:"css",register:rr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,n){var s,a,o,l,h,u,c,d,p,N,f,m,U,g,v,y,_,b,T,x,B=this._props,w=e.style,S=i.vars.startAt;for(h in fr||rr(),this.styles=this.styles||ir(e),g=this.styles.props,this.tween=i,t)if("autoRound"!==h&&(a=t[h],!V[h]||!di(h,t,i,r,e,n)))if(d=typeof a,l=Hr[h],"function"===d&&(d=typeof(a=a.call(i,r,e,n))),"string"===d&&~a.indexOf("random(")&&(a=Vt(a)),l)l(this,e,h,a,i)&&(U=1);else if("--"===h.substr(0,2))s=(getComputedStyle(e).getPropertyValue(h)+"").trim(),a+="",qt.lastIndex=0,qt.test(s)||(u=W(s),c=W(a)),c?u!==c&&(s=Ur(e,h,s,c)+c):u&&(a+=u),this.add(w,"setProperty",s,a,r,n,0,0,h),B.push(h),g.push(h,0,w[h]);else if("undefined"!==d){if(S&&h in S&&(s="function"==typeof S[h]?S[h].call(i,r,e,n):S[h],H(s)&&~s.indexOf("random(")&&(s=Vt(s)),W(s+"")||(s+=F.units[h]||W(Br(e,h))||""),"="!==(s+"").charAt(1))||(s=Br(e,h)),l=parseFloat(s),(d="string"===d&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),p=(h=h in Mr&&("autoAlpha"===h&&(1===l&&"hidden"===Br(e,"visibility")&&o&&(l=0),g.push("visibility",0,w.visibility),Dr(this,w,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==h)&&"transform"!==h&&~(h=Mr[h]).indexOf(",")?h.split(",")[0]:h)in _r)if(this.styles.save(h),N||((f=e._gsap).renderTransform&&!t.parseTransform||jr(e,t.parseTransform),m=!1!==t.smoothOrigin&&f.smooth,(N=this._pt=new q(this._pt,w,X,0,1,f.renderTransform,f,0,-1)).dep=1),"scale"===h)this._pt=new q(this._pt,f,"scaleY",f.scaleY,(d?It(f.scaleY,d+o):o)-f.scaleY||0,Vi),this._pt.u=0,B.push("scaleY",h),h+="X";else{if("transformOrigin"===h){g.push(Y,0,w[Y]),_=y=b=void 0,y=(b=(v=a).split(" "))[0],_=b[1]||"50%","top"!==y&&"bottom"!==y&&"left"!==_&&"right"!==_||(v=y,y=_,_=v),b[0]=Fr[y]||y,b[1]=Fr[_]||_,a=b.join(" "),f.svg?hr(e,a,0,m,0,this):((c=parseFloat(a.split(" ")[2])||0)!==f.zOrigin&&Dr(this,f,"zOrigin",f.zOrigin,c),Dr(this,w,h,qr(s),qr(a)));continue}if("svgOrigin"===h){hr(e,a,1,m,0,this);continue}if(h in Vr){v=this,y=f,_=h,b=l,T=d?It(l,d+a):a,x=R=O=void 0,O=H(T),R=parseFloat(T)*(O&&~T.indexOf("rad")?br:1)-b,x=b+R+"deg",O&&("short"===(O=T.split("_")[1])&&(R%=360)!=R%180&&(R+=R<0?360:-360),"cw"===O&&R<0?R=(R+36e9)%360-360*~~(R/360):"ccw"===O&&0<R&&(R=(R-36e9)%360-360*~~(R/360))),v._pt=T=new q(v._pt,y,_,b,R,Gi),T.e=x,T.u="deg",v._props.push(_);continue}if("smoothOrigin"===h){Dr(this,f,"smooth",f.smooth,a);continue}if("force3D"===h){f[h]=a;continue}if("transform"===h){O=D=I=A=L=C=M=E=void 0;var E,M,C,A,L,I,P=this,R=a,k=e,D=cr({},k._gsap),O=k.style;for(M in D.svg?(C=k.getAttribute("transform"),k.setAttribute("transform",""),O[X]=R,E=jr(k,1),kr(k,X),k.setAttribute("transform",C)):(C=getComputedStyle(k)[X],O[X]=R,E=jr(k,1),O[X]=C),_r)(C=D[M])!==(L=E[M])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(M)<0&&(A=W(C)!==(I=W(L))?Ur(k,M,C,I):parseFloat(C),L=parseFloat(L),P._pt=new q(P._pt,E,M,A,L-A,Vi),P._pt.u=I||0,P._props.push(M));cr(E,D);continue}}else h in w||(h=Ir(h)||h);if(p||(o||0===o)&&(l||0===l)&&!Er.test(a)&&h in w)o=o||0,(u=(s+"").substr((l+"").length))!==(c=W(a)||(h in F.units?F.units[h]:u))&&(l=Ur(e,h,s,c)),this._pt=new q(this._pt,p?f:w,h,l,(d?It(l,d+o):o)-l,p||"px"!==c&&"zIndex"!==h||!1===t.autoRound?Vi:ji),this._pt.u=c||0,u!==c&&"%"!==c&&(this._pt.b=s,this._pt.r=Wi);else if(h in w)ar.call(this,e,h,s,d?d+a:a);else if(h in e)this.add(e,h,s||e[h],d?d+a:a,r,n);else if("parseTransform"!==h){mt(h,a);continue}p||(h in w?g.push(h,0,w[h]):g.push(h,1,s||e[h])),B.push(h)}U&&Ci(this)},render:function(e,t){if(t.tween._time||!vr())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Br,aliases:Mr,getSetter:function(e,t,i){var r=Mr[t];return(t=r&&r.indexOf(",")<0?r:t)in _r&&t!==Y&&(e._gsap.x||Br(e,"x"))?i&&gr===i?"scale"===t?Ji:Ki:(gr=i||{})&&("scale"===t?Zi:Qi):e.style&&!st(e.style[t])?Yi:~t.indexOf("-")?$i:Ei(e,t)},core:{_removeProperty:kr,_getMatrix:Wr}},en=(u.utils.checkPrefix=Ir,u.core.getStyleSaver=ir,Qr=p("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+(t="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){_r[e]=1}),p(t,function(e){F.units[e]="deg",Vr[e]=1}),Mr[Qr[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+t,p("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(e){e=e.split(":");Mr[e[1]]=Qr[e[0]]}),p("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){F.units[e]="px"}),u.registerPlugin(e),u.registerPlugin(e)||u);en.core.Tween},9350:(e,t)=>{t.read=function(e,t,i,r,n){var s,a,o=8*n-r-1,l=(1<<o)-1,h=l>>1,u=-7,c=i?n-1:0,d=i?-1:1,n=e[t+c];for(c+=d,s=n&(1<<-u)-1,n>>=-u,u+=o;0<u;s=256*s+e[t+c],c+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;0<u;a=256*a+e[t+c],c+=d,u-=8);if(0===s)s=1-h;else{if(s===l)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,r),s-=h}return(n?-1:1)*a*Math.pow(2,s-r)},t.write=function(e,t,i,r,n,s){var a,o,l=8*s-n-1,h=(1<<l)-1,u=h>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,s=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=h):(a=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-a))<1&&(a--,r*=2),2<=(t+=1<=a+u?c/r:c*Math.pow(2,1-u))*r&&(a++,r/=2),h<=a+u?(o=0,a=h):1<=a+u?(o=(t*r-1)*Math.pow(2,n),a+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,n),a=0));8<=n;e[i+d]=255&o,d+=p,o/=256,n-=8);for(a=a<<n|o,l+=n;0<l;e[i+d]=255&a,d+=p,a/=256,l-=8);e[i+d-p]|=128*s}},6534:e=>{e.exports=function(e){var t;return!!e&&("[object Function]"===(t=i.call(e))||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt))};var i=Object.prototype.toString},2895:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!("undefined"==typeof window||!("ontouchstart"in window||window.DocumentTouch&&"undefined"!=typeof document&&document instanceof window.DocumentTouch))||!("undefined"==typeof navigator||!navigator.maxTouchPoints&&!navigator.msMaxTouchPoints)},e.exports=t.default},7815:(e,t,i)=>{"use strict";i.d(t,{Z:()=>function(e){var t={userAgent:"",platform:"",maxTouchPoints:0},e=(e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0},t.userAgent),i=e.split("[FBAN"),i=(void 0!==i[1]&&(e=i[0]),function(t){return function(e){return e.test(t)}}(e=void 0!==(i=e.split("Twitter"))[1]?i[0]:e)),e={apple:{phone:i(r)&&!i(c),ipod:i(n),tablet:!i(r)&&(i(s)||y(t))&&!i(c),universal:i(a),device:(i(r)||i(n)||i(s)||i(a)||y(t))&&!i(c)},amazon:{phone:i(h),tablet:!i(h)&&i(u),device:i(h)||i(u)},android:{phone:!i(c)&&i(h)||!i(c)&&i(o),tablet:!i(c)&&!i(h)&&!i(o)&&(i(u)||i(l)),device:!i(c)&&(i(h)||i(u)||i(o)||i(l))||i(/\bokhttp\b/i)},windows:{phone:i(c),tablet:i(d),device:i(c)||i(d)},other:{blackberry:i(p),blackberry10:i(f),opera:i(m),firefox:i(v),chrome:i(g),device:i(p)||i(f)||i(m)||i(v)||i(g)},any:!1,phone:!1,tablet:!1};return e.any=e.apple.device||e.android.device||e.windows.device||e.other.device,e.phone=e.apple.phone||e.android.phone||e.windows.phone,e.tablet=e.apple.tablet||e.android.tablet||e.windows.tablet,e}});var r=/iPhone/i,n=/iPod/i,s=/iPad/i,a=/\biOS-universal(?:.+)Mac\b/i,o=/\bAndroid(?:.+)Mobile\b/i,l=/Android/i,h=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,u=/Silk/i,c=/Windows Phone/i,d=/\bWindows(?:.+)ARM\b/i,p=/BlackBerry/i,f=/BB10/i,m=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,v=/Mobile(?:.+)Firefox\b/i,y=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&1<e.maxTouchPoints&&"undefined"==typeof MSStream}},1740:(e,t)=>{function i(e){var t;return"number"==typeof(e=e&&"object"==typeof e&&(t=e.which||e.keyCode||e.charCode)?t:e)?o[e]:(t=String(e),r[t.toLowerCase()]||n[t.toLowerCase()]||(1===t.length?t.charCodeAt(0):void 0))}i.isEventKey=function(e,t){if(e&&"object"==typeof e){var i,e=e.which||e.keyCode||e.charCode;if(null!=e)if("string"==typeof t){if(i=r[t.toLowerCase()])return i===e;if(i=n[t.toLowerCase()])return i===e}else if("number"==typeof t)return t===e;return!1}};for(var r=(t=e.exports=i).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},n=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91},s=97;s<123;s++)r[String.fromCharCode(s)]=s-32;for(var s=48;s<58;s++)r[s-48]=s;for(s=1;s<13;s++)r["f"+s]=s+111;for(s=0;s<10;s++)r["numpad "+s]=s+96;var a,o=t.names=t.title={};for(s in r)o[r[s]]=s;for(a in n)r[a]=n[a]},7002:e=>{e.exports=function(s){var a={},o=[];(s=s||this).on=function(e,t,i){return(a[e]=a[e]||[]).push([t,i]),s},s.off=function(e,t){for(var i=(a=e?a:{})[e]||o,r=i.length=t?i.length:0;r--;)t==i[r][0]&&i.splice(r,1);return s},s.emit=function(e){for(var t,i=a[e]||o,r=0<i.length?i.slice(0,i.length):i,n=0;t=r[n++];)t[0].apply(t[1],o.slice.call(arguments,1));return s}}},3047:(e,t,i)=>{var s=i(6109).getUint64;e.exports=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},r=12,n=(0===i.version?(i.earliestPresentationTime=t.getUint32(r),i.firstOffset=t.getUint32(r+4),r+=8):(i.earliestPresentationTime=s(e.subarray(r)),i.firstOffset=s(e.subarray(r+8)),r+=16),t.getUint16(r+=2));for(r+=2;0<n;r+=12,n--)i.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)});return i}},5531:e=>{var t=function(e){return 9e4*e},i=function(e,t){return e*t},r=function(e){return e/9e4},n=function(e,t){return e/t};e.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:t,secondsToAudioTs:i,videoTsToSeconds:r,audioTsToSeconds:n,audioTsToVideoTs:function(e,t){return e/t*9e4},videoTsToAudioTs:function(e,t){return e/9e4*t},metadataTsToSeconds:function(e,t,i){return r(i?e:e-t)}}},6109:e=>{var i=Math.pow(2,32);e.exports={getUint64:function(e){var t,e=new DataView(e.buffer,e.byteOffset,e.byteLength);return e.getBigUint64?(t=e.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(t):t:e.getUint32(0)*i+e.getUint32(4)},MAX_UINT32:i}},1127:e=>{e.exports=function(e,t){var i,r=null;try{i=JSON.parse(e,t)}catch(e){r=e}return[r,i]}},8388:(N,e,t)=>{"use strict";function r(n,s){return Object.getOwnPropertyNames(Object(n)).reduce((e,t)=>{var i=Object.getOwnPropertyDescriptor(Object(n),t),r=Object.getOwnPropertyDescriptor(Object(s),t);return Object.defineProperty(e,t,r||i)},{})}function f(e){return"string"==typeof e}function n(e){return Array.isArray(e)}function s(e={}){var t=r(e);let i;return void 0!==t.types?i=t.types:void 0!==t.split&&(i=t.split),void 0!==i&&(t.types=(f(i)||n(i)?String(i):"").split(",").map(e=>String(e).trim()).filter(e=>/((line)|(word)|(char))/i.test(e))),(t.absolute||t.position)&&(t.absolute=t.absolute||/absolute/.test(e.position)),t}function _(e){e=f(e)||n(e)?String(e):"";return{none:!e,lines:/line/i.test(e),words:/word/i.test(e),chars:/char/i.test(e)}}function a(e){return null!==e&&"object"==typeof e}function i(e){return a(e)&&/^(1|3|11)$/.test(e.nodeType)}function b(e){return n(e)?e:null==e?[]:a(e)&&"number"==typeof(t=e.length)&&-1<t&&t%1==0?Array.prototype.slice.call(e):[e];var t}function o(e){let t=e;return b(t=f(e)?/^(#[a-z]\w+)$/.test(e.trim())?document.getElementById(e.trim().slice(1)):document.querySelectorAll(e):t).reduce((e,t)=>[...e,...b(t).filter(i)],[])}function l(...t){const i=t.length;for(let e=0;e<i;e++){const i=t[e];1===i.nodeType||11===i.nodeType?this.appendChild(i):this.appendChild(document.createTextNode(String(i)))}}function h(...e){for(;this.lastChild;)this.removeChild(this.lastChild);e.length&&this.append(...e)}function u(...t){var i=this.parentNode;let r=t.length;if(i)for(r||i.removeChild(this);r--;){let e=t[r];"object"!=typeof e?e=this.ownerDocument.createTextNode(e):e.parentNode&&e.parentNode.removeChild(e),r?i.insertBefore(this.previousSibling,e):i.replaceChild(e,this)}}t.d(e,{Z:()=>O}),"undefined"!=typeof Element&&(Element.prototype.append||(Element.prototype.append=l,DocumentFragment.prototype.append=l),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=h,DocumentFragment.prototype.replaceChildren=h),Element.prototype.replaceWith||(Element.prototype.replaceWith=u,DocumentFragment.prototype.replaceWith=u));const c=Object["entries"],d="_splittype",p={};let U=0;function T(e,t,i){if(!a(e))return console.warn("[data.set] owner is not an object");var e=e[d]||(e[d]=++U),r=p[e]||(p[e]={});void 0===i?t&&Object.getPrototypeOf(t)===Object.prototype&&(p[e]={...r,...t}):void 0!==t&&(r[t]=i)}function x(e,t){e=a(e)?e[d]:null,e=e&&p[e]||{};return void 0===t?e:e[t]}function w(e){var t=e&&e[d];t&&(delete e[t],delete p[t])}const m="\\ud800-\\udfff",g="\\u0300-\\u036f\\ufe20-\\ufe23",v="\\u20d0-\\u20f0",y="\\ufe0e\\ufe0f",B=`[${m}]`,S=`[${g}${v}]`,E="\\ud83c[\\udffb-\\udfff]",M=`[^${m}]`,C="(?:\\ud83c[\\udde6-\\uddff]){2}",A="[\\ud800-\\udbff][\\udc00-\\udfff]",L=`(?:${S}|${E})?`,I=`[${y}]?`,F=I+L+"(?:\\u200d(?:"+[M,C,A].join("|")+")"+I+L+")*",H=`(?:${[""+M+S+"?",S,C,A,B].join("|")}
)`,z=RegExp(E+`(?=${E})|`+H+F,"g"),V=RegExp(`[${["\\u200d",m,g,v,y].join("")}]`);function P(e){return V.test(e)}function R(e,i){const r=document.createElement(e);return i&&Object.keys(i).forEach(e=>{var t=i[e],t=f(t)?t.trim():t;null!==t&&""!==t&&("children"===e?r.append(...b(t)):r.setAttribute(e,t))}),r}var k={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function G(e,h){const u=_((h=r(k,h)).types),c=h.tagName,t=e.nodeValue,d=document.createDocumentFragment();let i,p=[];return/^\s/.test(t)&&d.append(" "),i=(t?String(t):"").trim().replace(/\s+/g," ").split(" ").reduce((e,t,i,r)=>{let n,s;return u.chars&&(s=(o="",((a=null==(a=t)?"":String(a))&&f(a)&&!o&&P(a)?P(l=a)?l.match(z)||[]:l.split(""):a.split(o)).map(e=>{e=R(c,{class:h.splitClass+" "+h.charClass,style:"display: inline-block;",children:e});return T(e,"isChar",!0),p=[...p,e],e}))),u.words||u.lines?(T(n=R(c,{class:h.wordClass+" "+h.splitClass,style:"display: inline-block; "+(u.words&&h.absolute?"position: relative;":""),children:u.chars?s:t}),{isWord:!0,isWordStart:!0,isWordEnd:!0}),d.appendChild(n)):s.forEach(e=>{d.appendChild(e)}),i<r.length-1&&d.append(" "),u.words?e.concat(n):e;var a,o,l},[]),/\s$/.test(t)&&d.append(" "),e.replaceWith(d),{words:i,chars:p}}function W(s,h,u){const a=_(h.types),t=h.tagName,e=s.getElementsByTagName("*"),o=[];let i,r,l,c=[],d=null,n=[];const p=s.parentElement,f=s.nextElementSibling,m=document.createDocumentFragment(),g=window.getComputedStyle(s),v=g.textAlign,y=.2*parseFloat(g.fontSize);return h.absolute&&(l={left:s.offsetLeft,top:s.offsetTop,width:s.offsetWidth},r=s.offsetWidth,i=s.offsetHeight,T(s,{cssWidth:s.style.width,cssHeight:s.style.height})),b(e).forEach(e=>{const l=e.parentElement===s,{width:t,height:i,top:r,left:n}=function(e){if(!h.absolute)return{top:l?e.offsetTop:null};var t=e.offsetParent,[i,r]=u;let n=0,s=0;if(t&&t!==document.body){const e=t.getBoundingClientRect();n=e.x+i,s=e.y+r}var{width:t,height:e,x:a,y:o}=e.getBoundingClientRect();return{width:t,height:e,top:o+r-s,left:a+i-n}}(e);/^br$/i.test(e.nodeName)||(a.lines&&l&&((null===d||r-d>=y)&&(d=r,o.push(c=[])),c.push(e)),h.absolute&&T(e,{top:r,left:n,width:t,height:i}))}),p&&p.removeChild(s),a.lines&&(n=o.map(e=>{const a=R(t,{class:h.splitClass+" "+h.lineClass,style:`display: block; text-align: ${v}; width: 100%;`}),o=(T(a,"isLine",!0),{height:0,top:1e4});return m.appendChild(a),e.forEach((e,t,i)=>{var{isWordEnd:r,top:n,height:s}=x(e),i=i[t+1];o.height=Math.max(o.height,s),o.top=Math.min(o.top,n),a.appendChild(e),r&&x(i).isWordStart&&a.append(" ")}),h.absolute&&T(a,{height:o.height,top:o.top}),a}),a.words||function t(e){x(e).isWord?(w(e),e.replaceWith(...e.childNodes)):b(e.children).forEach(e=>t(e))}(m),s.replaceChildren(m)),h.absolute&&(s.style.width=`${s.style.width||r}px`,s.style.height=i+"px",b(e).forEach(e=>{var{isLine:t,top:i,left:r,width:n,height:s}=x(e),a=x(e.parentElement),o=!t&&a.isLine;e.style.top=`${o?i-a.top:i}px`,e.style.left=t?l.left+"px":r-(o?l.left:0)+"px",e.style.height=s+"px",e.style.width=t?l.width+"px":n+"px",e.style.position="absolute"})),p&&(f?p.insertBefore(s,f):p.appendChild(s)),n}let D=r(k,{});class O{static get data(){return p}static get defaults(){return D}static set defaults(e){D=r(D,s(e))}static setDefaults(e){return D=r(D,s(e)),k}static revert(e){o(e).forEach(e=>{var{isSplit:t,html:i,cssWidth:r,cssHeight:n}=x(e);t&&(e.innerHTML=i,e.style.width=r||"",e.style.height=n||"",w(e))})}static create(e,t){return new O(e,t)}constructor(e,t){this.isSplit=!1,this.settings=r(D,s(t)),this.elements=o(e),this.split()}split(e){this.revert(),this.elements.forEach(e=>{T(e,"html",e.innerHTML)}),this.lines=[],this.words=[],this.chars=[];const t=[window.pageXOffset,window.pageYOffset],i=(void 0!==e&&(this.settings=r(this.settings,s(e))),_(this.settings.types));i.none||(this.elements.forEach(e=>{T(e,"isRoot",!0);var{words:e,chars:t}=function r(e,n){const t=e.nodeType,i={words:[],chars:[]};if(!/(1|3|11)/.test(t))return i;if(3===t&&/\S/.test(e.nodeValue))return G(e,n);const s=b(e.childNodes);if(s.length&&(T(e,"isSplit",!0),!x(e).isRoot)){e.style.display="inline-block",e.style.position="relative";const n=e.nextSibling,t=e.previousSibling,i=e.textContent||"",s=n?n.textContent:" ",a=t?t.textContent:" ";T(e,{isWordEnd:/\s$/.test(i)||/^\s/.test(s),isWordStart:/^\s/.test(i)||/\s$/.test(a)})}return s.reduce((e,t)=>{var{words:t,chars:i}=r(t,n);return{words:[...e.words,...t],chars:[...e.chars,...i]}},i)}(e,this.settings);this.words=[...this.words,...e],this.chars=[...this.chars,...t]}),this.elements.forEach(e=>{if(i.lines||this.settings.absolute){const i=W(e,this.settings,t);this.lines=[...this.lines,...i]}}),this.isSplit=!0,window.scrollTo(t[0],t[1]),c(p).forEach(([e,{isRoot:t,isSplit:i}])=>{t&&i||(p[e]=null,delete p[e])}))}revert(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),O.revert(this.elements)}}},438:e=>{function t(){}t.prototype={on:function(e,t,i){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var r=this;function n(){r.off(e,n),t.apply(i,arguments)}return n._=t,this.on(e,n,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),r=0,n=i.length;r<n;r++)i[r].fn.apply(i[r].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),r=i[e],n=[];if(r&&t)for(var s=0,a=r.length;s<a;s++)r[s].fn!==t&&r[s].fn._!==t&&n.push(r[s]);return n.length?i[e]=n:delete i[e],this}},e.exports=t,e.exports.TinyEmitter=t},5488:function(e){var t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=a.parseURL(e);if(r)return r.path=a.normalizePath(r.path),a.buildURLFromParts(r);throw new Error("Error trying to parse base URL.")}r=a.parseURL(t);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=a.normalizePath(r.path),a.buildURLFromParts(r)):t;t=a.parseURL(e);if(!t)throw new Error("Error trying to parse base URL.");!t.netLoc&&t.path&&"/"!==t.path[0]&&(e=s.exec(t.path),t.netLoc=e[1],t.path=e[2]),t.netLoc&&!t.path&&(t.path="/");var n,e={scheme:t.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};return r.netLoc||(e.netLoc=t.netLoc,"/"===r.path[0])||(r.path?(n=(n=t.path).substring(0,n.lastIndexOf("/")+1)+r.path,e.path=a.normalizePath(n)):(e.path=t.path,r.params||(e.params=t.params,r.query)||(e.query=t.query))),null===e.path&&(e.path=i.alwaysNormalize?a.normalizePath(r.path):r.path),a.buildURLFromParts(e)},parseURL:function(e){e=t.exec(e);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(r,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=a},7198:(i,e,oi)=>{"use strict";oi.d(e,{Z:()=>I});var e=oi(1192),v=oi.n(e),e=oi(930),a=oi.n(e),e=oi(1740),s=oi.n(e),e=oi(1127),t=oi.n(e),e=oi(3065),N=oi.n(e),e=oi(545),U=oi.n(e),e=oi(5488),B=oi.n(e);function F(){return(F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i,r=arguments[t];for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}(e=z.prototype).on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.off=function(e,t){return!!this.listeners[e]&&(t=this.listeners[e].indexOf(t),this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(t,1),-1<t)},e.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),s=t.length,a=0;a<s;++a)t[a].apply(this,n)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",function(e){t.push(e)})};var e=z,H=oi(5851).lW;function z(){this.listeners={}}function V(e){e=e;for(var t=v().atob?v().atob(e):H.from(e,"base64").toString("binary"),i=new Uint8Array(t.length),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}class G extends e{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}function W(e){var e=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t}function j(i){var r={};if(i){var n=i.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'));let e,t=n.length;for(;t--;)""!==n[t]&&((e=/([^=]*)=(.*)/.exec(n[t]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),r[e[0]]=e[1])}return r}const q=String.fromCharCode(9);class X extends e{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(i){let e,r;0!==(i=i.trim()).length&&("#"===i[0]?this.tagMappers.reduce((e,t)=>{t=t(i);return t===i?e:e.concat([t])},[i]).forEach(t=>{for(let e=0;e<this.customParsers.length;e++)if(this.customParsers[e].call(this,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))this.trigger("data",{type:"tag",tagType:"m3u"});else if(e=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(t))r={type:"tag",tagType:"inf"},e[1]&&(r.duration=parseFloat(e[1])),e[2]&&(r.title=e[2]),this.trigger("data",r);else if(e=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(t))r={type:"tag",tagType:"targetduration"},e[1]&&(r.duration=parseInt(e[1],10)),this.trigger("data",r);else if(e=/^#EXT-X-VERSION:([0-9.]*)?/.exec(t))r={type:"tag",tagType:"version"},e[1]&&(r.version=parseInt(e[1],10)),this.trigger("data",r);else if(e=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(t))r={type:"tag",tagType:"media-sequence"},e[1]&&(r.number=parseInt(e[1],10)),this.trigger("data",r);else if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(t))r={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(r.number=parseInt(e[1],10)),this.trigger("data",r);else if(e=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(t))r={type:"tag",tagType:"playlist-type"},e[1]&&(r.playlistType=e[1]),this.trigger("data",r);else if(e=/^#EXT-X-BYTERANGE:(.*)?$/.exec(t))r=F(W(e[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);else if(e=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(t))r={type:"tag",tagType:"allow-cache"},e[1]&&(r.allowed=!/NO/.test(e[1])),this.trigger("data",r);else if(e=/^#EXT-X-MAP:(.*)$/.exec(t)){if(r={type:"tag",tagType:"map"},e[1]){const t=j(e[1]);t.URI&&(r.uri=t.URI),t.BYTERANGE&&(r.byterange=W(t.BYTERANGE))}this.trigger("data",r)}else if(e=/^#EXT-X-STREAM-INF:(.*)$/.exec(t)){if(r={type:"tag",tagType:"stream-inf"},e[1]){if(r.attributes=j(e[1]),r.attributes.RESOLUTION){const t=r.attributes.RESOLUTION.split("x"),e={};t[0]&&(e.width=parseInt(t[0],10)),t[1]&&(e.height=parseInt(t[1],10)),r.attributes.RESOLUTION=e}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r)}else(e=/^#EXT-X-MEDIA:(.*)$/.exec(t))?(r={type:"tag",tagType:"media"},e[1]&&(r.attributes=j(e[1])),this.trigger("data",r)):(e=/^#EXT-X-ENDLIST/.exec(t))?this.trigger("data",{type:"tag",tagType:"endlist"}):(e=/^#EXT-X-DISCONTINUITY/.exec(t))?this.trigger("data",{type:"tag",tagType:"discontinuity"}):(e=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(t))?(r={type:"tag",tagType:"program-date-time"},e[1]&&(r.dateTimeString=e[1],r.dateTimeObject=new Date(e[1])),this.trigger("data",r)):(e=/^#EXT-X-KEY:(.*)$/.exec(t))?(r={type:"tag",tagType:"key"},e[1]&&(r.attributes=j(e[1]),r.attributes.IV)&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV)),this.trigger("data",r)):(e=/^#EXT-X-START:(.*)$/.exec(t))?(r={type:"tag",tagType:"start"},e[1]&&(r.attributes=j(e[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r)):(e=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-out-cont"},e[1]?r.data=e[1]:r.data="",this.trigger("data",r)):(e=/^#EXT-X-CUE-OUT:(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-out"},e[1]?r.data=e[1]:r.data="",this.trigger("data",r)):(e=/^#EXT-X-CUE-IN:(.*)?$/.exec(t))?(r={type:"tag",tagType:"cue-in"},e[1]?r.data=e[1]:r.data="",this.trigger("data",r)):(e=/^#EXT-X-SKIP:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"skip"}).attributes=j(e[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(q)),this.trigger("data",r)):(e=/^#EXT-X-PART:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"part"}).attributes=j(e[1]),["DURATION"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),["INDEPENDENT","GAP"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=/YES/.test(r.attributes[e]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=W(r.attributes.BYTERANGE)),this.trigger("data",r)):(e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"server-control"}).attributes=j(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=/YES/.test(r.attributes[e]))}),this.trigger("data",r)):(e=/^#EXT-X-PART-INF:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"part-inf"}).attributes=j(e[1]),["PART-TARGET"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),this.trigger("data",r)):(e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"preload-hint"}).attributes=j(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(e){var t;r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseInt(r.attributes[e],10),t="BYTERANGE-LENGTH"===e?"length":"offset",r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[t]=r.attributes[e],delete r.attributes[e])}),this.trigger("data",r)):(e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(t))&&e[1]?((r={type:"tag",tagType:"rendition-report"}).attributes=j(e[1]),["LAST-MSN","LAST-PART"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseInt(r.attributes[e],10))}),this.trigger("data",r)):this.trigger("data",{type:"tag",data:t.slice(4)});else this.trigger("data",{type:"comment",text:t.slice(1)})}):this.trigger("data",{type:"uri",uri:i}))}addParser({expression:t,customType:i,dataParser:r,segment:n}){"function"!=typeof r&&(r=e=>e),this.customParsers.push(e=>{if(t.exec(e))return this.trigger("data",{type:"custom",data:r(e),customType:i,segment:n}),!0})}addTagMapper({expression:t,map:i}){this.tagMappers.push(e=>t.test(e)?i(e):e)}}function Y(t){const i={};return Object.keys(t).forEach(function(e){i[e.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase())]=t[e]}),i}function $(e){var t,i,r,n,s,{serverControl:e,targetDuration:a,partTargetDuration:o}=e;e&&(t="#EXT-X-SERVER-CONTROL",i="holdBack",r="partHoldBack",n=a&&3*a,s=o&&2*o,a&&!e.hasOwnProperty(i)&&(e[i]=n,this.trigger("info",{message:t+` defaulting HOLD-BACK to targetDuration * 3 (${n}).`})),n&&e[i]<n&&(this.trigger("warn",{message:t+` clamping HOLD-BACK (${e[i]}) to targetDuration * 3 (${n})`}),e[i]=n),o&&!e.hasOwnProperty(r)&&(e[r]=3*o,this.trigger("info",{message:t+` defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[r]}).`})),o)&&e[r]<s&&(this.trigger("warn",{message:t+` clamping PART-HOLD-BACK (${e[r]}) to partTargetDuration * 2 (${s}).`}),e[r]=s)}class K extends e{constructor(){super(),this.lineStream=new G,this.parseStream=new X,this.lineStream.pipe(this.parseStream);const e=this,r=[];let n,a,o={},l=!1;const h={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}};let u=0,c=(this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},0),d=0;this.on("end",()=>{o.uri||!o.parts&&!o.preloadHints||(!o.map&&n&&(o.map=n),!o.key&&a&&(o.key=a),o.timeline||"number"!=typeof u||(o.timeline=u),this.manifest.preloadSegment=o)}),this.parseStream.on("data",function(s){let t,i;({tag(){({version(){s.version&&(this.manifest.version=s.version)},"allow-cache"(){this.manifest.allowCache=s.allowed,"allowed"in s||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){var e={};"length"in s&&((o.byterange=e).length=s.length,"offset"in s||(s.offset=c)),"offset"in s&&((o.byterange=e).offset=s.offset),c=e.offset+e.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<s.duration&&(o.duration=s.duration),0===s.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key(){if(s.attributes)if("NONE"!==s.attributes.METHOD)if(s.attributes.URI)if("com.apple.streamingkeydelivery"===s.attributes.KEYFORMAT)this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:s.attributes};else{if("com.microsoft.playready"!==s.attributes.KEYFORMAT)return"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===s.attributes.KEYFORMAT?-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(s.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===s.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==s.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):s.attributes.KEYID&&"0x"===s.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:s.attributes.KEYFORMAT,keyId:s.attributes.KEYID.substring(2)},pssh:V(s.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"})):(s.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:s.attributes.METHOD||"AES-128",uri:s.attributes.URI},void(void 0!==s.attributes.IV&&(a.iv=s.attributes.IV)));this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:s.attributes.URI}}else this.trigger("warn",{message:"ignoring key declaration without URI"});else a=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(s.number)?this.manifest.mediaSequence=s.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+s.number})},"discontinuity-sequence"(){isFinite(s.number)?(this.manifest.discontinuitySequence=s.number,u=s.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+s.number})},"playlist-type"(){/VOD|EVENT/.test(s.playlistType)?this.manifest.playlistType=s.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+s.playlist})},map(){n={},s.uri&&(n.uri=s.uri),s.byterange&&(n.byterange=s.byterange),a&&(n.key=a)},"stream-inf"(){this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||h,s.attributes?(o.attributes||(o.attributes={}),F(o.attributes,s.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){var e;this.manifest.mediaGroups=this.manifest.mediaGroups||h,s.attributes&&s.attributes.TYPE&&s.attributes["GROUP-ID"]&&s.attributes.NAME?((e=this.manifest.mediaGroups[s.attributes.TYPE])[s.attributes["GROUP-ID"]]=e[s.attributes["GROUP-ID"]]||{},t=e[s.attributes["GROUP-ID"]],(i={default:/yes/i.test(s.attributes.DEFAULT)}).default?i.autoselect=!0:i.autoselect=/yes/i.test(s.attributes.AUTOSELECT),s.attributes.LANGUAGE&&(i.language=s.attributes.LANGUAGE),s.attributes.URI&&(i.uri=s.attributes.URI),s.attributes["INSTREAM-ID"]&&(i.instreamId=s.attributes["INSTREAM-ID"]),s.attributes.CHARACTERISTICS&&(i.characteristics=s.attributes.CHARACTERISTICS),s.attributes.FORCED&&(i.forced=/yes/i.test(s.attributes.FORCED)),t[s.attributes.NAME]=i):this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity(){u+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=s.dateTimeString,this.manifest.dateTimeObject=s.dateTimeObject),o.dateTimeString=s.dateTimeString,o.dateTimeObject=s.dateTimeObject},targetduration(){!isFinite(s.duration)||s.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+s.duration}):(this.manifest.targetDuration=s.duration,$.call(this,this.manifest))},start(){s.attributes&&!isNaN(s.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:s.attributes["TIME-OFFSET"],precise:s.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out"(){o.cueOut=s.data},"cue-out-cont"(){o.cueOutCont=s.data},"cue-in"(){o.cueIn=s.data},skip(){this.manifest.skip=Y(s.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",s.attributes,["SKIPPED-SEGMENTS"])},part(){l=!0;var e=this.manifest.segments.length,t=Y(s.attributes),t=(o.parts=o.parts||[],o.parts.push(t),t.byterange&&(t.byterange.hasOwnProperty("offset")||(t.byterange.offset=d),d=t.byterange.offset+t.byterange.length),o.parts.length-1);this.warnOnMissingAttributes_(`#EXT-X-PART #${t} for segment #`+e,s.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((e,t)=>{e.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${t} lacks required attribute(s): LAST-PART`})})},"server-control"(){var e=this.manifest.serverControl=Y(s.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),$.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){var t=this.manifest.segments.length,i=Y(s.attributes),e=i.type&&"PART"===i.type,r=(o.preloadHints=o.preloadHints||[],o.preloadHints.push(i),!i.byterange||i.byterange.hasOwnProperty("offset")||(i.byterange.offset=e?d:0,e&&(d=i.byterange.offset+i.byterange.length)),o.preloadHints.length-1);if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${r} for segment #`+t,s.attributes,["TYPE","URI"]),i.type)for(let e=0;e<o.preloadHints.length-1;e++){var n=o.preloadHints[e];n.type&&n.type===i.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${r} for segment #${t} has the same TYPE ${i.type} as preload hint #`+e})}},"rendition-report"(){var e=Y(s.attributes),e=(this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e),this.manifest.renditionReports.length-1),t=["LAST-MSN","URI"];l&&t.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+e,s.attributes,t)},"part-inf"(){this.manifest.partInf=Y(s.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",s.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),$.call(this,this.manifest)}}[s.tagType]||function(){}).call(e)},uri(){o.uri=s.uri,r.push(o),!this.manifest.targetDuration||"duration"in o||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),a&&(o.key=a),o.timeline=u,n&&(o.map=n),d=0,o={}},comment(){},custom(){s.segment?(o.custom=o.custom||{},o.custom[s.customType]=s.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[s.customType]=s.data)}})[s.type].call(e)})}warnOnMissingAttributes_(e,t,i){const r=[];i.forEach(function(e){t.hasOwnProperty(e)||r.push(e)}),r.length&&this.trigger("warn",{message:e+" lacks required attribute(s): "+r.join(", ")})}push(e){this.lineStream.push(e)}end(){this.lineStream.push("\n"),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}function J(e){var e=(e=void 0===e?"":e).split(","),s=[];return e.forEach(function(r){var n;r=r.trim(),se.forEach(function(e){var t,i=ne[e].exec(r.toLowerCase());!i||i.length<=1||(n=e,i=r.substring(0,i[1].length),t=r.replace(i,""),s.push({type:i,details:t,mediaType:e}))}),n||s.push({type:r,details:"",mediaType:"unknown"})}),s}function Z(e){var t,i,r;if(e&&"string"==typeof e)return i="video",1===(t=e.toLowerCase().split(",").map(function(e){return oe(e.trim())})).length&&le(t[0])?i="audio":1===t.length&&(void 0===(r=t[0])&&(r=""),ne.text.test(r.trim().toLowerCase()))&&(i="application"),r="mp4",t.every(function(e){return ne.mp4.test(e)})?r="mp4":t.every(function(e){return ne.webm.test(e)})?r="webm":t.every(function(e){return ne.ogg.test(e)})&&(r="ogg"),i+"/"+r+';codecs="'+e+'"'}function Q(e){return void 0===e&&(e=""),v().MediaSource&&v().MediaSource.isTypeSupported&&v().MediaSource.isTypeSupported(Z(e))||!1}function ee(e){return(e=void 0===e?"":e).toLowerCase().split(",").every(function(e){e=e.trim();for(var t=0;t<ae.length;t++)if(ne["muxer"+ae[t]].test(e))return!0;return!1})}function te(e){return he.test(e)?"hls":ue.test(e)?"dash":"application/vnd.videojs.vhs+json"===e?"vhs-json":null}function ie(e){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer}function re(e,t){if("string"!=typeof(e="string"!=typeof e&&e&&"function"==typeof e.toString?e.toString():e))return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}var ne={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},se=["video","audio","text"],ae=["Video","Audio","Text"],oe=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,i){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(i).toString(16)).slice(-2)})},le=function(e){return ne.audio.test((e=void 0===e?"":e).trim().toLowerCase())},he=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,ue=/^application\/dash\+xml/i,m=function(e){return e instanceof Uint8Array?e:(Array.isArray(e)||ie(e)||e instanceof ArrayBuffer||(e="number"!=typeof e||"number"==typeof e&&e!=e?0:[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},o=v().BigInt||Number,ce=[o("0x1"),o("0x100"),o("0x10000"),o("0x1000000"),o("0x100000000"),o("0x10000000000"),o("0x1000000000000"),o("0x100000000000000"),o("0x10000000000000000")],de=(e=new Uint16Array([65484]),255!==(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength))[0]&&e[0],function(r,e){var e=void 0===e?{}:e,t=e.signed,t=void 0!==t&&t,e=e.le,n=void 0!==e&&e,e=(r=m(r),n?"reduce":"reduceRight"),e=(r[e]||Array.prototype[e]).call(r,function(e,t,i){i=n?i:Math.abs(i+1-r.length);return e+o(t)*ce[i]},o(0));return t&&(t=ce[r.length]/o(2)-o(1),(e=o(e))>t)&&(e=(e=e-t-t)-o(2)),Number(e)}),g=function(i,e,t){var t=void 0===t?{}:t,r=t.offset,n=void 0===r?0:r,r=t.mask,s=void 0===r?[]:r,t=(i=m(i),((e=m(e)).every?e:Array.prototype).every);return e.length&&i.length-n>=e.length&&t.call(e,function(e,t){return e===(s[t]?s[t]&i[n+t]:i[n+t])})},pe="http://example.com";const fe=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=v().location&&v().location.href||"");var i="function"==typeof v().URL,r=/^\/\//.test(e),n=!v().location&&!/\/\//i.test(e);return i?e=new(v().URL)(e,v().location||pe):/\/\//i.test(e)||(e=B().buildAbsoluteURL(v().location&&v().location.href||"",e)),i?(i=new URL(t,e),n?i.href.slice(18):r?i.href.slice(i.protocol.length):i.href):B().buildAbsoluteURL(e,t)};var me=oi(8903);const ge=e=>!!e&&"object"==typeof e,c=(...e)=>e.reduce((t,i)=>("object"==typeof i&&Object.keys(i).forEach(e=>{Array.isArray(t[e])&&Array.isArray(i[e])?t[e]=t[e].concat(i[e]):ge(t[e])&&ge(i[e])?t[e]=c(t[e],i[e]):t[e]=i[e]}),t),{}),ve=t=>Object.keys(t).map(e=>t[e]),ye=e=>e.reduce((e,t)=>e.concat(t),[]),_e=t=>{if(!t.length)return[];var i=[];for(let e=0;e<t.length;e++)i.push(t[e]);return i},be=({baseUrl:r="",source:n="",range:s="",indexRange:a=""})=>{n={uri:n,resolvedUri:fe(r||"",n)};if(s||a){const r=(s||a).split("-");let e,t=v().BigInt?v().BigInt(r[0]):parseInt(r[0],10),i=v().BigInt?v().BigInt(r[1]):parseInt(r[1],10);t<Number.MAX_SAFE_INTEGER&&"bigint"==typeof t&&(t=Number(t)),i<Number.MAX_SAFE_INTEGER&&"bigint"==typeof i&&(i=Number(i)),"bigint"==typeof(e="bigint"==typeof i||"bigint"==typeof t?v().BigInt(i)-v().BigInt(t)+v().BigInt(1):i-t+1)&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),n.byterange={length:e,offset:t}}return n},Te=e=>(e&&"number"!=typeof e&&(e=parseInt(e,10)),isNaN(e)?null:e),xe={static(e){var{duration:t,timescale:i=1,sourceDuration:r,periodDuration:n}=e,e=Te(e.endNumber),t=t/i;return"number"==typeof e?{start:0,end:e}:"number"==typeof n?{start:0,end:n/t}:{start:0,end:r/t}},dynamic(e){var{NOW:t,clientOffset:i,availabilityStartTime:r,timescale:n=1,duration:s,periodStart:a=0,minimumUpdatePeriod:o=0,timeShiftBufferDepth:l=1/0}=e,e=Te(e.endNumber),t=(t+i)/1e3,i=r+a,r=Math.ceil((t+o-i)*n/s),a=Math.floor((t-i-l)*n/s),o=Math.floor((t-i)*n/s);return{start:Math.max(0,a),end:"number"==typeof e?e:Math.min(r,o)}}},we=e=>{const{type:t,duration:i,timescale:r=1,periodDuration:n,sourceDuration:s}=e,{start:a,end:o}=xe[t](e),l=((t,i)=>{var r=[];for(let e=t;e<i;e++)r.push(e);return r})(a,o).map((h=e,e=>{var{duration:t,timescale:i=1,periodStart:r,startNumber:n=1}=h;return{number:n+e,duration:t/i,timeline:r,time:e*t}}));var h;if("static"===t){const e=l.length-1,t="number"==typeof n?n:s;l[e].duration=t-i/r*e}return l},Se=e=>{const{baseUrl:t,initialization:i={},sourceDuration:r,indexRange:n="",periodStart:s,presentationTime:a,number:o=0,duration:l}=e;if(!t)throw new Error("NO_BASE_URL");var h=be({baseUrl:t,source:i.sourceURL,range:i.range}),u=be({baseUrl:t,source:t,indexRange:n});if(u.map=h,l){const t=we(e);t.length&&(u.duration=t[0].duration,u.timeline=t[0].timeline)}else r&&(u.duration=r,u.timeline=s);return u.presentationTime=a||s,u.number=o,[u]},Ee=(e,t,i)=>{const r=e.sidx.map||null,n=e.sidx.duration,s=e.timeline||0,a=e.sidx.byterange,o=a.offset+a.length,l=t.timescale,h=t.references.filter(e=>1!==e.referenceType),u=[],c=e.endList?"static":"dynamic",d=e.sidx.timeline;let p,f=d,m=e.mediaSequence||0;p="bigint"==typeof t.firstOffset?v().BigInt(o)+t.firstOffset:o+t.firstOffset;for(let e=0;e<h.length;e++){const a=t.references[e],o=a.referencedSize,h=a.subsegmentDuration;var g="bigint"==typeof p?p+v().BigInt(o)-v().BigInt(1):p+o-1,g=Se({baseUrl:i,timescale:l,timeline:s,periodStart:d,presentationTime:f,number:m,duration:h,sourceDuration:n,indexRange:p+"-"+g,type:c})[0];r&&(g.map=r),u.push(g),p+="bigint"==typeof p?v().BigInt(o):o,f+=h/l,m++}return e.segments=u,e},Me=["AUDIO","SUBTITLES"],Ce=e=>{return e=e,i=({timeline:e})=>e,ve(e.reduce((t,e)=>(e.forEach(e=>{t[i(e)]=e}),t),{})).sort((e,t)=>e.timeline>t.timeline?1:-1);var i},Ae=e=>{let n=[];var r=e,s=(e,t,i,r)=>{n=n.concat(e.playlists||[])};return Me.forEach(function(e){for(var t in r.mediaGroups[e])for(var i in r.mediaGroups[e][t]){i=r.mediaGroups[e][t][i];s(i)}}),n},Le=({playlist:i,mediaSequence:e})=>{i.mediaSequence=e,i.segments.forEach((e,t)=>{e.number=i.mediaSequence+t})},Ie=e=>{return e&&e.uri+"-"+(e=e.byterange,t="bigint"==typeof e.offset||"bigint"==typeof e.length?v().BigInt(e.offset)+v().BigInt(e.length)-v().BigInt(1):e.offset+e.length-1,e.offset)+"-"+t;var t},Pe=e=>ve(e.reduce((e,t)=>{var i=t.attributes.id+(t.attributes.lang||"");return e[i]?(t.segments&&(t.segments[0]&&(t.segments[0].discontinuity=!0),e[i].segments.push(...t.segments)),t.attributes.contentProtection&&(e[i].attributes.contentProtection=t.attributes.contentProtection)):(e[i]=t,e[i].attributes.timelineStarts=[]),e[i].attributes.timelineStarts.push({start:t.attributes.periodStart,timeline:t.attributes.periodStart}),e},{})).map(e=>{return e.discontinuityStarts=(e.segments||[]).reduce((e,t,i)=>(t.discontinuity&&e.push(i),e),[]),e}),Re=(e,t)=>{var i=Ie(e.sidx),t=i&&t[i]&&t[i].sidx;return t&&Ee(e,t,e.sidx.resolvedUri),e},ke=({attributes:e,segments:t,sidx:i,discontinuityStarts:r})=>{r={attributes:{NAME:e.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:e.width,height:e.height},CODECS:e.codecs,BANDWIDTH:e.bandwidth,"PROGRAM-ID":1},uri:"",endList:"static"===e.type,timeline:e.periodStart,resolvedUri:"",targetDuration:e.duration,discontinuityStarts:r,timelineStarts:e.timelineStarts,segments:t};return e.frameRate&&(r.attributes["FRAME-RATE"]=e.frameRate),e.contentProtection&&(r.contentProtection=e.contentProtection),i&&(r.sidx=i),r},De=({attributes:e})=>"video/mp4"===e.mimeType||"video/webm"===e.mimeType||"video"===e.contentType,Oe=({attributes:e})=>"audio/mp4"===e.mimeType||"audio/webm"===e.mimeType||"audio"===e.contentType,Ne=({attributes:e})=>"text/vtt"===e.mimeType||"text"===e.contentType,Ue=i=>i?Object.keys(i).reduce((e,t)=>{t=i[t];return e.concat(t.playlists)},[]):[],Be=({dashPlaylists:e,locations:t,sidxMapping:i={},previousManifest:r})=>{var n,s,a,o,l,h,u,c,d,p,f;return e.length?({sourceDuration:n,type:s,suggestedPresentationDelay:a,minimumUpdatePeriod:u}=e[0].attributes,f=Pe(e.filter(De)).map(ke),o=Pe(e.filter(Oe)),p=Pe(e.filter(Ne)),e=e.map(e=>e.attributes.captionServices).filter(Boolean),n={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:n,playlists:((e,t={})=>{if(Object.keys(t).length)for(const i in e)e[i]=Re(e[i],t);return e})(f,i)},0<=u&&(n.minimumUpdatePeriod=1e3*u),t&&(n.locations=t),"dynamic"===s&&(n.suggestedPresentationDelay=a),u=0===n.playlists.length,t=o.length?((e,s={},a)=>{let o;e=e.reduce((e,t)=>{var i=t.attributes.role&&t.attributes.role.value||"",r=t.attributes.lang||"";let n=t.attributes.label||"main";if(r&&!t.attributes.label){const e=i?` (${i})`:"";n=""+t.attributes.lang+e}e[n]||(e[n]={language:r,autoselect:!0,default:"main"===i,playlists:[],uri:""});r=Re((({attributes:e,segments:t,sidx:i,mediaSequence:r,discontinuitySequence:n,discontinuityStarts:s},a)=>{n={attributes:{NAME:e.id,BANDWIDTH:e.bandwidth,CODECS:e.codecs,"PROGRAM-ID":1},uri:"",endList:"static"===e.type,timeline:e.periodStart,resolvedUri:"",targetDuration:e.duration,discontinuitySequence:n,discontinuityStarts:s,timelineStarts:e.timelineStarts,mediaSequence:r,segments:t};return e.contentProtection&&(n.contentProtection=e.contentProtection),i&&(n.sidx=i),a&&(n.attributes.AUDIO="audio",n.attributes.SUBTITLES="subs"),n})(t,a),s);return e[n].playlists.push(r),void 0===o&&"main"===i&&((o=t).default=!0),e},{});return o||(e[Object.keys(e)[0]].default=!0),e})(o,i,u):null,s=p.length?([l={}]=[i],p.reduce((e,t)=>{var i,r,n,s,a=t.attributes.lang||"text";return e[a]||(e[a]={language:a,default:!1,autoselect:!1,playlists:[],uri:""}),e[a].playlists.push(Re(({attributes:a,segments:t,mediaSequence:i,discontinuityStarts:r,discontinuitySequence:n}=[t][0],void 0===t&&(t=[{uri:a.baseUrl,timeline:a.periodStart,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}],a.duration=a.sourceDuration),s={NAME:a.id,BANDWIDTH:a.bandwidth,"PROGRAM-ID":1},a.codecs&&(s.CODECS=a.codecs),{attributes:s,uri:"",endList:"static"===a.type,timeline:a.periodStart,resolvedUri:a.baseUrl||"",targetDuration:a.duration,timelineStarts:a.timelineStarts,discontinuityStarts:r,discontinuitySequence:n,mediaSequence:i,segments:t}),l)),e},{})):null,o=(a=f.concat(Ue(t),Ue(s))).map(({timelineStarts:e})=>e),n.timelineStarts=Ce(o),h=n.timelineStarts,a.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=h.findIndex(function({timeline:e}){return e===t.timeline}),t.segments&&t.segments.forEach((e,t)=>{e.number=t})}),t&&(n.mediaGroups.AUDIO.audio=t),s&&(n.mediaGroups.SUBTITLES.subs=s),e.length&&(n.mediaGroups["CLOSED-CAPTIONS"].cc=e.reduce((r,e)=>(e&&e.forEach(e=>{var{channel:t,language:i}=e;r[i]={autoselect:!1,default:!1,instreamId:t,language:i},e.hasOwnProperty("aspectRatio")&&(r[i].aspectRatio=e.aspectRatio),e.hasOwnProperty("easyReader")&&(r[i].easyReader=e.easyReader),e.hasOwnProperty("3D")&&(r[i]["3D"]=e["3D"])}),r),{})),r?({oldManifest:u,newManifest:i}=[{oldManifest:r,newManifest:n}][0],p=u.playlists.concat(Ae(u)),f=i.playlists.concat(Ae(i)),i.timelineStarts=Ce([u.timelineStarts,i.timelineStarts]),{oldPlaylists:c,newPlaylists:u,timelineStarts:d}={oldPlaylists:p,newPlaylists:f,timelineStarts:i.timelineStarts},u.forEach(t=>{t.discontinuitySequence=d.findIndex(function({timeline:e}){return e===t.timeline});var e=((t,i)=>{for(let e=0;e<t.length;e++)if(t[e].attributes.NAME===i)return t[e];return null})(c,t.attributes.NAME);if(e&&!t.sidx){const i=t.segments[0],r=e.segments.findIndex(function(e){return Math.abs(e.presentationTime-i.presentationTime)<.016666666666666666});-1===r?(Le({playlist:t,mediaSequence:e.mediaSequence+e.segments.length}),t.segments[0].discontinuity=!0,t.discontinuityStarts.unshift(0),(!e.segments.length&&t.timeline>e.timeline||e.segments.length&&t.timeline>e.segments[e.segments.length-1].timeline)&&t.discontinuitySequence--):(e.segments[r].discontinuity&&!i.discontinuity&&(i.discontinuity=!0,t.discontinuityStarts.unshift(0),t.discontinuitySequence--),Le({playlist:t,mediaSequence:e.segments[r].number}))}}),i):n):{}},Fe=(r,n)=>{const{type:s,minimumUpdatePeriod:a=0,media:o="",sourceDuration:l,timescale:h=1,startNumber:u=1,periodStart:c}=r,d=[];let p=-1;for(let i=0;i<n.length;i++){var f=n[i],m=f.d,g=f.r||0,f=f.t||0;let e;if(p<0&&(p=f),f&&f>p&&(p=f),g<0){const u=i+1;e=u===n.length?"dynamic"===s&&0<a&&0<o.indexOf("$Number$")?((e,t,i)=>{var{NOW:e,clientOffset:r,availabilityStartTime:n,timescale:s=1,periodStart:a=0,minimumUpdatePeriod:o=0}=e;return Math.ceil((((e+r)/1e3+o-(n+a))*s-t)/i)})(r,p,m):(l*h-p)/m:(n[u].t-p)/m}else e=g+1;var v=u+d.length+e;let t=u+d.length;for(;t<v;)d.push({number:t,duration:m/h,time:p,timeline:c}),p+=m,t++}return d},He=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,ze=(e,t)=>{return e.replace(He,(n=t,(e,t,i,r)=>{return"$$"===e?"$":void 0===n[t]?e:(e=""+n[t],"RepresentationID"===t||(r=i?parseInt(r,10):1)<=e.length?e:new Array(r-e.length+1).join("0")+e)}));var n},Ve=(n,e)=>{const s={RepresentationID:n.id,Bandwidth:n.bandwidth||0},{initialization:t={sourceURL:"",range:""}}=n,a=be({baseUrl:n.baseUrl,source:ze(t.sourceURL,s),range:t.range}),i=(e=e,(r=n).duration||e?r.duration?we(r):Fe(r,e):[{number:r.startNumber||1,duration:r.sourceDuration,time:0,timeline:r.periodStart}]);var r;return i.map(e=>{s.Number=e.number,s.Time=e.time;var t=ze(n.media||"",s),i=n.timescale||1,r=n.presentationTimeOffset||0,r=n.periodStart+(e.time-r)/i;return{uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:fe(n.baseUrl||"",t),map:a,number:e.number,presentationTime:r}})},Ge=(n,e)=>{const{duration:t,segmentUrls:i=[],periodStart:s}=n;if(!t&&!e||t&&e)throw new Error("SEGMENT_TIME_UNSPECIFIED");const a=i.map(e=>{var{baseUrl:t,initialization:i={}}=n,i=be({baseUrl:t,source:i.sourceURL,range:i.range});return(t=be({baseUrl:t,source:e.media,range:e.mediaRange})).map=i,t});let r;return t&&(r=we(n)),(r=e?Fe(n,e):r).map((e,t)=>{var i,r;if(a[t])return t=a[t],i=n.timescale||1,r=n.presentationTimeOffset||0,t.timeline=e.timeline,t.duration=e.duration,t.number=e.number,t.presentationTime=s+(e.time-r)/i,t}).filter(e=>e)},We=({attributes:e,segmentInfo:t})=>{let i,r;t.template?(r=Ve,i=c(e,t.template)):t.base?(r=Se,i=c(e,t.base)):t.list&&(r=Ge,i=c(e,t.list));e={attributes:e};if(r){var n=r(i,t.segmentTimeline);if(i.duration){const{duration:e,timescale:t=1}=i;i.duration=e/t}else n.length?i.duration=n.reduce((e,t)=>Math.max(e,Math.ceil(t.duration)),0):i.duration=0;e.attributes=i,e.segments=n,t.base&&i.indexRange&&(e.sidx=n[0],e.segments=[])}return e},d=(e,t)=>_e(e.childNodes).filter(({tagName:e})=>e===t),je=e=>e.textContent.trim(),qe=e=>{var t,i,r,n,s,e=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);return e?([e,t,i,r,n,s]=e.slice(1),31536e3*parseFloat(e||0)+2592e3*parseFloat(t||0)+86400*parseFloat(i||0)+3600*parseFloat(r||0)+60*parseFloat(n||0)+parseFloat(s||0)):0},Xe={mediaPresentationDuration:e=>qe(e),availabilityStartTime(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e=e)&&(e+="Z"),Date.parse(e)/1e3},minimumUpdatePeriod:e=>qe(e),suggestedPresentationDelay:e=>qe(e),type:e=>e,timeShiftBufferDepth:e=>qe(e),start:e=>qe(e),width:e=>parseInt(e,10),height:e=>parseInt(e,10),bandwidth:e=>parseInt(e,10),frameRate:e=>parseFloat(e.split("/").reduce((e,t)=>e/t)),startNumber:e=>parseInt(e,10),timescale:e=>parseInt(e,10),presentationTimeOffset:e=>parseInt(e,10),duration(e){var t=parseInt(e,10);return isNaN(t)?qe(e):t},d:e=>parseInt(e,10),t:e=>parseInt(e,10),r:e=>parseInt(e,10),DEFAULT:e=>e},p=e=>e&&e.attributes?_e(e.attributes).reduce((e,t)=>{var i=Xe[t.name]||Xe.DEFAULT;return e[t.name]=i(t.value),e},{}):{},Ye={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},$e=(e,i)=>i.length?ye(e.map(function(t){return i.map(function(e){return fe(t,je(e))})})):e,Ke=e=>{var t=d(e,"SegmentTemplate")[0],i=d(e,"SegmentList")[0],r=i&&d(i,"SegmentURL").map(e=>c({tag:"SegmentURL"},p(e))),e=d(e,"SegmentBase")[0],n=i||t,n=n&&d(n,"SegmentTimeline")[0],s=i||e||t,s=s&&d(s,"Initialization")[0],t=t&&p(t);t&&s?t.initialization=s&&p(s):t&&t.initialization&&(t.initialization={sourceURL:t.initialization});const a={template:t,segmentTimeline:n&&d(n,"S").map(e=>p(e)),list:i&&c(p(i),{segmentUrls:r,initialization:p(s)}),base:e&&c(p(e),{initialization:p(s)})};return Object.keys(a).forEach(e=>{a[e]||delete a[e]}),a},Je=(s,a)=>(e,t)=>{var l,h,u,i=$e(a,d(e.node,"BaseURL")),r=c(s,{periodStart:e.attributes.start}),n=("number"==typeof e.attributes.duration&&(r.periodDuration=e.attributes.duration),d(e.node,"AdaptationSet")),e=Ke(e.node);return ye(n.map((l=r,h=i,u=e,e=>{var t=p(e),i=$e(h,d(e,"BaseURL")),r=d(e,"Role")[0],r={role:p(r)};let n=c(l,t,r);t=d(e,"Accessibility")[0],t="urn:scte:dash:cc:cea-608:2015"===(r=p(t)).schemeIdUri?("string"!=typeof r.value?[]:r.value.split(";")).map(e=>{let t,i;return i=e,/^CC\d=/.test(e)?[t,i]=e.split("="):/^CC\d$/.test(e)&&(t=e),{channel:t,language:i}}):"urn:scte:dash:cc:cea-708:2015"===r.schemeIdUri?("string"!=typeof r.value?[]:r.value.split(";")).map(e=>{const i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};var t,r;return/=/.test(e)?([t,r=""]=e.split("="),i.channel=t,i.language=e,r.split(",").forEach(e=>{var[e,t]=e.split(":");"lang"===e?i.language=t:"er"===e?i.easyReader=Number(t):"war"===e?i.aspectRatio=Number(t):"3D"===e&&(i["3D"]=Number(t))})):i.language=e,i.channel&&(i.channel="SERVICE"+i.channel),i}):void 0,t&&(n=c(n,{captionServices:t})),r=d(e,"Label")[0];if(r&&r.childNodes.length){const l=r.childNodes[0].nodeValue.trim();n=c(n,{label:l})}var s,a,o,t=d(e,"ContentProtection").reduce((e,t)=>{var i=p(t),r=(i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase()),Ye[i.schemeIdUri]);if(r){e[r]={attributes:i};i=d(t,"cenc:pssh")[0];if(i){const t=je(i);e[r].pssh=t&&V(t)}}return e},{}),r=(Object.keys(t).length&&(n=c(n,{contentProtection:t})),Ke(e)),t=d(e,"Representation"),e=c(u,r);return ye(t.map((s=n,a=i,o=e,e=>{const t=d(e,"BaseURL"),i=$e(a,t),r=c(s,p(e)),n=Ke(e);return i.map(e=>({segmentInfo:c(o,n),attributes:c(r,{baseUrl:e})}))})))})))},Ze=e=>{if(""===e)throw new Error("DASH_EMPTY_MANIFEST");var t=new me.DOMParser;let i,r;try{i=t.parseFromString(e,"application/xml"),r=i&&"MPD"===i.documentElement.tagName?i.documentElement:null}catch(e){}if(!r||r&&0<r.getElementsByTagName("parsererror").length)throw new Error("DASH_INVALID_XML");return r};function Qe(e,t){return void 0===t&&(t=0),(e=m(e)).length-t<10||!g(e,at,{offset:t})?t:(t+=(void 0===(r=t)&&(r=0),n=(i=m(e))[r+5],i=i[r+6]<<21|i[r+7]<<14|i[r+8]<<7|i[r+9],(16&n)>>4?20+i:10+i),Qe(e,t));var i,r,n}function et(e){return"string"==typeof e?re(e):e}function tt(e){if("string"==typeof e)return e.match(/.{1,2}/g).map(tt);if("number"!=typeof e)return e;for(var t=e,e={}.le,i=void 0!==e&&e,r=(e=t=o(t="bigint"!=typeof t&&"number"!=typeof t||"number"==typeof t&&t!=t?0:t),Math.ceil(e.toString(2).length/8)),n=new Uint8Array(new ArrayBuffer(r)),s=0;s<r;s++){var a=i?s:Math.abs(s+1-n.length);n[a]=Number(t/ce[s]&o(255)),t<0&&(n[a]=Math.abs(~n[a]),n[a]-=0===s?1:2)}return n}function it(e,t,i){var r;return i>=t.length?t.length:(r=ut(t,i,!1),g(e.bytes,r.bytes)?i:it(e,t,i+(e=ut(t,i+r.length)).length+e.value+r.length))}function rt(e,t){i=t,t=Array.isArray(i)?i.map(tt):[tt(i)],e=m(e);var i,r=[];if(t.length)for(var n=0;n<e.length;){var s=ut(e,n,!1),a=ut(e,n+s.length),o=n+s.length+a.length,l=(127===a.value&&(a.value=it(s,e,o),a.value!==e.length)&&(a.value-=o),o+a.value>e.length?e.length:o+a.value),o=e.subarray(o,l);g(t[0],s.bytes)&&(1===t.length?r.push(o):r=r.concat(rt(o,t.slice(1)))),n+=s.length+a.length+o.length}return r}function nt(e,t,i,r){void 0===r&&(r=1/0),e=m(e),i=[].concat(i);for(var n,s=0,a=0;s<e.length&&(a<r||n);){var o=void 0;if(g(e.subarray(s),ct)?o=4:g(e.subarray(s),dt)&&(o=3),o){if(a++,n){var l=e.subarray(n,s);for(var h=[],u=1;u<l.length-2;)g(l.subarray(u,u+3),pt)&&(h.push(u+2),u++),u++;if(0===h.length)return l;for(var c=l.length-h.length,d=new Uint8Array(c),p=0,u=0;u<c;p++,u++)p===h[0]&&(p++,h.shift()),d[u]=l[p];return d;return}var f=void 0;"h264"===t?f=31&e[s+o]:"h265"===t&&(f=e[s+o]>>1&63),-1!==i.indexOf(f)&&(n=s+o),s+=o+("h264"===t?1:2)}else s++}return e.subarray(0,0)}var e=oi(3047),st=oi.n(e),at=m([73,68,51]),ot=(new Uint8Array([79,112,117,115,72,101,97,100]),function e(t,i,r){void 0===r&&(r=!1),n=i,i=Array.isArray(n)?n.map(et):[et(n)],t=m(t);var n,s=[];if(i.length)for(var a=0;a<t.length;){var o=(t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3])>>>0,l=t.subarray(a+4,a+8);if(0==o)break;o=a+o;if(o>t.length){if(r)break;o=t.length}var h=t.subarray(a+8,o);g(l,i[0])&&(1===i.length?s.push(h):s.push.apply(s,e(h,i.slice(1),r))),a=o}return s}),lt={EBML:m([26,69,223,163]),DocType:m([66,130]),Segment:m([24,83,128,103]),SegmentInfo:m([21,73,169,102]),Tracks:m([22,84,174,107]),Track:m([174]),TrackNumber:m([215]),DefaultDuration:m([35,227,131]),TrackEntry:m([174]),TrackType:m([131]),FlagDefault:m([136]),CodecID:m([134]),CodecPrivate:m([99,162]),VideoTrack:m([224]),AudioTrack:m([225]),Cluster:m([31,67,182,117]),Timestamp:m([231]),TimestampScale:m([42,215,177]),BlockGroup:m([160]),BlockDuration:m([155]),Block:m([161]),SimpleBlock:m([163])},ht=[128,64,32,16,8,4,2,1],ut=function(e,t,i,r){void 0===i&&(i=!0),void 0===r&&(r=!1);var n=function(e){for(var t=1,i=0;i<ht.length&&!(e&ht[i]);i++)t++;return t}(e[t]),s=e.subarray(t,t+n);return i&&((s=Array.prototype.slice.call(e,t,t+n))[0]^=ht[n-1]),{length:n,value:de(s,{signed:r}),bytes:s}},ct=m([0,0,0,1]),dt=m([0,0,1]),pt=m([0,0,3]),r={webm:m([119,101,98,109]),matroska:m([109,97,116,114,111,115,107,97]),flac:m([102,76,97,67]),ogg:m([79,103,103,83]),ac3:m([11,119]),riff:m([82,73,70,70]),avi:m([65,86,73]),wav:m([87,65,86,69]),"3gp":m([102,116,121,112,51,103]),mp4:m([102,116,121,112]),fmp4:m([115,116,121,112]),mov:m([102,116,121,112,113,116]),moov:m([109,111,111,118]),moof:m([109,111,111,102])},ft={aac:function(e){var t=Qe(e);return g(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=Qe(e);return g(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){e=rt(e,[lt.EBML,lt.DocType])[0];return g(e,r.webm)},mkv:function(e){e=rt(e,[lt.EBML,lt.DocType])[0];return g(e,r.matroska)},mp4:function(e){return!ft["3gp"](e)&&!ft.mov(e)&&(!(!g(e,r.mp4,{offset:4})&&!g(e,r.fmp4,{offset:4}))||!(!g(e,r.moof,{offset:4})&&!g(e,r.moov,{offset:4}))||void 0)},mov:function(e){return g(e,r.mov,{offset:4})},"3gp":function(e){return g(e,r["3gp"],{offset:4})},ac3:function(e){var t=Qe(e);return g(e,r.ac3,{offset:t})},ts:function(e){if(e.length<189&&1<=e.length)return 71===e[0];for(var t=0;t+188<e.length&&t<188;){if(71===e[t]&&71===e[t+188])return!0;t+=1}return!1},flac:function(e){var t=Qe(e);return g(e,r.flac,{offset:t})},ogg:function(e){return g(e,r.ogg)},avi:function(e){return g(e,r.riff)&&g(e,r.avi,{offset:8})},wav:function(e){return g(e,r.riff)&&g(e,r.wav,{offset:8})},h264:function(e){return nt(e,"h264",7,3).length},h265:function(e){return nt(e,"h265",[32,33],3).length}},mt=Object.keys(ft).filter(function(e){return"ts"!==e&&"h264"!==e&&"h265"!==e}).concat(["ts","h264","h265"]),gt=(mt.forEach(function(e){var t=ft[e];ft[e]=function(e){return t(m(e))}}),ft),vt=function(e){e=m(e);for(var t=0;t<mt.length;t++){var i=mt[t];if(gt[i](e))return i}return""},yt=oi(5531);function _t(e,t){return!((t=Tt(e).indexOf(t))<=-1||(bt[e]=bt[e].slice(),bt[e].splice(t,1),0))}const bt={},Tt=function(e,t){return bt[e]=bt[e]||[],t&&(bt[e]=bt[e].concat(t)),bt[e]},xt={prefixed:!0},wt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],St=wt[0];let Et;for(let e=0;e<wt.length;e++)if(wt[e][1]in a()){Et=wt[e];break}if(Et){for(let e=0;e<Et.length;e++)xt[St[e]]=Et[e];xt.prefixed=Et[0]!==St[0]}let l=[];function Mt(e){return Pt(e)?Object.keys(e):[]}const h=function t(i){let r,n="info";function s(...e){r("log",n,e)}return r=(e=i,(t,i,r)=>{var i=a.levels[i],n=new RegExp(`^(${i})$`);if("log"!==t&&r.unshift(t.toUpperCase()+":"),r.unshift(e+":"),l){l.push([].concat(r));const e=l.length-1e3;l.splice(0,0<e?e:0)}if(v().console){let e=v().console[t];(e=e||"debug"!==t?e:v().console.info||v().console.log)&&i&&n.test(t)&&e[Array.isArray(r)?"apply":"call"](v().console,r)}}),(a=s).createLogger=e=>t(i+": "+e),s.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:n},s.level=e=>{if("string"==typeof e){if(!s.levels.hasOwnProperty(e))throw new Error(`"${e}" in not a valid log level`);n=e}return n},(s.history=()=>l?[].concat(l):[]).filter=t=>(l||[]).filter(e=>new RegExp(`.*${t}.*`).test(e[0])),s.history.clear=()=>{l&&(l.length=0)},s.history.disable=()=>{null!==l&&(l.length=0,l=null)},s.history.enable=()=>{null===l&&(l=[])},s.error=(...e)=>r("error",n,e),s.warn=(...e)=>r("warn",n,e),s.debug=(...e)=>r("debug",n,e),s;var e,a}("VIDEOJS"),Ct=h.createLogger,At=Object.prototype.toString;function Lt(t,i){Mt(t).forEach(e=>i(t[e],e))}function It(i,r,e=0){return Mt(i).reduce((e,t)=>r(e,i[t],t),e)}function Pt(e){return!!e&&"object"==typeof e}function Rt(e){return Pt(e)&&"[object Object]"===At.call(e)&&e.constructor===Object}function u(...e){const i={};return e.forEach(e=>{e&&Lt(e,(e,t)=>{Rt(e)?(Rt(i[t])||(i[t]={}),i[t]=u(i[t],e)):i[t]=e})}),i}function kt(t,i,r,e=!0){const n=e=>Object.defineProperty(t,i,{value:e,enumerable:!0,writable:!0}),s={configurable:!0,enumerable:!0,get(){var e=r();return n(e),e}};return e&&(s.set=n),Object.defineProperty(t,i,s)}var Dt,e=Object.freeze({__proto__:null,each:Lt,reduce:It,isObject:Pt,isPlain:Rt,merge:u,defineLazyProperty:kt});let Ot,Nt=!1,Ut=null,Bt=!1,Ft=!1,Ht=!1,zt=!1,Vt=!1,Gt=null,Wt=null,jt=null,qt=!1,Xt=!1,Yt=!1,$t=!1;const Kt=Boolean(ti()&&("ontouchstart"in v()||v().navigator.maxTouchPoints||v().DocumentTouch&&v().document instanceof v().DocumentTouch)),Jt=v().navigator&&v().navigator.userAgentData;if(Jt&&(Bt="Android"===Jt.platform,Ht=Boolean(Jt.brands.find(e=>"Microsoft Edge"===e.brand)),zt=Boolean(Jt.brands.find(e=>"Chromium"===e.brand)),Vt=!Ht&&zt,Gt=Wt=(Jt.brands.find(e=>"Chromium"===e.brand)||{}).version||null,Xt="Windows"===Jt.platform),!zt){const i=v().navigator&&v().navigator.userAgent||"";Nt=/iPod/i.test(i),Ut=(Qt=i.match(/OS (\d+)_/i))&&Qt[1]?Qt[1]:null,Bt=/Android/i.test(i),Ot=(Qt=i.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i))?(Ji=Qt[1]&&parseFloat(Qt[1]),Dt=Qt[2]&&parseFloat(Qt[2]),Ji&&Dt?parseFloat(Qt[1]+"."+Qt[2]):Ji||null):null,Ft=/Firefox/i.test(i),Ht=/Edg/i.test(i),zt=/Chrome/i.test(i)||/CriOS/i.test(i),Vt=!Ht&&zt,Gt=Wt=(Dt=i.match(/(Chrome|CriOS)\/(\d+)/))&&Dt[2]?parseFloat(Dt[2]):null,jt=function(){var e=/MSIE\s(\d+)\.\d/.exec(i);let t=e&&parseFloat(e[1]);return t=!t&&/Trident\/7.0/i.test(i)&&/rv:11.0/.test(i)?11:t}(),qt=/Safari/i.test(i)&&!Vt&&!Bt&&!Ht,Xt=/Windows/i.test(i),Yt=/iPad/i.test(i)||qt&&Kt&&!/iPhone/i.test(i),$t=/iPhone/i.test(i)&&!Yt}const f=$t||Yt||Nt,Zt=(qt||f)&&!Vt;var Qt=Object.freeze({__proto__:null,get IS_IPOD(){return Nt},get IOS_VERSION(){return Ut},get IS_ANDROID(){return Bt},get ANDROID_VERSION(){return Ot},get IS_FIREFOX(){return Ft},get IS_EDGE(){return Ht},get IS_CHROMIUM(){return zt},get IS_CHROME(){return Vt},get CHROMIUM_VERSION(){return Gt},get CHROME_VERSION(){return Wt},get IE_VERSION(){return jt},get IS_SAFARI(){return qt},get IS_WINDOWS(){return Xt},get IS_IPAD(){return Yt},get IS_IPHONE(){return $t},TOUCH_ENABLED:Kt,IS_IOS:f,IS_ANY_SAFARI:Zt});function ei(e){return"string"==typeof e&&Boolean(e.trim())}function ti(){return a()===v().document}function ii(e){return Pt(e)&&1===e.nodeType}function ri(){try{return v().parent!==v().self}catch(e){return!0}}function ni(i){return function(e,t){return ei(e)?(t=ii(t=ei(t)?a().querySelector(t):t)?t:a())[i]&&t[i](e):a()[i](null)}}function y(e="div",i={},t={},r){const n=a().createElement(e);return Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];"textContent"===e?si(n,t):n[e]===t&&"tabIndex"!==e||(n[e]=t)}),Object.getOwnPropertyNames(t).forEach(function(e){n.setAttribute(e,t[e])}),r&&Ei(n,r),n}function si(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function ai(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function li(e,t){if(0<=t.indexOf(" "))throw new Error("class has illegal whitespace characters");return e.classList.contains(t)}function hi(e,...t){return e.classList.add(...t.reduce((e,t)=>e.concat(t.split(/\s+/)),[])),e}function ui(e,...t){return e?(e.classList.remove(...t.reduce((e,t)=>e.concat(t.split(/\s+/)),[])),e):(h.warn("removeClass was called with an element that doesn't exist"),null)}function ci(t,e,i){return"boolean"!=typeof(i="function"==typeof i?i(t,e):i)&&(i=void 0),e.split(/\s+/).forEach(e=>t.classList.toggle(e,i)),t}function di(i,r){Object.getOwnPropertyNames(r).forEach(function(e){var t=r[e];null==t||!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})}function pi(i){var r={};if(i&&i.attributes&&0<i.attributes.length){var n=i.attributes;for(let t=n.length-1;0<=t;t--){var s=n[t].name;let e=n[t].value;"boolean"!=typeof i[s]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+s+",")||(e=null!==e),r[s]=e}}return r}function fi(e,t){return e.getAttribute(t)}function mi(e,t,i){e.setAttribute(t,i)}function gi(e,t){e.removeAttribute(t)}function vi(){a().body.focus(),a().onselectstart=function(){return!1}}function yi(){a().onselectstart=function(){return!0}}function _i(e){if(e&&e.getBoundingClientRect&&e.parentNode){const t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(e=>{void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(Ii(e,"height"))),i.width||(i.width=parseFloat(Ii(e,"width"))),i}}function bi(e){if(!e||!e.offsetParent)return{left:0,top:0,width:0,height:0};var t=e.offsetWidth,i=e.offsetHeight;let r=0,n=0;for(;e.offsetParent&&e!==a()[xt.fullscreenElement];)r+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:r,top:n,width:t,height:i}}function Ti(t,i){var r={x:0,y:0};if(f){let e=t;for(;e&&"html"!==e.nodeName.toLowerCase();){const t=Ii(e,"transform");if(/^matrix/.test(t)){const i=t.slice(7,-1).split(/,\s/).map(Number);r.x+=i[4],r.y+=i[5]}else if(/^matrix3d/.test(t)){const i=t.slice(9,-1).split(/,\s/).map(Number);r.x+=i[12],r.y+=i[13]}e=e.parentNode}}var e={},n=bi(i.target),t=bi(t),s=t.width,a=t.height;let o=i.offsetY-(t.top-n.top),l=i.offsetX-(t.left-n.left);return i.changedTouches&&(l=i.changedTouches[0].pageX-t.left,o=i.changedTouches[0].pageY+t.top,f)&&(l-=r.x,o-=r.y),e.y=1-Math.max(0,Math.min(1,o/a)),e.x=Math.max(0,Math.min(1,l/s)),e}function xi(e){return Pt(e)&&3===e.nodeType}function wi(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function Si(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(e=>ii(e="function"==typeof e?e():e)||xi(e)?e:"string"==typeof e&&/\S/.test(e)?a().createTextNode(e):void 0).filter(e=>e)}function Ei(t,e){return Si(e).forEach(e=>t.appendChild(e)),t}function Mi(e,t){return Ei(wi(e),t)}function Ci(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||"mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons}const Ai=ni("querySelector"),Li=ni("querySelectorAll");function Ii(t,i){if(!t||!i)return"";if("function"!=typeof v().getComputedStyle)return"";{let e;try{e=v().getComputedStyle(t)}catch(t){return""}return e?e.getPropertyValue(i)||e[i]:""}}var Pi=Object.freeze({__proto__:null,isReal:ti,isEl:ii,isInFrame:ri,createEl:y,textContent:si,prependTo:ai,hasClass:li,addClass:hi,removeClass:ui,toggleClass:ci,setAttributes:di,getAttributes:pi,getAttribute:fi,setAttribute:mi,removeAttribute:gi,blockTextSelection:vi,unblockTextSelection:yi,getBoundingClientRect:_i,findPosition:bi,getPointerPosition:Ti,isTextNode:xi,emptyEl:wi,normalizeContent:Si,appendContent:Ei,insertContent:Mi,isSingleLeftClick:Ci,$:Ai,$$:Li,computedStyle:Ii});let Ri,ki=!1;function Di(){if(!1!==Ri.options.autoSetup){const e=Array.prototype.slice.call(a().getElementsByTagName("video")),i=Array.prototype.slice.call(a().getElementsByTagName("audio")),t=Array.prototype.slice.call(a().getElementsByTagName("video-js")),r=e.concat(i,t);if(r&&0<r.length)for(let e=0,t=r.length;e<t;e++){const i=r[e];if(!i||!i.getAttribute){Oi(1);break}void 0===i.player&&null!==i.getAttribute("data-setup")&&Ri(i)}else ki||Oi(1)}}function Oi(e,t){ti()&&(t&&(Ri=t),v().setTimeout(Di,e))}function Ni(){ki=!0,v().removeEventListener("load",Ni)}ti()&&("complete"===a().readyState?Ni():v().addEventListener("load",Ni));function Ui(e){var t=a().createElement("style");return t.className=e,t}function Bi(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}var _=new WeakMap;let Fi,Hi=3;function zi(e,t){var i;_.has(e)&&(0===(i=_.get(e)).handlers[t].length&&(delete i.handlers[t],e.removeEventListener?e.removeEventListener(t,i.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length)&&_.delete(e)}function Vi(t,i,e,r){e.forEach(function(e){t(i,e,r)})}function Gi(e){if(!e.fixed_){if(!e||!e.isPropagationStopped||!e.isImmediatePropagationStopped){const r=e||v().event;e={};for(const t in r)"layerX"===t||"layerY"===t||"keyLocation"===t||"webkitMovementX"===t||"webkitMovementY"===t||"path"===t||"returnValue"===t&&r.preventDefault||(e[t]=r[t]);if(e.target||(e.target=e.srcElement||a()),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=i,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=i,null!==e.clientX&&void 0!==e.clientX){const t=a().documentElement,i=a().body;e.pageX=e.clientX+(t&&t.scrollLeft||i&&i.scrollLeft||0)-(t&&t.clientLeft||i&&i.clientLeft||0),e.pageY=e.clientY+(t&&t.scrollTop||i&&i.scrollTop||0)-(t&&t.clientTop||i&&i.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}e.fixed_=!0}return e;function t(){return!0}function i(){return!1}}const Wi=["touchstart","touchmove"];function b(n,t,e){if(Array.isArray(t))return Vi(b,n,t,e);_.has(n)||_.set(n,{});const s=_.get(n);if(s.handlers||(s.handlers={}),s.handlers[t]||(s.handlers[t]=[]),e.guid||(e.guid=Hi++),s.handlers[t].push(e),s.dispatcher||(s.disabled=!1,s.dispatcher=function(i,r){if(!s.disabled){i=Gi(i);var e=s.handlers[i.type];if(e){const s=e.slice(0);for(let e=0,t=s.length;e<t&&!i.isImmediatePropagationStopped();e++)try{s[e].call(n,i,r)}catch(e){h.error(e)}}}}),1===s.handlers[t].length)if(n.addEventListener){let e=!1;(function(){if("boolean"!=typeof Fi){Fi=!1;try{var e=Object.defineProperty({},"passive",{get(){Fi=!0}});v().addEventListener("test",null,e),v().removeEventListener("test",null,e)}catch(e){}}return Fi})()&&-1<Wi.indexOf(t)&&(e={passive:!0}),n.addEventListener(t,s.dispatcher,e)}else n.attachEvent&&n.attachEvent("on"+t,s.dispatcher)}function T(e,t,i){if(_.has(e)){const s=_.get(e);if(s.handlers){if(Array.isArray(t))return Vi(T,e,t,i);var r=function(e,t){s.handlers[t]=[],zi(e,t)};if(void 0===t)for(const t in s.handlers)Object.prototype.hasOwnProperty.call(s.handlers||{},t)&&r(e,t);else{var n=s.handlers[t];if(n)if(i){if(i.guid)for(let e=0;e<n.length;e++)n[e].guid===i.guid&&n.splice(e--,1);zi(e,t)}else r(e,t)}}}}function ji(e,t,i){var r=_.has(e)?_.get(e):{},n=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=Gi(t),r.dispatcher&&r.dispatcher.call(e,t,i),n&&!t.isPropagationStopped()&&!0===t.bubbles)ji.call(null,n,t,i);else if(!n&&!t.defaultPrevented&&t.target&&t.target[t.type]){_.has(t.target)||_.set(t.target,{});const e=_.get(t.target);t.target[t.type]&&(e.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),e.disabled=!1)}return!t.defaultPrevented}function qi(e,t,i){if(Array.isArray(t))return Vi(qi,e,t,i);function r(){T(e,t,r),i.apply(this,arguments)}r.guid=i.guid=i.guid||Hi++,b(e,t,r)}function Xi(e,t,i){function r(){T(e,t,r),i.apply(this,arguments)}r.guid=i.guid=i.guid||Hi++,b(e,t,r)}var Yi=Object.freeze({__proto__:null,fixEvent:Gi,on:b,off:T,trigger:ji,one:qi,any:Xi});function x(e,t,i){return t.guid||(t.guid=Hi++),(e=t.bind(e)).guid=i?i+"_"+t.guid:t.guid,e}function $i(i,r){let n=v().performance.now();return function(...e){var t=v().performance.now();t-n>=r&&(i(...e),n=t)}}function Ki(r,n,s,a=v()){let o;function e(){const e=this,t=arguments;let i=function(){o=null,i=null,s||r.apply(e,t)};!o&&s&&r.apply(e,t),a.clearTimeout(o),o=a.setTimeout(i,n)}return e.cancel=()=>{a.clearTimeout(o),o=null},e}var Ji=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:30,bind_:x,throttle:$i,debounce:Ki});let Zi;class Qi{on(e,t){var i=this.addEventListener;this.addEventListener=()=>{},b(this,e,t),this.addEventListener=i}off(e,t){T(this,e,t)}one(e,t){var i=this.addEventListener;this.addEventListener=()=>{},qi(this,e,t),this.addEventListener=i}any(e,t){var i=this.addEventListener;this.addEventListener=()=>{},Xi(this,e,t),this.addEventListener=i}trigger(e){var t=e.type||e;e=Gi(e="string"==typeof e?{type:t}:e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),ji(this,e)}queueTrigger(e){Zi=Zi||new Map;const t=e.type||e;let i=Zi.get(this);i||(i=new Map,Zi.set(this,i));var r=i.get(t),r=(i.delete(t),v().clearTimeout(r),v().setTimeout(()=>{i.delete(t),0===i.size&&(i=null,Zi.delete(this)),this.trigger(e)},0));i.set(t,r)}}Qi.prototype.allowedEvents_={},Qi.prototype.addEventListener=Qi.prototype.on,Qi.prototype.removeEventListener=Qi.prototype.off,Qi.prototype.dispatchEvent=Qi.prototype.trigger;const er=e=>"function"==typeof e.name?e.name():"string"==typeof e.name?e.name:e.name_||(e.constructor&&e.constructor.name?e.constructor.name:typeof e),tr=t=>t instanceof Qi||!!t.eventBusEl_&&["on","one","off","trigger"].every(e=>"function"==typeof t[e]),ir=e=>"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length,rr=(e,t,i)=>{if(!e||!e.nodeName&&!tr(e))throw new Error(`Invalid target for ${er(t)}#${i}; must be a DOM node or evented object.`)},nr=(e,t,i)=>{if(!ir(e))throw new Error(`Invalid event type for ${er(t)}#${i}; must be a non-empty string or array.`)},sr=(e,t,i)=>{if("function"!=typeof e)throw new Error(`Invalid listener for ${er(t)}#${i}; must be a function.`)},ar=(e,t,i)=>{var r=t.length<3||t[0]===e||t[0]===e.eventBusEl_;let n,s,a;return r?(n=e.eventBusEl_,3<=t.length&&t.shift(),[s,a]=t):[n,s,a]=t,rr(n,e,i),nr(s,e,i),sr(a,e,i),a=x(e,a),{isTargetingSelf:r,target:n,type:s,listener:a}},or=(e,t,i,r)=>{rr(e,e,t),e.nodeName?Yi[t](e,i,r):e[t](i,r)},lr={on(...e){const{isTargetingSelf:t,target:i,type:r,listener:n}=ar(this,e,"on");if(or(i,"on",r,n),!t){const e=()=>this.off(i,r,n),t=(e.guid=n.guid,()=>this.off("dispose",e));t.guid=n.guid,or(this,"on","dispose",e),or(i,"on","dispose",t)}},one(...t){const{isTargetingSelf:e,target:i,type:r,listener:n}=ar(this,t,"one");if(e)or(i,"one",r,n);else{const t=(...e)=>{this.off(i,r,t),n.apply(null,e)};t.guid=n.guid,or(i,"one",r,t)}},any(...t){const{isTargetingSelf:e,target:i,type:r,listener:n}=ar(this,t,"any");if(e)or(i,"any",r,n);else{const t=(...e)=>{this.off(i,r,t),n.apply(null,e)};t.guid=n.guid,or(i,"any",r,t)}},off(e,t,i){!e||ir(e)?T(this.eventBusEl_,e,t):(e=e,t=t,rr(e,this,"off"),nr(t,this,"off"),sr(i,this,"off"),i=x(this,i),this.off("dispose",i),e.nodeName?(T(e,t,i),T(e,"dispose",i)):tr(e)&&(e.off(t,i),e.off("dispose",i)))},trigger(e,t){rr(this.eventBusEl_,this,"trigger");var i=e&&"string"!=typeof e?e.type:e;if(ir(i))return ji(this.eventBusEl_,e,t);throw new Error(`Invalid event type for ${er(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`)}};function hr(e,t={}){t=t.eventBusKey;if(t){if(!e[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);e.eventBusEl_=e[t]}else e.eventBusEl_=y("span",{className:"vjs-event-bus"});Object.assign(e,lr),e.eventedCallbacks&&e.eventedCallbacks.forEach(e=>{e()}),e.on("dispose",()=>{e.off(),[e,e.el_,e.eventBusEl_].forEach(function(e){e&&_.has(e)&&_.delete(e)}),v().setTimeout(()=>{e.eventBusEl_=null},0)})}const ur={state:{},setState(e){let i;return Lt(e="function"==typeof e?e():e,(e,t)=>{this.state[t]!==e&&((i=i||{})[t]={from:this.state[t],to:e}),this.state[t]=e}),i&&tr(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function cr(e,t){Object.assign(e,ur),e.state=Object.assign({},e.state,t),"function"==typeof e.handleStateChanged&&tr(e)&&e.on("statechanged",e.handleStateChanged)}function dr(e){return"string"!=typeof e?e:e.replace(/./,e=>e.toLowerCase())}function w(e){return"string"!=typeof e?e:e.replace(/./,e=>e.toUpperCase())}function pr(e,t){return w(e)===w(t)}var fr=Object.freeze({__proto__:null,toLowerCase:dr,toTitleCase:w,titleCaseEquals:pr});class S{constructor(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=u({},this.options_),t=this.options_=u(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const t=e&&e.id&&e.id()||"no_player";this.id_=t+"_component_"+Hi++}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(e=>this.addClass(e)),!1!==t.evented&&(hr(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),cr(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,(this.clearingTimersOnDispose_=!1)!==t.initChildren&&this.initChildren(),this.ready(i),!1!==t.reportTouchActivity&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e&&(this.options_=u(this.options_,e)),this.options_}el(){return this.el_}createEl(e,t,i){return y(e,t,i)}localize(e,r,t=e){var i=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),s=n&&n[i],i=i&&i.split("-")[0],n=n&&n[i];let a=t;return s&&s[e]?a=s[e]:n&&n[e]&&(a=n[e]),a=r?a.replace(/\{(\d+)\}/g,function(e,t){t=r[t-1];let i=void 0===t?e:t;return i}):a}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...t){t=t.reduce((e,t)=>e.concat(t),[]);let i=this;for(let e=0;e<t.length;e++)if(!(i=i.getChild(t[e]))||!i.getChild)return;return i}addChild(e,t={},i=this.children_.length){let r,n;if("string"==typeof e){n=w(e);const i=t.componentClass||n;t.name=n;var s=S.getComponent(i);if(!s)throw new Error(`Component ${i} does not exist`);if("function"!=typeof s)return null;r=new s(this.player_||this,t)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(i,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(n=n||r.name&&w(r.name()))&&(this.childNameIndex_[n]=r,this.childNameIndex_[dr(n)]=r),"function"==typeof r.el&&r.el()){let e=null;this.children_[i+1]&&(this.children_[i+1].el_?e=this.children_[i+1].el_:ii(this.children_[i+1])&&(e=this.children_[i+1])),this.contentEl().insertBefore(r.el(),e)}return r}removeChild(i){if((i="string"==typeof i?this.getChild(i):i)&&this.children_){let t=!1;for(let e=this.children_.length-1;0<=e;e--)if(this.children_[e]===i){t=!0,this.children_.splice(e,1);break}var e;t&&(i.parentComponent_=null,this.childIndex_[i.id()]=null,this.childNameIndex_[w(i.name())]=null,this.childNameIndex_[dr(i.name())]=null,e=i.el())&&e.parentNode===this.contentEl()&&this.contentEl().removeChild(i.el())}}initChildren(){const r=this.options_.children;if(r){const n=this.options_,t=e=>{var t=e.name;let i=e.opts;!1!==(i=void 0!==n[t]?n[t]:i)&&((i=!0===i?{}:i).playerOptions=this.options_.playerOptions,e=this.addChild(t,i))&&(this[t]=e)};let e;const i=S.getComponent("Tech");(e=Array.isArray(r)?r:Object.keys(r)).concat(Object.keys(this.options_).filter(function(t){return!e.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(e=>{let t,i;return i="string"==typeof e?(t=e,r[t]||this.options_[t]||{}):(t=e.name,e),{name:t,opts:i}}).filter(e=>{e=S.getComponent(e.opts.componentClass||w(e.name));return e&&!i.isTech(e)}).forEach(t)}}buildCSSClass(){return""}ready(e,t=!1){if(e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))}triggerReady(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)}$(e,t){return Ai(e,t||this.contentEl())}$$(e,t){return Li(e,t||this.contentEl())}hasClass(e){return li(this.el_,e)}addClass(...e){hi(this.el_,...e)}removeClass(...e){ui(this.el_,...e)}toggleClass(e,t){ci(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return fi(this.el_,e)}setAttribute(e,t){mi(this.el_,e,t)}removeAttribute(e){gi(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,i){var r,n;if(void 0===t)return this.el_?-1!==(n=(r=this.el_.style[e]).indexOf("px"))?parseInt(r.slice(0,n),10):parseInt(this.el_["offset"+w(e)],10):0;-1!==(""+(t=null!==t&&t==t?t:0)).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",i||this.trigger("componentresize")}currentDimension(e){let t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");return t=Ii(this.el_,e),0!==(t=parseFloat(t))&&!isNaN(t)||(e="offset"+w(e),t=this.el_[e]),t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(s().isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let i,t=0,r=null;this.on("touchstart",function(e){1===e.touches.length&&(r={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},t=v().performance.now(),i=!0)}),this.on("touchmove",function(e){var t;(1<e.touches.length||r&&(t=e.touches[0].pageX-r.pageX,e=e.touches[0].pageY-r.pageY,10<Math.sqrt(t*t+e*e)))&&(i=!1)});function e(){i=!1}this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){!(r=null)===i&&v().performance.now()-t<200&&(e.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){const i=x(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){i(),this.clearInterval(t),t=this.setInterval(i,250)});var e=function(e){i(),this.clearInterval(t)};this.on("touchmove",i),this.on("touchend",e),this.on("touchcancel",e)}}setTimeout(e,t){var i;return e=x(this,e),this.clearTimersOnDispose_(),i=v().setTimeout(()=>{this.setTimeoutIds_.has(i)&&this.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),v().clearTimeout(e)),e}setInterval(e,t){e=x(this,e),this.clearTimersOnDispose_();e=v().setInterval(e,t);return this.setIntervalIds_.add(e),e}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),v().clearInterval(e)),e}requestAnimationFrame(e){var t;return this.clearTimersOnDispose_(),e=x(this,e),t=v().requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){var i;if(!this.namedRafs_.has(e))return this.clearTimersOnDispose_(),t=x(this,t),i=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)}),this.namedRafs_.set(e,i),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),v().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((e,t)=>this[i](t))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(t,e){if("string"!=typeof t||!t)throw new Error(`Illegal component name, "${t}"; must be a non-empty string.`);var i=S.getComponent("Tech"),i=i&&i.isTech(e),r=S===e||S.prototype.isPrototypeOf(e.prototype);if(i||!r)throw new Error(`Illegal component, "${t}"; ${i?"techs must be registered using Tech.registerTech()":"must be a Component subclass"}.`);t=w(t),S.components_||(S.components_={});r=S.getComponent("Player");if("Player"===t&&r&&r.players){const t=r.players,e=Object.keys(t);if(t&&0<e.length&&e.map(e=>t[e]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return S.components_[t]=e,S.components_[dr(t)]=e}static getComponent(e){if(e&&S.components_)return S.components_[e]}}function mr(e,t,i,r){var n=i.length-1;if("number"!=typeof r||r<0||n<r)throw new Error(`Failed to execute '${e}' on 'TimeRanges': The index provided (${r}) is non-numeric or out of bounds (0-${n}).`);return i[r][t]}function gr(e){var t=void 0===e||0===e.length?{length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:mr.bind(null,"start",0,e),end:mr.bind(null,"end",1,e)};return v().Symbol&&v().Symbol.iterator&&(t[v().Symbol.iterator]=()=>(e||[]).values()),t}function vr(e,t){return Array.isArray(e)?gr(e):void 0===e||void 0===t?gr():gr([[e,t]])}S.registerComponent("Component",S);function yr(e,t){e=e<0?0:e;let i=Math.floor(e%60),r=Math.floor(e/60%60),n=Math.floor(e/3600);var s=Math.floor(t/60%60),t=Math.floor(t/3600);return n=0<(n=!isNaN(e)&&e!==1/0?n:r=i="-")||0<t?n+":":"",r=((n||10<=s)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,n+r+i}let _r=yr;function br(e){_r=e}function Tr(){_r=yr}function xr(e,t=e){return _r(e,t)}var wr=Object.freeze({__proto__:null,createTimeRanges:vr,createTimeRange:vr,setFormatTime:br,resetFormatTime:Tr,formatTime:xr});function Sr(t,i){let r,n,s=0;if(!i)return 0;t&&t.length||(t=vr(0,0));for(let e=0;e<t.length;e++)r=t.start(e),(n=t.end(e))>i&&(n=i),s+=n-r;return s/i}function n(e){if(e instanceof n)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:Pt(e)&&("number"==typeof e.code&&(this.code=e.code),Object.assign(this,e)),this.message||(this.message=n.defaultMessages[this.code]||"")}n.prototype.code=0,n.prototype.message="",n.prototype.status=null,n.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],n.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let e=0;e<n.errorTypes.length;e++)n[n.errorTypes[e]]=e,n.prototype[n.errorTypes[e]]=e;function Er(e){return null!=e&&"function"==typeof e.then}function Mr(e){Er(e)&&e.then(null,e=>{})}function Cr(r){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((e,t,i)=>(r[t]&&(e[t]=r[t]),e),{cues:r.cues&&Array.prototype.map.call(r.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})}const Ar="vjs-modal-dialog";class Lr extends S{constructor(e,t){super(e,t),this.handleKeyDown_=e=>this.handleKeyDown(e),this.close_=e=>this.close(e),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=y("div",{className:Ar+"-content"},{role:"document"}),this.descEl_=y("p",{className:Ar+"-description vjs-control-text",id:this.el().getAttribute("aria-describedby")}),si(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return Ar+" vjs-hidden "+super.buildCSSClass()}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){var e;this.opened_||(e=this.player(),this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0)}opened(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_}close(){var e;this.opened_&&(e=this.player(),this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary)&&this.dispose()}closeable(t){if("boolean"==typeof t){t=this.closeable_=!!t;let e=this.getChild("closeButton");if(t&&!e){const t=this.contentEl_;this.contentEl_=this.el_,e=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=t,this.on(e,"close",this.close_)}!t&&e&&(this.off(e,"close",this.close_),this.removeChild(e),e.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){var t=this.contentEl(),i=t.parentNode,r=t.nextSibling,e=(this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),Mi(t,e),this.trigger("modalfill"),r?i.insertBefore(t,r):i.appendChild(t),this.getChild("closeButton"));e&&i.appendChild(e.el_)}empty(){this.trigger("beforemodalempty"),wi(this.contentEl()),this.trigger("modalempty")}content(e){return void 0!==e&&(this.content_=e),this.content_}conditionalFocus_(){var e=a().activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,!t.contains(e)&&t!==e||(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),s().isEventKey(e,"Escape")&&this.closeable())e.preventDefault(),this.close();else if(s().isEventKey(e,"Tab")){var i=this.focusableEls_(),r=this.el_.querySelector(":focus");let t;for(let e=0;e<i.length;e++)if(r===i[e]){t=e;break}a().activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(i[i.length-1].focus(),e.preventDefault()):e.shiftKey||t!==i.length-1||(i[0].focus(),e.preventDefault())}}focusableEls_(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,e=>(e instanceof v().HTMLAnchorElement||e instanceof v().HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof v().HTMLInputElement||e instanceof v().HTMLSelectElement||e instanceof v().HTMLTextAreaElement||e instanceof v().HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof v().HTMLIFrameElement||e instanceof v().HTMLObjectElement||e instanceof v().HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable"))}}Lr.prototype.options_={pauseOnOpen:!0,temporary:!0},S.registerComponent("ModalDialog",Lr);class Ir extends Qi{constructor(t=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let e=0;e<t.length;e++)this.addTrack(t[e])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},tr(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(i){let r;for(let e=0,t=this.length;e<t;e++)if(this[e]===i){(r=this[e]).off&&r.off(),this.tracks_.splice(e,1);break}r&&this.trigger({track:r,type:"removetrack",target:this})}getTrackById(i){let r=null;for(let e=0,t=this.length;e<t;e++){var n=this[e];if(n.id===i){r=n;break}}return r}}for(const i in Ir.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"})Ir.prototype["on"+i]=null;function Pr(t,i){for(let e=0;e<t.length;e++)Object.keys(t[e]).length&&i.id!==t[e].id&&(t[e].enabled=!1)}function Rr(t,i){for(let e=0;e<t.length;e++)Object.keys(t[e]).length&&i.id!==t[e].id&&(t[e].selected=!1)}class kr extends Ir{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_)&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_)}}class Dr{constructor(e){Dr.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){var t=this.length||0;let i=0;function r(e){""+e in this||Object.defineProperty(this,""+e,{get(){return this.cues_[e]}})}var n=e.length;this.cues_=e,this.length_=e.length;if(t<n)for(i=t;i<n;i++)r.call(this,i)}getCueById(i){let r=null;for(let e=0,t=this.length;e<t;e++){var n=this[e];if(n.id===i){r=n;break}}return r}}const Or={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Nr={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Ur={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Br={disabled:"disabled",hidden:"hidden",showing:"showing"};class Fr extends Qi{constructor(e={}){super();const t={id:e.id||"vjs_track_"+Hi++,kind:e.kind||"",language:e.language||""};let i=e.label||"";for(const e in t)Object.defineProperty(this,e,{get:()=>t[e],set(){}});Object.defineProperty(this,"label",{get:()=>i,set(e){e!==i&&(i=e,this.trigger("labelchange"))}})}}function Hr(e){var t=["protocol","hostname","port","pathname","search","hash","host"],i=a().createElement("a"),r=(i.href=e,{});for(let e=0;e<t.length;e++)r[t[e]]=i[t[e]];return"http:"===r.protocol&&(r.host=r.host.replace(/:80$/,"")),"https:"===r.protocol&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=v().location.protocol),r.host||(r.host=v().location.host),r}function zr(e){var t;return e.match(/^https?:\/\//)||((t=a().createElement("a")).href=e,e=t.href),e}function Vr(e){if("string"==typeof e){e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(e)return e.pop().toLowerCase()}return""}function Gr(e,t=v().location){return(":"===(e=Hr(e)).protocol?t:e).protocol+e.host!==t.protocol+t.host}var Wr=Object.freeze({__proto__:null,parseUrl:Hr,getAbsoluteURL:zr,getFileExtension:Vr,isCrossOrigin:Gr});function jr(e,t){const i=new(v().WebVTT.Parser)(v(),v().vttjs,v().WebVTT.StringDecoder()),r=[];i.oncue=function(e){t.addCue(e)},i.onparsingerror=function(e){r.push(e)},i.onflush=function(){t.trigger({type:"loadeddata",target:t})},i.parse(e),0<r.length&&(v().console&&v().console.groupCollapsed&&v().console.groupCollapsed("Text Track parsing errors for "+t.src),r.forEach(e=>h.error(e)),v().console)&&v().console.groupEnd&&v().console.groupEnd(),i.flush()}function qr(e,r){var t={uri:e};(e=Gr(e))&&(t.cors=e),(e="use-credentials"===r.tech_.crossOrigin())&&(t.withCredentials=e),N()(t,x(this,function(e,t,i){if(e)return h.error(e,t);r.loaded_=!0,"function"!=typeof v().WebVTT?r.tech_&&r.tech_.any(["vttjsloaded","vttjserror"],e=>{if("vttjserror"!==e.type)return jr(i,r);h.error("vttjs failed to load, stopping trying to process "+r.src)}):jr(i,r)}))}class Xr extends Fr{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");e=u(e,{kind:Ur[e.kind]||"subtitles",language:e.language||e.srclang||""});let t=Br[e.mode]||"disabled";const i=e.default,r=("metadata"!==e.kind&&"chapters"!==e.kind||(t="hidden"),super(e),this.tech_=e.tech,this.cues_=[],this.activeCues_=[],this.preload_=!1!==this.tech_.preloadTextTracks,new Dr(this.cues_)),s=new Dr(this.activeCues_);let a=!1;this.timeupdateHandler=x(this,function(e={}){this.tech_.isDisposed()||(this.tech_.isReady_&&(this.activeCues=this.activeCues,a)&&(this.trigger("cuechange"),a=!1),"timeupdate"!==e.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))}),this.tech_.one("dispose",()=>{this.stopTracking()}),"disabled"!==t&&this.startTracking(),Object.defineProperties(this,{default:{get:()=>i,set(){}},mode:{get:()=>t,set(e){Br[e]&&t!==e&&(t=e,this.preload_||"disabled"===t||0!==this.cues.length||qr(this.src,this),this.stopTracking(),"disabled"!==t&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?r:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(0!==this.cues.length){var i=this.tech_.currentTime(),r=[];for(let e=0,t=this.cues.length;e<t;e++){var n=this.cues[e];n.startTime<=i&&n.endTime>=i&&r.push(n)}if(a=!1,r.length!==this.activeCues_.length)a=!0;else for(let e=0;e<r.length;e++)-1===this.activeCues_.indexOf(r[e])&&(a=!0);this.activeCues_=r,s.setCues_(this.activeCues_)}return s},set(){}}}),e.src?(this.src=e.src,this.preload_||(this.loaded_=!0),(this.preload_||"subtitles"!==e.kind&&"captions"!==e.kind)&&qr(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(v().vttjs&&!(e instanceof v().vttjs.VTTCue)){t=new(v().vttjs.VTTCue)(e.startTime,e.endTime,e.text);for(const i in e)i in t||(t[i]=e[i]);t.id=e.id,t.originalCue_=e}const i=this.tech_.textTracks();for(let e=0;e<i.length;e++)i[e]!==this&&i[e].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}removeCue(e){let t=this.cues_.length;for(;t--;){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}Xr.prototype.allowedEvents_={cuechange:"cuechange"};class Yr extends Fr{constructor(e={}){e=u(e,{kind:Nr[e.kind]||""});super(e);let t=!1;Object.defineProperty(this,"enabled",{get:()=>t,set(e){"boolean"==typeof e&&e!==t&&(t=e,this.trigger("enabledchange"))}}),e.enabled&&(this.enabled=e.enabled),this.loaded_=!0}}class $r extends Fr{constructor(e={}){e=u(e,{kind:Or[e.kind]||""});super(e);let t=!1;Object.defineProperty(this,"selected",{get:()=>t,set(e){"boolean"==typeof e&&e!==t&&(t=e,this.trigger("selectedchange"))}}),e.selected&&(this.selected=e.selected)}}class Kr extends Qi{constructor(e={}){let t;super();const i=new Xr(e);this.kind=i.kind,this.src=i.src,this.srclang=i.language,this.label=i.label,this.default=i.default,Object.defineProperties(this,{readyState:{get:()=>t},track:{get:()=>i}}),t=Kr.NONE,i.addEventListener("loadeddata",()=>{t=Kr.LOADED,this.trigger({type:"load",target:this})})}}Kr.prototype.allowedEvents_={load:"load"},Kr.NONE=0,Kr.LOADING=1,Kr.LOADED=2,Kr.ERROR=3;const Jr={audio:{ListClass:class extends Ir{constructor(t=[]){for(let e=t.length-1;0<=e;e--)if(t[e].enabled){Pr(t,t[e]);break}super(t),this.changing_=!1}addTrack(e){e.enabled&&Pr(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,Pr(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}},TrackClass:Yr,capitalName:"Audio"},video:{ListClass:class extends Ir{constructor(t=[]){for(let e=t.length-1;0<=e;e--)if(t[e].selected){Rr(t,t[e]);break}super(t),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set(){}})}addTrack(e){e.selected&&Rr(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,Rr(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}},TrackClass:$r,capitalName:"Video"},text:{ListClass:kr,TrackClass:Xr,capitalName:"Text"}},Zr=(Object.keys(Jr).forEach(function(e){Jr[e].getterName=e+"Tracks",Jr[e].privateName=e+"Tracks_"}),{remoteText:{ListClass:kr,TrackClass:Xr,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:class{constructor(i=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let e=0,t=i.length;e<t;e++)this.addTrackElement_(i[e])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)}getTrackElementByTrack_(i){let r;for(let e=0,t=this.trackElements_.length;e<t;e++)if(i===this.trackElements_[e].track){r=this.trackElements_[e];break}return r}removeTrackElement_(i){for(let e=0,t=this.trackElements_.length;e<t;e++)if(i===this.trackElements_[e]){this.trackElements_[e].track&&"function"==typeof this.trackElements_[e].track.off&&this.trackElements_[e].track.off(),"function"==typeof this.trackElements_[e].off&&this.trackElements_[e].off(),this.trackElements_.splice(e,1);break}}},TrackClass:Kr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}}),E=Object.assign({},Jr,Zr);Zr.names=Object.keys(Zr),Jr.names=Object.keys(Jr),E.names=[].concat(Zr.names).concat(Jr.names);class M extends S{constructor(t={},e=function(){}){t.reportTouchActivity=!1,super(null,t,e),this.onDurationChange_=e=>this.onDurationChange(e),this.trackProgress_=e=>this.trackProgress(e),this.trackCurrentTime_=e=>this.trackCurrentTime(e),this.stopTrackingCurrentTime_=e=>this.stopTrackingCurrentTime(e),this.disposeSourceHandler_=e=>this.disposeSourceHandler(e),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),E.names.forEach(e=>{e=E[e];t&&t[e.getterName]&&(this[e.privateName]=t[e.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(e=>{!1===t[`native${e}Tracks`]&&(this[`featuresNative${e}Tracks`]=!1)}),!1===t.nativeCaptions||!1===t.nativeTextTracks?this.featuresNativeTextTracks=!1:!0!==t.nativeCaptions&&!0!==t.nativeTextTracks||(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=!1!==t.preloadTextTracks,this.autoRemoteTextTracks_=new E.text.ListClass,this.initTrackListeners(),t.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(x(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return vr(0,0)}bufferedPercent(){return Sr(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Jr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){(e=[].concat(e)).forEach(e=>{var t=this[e+"Tracks"]()||[];let i=t.length;for(;i--;){var r=t[i];"text"===e&&this.removeRemoteTextTrack(r),t.removeTrack(r)}})}cleanupAutoTextTracks(){var e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){var i=e[t];this.removeRemoteTextTrack(i)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return void 0!==e&&(this.error_=new n(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?vr(0,0):vr()}play(){}setScrubbing(){}scrubbing(){}setCurrentTime(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Jr.names.forEach(e=>{const t=Jr[e],i=()=>{this.trigger(e+"trackchange")},r=this[t.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),this.on("dispose",()=>{r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)})})}addWebVttScript_(){if(!v().WebVTT)if(a().body.contains(this.el()))if(!this.options_["vtt.js"]&&Rt(U())&&0<Object.keys(U()).length)this.trigger("vttjsloaded");else{const e=a().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),v().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const i=this.textTracks(),e=this.remoteTextTracks(),t=e=>i.addTrack(e.track),r=e=>i.removeTrack(e.track),n=(e.on("addtrack",t),e.on("removetrack",r),this.addWebVttScript_(),()=>this.trigger("texttrackchange")),s=()=>{n();for(let e=0;e<i.length;e++){var t=i[e];t.removeEventListener("cuechange",n),"showing"===t.mode&&t.addEventListener("cuechange",n)}};s(),i.addEventListener("change",s),i.addEventListener("addtrack",s),i.addEventListener("removetrack",s),this.on("dispose",function(){e.off("addtrack",t),e.off("removetrack",r),i.removeEventListener("change",s),i.removeEventListener("addtrack",s),i.removeEventListener("removetrack",s);for(let e=0;e<i.length;e++)i[e].removeEventListener("cuechange",n)})}addTextTrack(e,t,i){if(e)return e=e,t=t,i=i,n={},s=(r=this).textTracks(),n.kind=e,t&&(n.label=t),i&&(n.language=i),n.tech=r,e=new E.text.TrackClass(n),s.addTrack(e),e;throw new Error("TextTrack kind is required but was not provided");var r,n,s}createRemoteTextTrack(e){e=u(e,{tech:this});return new Zr.remoteTextEl.TrackClass(e)}addRemoteTextTrack(e={},t){const i=this.createRemoteTextTrack(e);return"boolean"!=typeof t&&(t=!1),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!1===t&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(i.track)),i}removeRemoteTextTrack(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=Hi++;return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(){}overrideNativeVideoTracks(){}canPlayType(){return""}static canPlayType(){return""}static canPlaySource(e,t){return M.canPlayType(e.type)}static isTech(e){return e.prototype instanceof M||e instanceof M||e===M}static registerTech(e,t){if(M.techs_||(M.techs_={}),!M.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!M.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(M.canPlaySource)return e=w(e),M.techs_[e]=t,M.techs_[dr(e)]=t,"Tech"!==e&&M.defaultTechOrder_.push(e),t;throw new Error("Techs must have a static canPlaySource method on them")}static getTech(e){if(e)return M.techs_&&M.techs_[e]?M.techs_[e]:(e=w(e),v()&&v().videojs&&v().videojs[e]?(h.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),v().videojs[e]):void 0)}}E.names.forEach(function(e){const t=E[e];M.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),M.prototype.featuresVolumeControl=!0,M.prototype.featuresMuteControl=!0,M.prototype.featuresFullscreenResize=!1,M.prototype.featuresPlaybackRate=!1,M.prototype.featuresProgressEvents=!1,M.prototype.featuresSourceset=!1,M.prototype.featuresTimeupdateEvents=!1,M.prototype.featuresNativeTextTracks=!1,M.prototype.featuresVideoFrameCallback=!1,M.withSourceHandlers=function(n){n.registerSourceHandler=function(e,t){let i=n.sourceHandlers;i=i||(n.sourceHandlers=[]),void 0===t&&(t=i.length),i.splice(t,0,e)},n.canPlayType=function(t){var i,r=n.sourceHandlers||[];for(let e=0;e<r.length;e++)if(i=r[e].canPlayType(t))return i;return""},n.selectSourceHandler=function(t,i){var r=n.sourceHandlers||[];for(let e=0;e<r.length;e++)if(r[e].canHandleSource(t,i))return r[e];return null},n.canPlaySource=function(e,t){var i=n.selectSourceHandler(e,t);return i?i.canHandleSource(e,t):""},["seekable","seeking","duration"].forEach(function(e){const t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(e){let t=n.selectSourceHandler(e,this.options_);t||(n.nativeSourceHandler?t=n.nativeSourceHandler:h.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),t!==n.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=t.handleSource(e,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},S.registerComponent("Tech",M),M.registerTech("Tech",M),M.defaultTechOrder_=[];const Qr={},en={},tn={};function rn(e,t,i){e.setTimeout(()=>function i(r={},n=[],s,a,o=[],l=!1){const[e,...h]=n;if("string"==typeof e)i(r,Qr[e],s,a,o,l);else if(e){const n=function(e,t){const i=en[e.id()];let r=null;if(null==i)r=t(e),en[e.id()]=[[t,r]];else{for(let e=0;e<i.length;e++){const[n,s]=i[e];n===t&&(r=s)}null===r&&(r=t(e),i.push([t,r]))}return r}(a,e);if(!n.setSource)return o.push(n),i(r,h,s,a,o,l);n.setSource(Object.assign({},r),function(e,t){if(e)return i(r,h,s,a,o,l);o.push(n),i(t,r.type===t.type?h:Qr[t.type],s,a,o,l)})}else h.length?i(r,h,s,a,o,l):l?s(r,o):i(r,Qr["*"],s,a,o,!0)}(t,Qr[t.type],i,e),1)}function nn(e,t,i,r=null){var n="call"+w(i),n=e.reduce(ln(n),r),r=n===tn,t=r?null:t[i](n),s=e,a=i,o=t,l=r;for(let e=s.length-1;0<=e;e--){var h=s[e];h[a]&&h[a](l,o)}return t}const sn={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},an={setCurrentTime:1,setMuted:1,setVolume:1},on={play:1,pause:1};function ln(i){return(e,t)=>e===tn?tn:t[i]?t[i](e):e}function hn(e){if(Array.isArray(e)){let t=[];e.forEach(function(e){e=hn(e),Array.isArray(e)?t=t.concat(e):Pt(e)&&t.push(e)}),e=t}else e="string"==typeof e&&e.trim()?[dn({src:e})]:Pt(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[dn(e)]:[];return e}const un={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},cn=function(e=""){e=Vr(e);return un[e.toLowerCase()]||""};function dn(e){var t;return e.type||(t=cn(e.src))&&(e.type=t),e}S.registerComponent("MediaLoader",class extends S{constructor(r,n,e){if(super(r,u({createEl:!1},n),e),n.playerOptions.sources&&0!==n.playerOptions.sources.length)r.src(n.playerOptions.sources);else for(let t=0,i=n.playerOptions.techOrder;t<i.length;t++){const n=w(i[t]);let e=M.getTech(n);if((e=n?e:S.getComponent(n))&&e.isSupported()){r.loadTech_(n);break}}}});class pn extends S{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=e=>this.handleMouseOver(e),this.handleMouseOut_=e=>this.handleMouseOut(e),this.handleClick_=e=>this.handleClick(e),this.handleKeyDown_=e=>this.handleKeyDown(e),this.emitTapEvents(),this.enable()}createEl(e="div",t={},i={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&h.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),i=Object.assign({role:"button"},i),this.tabIndex_=t.tabIndex;e=y(e,t,i);return e.appendChild(y("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(e),e}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=y("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e,si(this.controlTextEl_,i),this.nonIconControl||this.player_.options_.noUITitleAttributes||t.setAttribute("title",i)}buildCSSClass(){return"vjs-control vjs-button "+super.buildCSSClass()}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){s().isEventKey(e,"Space")||s().isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}S.registerComponent("ClickableComponent",pn);class fn extends pn{constructor(e,t){super(e,t),this.update(),this.update_=e=>this.update(e),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return y("picture",{className:"vjs-poster",tabIndex:-1},{},y("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))}crossOrigin(e){if(void 0===e)return this.el_?this.el_.querySelector("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;null===e||"anonymous"===e||"use-credentials"===e?this.el_.querySelector("img").crossOrigin=e:this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`)}update(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){this.el_.querySelector("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Mr(this.player_.play()):this.player_.pause())}}fn.prototype.crossorigin=fn.prototype.crossOrigin,S.registerComponent("PosterImage",fn);const mn={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function gn(e,t){let i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");i=e.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function vn(e,t,i){try{e.style[t]=i}catch(e){}}S.registerComponent("TextTrackDisplay",class extends S{constructor(r,e,t){super(r,e,t);const n=e=>this.updateDisplay(e);r.on("loadstart",e=>this.toggleDisplay(e)),r.on("texttrackchange",n),r.on("loadedmetadata",e=>this.preselectTrack(e)),r.ready(x(this,function(){if(r.tech_&&r.tech_.featuresNativeTextTracks)this.hide();else{r.on("fullscreenchange",n),r.on("playerresize",n);const e=v().screen.orientation||v(),i=v().screen.orientation?"change":"orientationchange";e.addEventListener(i,n),r.on("dispose",()=>e.removeEventListener(i,n));var t=this.options_.playerOptions.tracks||[];for(let e=0;e<t.length;e++)this.player_.addRemoteTextTrack(t[e],!0);this.preselectTrack()}}))}preselectTrack(){var t={captions:1,subtitles:1},i=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage;let n,s,a;for(let e=0;e<i.length;e++){var o=i[e];r&&r.enabled&&r.language&&r.language===o.language&&o.kind in t?a=o.kind!==r.kind&&a||o:r&&!r.enabled?(a=null,n=null,s=null):o.default&&("descriptions"!==o.kind||n?o.kind in t&&!s&&(s=o):n=o)}a?a.mode="showing":s?s.mode="showing":n&&(n.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){"function"==typeof v().WebVTT&&v().WebVTT.processCues(v(),[],this.el_)}updateDisplay(){const r=this.player_.textTracks(),n=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),n){const n=[];for(let e=0;e<r.length;++e){const t=r[e];"showing"===t.mode&&n.push(t)}void this.updateForTrack(n)}else{let e=null,t=null,i=r.length;for(;i--;){const n=r[i];"showing"===n.mode&&("descriptions"===n.kind?e=n:t=n)}t?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(t)):e&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(e))}}updateDisplayState(e){var t=this.player_.textTrackSettings.getValues(),i=e.activeCues;let r=i.length;for(;r--;){const e=i[r];if(e){var n=e.displayState;if(t.color&&(n.firstChild.style.color=t.color),t.textOpacity&&vn(n.firstChild,"color",gn(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(n.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&vn(n.firstChild,"backgroundColor",gn(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?vn(n,"backgroundColor",gn(t.windowColor,t.windowOpacity)):n.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?n.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===t.edgeStyle?n.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===t.edgeStyle?n.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===t.edgeStyle&&(n.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),t.fontPercent&&1!==t.fontPercent){const e=v().parseFloat(n.style.fontSize);n.style.fontSize=e*t.fontPercent+"px",n.style.height="auto",n.style.top="auto"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?n.firstChild.style.fontVariant="small-caps":n.firstChild.style.fontFamily=mn[t.fontFamily])}}}updateForTrack(i){if(Array.isArray(i)||(i=[i]),"function"==typeof v().WebVTT&&!i.every(e=>!e.activeCues)){var t=[];for(let e=0;e<i.length;++e){var r=i[e];for(let e=0;e<r.activeCues.length;++e)t.push(r.activeCues[e])}v().WebVTT.processCues(v(),t,this.el_);for(let t=0;t<i.length;++t){var n=i[t];for(let e=0;e<n.activeCues.length;++e){var s=n.activeCues[e].displayState;hi(s,"vjs-text-track-cue","vjs-text-track-cue-"+(n.language||t)),n.language&&mi(s,"lang",n.language)}this.player_.textTrackSettings&&this.updateDisplayState(n)}}}}),S.registerComponent("LoadingSpinner",class extends S{createEl(){var e=this.player_.isAudio(),e=this.localize(e?"Audio Player":"Video Player"),e=y("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[e])}),t=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return t.appendChild(e),t}});class yn extends pn{createEl(e,t={},i={}){t=y("button",t=Object.assign({className:this.buildCSSClass()},t),i=Object.assign({type:"button"},i));return t.appendChild(y("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(t),t}addChild(e,t={}){var i=this.constructor.name;return h.warn(`Adding an actionable (user controllable) child to a Button (${i}) is not supported; use a ClickableComponent instead.`),S.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){s().isEventKey(e,"Space")||s().isEventKey(e,"Enter")?e.stopPropagation():super.handleKeyDown(e)}}S.registerComponent("Button",yn);class _n extends yn{constructor(e,t){super(e,t),this.mouseused_=!1,this.on("mousedown",e=>this.handleMouseDown(e))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)Mr(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();else{const i=this.player_.getChild("controlBar"),r=i&&i.getChild("playToggle");r?(e=()=>r.focus(),Er(t)?t.then(e,()=>{}):this.setTimeout(e,1)):this.player_.tech(!0).focus()}}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}_n.prototype.controlText_="Play Video",S.registerComponent("BigPlayButton",_n),S.registerComponent("CloseButton",class extends yn{constructor(e,t){super(e,t),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return"vjs-close-button "+super.buildCSSClass()}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){s().isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}});class bn extends yn{constructor(e,t={}){super(e,t),t.replay=void 0===t.replay||t.replay,this.on(e,"play",e=>this.handlePlay(e)),this.on(e,"pause",e=>this.handlePause(e)),t.replay&&this.on(e,"ended",e=>this.handleEnded(e))}buildCSSClass(){return"vjs-play-control "+super.buildCSSClass()}handleClick(e){this.player_.paused()?Mr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",e=>this.handleSeeked(e))}}bn.prototype.controlText_="Play",S.registerComponent("PlayToggle",bn);class Tn extends S{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended"],e=>this.updateContent(e)),this.updateTextNode_()}createEl(){var e=this.buildCSSClass(),t=super.createEl("div",{className:e+" vjs-time-control vjs-control"}),i=y("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+" "},{role:"presentation"});return t.appendChild(i),this.contentEl_=y("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(e=0){e=xr(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(this.contentEl_){let e=this.textNode_;e&&this.contentEl_.firstChild!==e&&(e=null,h.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=a().createTextNode(this.formattedTime_),this.textNode_&&(e?this.contentEl_.replaceChild(this.textNode_,e):this.contentEl_.appendChild(this.textNode_))}}))}updateContent(e){}}Tn.prototype.labelText_="Time",Tn.prototype.controlText_="Time",S.registerComponent("TimeDisplay",Tn);class xn extends Tn{buildCSSClass(){return"vjs-current-time"}updateContent(e){var t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateTextNode_(t)}}xn.prototype.labelText_="Current Time",xn.prototype.controlText_="Current Time",S.registerComponent("CurrentTimeDisplay",xn);class wn extends Tn{constructor(e,t){super(e,t);t=e=>this.updateContent(e);this.on(e,"durationchange",t),this.on(e,"loadstart",t),this.on(e,"loadedmetadata",t)}buildCSSClass(){return"vjs-duration"}updateContent(e){var t=this.player_.duration();this.updateTextNode_(t)}}wn.prototype.labelText_="Duration",wn.prototype.controlText_="Duration",S.registerComponent("DurationDisplay",wn),S.registerComponent("TimeDivider",class extends S{createEl(){var e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),i=super.createEl("span",{textContent:"/"});return t.appendChild(i),e.appendChild(t),e}});class Sn extends Tn{constructor(e,t){super(e,t),this.on(e,"durationchange",e=>this.updateContent(e))}buildCSSClass(){return"vjs-remaining-time"}createEl(){var e=super.createEl();return!1!==this.options_.displayNegative&&e.insertBefore(y("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){var t;"number"==typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))}}Sn.prototype.labelText_="Remaining Time",Sn.prototype.controlText_="Remaining Time",S.registerComponent("RemainingTimeDisplay",Sn),S.registerComponent("LiveDisplay",class extends S{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",e=>this.updateShowing(e))}createEl(){var e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=y("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(y("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+" "})),this.contentEl_.appendChild(a().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}});class En extends yn{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=e=>this.updateLiveEdgeStatus(e),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){var e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=y("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}function Mn(e,t,i){return e=Number(e),Math.min(i,Math.max(t,isNaN(e)?t:e))}En.prototype.controlText_="Seek to live, currently playing live",S.registerComponent("SeekToLive",En);var Cn=Object.freeze({__proto__:null,clamp:Mn});class An extends S{constructor(e,t){super(e,t),this.handleMouseDown_=e=>this.handleMouseDown(e),this.handleMouseUp_=e=>this.handleMouseUp(e),this.handleKeyDown_=e=>this.handleKeyDown(e),this.handleClick_=e=>this.handleClick(e),this.handleMouseMove_=e=>this.handleMouseMove(e),this.update_=e=>this.update(e),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){var e;this.enabled()&&(e=this.bar.el_.ownerDocument,this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1)}createEl(e,t={},i={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),i=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},i),super.createEl(e,t,i)}handleMouseDown(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||Vt||e.preventDefault(),vi(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(){var e=this.bar.el_.ownerDocument;yi(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.update()}update(){if(this.el_&&this.bar){const t=this.getProgress();return t!==this.progress_&&(this.progress_=t,this.requestNamedAnimationFrame("Slider#update",()=>{var e=this.vertical()?"height":"width";this.bar.el().style[e]=(100*t).toFixed(2)+"%"})),t}}getProgress(){return Number(Mn(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){e=Ti(this.el_,e);return this.vertical()?e.y:e.x}handleKeyDown(e){s().isEventKey(e,"Left")||s().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):s().isEventKey(e,"Right")||s().isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}S.registerComponent("Slider",An);const Ln=(e,t)=>Mn(e/t*100,0,100).toFixed(2)+"%";S.registerComponent("LoadProgressBar",class extends S{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",e=>this.update(e))}createEl(){var e=super.createEl("div",{className:"vjs-load-progress"}),t=y("span",{className:"vjs-control-text"}),i=y("span",{textContent:this.localize("Loaded")}),r=a().createTextNode(": ");return this.percentageEl_=y("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(r),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const e=this.player_.liveTracker,i=this.player_.buffered(),r=e&&e.isLive()?e.seekableEnd():this.player_.duration(),n=this.player_.bufferedEnd(),s=this.partEls_,a=Ln(n,r);this.percent_!==a&&(this.el_.style.width=a,si(this.percentageEl_,a),this.percent_=a);for(let t=0;t<i.length;t++){const r=i.start(t),a=i.end(t);let e=s[t];e||(e=this.el_.appendChild(y()),s[t]=e),e.dataset.start===r&&e.dataset.end===a||(e.dataset.start=r,e.dataset.end=a,e.style.left=Ln(r,n),e.style.width=Ln(a-r,n))}for(let e=s.length;e>i.length;e--)this.el_.removeChild(s[e-1]);s.length=i.length})}}),S.registerComponent("TimeTooltip",class extends S{constructor(e,t){super(e,t),this.update=$i(x(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(t,i,r){var n=bi(this.el_),s=_i(this.player_.el()),i=t.width*i;if(s&&n){var a=t.left-s.left+i,i=t.width-i+(s.right-t.right);let e=n.width/2;a<e?e+=e-a:i<e&&(e=i),e<0?e=0:e>n.width&&(e=n.width),e=Math.round(e),this.el_.style.right=`-${e}px`,this.write(r)}}write(e){si(this.el_,e)}updateTime(i,r,n,s){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let e;var t=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const i=this.player_.liveTracker.liveWindow(),n=i-r*i;e=(n<1?"":"-")+xr(n,i)}else e=xr(n,t);this.update(i,r,e),s&&s()})}});class In extends S{constructor(e,t){super(e,t),this.update=$i(x(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t){var i,r=this.getChild("timeTooltip");r&&(i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),r.updateTime(e,t,i))}}In.prototype.options_={children:[]},f||Bt||In.prototype.options_.children.push("timeTooltip"),S.registerComponent("PlayProgressBar",In);class Pn extends S{constructor(e,t){super(e,t),this.update=$i(x(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){var i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,()=>{this.el_.style.left=e.width*t+"px"})}}Pn.prototype.options_={children:["timeTooltip"]},S.registerComponent("MouseTimeDisplay",Pn);class Rn extends An{constructor(e,t){super(e,t),this.setEventHandlers_()}setEventHandlers_(){this.update_=x(this,this.update),this.update=$i(this.update_,30),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in a()&&"visibilityState"in a()&&this.on(a(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){"hidden"===a().visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,30))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if("hidden"!==a().visibilityState){const r=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{var e=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),t=this.player_.liveTracker;let i=this.player_.duration();t&&t.isLive()&&(i=this.player_.liveTracker.liveCurrentTime()),this.percent_!==r&&(this.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),this.percent_=r),this.currentTime_===e&&this.duration_===i||(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[xr(e,i),xr(i,i)],"{1} of {2}")),this.currentTime_=e,this.duration_=i),this.bar&&this.bar.update(_i(this.el()),this.getProgress())}),r}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){var e=this.getCurrentTime_();let t;var i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){Ci(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(t,i=!1){if(Ci(t)){let e;i||this.player_.scrubbing()||this.player_.scrubbing(!0);var r=this.calculateDistance(t),n=this.player_.liveTracker;if(n&&n.isLive()){if(.99<=r)return void n.seekToLiveEdge();const t=n.seekableStart(),i=n.liveCurrentTime();if((e=(e=(e=t+r*n.liveWindow())>=i?i:e)<=t?t+.1:e)===1/0)return}else(e=r*this.player_.duration())===this.player_.duration()&&(e-=.1);this.userSeek_(e)}}enable(){super.enable();var e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();var e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Mr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+5)}stepBack(){this.userSeek_(this.player_.currentTime()-5)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){var t,i=this.player_.liveTracker;s().isEventKey(e,"Space")||s().isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.handleAction(e)):s().isEventKey(e,"Home")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(0)):s().isEventKey(e,"End")?(e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration())):/^[0-9]$/.test(s()(e))?(e.preventDefault(),e.stopPropagation(),t=10*(s().codes[s()(e)]-s().codes[0])/100,i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*t):this.userSeek_(this.player_.duration()*t)):s().isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):s().isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in a()&&"visibilityState"in a()&&this.off(a(),"visibilitychange",this.toggleVisibility_),super.dispose()}}Rn.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},f||Bt||Rn.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),S.registerComponent("SeekBar",Rn);class kn extends S{constructor(e,t){super(e,t),this.handleMouseMove=$i(x(this,this.handleMouseMove),30),this.throttledHandleMouseSeek=$i(x(this,this.handleMouseSeek),30),this.handleMouseUpHandler_=e=>this.handleMouseUp(e),this.handleMouseDownHandler_=e=>this.handleMouseDown(e),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){var t,i,r,n,s=this.getChild("seekBar");s&&(t=s.getChild("playProgressBar"),i=s.getChild("mouseTimeDisplay"),t||i)&&(r=bi(n=s.el()),n=Mn(n=Ti(n,e).x,0,1),i&&i.update(r,n),t)&&t.update(r,s.getProgress())}handleMouseSeek(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){var e;this.children().forEach(e=>e.disable&&e.disable()),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())&&(e=this.getChild("seekBar"),this.player_.scrubbing(!1),e.videoWasPlaying&&Mr(this.player_.play()))}enable(){this.children().forEach(e=>e.enable&&e.enable()),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){var t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}kn.prototype.options_={children:["seekBar"]},S.registerComponent("ProgressControl",kn);class Dn extends yn{constructor(e,t){super(e,t),this.on(e,["enterpictureinpicture","leavepictureinpicture"],e=>this.handlePictureInPictureChange(e)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],e=>this.handlePictureInPictureEnabledChange(e)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{"audio"===e.currentType().substring(0,5)||e.audioPosterMode()||e.audioOnlyMode()?(e.isInPictureInPicture()&&e.exitPictureInPicture(),this.hide()):this.show()}),this.disable()}buildCSSClass(){return"vjs-picture-in-picture-control "+super.buildCSSClass()}handlePictureInPictureEnabledChange(){a().pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}Dn.prototype.controlText_="Picture-in-Picture",S.registerComponent("PictureInPictureToggle",Dn);class On extends yn{constructor(e,t){super(e,t),this.on(e,"fullscreenchange",e=>this.handleFullscreenChange(e)),!1===a()[e.fsApi_.fullscreenEnabled]&&this.disable()}buildCSSClass(){return"vjs-fullscreen-control "+super.buildCSSClass()}handleFullscreenChange(e){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}On.prototype.controlText_="Fullscreen",S.registerComponent("FullscreenToggle",On),S.registerComponent("VolumeLevel",class extends S{createEl(){var e=super.createEl("div",{className:"vjs-volume-level"});return e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}),S.registerComponent("VolumeLevelTooltip",class extends S{constructor(e,t){super(e,t),this.update=$i(x(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(t,i,r,n){if(!r){const r=_i(this.el_),n=_i(this.player_.el()),s=t.width*i;if(!n||!r)return;i=t.left-n.left+s,t=t.width-s+(n.right-t.right);let e=r.width/2;i<e?e+=e-i:t<e&&(e=t),e<0?e=0:e>r.width&&(e=r.width),this.el_.style.right=`-${e}px`}this.write(n+"%")}write(e){si(this.el_,e)}updateVolume(e,t,i,r,n){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,i,r.toFixed(0)),n&&n()})}});class Nn extends S{constructor(e,t){super(e,t),this.update=$i(x(this,this.update),30)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,i){var r=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,r,()=>{i?this.el_.style.bottom=e.height*t+"px":this.el_.style.left=e.width*t+"px"})}}Nn.prototype.options_={children:["volumeLevelTooltip"]},S.registerComponent("MouseVolumeLevelDisplay",Nn);class Un extends An{constructor(e,t){super(e,t),this.on("slideractive",e=>this.updateLastVolume_(e)),this.on(e,"volumechange",e=>this.updateARIAAttributes(e)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){Ci(e)&&super.handleMouseDown(e)}handleMouseMove(e){var t,i,r,n=this.getChild("mouseVolumeLevelDisplay");n&&(t=_i(r=this.el()),i=this.vertical(),r=Ti(r,e),r=Mn(r=i?r.y:r.x,0,1),n.update(t,r,i)),Ci(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(100*this.player_.volume())}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{0===this.player_.volume()&&this.player_.lastVolume_(e)})}}Un.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},f||Bt||Un.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Un.prototype.playerEvent="volumechange",S.registerComponent("VolumeBar",Un);class Bn extends S{constructor(e,t={}){var i,r;t.vertical=t.vertical||!1,void 0!==t.volumeBar&&!Rt(t.volumeBar)||(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),i=this,(r=e).tech_&&!r.tech_.featuresVolumeControl&&i.addClass("vjs-hidden"),i.on(r,"loadstart",function(){r.tech_.featuresVolumeControl?i.removeClass("vjs-hidden"):i.addClass("vjs-hidden")}),this.throttledHandleMouseMove=$i(x(this,this.handleMouseMove),30),this.handleMouseUpHandler_=e=>this.handleMouseUp(e),this.on("mousedown",e=>this.handleMouseDown(e)),this.on("touchstart",e=>this.handleMouseDown(e)),this.on("mousemove",e=>this.handleMouseMove(e)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:"vjs-volume-control vjs-control "+e})}handleMouseDown(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}Bn.prototype.options_={children:["volumeBar"]},S.registerComponent("VolumeControl",Bn);class Fn extends yn{constructor(e,t){var i,r;super(e,t),i=this,(r=e).tech_&&!r.tech_.featuresMuteControl&&i.addClass("vjs-hidden"),i.on(r,"loadstart",function(){r.tech_.featuresMuteControl?i.removeClass("vjs-hidden"):i.addClass("vjs-hidden")}),this.on(e,["loadstart","volumechange"],e=>this.update(e))}buildCSSClass(){return"vjs-mute-control "+super.buildCSSClass()}handleClick(e){var t=this.player_.volume(),i=this.player_.lastVolume_();if(0===t){const e=i<.1?.1:i;this.player_.volume(e),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){var e=this.player_.volume();let t=3;f&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2),ui(this.el_,[0,1,2,3].reduce((e,t)=>e+`${t?" ":""}vjs-vol-`+t,"")),hi(this.el_,"vjs-vol-"+t)}updateControlText_(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)}}Fn.prototype.controlText_="Mute",S.registerComponent("MuteToggle",Fn);class Hn extends S{constructor(e,t={}){void 0!==t.inline?t.inline=t.inline:t.inline=!0,void 0!==t.volumeControl&&!Rt(t.volumeControl)||(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=e=>this.handleKeyPress(e),this.on(e,["loadstart"],e=>this.volumePanelState_(e)),this.on(this.muteToggle,"keyup",e=>this.handleKeyPress(e)),this.on(this.volumeControl,"keyup",e=>this.handleVolumeControlKeyUp(e)),this.on("keydown",e=>this.handleKeyPress(e)),this.on("mouseover",e=>this.handleMouseOver(e)),this.on("mouseout",e=>this.handleMouseOut(e)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:"vjs-volume-panel vjs-control "+e})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){s().isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),b(a(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),T(a(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){s().isEventKey(e,"Esc")&&this.handleMouseOut()}}Hn.prototype.options_={children:["muteToggle","volumeControl"]},S.registerComponent("VolumePanel",Hn);class zn extends S{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",e=>this.handleKeyDown(e)),this.boundHandleBlur_=e=>this.handleBlur(e),this.boundHandleTapClick_=e=>this.handleTapClick(e)}addEventListenerForItem(e){e instanceof S&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof S&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){"string"==typeof e&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){e=this.addChild(e);e&&this.addEventListenerForItem(e)}createEl(){var e=this.options_.contentElType||"ul",e=(this.contentEl_=y(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu"),super.createEl("div",{append:this.contentEl_,className:"vjs-menu"}));return e.appendChild(this.contentEl_),b(e,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),e}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||a().activeElement;if(!this.children().some(e=>e.el()===t)){const e=this.menuButton_;e&&e.buttonPressed_&&t!==e.el().firstChild&&e.unpressButton()}}handleTapClick(t){var e;this.menuButton_&&(this.menuButton_.unpressButton(),e=this.children(),Array.isArray(e))&&(e=e.filter(e=>e.el()===t.target)[0])&&"CaptionSettingsMenuItem"!==e.name()&&this.menuButton_.focus()}handleKeyDown(e){s().isEventKey(e,"Left")||s().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(s().isEventKey(e,"Right")||s().isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){var t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())}}S.registerComponent("Menu",zn);class Vn extends S{constructor(e,t={}){super(e,t),this.menuButton_=new yn(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");e=yn.prototype.buildCSSClass(),this.menuButton_.el_.className=this.buildCSSClass()+" "+e,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0,t=e=>this.handleClick(e);this.handleMenuKeyUp_=e=>this.handleMenuKeyUp(e),this.on(this.menuButton_,"tap",t),this.on(this.menuButton_,"click",t),this.on(this.menuButton_,"keydown",e=>this.handleKeyDown(e)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),b(a(),"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",e=>this.handleMouseLeave(e)),this.on("keydown",e=>this.handleSubmenuKeyDown(e))}update(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){var e,t=new zn(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title&&(e=y("li",{className:"vjs-menu-title",textContent:w(this.options_.title),tabIndex:-1}),e=new S(this.player_,{el:e}),t.addItem(e)),this.items=this.createItems(),this.items)for(let e=0;e<this.items.length;e++)t.addItem(this.items[e]);return t}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${yn.prototype.buildCSSClass()} `+super.buildCSSClass()}buildCSSClass(){let e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup",`vjs-menu-button ${e} `+super.buildCSSClass()}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),T(a(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){s().isEventKey(e,"Esc")||s().isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),s().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):!s().isEventKey(e,"Up")&&!s().isEventKey(e,"Down")||this.buttonPressed_||(e.preventDefault(),this.pressButton())}handleMenuKeyUp(e){(s().isEventKey(e,"Esc")||s().isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(s().isEventKey(e,"Esc")||s().isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),s().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){this.enabled_&&(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),f&&ri()||this.menu.focus())}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}S.registerComponent("MenuButton",Vn);class Gn extends Vn{constructor(e,t){const i=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),i){const r=x(this,this.update);i.addEventListener("removetrack",r),i.addEventListener("addtrack",r),i.addEventListener("labelchange",r),this.player_.on("ready",r),this.player_.on("dispose",function(){i.removeEventListener("removetrack",r),i.removeEventListener("addtrack",r),i.removeEventListener("labelchange",r)})}}}S.registerComponent("TrackButton",Gn);const Wn=["Tab","Esc","Up","Down","Right","Left"];class jn extends pn{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,i){this.nonIconControl=!0;t=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),i);return t.replaceChild(y("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),t.querySelector(".vjs-icon-placeholder")),t}handleKeyDown(t){Wn.some(e=>s().isEventKey(t,e))||super.handleKeyDown(t)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}S.registerComponent("MenuItem",jn);class qn extends jn{constructor(e,t){const i=t.track,r=e.textTracks(),n=(t.label=i.label||i.language||"Unknown",t.selected="showing"===i.mode,super(e,t),this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean),(...e)=>{this.handleTracksChange.apply(this,e)}),s=(...e)=>{this.handleSelectedLanguageChange.apply(this,e)};if(e.on(["loadstart","texttrackchange"],n),r.addEventListener("change",n),r.addEventListener("selectedlanguagechange",s),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],n),r.removeEventListener("change",n),r.removeEventListener("selectedlanguagechange",s)}),void 0===r.onchange){let e;this.on(["tap","click"],function(){if("object"!=typeof v().Event)try{e=new(v().Event)("change")}catch(e){}e||(e=a().createEvent("Event")).initEvent("change",!0,!0),r.dispatchEvent(e)})}this.handleTracksChange()}handleClick(e){var t=this.track,i=this.player_.textTracks();if(super.handleClick(e),i)for(let e=0;e<i.length;e++){var r=i[e];-1!==this.kinds.indexOf(r.kind)&&(r===t?"showing"!==r.mode&&(r.mode="showing"):"disabled"!==r.mode&&(r.mode="disabled"))}}handleTracksChange(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if("showing"===this.track.mode){const e=this.player_.cache_.selectedLanguage;e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind||(this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind})}}dispose(){this.track=null,super.dispose()}}S.registerComponent("TextTrackMenuItem",qn);class Xn extends qn{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){var i=this.player().textTracks();let r=!0;for(let e=0,t=i.length;e<t;e++){var n=i[e];if(-1<this.options_.kinds.indexOf(n.kind)&&"showing"===n.mode){r=!1;break}}r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(e){var i=this.player().textTracks();let r=!0;for(let e=0,t=i.length;e<t;e++){var n=i[e];if(-1<["captions","descriptions","subtitles"].indexOf(n.kind)&&"showing"===n.mode){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})}}S.registerComponent("OffTextTrackMenuItem",Xn);class Yn extends Gn{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(t=[],i=qn){let r;this.label_&&(r=this.label_+" off"),t.push(new Xn(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;var n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let e=0;e<n.length;e++){var s=n[e];if(-1<this.kinds_.indexOf(s.kind)){const r=new i(this.player_,{track:s,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});r.addClass(`vjs-${s.kind}-menu-item`),t.push(r)}}return t}}S.registerComponent("TextTrackButton",Yn);class $n extends jn{constructor(e,t){var i=t.track,r=t.cue,n=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=r.text,t.selected=r.startTime<=n&&n<r.endTime,super(e,t),this.track=i,this.cue=r}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}S.registerComponent("ChaptersTrackMenuItem",$n);class Kn extends Yn{constructor(e,t,i){super(e,t,i),this.selectCurrentItem_=()=>{this.items.forEach(e=>{e.selected(this.track_.activeCues[0]===e.cue)})}}buildCSSClass(){return"vjs-chapters-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-chapters-button "+super.buildWrapperCSSClass()}update(e){e&&e.track&&"chapters"!==e.track.kind||((e=this.findChaptersTrack())!==this.track_?(this.setTrack(e),super.update()):(!this.items||e&&e.cues&&e.cues.length!==this.items.length)&&super.update())}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){var t=this.player_.textTracks()||[];for(let e=t.length-1;0<=e;e--){var i=t[e];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(w(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){var i=[];if(this.track_){var r=this.track_.cues;if(r)for(let e=0,t=r.length;e<t;e++){var n=r[e],n=new $n(this.player_,{track:this.track_,cue:n});i.push(n)}}return i}}Kn.prototype.kind_="chapters",Kn.prototype.controlText_="Chapters",S.registerComponent("ChaptersButton",Kn);class Jn extends Yn{constructor(e,t,i){super(e,t,i);const r=e.textTracks(),n=x(this,this.handleTracksChange);r.addEventListener("change",n),this.on("dispose",function(){r.removeEventListener("change",n)})}handleTracksChange(e){var i=this.player().textTracks();let r=!1;for(let e=0,t=i.length;e<t;e++){var n=i[e];if(n.kind!==this.kind_&&"showing"===n.mode){r=!0;break}}r?this.disable():this.enable()}buildCSSClass(){return"vjs-descriptions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-descriptions-button "+super.buildWrapperCSSClass()}}Jn.prototype.kind_="descriptions",Jn.prototype.controlText_="Descriptions",S.registerComponent("DescriptionsButton",Jn);class Zn extends Yn{constructor(e,t,i){super(e,t,i)}buildCSSClass(){return"vjs-subtitles-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subtitles-button "+super.buildWrapperCSSClass()}}Zn.prototype.kind_="subtitles",Zn.prototype.controlText_="Subtitles",S.registerComponent("SubtitlesButton",Zn);class Qn extends qn{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}}S.registerComponent("CaptionSettingsMenuItem",Qn);class es extends Yn{constructor(e,t,i){super(e,t,i)}buildCSSClass(){return"vjs-captions-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-captions-button "+super.buildWrapperCSSClass()}createItems(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Qn(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}es.prototype.kind_="captions",es.prototype.controlText_="Captions",S.registerComponent("CaptionsButton",es);class ts extends qn{createEl(e,t,i){e=super.createEl(e,t,i),t=e.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(t.appendChild(y("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),t.appendChild(y("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),e}}S.registerComponent("SubsCapsMenuItem",ts);class is extends Yn{constructor(e,t={}){super(e,t),this.label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)&&(this.label_="captions"),this.menuButton_.controlText(w(this.label_))}buildCSSClass(){return"vjs-subs-caps-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-subs-caps-button "+super.buildWrapperCSSClass()}createItems(){let e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Qn(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,ts)}}is.prototype.kinds_=["captions","subtitles"],is.prototype.controlText_="Subtitles",S.registerComponent("SubsCapsButton",is);class rs extends jn{constructor(e,t){const i=t.track,r=e.audioTracks(),n=(t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),this.track=i,this.addClass(`vjs-${i.kind}-menu-item`),(...e)=>{this.handleTracksChange.apply(this,e)});r.addEventListener("change",n),this.on("dispose",()=>{r.removeEventListener("change",n)})}createEl(e,t,i){e=super.createEl(e,t,i),t=e.querySelector(".vjs-menu-item-text");return"main-desc"===this.options_.track.kind&&(t.appendChild(y("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),t.appendChild(y("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),e}handleClick(t){if(super.handleClick(t),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let e=0;e<t.length;e++){var i=t[e];i!==this.track&&(i.enabled=i===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}S.registerComponent("AudioTrackMenuItem",rs);class ns extends Gn{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t)}buildCSSClass(){return"vjs-audio-button "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-audio-button "+super.buildWrapperCSSClass()}createItems(t=[]){this.hideThreshold_=1;var i=this.player_.audioTracks();for(let e=0;e<i.length;e++){var r=i[e];t.push(new rs(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return t}}ns.prototype.controlText_="Audio Track",S.registerComponent("AudioTrackButton",ns);class ss extends jn{constructor(e,t){var i=t.rate,r=parseFloat(i,10);t.label=i,t.selected=r===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=i,this.rate=r,this.on(e,"ratechange",e=>this.update(e))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}ss.prototype.contentElType="button",S.registerComponent("PlaybackRateMenuItem",ss);class as extends Vn{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",e=>this.updateVisibility(e)),this.on(e,"ratechange",e=>this.updateLabel(e)),this.on(e,"playbackrateschange",e=>this.handlePlaybackRateschange(e))}createEl(){var e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=y("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return"vjs-playback-rate "+super.buildCSSClass()}buildWrapperCSSClass(){return"vjs-playback-rate "+super.buildWrapperCSSClass()}createItems(){var t=this.playbackRates(),i=[];for(let e=t.length-1;0<=e;e--)i.push(new ss(this.player(),{rate:t[e]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){var e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}as.prototype.controlText_="Playback Rate",S.registerComponent("PlaybackRateMenuButton",as);class os extends S{buildCSSClass(){return"vjs-spacer "+super.buildCSSClass()}createEl(e="div",t={},i={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,i)}}S.registerComponent("Spacer",os),S.registerComponent("CustomControlSpacer",class extends os{buildCSSClass(){return"vjs-custom-control-spacer "+super.buildCSSClass()}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}});class ls extends S{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}ls.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in a()&&ls.prototype.options_.children.splice(ls.prototype.options_.children.length-1,0,"pictureInPictureToggle"),S.registerComponent("ControlBar",ls);class hs extends Lr{constructor(e,t){super(e,t),this.on(e,"error",e=>this.open(e))}buildCSSClass(){return"vjs-error-display "+super.buildCSSClass()}content(){var e=this.player().error();return e?this.localize(e.message):""}}hs.prototype.options_=Object.assign({},Lr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),S.registerComponent("ErrorDisplay",hs);const us="vjs-text-track-settings",cs=["#000","Black"],ds=["#00F","Blue"],ps=["#0FF","Cyan"],fs=["#0F0","Green"],ms=["#F0F","Magenta"],gs=["#F00","Red"],vs=["#FFF","White"],ys=["#FF0","Yellow"],_s=["1","Opaque"],bs=["0.5","Semi-Transparent"],Ts=["0","Transparent"],xs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[cs,vs,gs,fs,ds,ys,ms,ps]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[_s,bs,Ts]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[vs,cs,gs,fs,ds,ys,ms,ps]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:e=>"1.00"===e?null:Number(e)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[_s,bs]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ts,bs,_s]}};function ws(e,t){if((e=t?t(e):e)&&"none"!==e)return e}xs.windowColor.options=xs.backgroundColor.options,S.registerComponent("TextTrackSettings",class extends Lr{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=y("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),void 0===t.persistTextTrackSettings&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),Lt(xs,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,t="",i="label"){const r=xs[e],n=r.id.replace("%s",this.id_),s=[t,n].join(" ").trim();return[`<${i} id="${n}" class="${"label"===i?"vjs-label":""}">`,this.localize(r.label),`</${i}>`,`<select aria-labelledby="${s}">`].concat(r.options.map(e=>{var t=n+"-"+e[1].replace(/\W+/g,"");return[`<option id="${t}" value="${e[0]}" `,`aria-labelledby="${s} ${t}">`,this.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">',`<legend id="${e}">`,this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return y("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return y("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){var e=this.localize("restore all settings to the default values");return y("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return It(xs,(e,t,i)=>{r=this.$(t.selector),t=t.parser;var r=ws(r.options[r.options.selectedIndex].value,t);return void 0!==r&&(e[i]=r),e},{})}setValues(s){Lt(xs,(e,t)=>{var i=this.$(e.selector),r=s[t],n=e.parser;if(r)for(let e=0;e<i.options.length;e++)if(ws(i.options[e].value,n)===r){i.selectedIndex=e;break}})}setDefaults(){Lt(xs,e=>{var t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(v().localStorage.getItem(us))}catch(e){h.warn(e)}e&&this.setValues(e)}saveSettings(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?v().localStorage.setItem(us,JSON.stringify(e)):v().localStorage.removeItem(us)}catch(e){h.warn(e)}}}updateDisplay(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,e=e&&e.captionsButton;t?t.focus():e&&e.focus()}}),S.registerComponent("ResizeManager",class extends S{constructor(e,t){let i=t.ResizeObserver||v().ResizeObserver;super(e,u({createEl:!(i=null===t.ResizeObserver?!1:i),reportTouchActivity:!1},t)),this.ResizeObserver=t.ResizeObserver||v().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=Ki(()=>{this.resizeHandler()},100,!1,this),i?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(this.el_&&this.el_.contentWindow){const t=this.debouncedHandler_;let e=this.unloadListener_=function(){T(this,"resize",t),T(this,"unload",e),e=null};b(this.el_.contentWindow,"unload",e),b(this.el_.contentWindow,"resize",t)}},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}});function Ss(i){const r=i.el();if(!r.resetSourceWatch_){const t={},n=(e=i,As([e.el(),v().HTMLMediaElement.prototype,v().Element.prototype,Cs],"innerHTML")),s=t=>(...e)=>{e=t.apply(r,e);return Ms(i),e};var e;["append","appendChild","insertAdjacentHTML"].forEach(e=>{r[e]&&(t[e]=r[e],r[e]=s(t[e]))}),Object.defineProperty(r,"innerHTML",u(n,{set:s(n.set)})),r.resetSourceWatch_=()=>{r.resetSourceWatch_=null,Object.keys(t).forEach(e=>{r[e]=t[e]}),Object.defineProperty(r,"innerHTML",n)},i.one("sourceset",r.resetSourceWatch_)}}const Es={trackingThreshold:20,liveTolerance:15},Ms=(S.registerComponent("LiveTracker",class extends S{constructor(e,t){super(e,u(Es,t,{createEl:!1})),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=e=>this.handlePlay(e),this.handleFirstTimeupdate_=e=>this.handleFirstTimeupdate(e),this.handleSeeked_=e=>this.handleSeeked(e),this.seekToLiveEdge_=e=>this.seekToLiveEdge(e),this.reset_(),this.on(this.player_,"durationchange",e=>this.handleDurationchange(e)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){var t=this.player_.seekable();if(t&&t.length){var t=Number(v().performance.now().toFixed(4)),i=-1===this.lastTime_?0:(t-this.lastTime_)/1e3,t=(this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i,this.liveCurrentTime()),i=this.player_.currentTime();let e=this.player_.paused()||this.seekedBehindLive_||Math.abs(t-i)>this.options_.liveTolerance;(e=this.timeupdateSeen_&&t!==1/0?e:!1)!==this.behindLiveEdge_&&(this.behindLiveEdge_=e,this.trigger("liveedgechange"))}}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,30),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&2<e,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){var e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){var e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0}liveWindow(){var e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return"number"==typeof this.trackingInterval_}seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}),S.registerComponent("TitleBar",class extends S{constructor(e,t){super(e,t),this.on("statechanged",e=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:y("div",{className:"vjs-title-bar-title",id:"vjs-title-bar-title-"+Hi++}),description:y("div",{className:"vjs-title-bar-description",id:"vjs-title-bar-description-"+Hi++})},y("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){const e=this.player_.tech_,r=e&&e.el_,n={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(e=>{var t=this.state[e],i=this.els[e],e=n[e];wi(i),t&&si(i,t),r&&(r.removeAttribute(e),t)&&r.setAttribute(e,i.id)}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){var e=this.player_.tech_,e=e&&e.el_;e&&(e.removeAttribute("aria-labelledby"),e.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}),e=>{const t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var i=e.$$("source"),r=[];let n="";if(!i.length)return!1;for(let e=0;e<i.length;e++){const t=i[e].src;t&&-1===r.indexOf(t)&&r.push(t)}return!!r.length&&(1===r.length&&(n=r[0]),e.triggerSourceset(n),!0)}),Cs=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(e){for(var t=a().createElement(this.nodeName.toLowerCase()),i=(t.innerHTML=e,a().createDocumentFragment());t.childNodes.length;)i.appendChild(t.childNodes[0]);return this.innerText="",v().Element.prototype.appendChild.call(this,i),this.innerHTML}}),As=(t,i)=>{let r={};for(let e=0;e<t.length&&!((r=Object.getOwnPropertyDescriptor(t[e],i))&&r.set&&r.get);e++);return r.enumerable=!0,r.configurable=!0,r},Ls=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?zr(v().Element.prototype.getAttribute.call(this,"src")):""},set(e){return v().Element.prototype.setAttribute.call(this,"src",e),e}});class C extends M{constructor(t,e){super(t,e);const i=t.source;let r=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&"VIDEO"===this.el_.tagName,i&&(this.el_.currentSrc!==i.src||t.tag&&3===t.tag.initNetworkState_)?this.setSource(i):this.handleLateInit_(this.el_),t.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const t=this.el_.childNodes;let e=t.length;const i=[];for(;e--;){var n=t[e];"track"===n.nodeName.toLowerCase()&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),this.textTracks().addTrack(n.track),r||this.el_.hasAttribute("crossorigin")||!Gr(n.src)||(r=!0)):i.push(n))}for(let e=0;e<i.length;e++)this.el_.removeChild(i[e])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&r&&h.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),this.restoreMetadataTracksInIOSNativePlayer_(),(Kt||$t)&&!0===t.nativeControlsForTouch&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),C.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){var e,i=this;if(i.featuresSourceset){const r=i.el();if(!r.resetSourceset_){e=i;const t=As([e.el(),v().HTMLMediaElement.prototype,Ls],"src"),n=r.setAttribute,s=r.load;Object.defineProperty(r,"src",u(t,{set:e=>{e=t.set.call(r,e);return i.triggerSourceset(r.src),e}})),r.setAttribute=(e,t)=>{t=n.call(r,e,t);return/src/i.test(e)&&i.triggerSourceset(r.src),t},r.load=()=>{var e=s.call(r);return Ms(i)||(i.triggerSourceset(""),Ss(i)),e},r.currentSrc?i.triggerSourceset(r.currentSrc):Ms(i)||Ss(i),r.resetSourceset_=()=>{r.resetSourceset_=null,r.load=s,r.setAttribute=n,Object.defineProperty(r,"src",t),r.resetSourceWatch_&&r.resetSourceWatch_()}}}}restoreMetadataTracksInIOSNativePlayer_(){const i=this.textTracks();let r;const e=()=>{r=[];for(let e=0;e<i.length;e++){var t=i[e];"metadata"===t.kind&&r.push({track:t,storedMode:t.mode})}},n=(e(),i.addEventListener("change",e),this.on("dispose",()=>i.removeEventListener("change",e)),()=>{for(let e=0;e<r.length;e++){var t=r[e];"disabled"===t.track.mode&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode)}i.removeEventListener("change",n)});this.on("webkitbeginfullscreen",()=>{i.removeEventListener("change",e),i.removeEventListener("change",n),i.addEventListener("change",n)}),this.on("webkitendfullscreen",()=>{i.removeEventListener("change",e),i.addEventListener("change",e),i.removeEventListener("change",n)})}overrideNative_(e,t){if(t===this[`featuresNative${e}Tracks`]){const i=e.toLowerCase();this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(e=>{this.el()[i+"Tracks"].removeEventListener(e,this[i+"TracksListeners_"][e])}),this[`featuresNative${e}Tracks`]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i)}}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(i){const e=Jr[i],r=this.el()[e.getterName],n=this[e.getterName]();if(this[`featuresNative${e.capitalName}Tracks`]&&r&&r.addEventListener){const s={change:e=>{var t={type:"change",target:n,currentTarget:n,srcElement:n};n.trigger(t),"text"===i&&this[Zr.remoteText.getterName]().trigger(t)},addtrack(e){n.addTrack(e.track)},removetrack(e){n.removeTrack(e.track)}},t=function(){var e=[];for(let i=0;i<n.length;i++){let t=!1;for(let e=0;e<r.length;e++)if(r[e]===n[i]){t=!0;break}t||e.push(n[i])}for(;e.length;)n.removeTrack(e.shift())};this[e.getterName+"Listeners_"]=s,Object.keys(s).forEach(t=>{const i=s[t];r.addEventListener(t,i),this.on("dispose",e=>r.removeEventListener(t,i))}),this.on("loadstart",t),this.on("dispose",e=>this.off("loadstart",t))}}proxyNativeTracks_(){Jr.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let t=this.options_.tag;if(!t||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(t){const i=t.cloneNode(!0);t.parentNode&&t.parentNode.insertBefore(i,t),C.disposeMediaElement(t),t=i}else{t=a().createElement("video");const i=u({},this.options_.tag&&pi(this.options_.tag));Kt&&!0===this.options_.nativeControlsForTouch||delete i.controls,di(t,Object.assign(i,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}void 0!==this.options_.preload&&mi(t,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(t.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let e=0;e<i.length;e++){var r=i[e],n=this.options_[r];void 0!==n&&(n?mi(t,r,r):gi(t,r),t[r]=n)}return t}handleLateInit_(e){if(0!==e.networkState&&3!==e.networkState)if(0===e.readyState){let e=!1;const t=function(){e=!0},i=(this.on("loadstart",t),function(){e||this.trigger("loadstart")});this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",t),this.off("loadedmetadata",i),e||this.trigger("loadstart")})}else{const t=["loadstart"];t.push("loadedmetadata"),2<=e.readyState&&t.push("loadeddata"),3<=e.readyState&&t.push("canplay"),4<=e.readyState&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(e){this.trigger(e)},this)})}}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&Zt?this.el_.fastSeek(e):this.el_.currentTime=e}catch(e){h(e,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Bt&&Vt&&0===this.el_.currentTime){const e=()=>{0<this.el_.currentTime&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if("webkitDisplayingFullscreen"in this.el_){const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}}supportsFullScreen(){return"function"==typeof this.el_.webkitEnterFullScreen}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Mr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(void 0===e)return this.el_.src;this.setSrc(e)}reset(){C.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):super.addTextTrack(e,t,i)}createRemoteTextTrack(e){var t;return this.featuresNativeTextTracks?(t=a().createElement("track"),e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t):super.createRemoteTextTrack(e)}addRemoteTextTrack(e,t){e=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(e),e}removeRemoteTextTrack(t){if(super.removeRemoteTextTrack(t),this.featuresNativeTextTracks){var i=this.$$("track");let e=i.length;for(;e--;)t!==i[e]&&t!==i[e].track||this.el().removeChild(i[e])}}getVideoPlaybackQuality(){var e;return"function"==typeof this.el().getVideoPlaybackQuality?this.el().getVideoPlaybackQuality():(e={},void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),v().performance&&(e.creationTime=v().performance.now()),e)}}kt(C,"TEST_VID",function(){var e,t;if(ti())return e=a().createElement("video"),(t=a().createElement("track")).kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}),C.isSupported=function(){try{C.TEST_VID.volume=.5}catch(e){return!1}return!(!C.TEST_VID||!C.TEST_VID.canPlayType)},C.canPlayType=function(e){return C.TEST_VID.canPlayType(e)},C.canPlaySource=function(e,t){return C.canPlayType(e.type)},C.canControlVolume=function(){try{const t=C.TEST_VID.volume;C.TEST_VID.volume=t/2+.1;var e=t!==C.TEST_VID.volume;return e&&f?(v().setTimeout(()=>{C&&C.prototype&&(C.prototype.featuresVolumeControl=t!==C.TEST_VID.volume)}),!1):e}catch(e){return!1}},C.canMuteVolume=function(){try{var e=C.TEST_VID.muted;return C.TEST_VID.muted=!e,C.TEST_VID.muted?mi(C.TEST_VID,"muted","muted"):gi(C.TEST_VID,"muted"),e!==C.TEST_VID.muted}catch(e){return!1}},C.canControlPlaybackRate=function(){if(Bt&&Vt&&Wt<58)return!1;try{var e=C.TEST_VID.playbackRate;return C.TEST_VID.playbackRate=e/2+.1,e!==C.TEST_VID.playbackRate}catch(e){return!1}},C.canOverrideAttributes=function(){try{var e=()=>{};Object.defineProperty(a().createElement("video"),"src",{get:e,set:e}),Object.defineProperty(a().createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(a().createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(a().createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},C.supportsNativeTextTracks=function(){return Zt||f&&Vt},C.supportsNativeVideoTracks=function(){return!(!C.TEST_VID||!C.TEST_VID.videoTracks)},C.supportsNativeAudioTracks=function(){return!(!C.TEST_VID||!C.TEST_VID.audioTracks)},C.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([e,t]){kt(C.prototype,e,()=>C[t](),!0)}),C.prototype.featuresVolumeControl=C.canControlVolume(),C.prototype.movingMediaElementInDOM=!f,C.prototype.featuresFullscreenResize=!0,C.prototype.featuresProgressEvents=!0,C.prototype.featuresTimeupdateEvents=!0,C.prototype.featuresVideoFrameCallback=!(!C.TEST_VID||!C.TEST_VID.requestVideoFrameCallback),C.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);if(e.removeAttribute("src"),"function"==typeof e.load)try{e.load()}catch(e){}}},C.resetMediaElement=function(t){if(t){var i=t.querySelectorAll("source");let e=i.length;for(;e--;)t.removeChild(i[e]);if(t.removeAttribute("src"),"function"==typeof t.load)try{t.load()}catch(e){}}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){C.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){C.prototype["set"+w(t)]=function(e){(this.el_[t]=e)?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(e){C.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(t){C.prototype["set"+w(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(e){C.prototype[e]=function(){return this.el_[e]()}}),M.withSourceHandlers(C),C.nativeSourceHandler={},C.nativeSourceHandler.canPlayType=function(e){try{return C.TEST_VID.canPlayType(e)}catch(e){return""}},C.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return C.nativeSourceHandler.canPlayType(e.type);if(e.src){const t=Vr(e.src);return C.nativeSourceHandler.canPlayType("video/"+t)}return""},C.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},C.nativeSourceHandler.dispose=function(){},C.registerSourceHandler(C.nativeSourceHandler),M.registerTech("Html5",C);const Is=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ps={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Rs=["tiny","xsmall","small","medium","large","xlarge","huge"],ks={},Ds=(Rs.forEach(e=>{var t="x"===e.charAt(0)?"x-"+e.substring(1):e;ks[e]="vjs-layout-"+t}),{tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0});class A extends S{constructor(t,i,e){if(t.id=t.id||i.id||"vjs_video_"+Hi++,(i=Object.assign(A.getTagSettings(t),i)).initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const e=t.closest("[lang]");e&&(i.language=e.getAttribute("lang"))}if(super(null,i,e),this.boundDocumentFullscreenChange_=e=>this.documentFullscreenChange_(e),this.boundFullWindowOnEscKey_=e=>this.fullWindowOnEscKey(e),this.boundUpdateStyleEl_=e=>this.updateStyleEl_(e),this.boundApplyInitTime_=e=>this.applyInitTime_(e),this.boundUpdateCurrentBreakpoint_=e=>this.updateCurrentBreakpoint_(e),this.boundHandleTechClick_=e=>this.handleTechClick_(e),this.boundHandleTechDoubleClick_=e=>this.handleTechDoubleClick_(e),this.boundHandleTechTouchStart_=e=>this.handleTechTouchStart_(e),this.boundHandleTechTouchMove_=e=>this.handleTechTouchMove_(e),this.boundHandleTechTouchEnd_=e=>this.handleTechTouchEnd_(e),this.boundHandleTechTap_=e=>this.handleTechTap_(e),this.isFullscreen_=!1,this.log=Ct(this.id_),this.fsApi_=xt,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=t,this.tagAttributes=t&&pi(t),this.language(this.options_.language),i.languages){const t={};Object.getOwnPropertyNames(i.languages).forEach(function(e){t[e.toLowerCase()]=i.languages[e]}),this.languages_=t}else this.languages_=A.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,t.controls=!1,t.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],t.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(e=>{if("function"!=typeof this[e])throw new Error(`plugin "${e}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),hr(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(b(a(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);e=u(this.options_),i.plugins&&Object.keys(i.plugins).forEach(e=>{this[e](i.plugins[e])}),i.debug&&this.debug(!0),this.options_.playerOptions=e,this.middleware_=[],this.playbackRates(i.playbackRates),this.initChildren(),this.isAudio("audio"===t.nodeName.toLowerCase()),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),Kt&&this.addClass("vjs-touch-enabled"),f||this.addClass("vjs-workinghover"),A.players[this.id_]=this,e="8.0.4".split(".")[0];this.addClass("vjs-v"+e),this.userActive(!0),this.reportUserActivity(),this.one("play",e=>this.listenForUserActivity_(e)),this.on("keydown",e=>this.handleKeyDown(e)),this.on("languagechange",e=>this.handleLanguagechange(e)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),T(a(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),T(a(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),A.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),en[this.id()]=null,E.names.forEach(e=>{e=this[E[e].getterName]();e&&e.off&&e.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let t,i=this.tag,e=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player");const r="video-js"===this.tag.tagName.toLowerCase(),n=(e?t=this.el_=i.parentNode:r||(t=this.el_=super.createEl("div")),pi(i));if(r){for(t=this.el_=i,i=this.tag=a().createElement("video");t.children.length;)i.appendChild(t.firstChild);li(t,"video-js")||hi(t,"video-js"),t.appendChild(i),e=this.playerElIngest_=t,Object.keys(t).forEach(e=>{try{i[e]=t[e]}catch(e){}})}if(i.setAttribute("tabindex","-1"),n.tabindex="-1",Vt&&Xt&&(i.setAttribute("role","application"),n.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in n&&delete n.width,"height"in n&&delete n.height,Object.getOwnPropertyNames(n).forEach(function(e){r&&"class"===e||t.setAttribute(e,n[e]),r&&i.setAttribute(e,n[e])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",(i.player=t.player=this).addClass("vjs-paused"),!0!==v().VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Ui("vjs-styles-dimensions");const t=Ai(".vjs-styles-defaults"),i=Ai("head");i.insertBefore(this.styleEl_,t?t.nextSibling:i.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);var s=i.getElementsByTagName("a");for(let e=0;e<s.length;e++){const i=s.item(e);hi(i,"vjs-hidden"),i.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!e&&i.parentNode.insertBefore(t,i),ai(i,t),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t}crossOrigin(e){if(void 0===e)return this.techGet_("crossOrigin");null===e||"anonymous"===e||"use-credentials"===e?(this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)):h.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){var i,r=e+"_";if(void 0===t)return this[r]||0;""===t||"auto"===t?(this[r]=void 0,this.updateStyleEl_()):(i=parseFloat(t),isNaN(i)?h.error(`Improper value "${t}" supplied for for `+e):(this[r]=i,this.updateStyleEl_()))}fluid(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,tr(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),e=()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)},tr(this)?e():(this.eventedCallbacks||(this.eventedCallbacks=[]),this.eventedCallbacks.push(e))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(!0===v().VIDEOJS_NO_DYNAMIC_STYLE){const e="number"==typeof this.width_?this.width_:this.options_.width,t="number"==typeof this.height_?this.height_:this.options_.height,i=this.tech_&&this.tech_.el();void(i&&(0<=e&&(i.width=e),0<=t)&&(i.height=t))}else{let e,t,i,r;var n=(i=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),n=n[1]/n[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/n:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*n,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),Bi(this.styleEl_,`
      .${r} {
        width: ${e}px;
        height: ${t}px;
      }

      .${r}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${100*n}%;
      }
    `)}}loadTech_(e,t){this.tech_&&this.unloadTech_();var i=w(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==i&&this.tag&&(M.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;let n=this.autoplay();const s={source:t,autoplay:n="string"==typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay?!1:n,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+`_${r}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};E.names.forEach(e=>{e=E[e];s[e.getterName]=this[e.privateName]}),Object.assign(s,this.options_[i]),Object.assign(s,this.options_[r]),Object.assign(s,this.options_[e.toLowerCase()]),this.tag&&(s.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(s.startTime=this.cache_.currentTime);var a,r=M.getTech(e);if(!r)throw new Error(`No Tech named '${i}' exists! '${i}' should be registered using videojs.registerTech()'`);this.tech_=new r(s),this.tech_.ready(x(this,this.handleTechReady_),!0),t=this.textTracksJson_||[],a=this.tech_,t.forEach(function(e){const t=a.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(e=>t.addCue(e))}),a.textTracks(),Is.forEach(t=>{this.on(this.tech_,t,e=>this[`handleTech${w(t)}_`](e))}),Object.keys(Ps).forEach(t=>{this.on(this.tech_,t,e=>{0===this.tech_.playbackRate()&&this.tech_.seeking()?this.queuedCallbacks_.push({callback:this[`handleTech${Ps[t]}_`].bind(this),event:e}):this[`handleTech${Ps[t]}_`](e)})}),this.on(this.tech_,"loadstart",e=>this.handleTechLoadStart_(e)),this.on(this.tech_,"sourceset",e=>this.handleTechSourceset_(e)),this.on(this.tech_,"waiting",e=>this.handleTechWaiting_(e)),this.on(this.tech_,"ended",e=>this.handleTechEnded_(e)),this.on(this.tech_,"seeking",e=>this.handleTechSeeking_(e)),this.on(this.tech_,"play",e=>this.handleTechPlay_(e)),this.on(this.tech_,"pause",e=>this.handleTechPause_(e)),this.on(this.tech_,"durationchange",e=>this.handleTechDurationChange_(e)),this.on(this.tech_,"fullscreenchange",(e,t)=>this.handleTechFullscreenChange_(e,t)),this.on(this.tech_,"fullscreenerror",(e,t)=>this.handleTechFullscreenError_(e,t)),this.on(this.tech_,"enterpictureinpicture",e=>this.handleTechEnterPictureInPicture_(e)),this.on(this.tech_,"leavepictureinpicture",e=>this.handleTechLeavePictureInPicture_(e)),this.on(this.tech_,"error",e=>this.handleTechError_(e)),this.on(this.tech_,"posterchange",e=>this.handleTechPosterChange_(e)),this.on(this.tech_,"textdata",e=>this.handleTechTextData_(e)),this.on(this.tech_,"ratechange",e=>this.handleTechRateChange_(e)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||ai(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){E.names.forEach(e=>{e=E[e];this[e.privateName]=this[e.getterName]()}),this.textTracksJson_=function(e){const t=e.$$("track"),i=Array.prototype.map.call(t,e=>e.track);return Array.prototype.map.call(t,function(e){var t=Cr(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===i.indexOf(e)}).map(Cr))}(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return void 0===e&&h.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()&&this.hasStarted(!1),this.trigger("loadstart"),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(t){if(this.tech_&&"string"==typeof t){var i=()=>{const e=this.muted(),t=(this.muted(!0),()=>{this.muted(e)});this.playTerminatedQueue_.push(t);var i=this.play();if(Er(i))return i.catch(e=>{throw t(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(e||""))})};let e;return"any"!==t||this.muted()?e="muted"!==t||this.muted()?this.play():i():Er(e=this.play())&&(e=e.catch(i)),Er(e)?e.then(()=>{this.trigger({type:"autoplay-success",autoplay:t})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:t})}):void 0}}updateSourceCaches_(e=""){let t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=((e,t)=>{if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;const i=e.cache_.sources.filter(e=>e.src===t);if(i.length)return i[0].type;var r=e.$$("source");for(let e=0;e<r.length;e++){const i=r[e];if(i.type&&i.src&&i.src===t)return i.type}return cn(t)})(this,t)),this.cache_.source=u({},e,{src:t,type:i});var e=this.cache_.sources.filter(e=>e.src&&e.src===t),r=[],n=this.$$("source"),s=[];for(let e=0;e<n.length;e++){const i=pi(n[e]);r.push(i),i.src&&i.src===t&&s.push(i.src)}s.length&&!e.length?this.cache_.sources=r:e.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(t){if(!this.changingSrc_){let e=e=>this.updateSourceCaches_(e);var i=this.currentSource().src,r=t.src;(e=i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==i)?()=>{}:e)(r),t.src||this.tech_.any(["sourceset","loadstart"],e=>{"sourceset"!==e.type&&(e=this.techGet("currentSrc"),this.lastSource_.tech=e,this.updateSourceCaches_(e))})}this.lastSource_={player:this.currentSource().src,tech:t.src},this.trigger({src:t.src,type:"sourceset"})}hasStarted(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){!this.controls_||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.click?this.options_.userActions.click.call(this,e):this.paused()?Mr(this.play()):this.pause())}handleTechDoubleClick_(t){!this.controls_||Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),e=>e.contains(t.target))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,t):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(t){t=t.target.player;if(!t||t===this){t=this.el();let e=a()[this.fsApi_.fullscreenElement]===t;!e&&t.matches?e=t.matches(":"+this.fsApi_.fullscreen):!e&&t.msMatchesSelector&&(e=t.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(e)}}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){var e=this.tech_.error();this.error(e)}handleTechTextData_(){let e=1<arguments.length?arguments[1]:null;this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(t,i){this.ready(function(){if(t in an)return e=this.middleware_,this.tech_[t](e.reduce(ln(t),i));var e;if(t in on)return nn(this.middleware_,this.tech_,t,i);try{this.tech_&&this.tech_[t](i)}catch(e){throw h(e),e}},!0)}techGet_(t){if(this.tech_&&this.tech_.isReady_){if(t in sn)return e=this.middleware_,i=this.tech_,e.reduceRight(ln(t),i[t]());if(t in on)return nn(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){throw void 0===this.tech_[t]?h(`Video.js: ${t} method not defined for ${this.techName_} playback technology.`,e):"TypeError"===e.name?(h(`Video.js: ${t} unavailable on ${this.techName_} playback technology element.`,e),this.tech_.isReady_=!1):h(e),e}}var e,i}play(){return new Promise(e=>{this.play_(e)})}play_(e=Mr){this.playCallbacks_.push(e);var t,e=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),this.isReady_&&e?null===(t=this.techGet_("play"))?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(t):(this.waitToPlay_=e=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),e||!Zt&&!f||this.load())}runPlayTerminatedQueue_(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})}runPlayCallbacks_(t){var e=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],e.forEach(function(e){e(t)})}pause(){this.techCall_("pause")}paused(){return!1!==this.techGet_("paused")}played(){return this.techGet_("played")||vr(0,0)}scrubbing(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){return void 0!==e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=(e=parseFloat(e))<0?1/0:e)!==this.cache_.duration&&((this.cache_.duration=e)===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return e=e&&e.length?e:vr(0,0)}bufferedPercent(){return Sr(this.buffered(),this.duration())}bufferedEnd(){var e=this.buffered(),t=this.duration();let i=e.end(e.length-1);return i=i>t?t:i}volume(e){let t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)}muted(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)}defaultMuted(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1}lastVolume_(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){var t;if(void 0===e)return this.isFullscreen_;t=this.isFullscreen_,this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_()}requestFullscreen(a){this.isInPictureInPicture()&&this.exitPictureInPicture();const o=this;return new Promise((e,i)=>{function r(){o.off("fullscreenerror",n),o.off("fullscreenchange",t)}function t(){r(),e()}function n(e,t){r(),i(t)}o.one("fullscreenchange",t),o.one("fullscreenerror",n);var s=o.requestFullscreenHelper_(a);s&&(s.then(r,r),s.then(e,i))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){const e=this.el_[this.fsApi_.requestFullscreen](t);return e&&e.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),e}this.tech_.supportsFullScreen()&&1==!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const a=this;return new Promise((e,i)=>{function r(){a.off("fullscreenerror",n),a.off("fullscreenchange",t)}function t(){r(),e()}function n(e,t){r(),i(t)}a.one("fullscreenchange",t),a.one("fullscreenerror",n);var s=a.exitFullscreenHelper_();s&&(s.then(r,r),s.then(e,i))})}exitFullscreenHelper_(){var e;if(this.fsApi_.requestFullscreen)return(e=a()[this.fsApi_.exitFullscreen]())&&Mr(e.then(()=>this.isFullscreen(!1))),e;this.tech_.supportsFullScreen()&&1==!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=a().documentElement.style.overflow,b(a(),"keydown",this.boundFullWindowOnEscKey_),a().documentElement.style.overflow="hidden",hi(a().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){s().isEventKey(e,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,T(a(),"keydown",this.boundFullWindowOnEscKey_),a().documentElement.style.overflow=this.docOrigOverflow,ui(a().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(void 0===e)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_}requestPictureInPicture(){if("pictureInPictureEnabled"in a()&&!1===this.disablePictureInPicture())return this.techGet_("requestPictureInPicture")}exitPictureInPicture(){if("pictureInPictureEnabled"in a())return a().exitPictureInPicture()}handleKeyDown(e){var t,i,r=this.options_["userActions"];r&&r.hotkeys&&(t=this.el_.ownerDocument.activeElement,i=t.tagName.toLowerCase(),t.isContentEditable||("input"===i?-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(t.type):-1!==["textarea"].indexOf(i))||("function"==typeof r.hotkeys?r.hotkeys.call(this,e):this.handleHotkeys(e)))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:i=e=>s().isEventKey(e,"f"),muteKey:r=e=>s().isEventKey(e,"m"),playPauseKey:n=e=>s().isEventKey(e,"k")||s().isEventKey(e,"Space")}=t;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();const t=S.getComponent("FullscreenToggle");!1!==a()[this.fsApi_.fullscreenEnabled]&&t.prototype.handleClick.call(this,e)}else r.call(this,e)?(e.preventDefault(),e.stopPropagation(),S.getComponent("MuteToggle").prototype.handleClick.call(this,e)):n.call(this,e)&&(e.preventDefault(),e.stopPropagation(),S.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(r){let n;for(let t=0,i=this.options_.techOrder;t<i.length;t++){var s=i[t];let e=M.getTech(s);if(e=e||S.getComponent(s)){if(e.isSupported()&&(n=e.canPlayType(r)))return n}else h.error(`The "${s}" tech is undefined. Skipped browser support check for that tech.`)}return""}selectSource(e){function t(e,i,r){let n;return e.some(t=>i.some(e=>{if(n=r(t,e))return!0})),n}var i,r=this.options_.techOrder.map(e=>[e,M.getTech(e)]).filter(([e,t])=>t?t.isSupported():(h.error(`The "${e}" tech is undefined. Skipped browser support check for that tech.`),!1)),n=([e,t],i)=>{if(t.canPlaySource(i,this.options_[e.toLowerCase()]))return{source:i,tech:e}};return(this.options_.sourceOrder?t(e,r,(i=n,(e,t)=>i(t,e))):t(r,e,n))||!1}handleSrc_(e,r){if(void 0===e)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const n=hn(e);if(n.length){if(this.changingSrc_=!0,r||(this.cache_.sources=n),this.updateSourceCaches_(n[0]),rn(this,n[0],(e,t)=>{if(this.middleware_=t,r||(this.cache_.sources=n),this.updateSourceCaches_(e),this.src_(e))return 1<n.length?this.handleSrc_(n.slice(1)):(this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),void this.triggerReady());var e=t,i=this.tech_;e.forEach(e=>e.setTech&&e.setTech(i))}),1<n.length){const e=()=>{this.error(null),this.handleSrc_(n.slice(1),!0)},r=()=>{this.off("error",e)};this.one("error",e),this.one("playing",r),this.resetRetryOnError_=()=>{this.off("error",e),this.off("playing",r)}}}else this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0)}src(e){return this.handleSrc_(e,!1)}src_(e){var t=this.selectSource([e]);return!t||(pr(t.tech,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1})),!1)}load(){this.techCall_("load")}reset(){this.paused()?this.doReset_():Mr(this.play().then(()=>this.doReset_()))}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),tr(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);var{durationDisplay:e,remainingTimeDisplay:t}=this.controlBar||{};e&&e.updateContent(),t&&t.updateContent()}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")}autoplay(e){if(void 0===e)return this.options_.autoplay||!1;let t;"string"==typeof e&&/(any|play|muted)/.test(e)||!0===e&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_("string"==typeof e?e:"play"),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")}loop(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")}poster(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){var e;(!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster&&(e=this.tech_.poster()||"")!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}controls(e){if(void 0===e)return!!this.controls_;this.controls_!==(e=!!e)&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(void 0===e)return!!this.usingNativeControls_;this.usingNativeControls_!==(e=!!e)&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(t){if(void 0===t)return this.error_||null;if(Tt("beforeerror").forEach(e=>{e=e(this,t);Pt(e)&&!Array.isArray(e)||"string"==typeof e||"number"==typeof e||null===e?t=e:this.log.error("please return a value that MediaError expects in beforeerror hooks")}),this.options_.suppressNotSupportedError&&t&&4===t.code){const e=function(){this.error(t)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],e),void this.one("loadstart",function(){this.off(["click","touchstart"],e)})}else null===t?(this.error_=t,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close()):(this.error_=new n(t),this.addClass("vjs-error"),h.error(`(CODE:${this.error_.code} ${n.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Tt("error").forEach(e=>e(this,this.error_)))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(void 0===e)return this.userActive_;(e=!!e)!==this.userActive_&&(this.userActive_=e,this.userActive_?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")))}listenForUserActivity_(){let t,i,r;function e(e){n(),this.clearInterval(t)}const n=x(this,this.reportUserActivity);this.on("mousedown",function(){n(),this.clearInterval(t),t=this.setInterval(n,250)}),this.on("mousemove",function(e){e.screenX===i&&e.screenY===r||(i=e.screenX,r=e.screenY,n())}),this.on("mouseup",e),this.on("mouseleave",e);var s=this.getChild("controlBar");let a;!s||f||Bt||(s.on("mouseenter",function(e){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),s.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",n),this.on("keyup",n),this.setInterval(function(){var e;this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a),(e=this.options_.inactivityTimeout)<=0||(a=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e)))},250)}playbackRate(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)}defaultPlaybackRate(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),i=t&&t.currentHeight();e.forEach(e=>{e!==t&&e.el_&&!e.hasClass("vjs-hidden")&&(e.hide(),this.audioOnlyCache_.hiddenChildren.push(e))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(i),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if("boolean"!=typeof e||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e){const e=[];return this.isInPictureInPicture()&&e.push(this.exitPictureInPicture()),this.isFullscreen()&&e.push(this.exitFullscreen()),this.audioPosterMode()&&e.push(this.audioPosterMode(!1)),Promise.all(e).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return"boolean"!=typeof e||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e)?(this.audioOnlyMode()?this.audioOnlyMode(!1):Promise.resolve()).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()})}addTextTrack(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let t=e["track"];if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(void 0===e)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),tr(this))&&this.trigger("languagechange")}languages(){return u(A.prototype.options_.languages,this.languages_)}toJSON(){var t=u(this.options_),i=t.tracks;t.tracks=[];for(let e=0;e<i.length;e++){var r=i[e];(r=u(r)).player=void 0,t.tracks[e]=r}return t}createModal(e,t){(t=t||{}).content=e||"";const i=new Lr(this,t);return this.addChild(i),i.on("dispose",()=>{this.removeChild(i)}),i.open(),i}updateCurrentBreakpoint_(){if(this.responsive()){var t=this.currentBreakpoint(),i=this.currentWidth();for(let e=0;e<Rs.length;e++){var r=Rs[e];if(i<=this.breakpoints_[r]){if(t===r)return;t&&this.removeClass(ks[t]),this.addClass(ks[r]),this.breakpoint_=r;break}}}}removeCurrentBreakpoint_(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return void 0!==e&&(this.breakpoint_="",this.breakpoints_=Object.assign({},Ds,e),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}responsive(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return ks[this.breakpoint_]||""}loadMedia(e,t){var i,r,n,s,a,o;e&&"object"==typeof e&&(this.reset(),this.cache_.media=u(e),{artist:e,artwork:i,description:r,poster:n,src:s,textTracks:a,title:o}=this.cache_.media,!i&&n&&(this.cache_.media.artwork=[{src:n,type:cn(n)}]),s&&this.src(s),n&&this.poster(n),Array.isArray(a)&&a.forEach(e=>this.addRemoteTextTrack(e,!1)),this.titleBar&&this.titleBar.update({title:o,description:r||e||""}),this.ready(t))}getMedia(){var e,t;return this.cache_.media?u(this.cache_.media):(e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),e=>({kind:e.kind,label:e.label,language:e.language,src:e.src}))},e&&(t.poster=e,t.artwork=[{src:t.poster,type:cn(t.poster)}]),t)}static getTagSettings(e){const i={sources:[],tracks:[]},r=pi(e),n=r["data-setup"];if(li(e,"vjs-fill")&&(r.fill=!0),li(e,"vjs-fluid")&&(r.fluid=!0),null!==n){const[e,i]=t()(n||"{}");e&&h.error(e),Object.assign(r,i)}if(Object.assign(i,r),e.hasChildNodes()){const r=e.childNodes;for(let e=0,t=r.length;e<t;e++){const n=r[e],s=n.nodeName.toLowerCase();"source"===s?i.sources.push(pi(n)):"track"===s&&i.tracks.push(pi(n))}}return i}debug(e){if(void 0===e)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(void 0===e)return this.cache_.playbackRates;Array.isArray(e)&&e.every(e=>"number"==typeof e)&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}E.names.forEach(function(e){const t=E[e];A.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),A.prototype.crossorigin=A.prototype.crossOrigin,A.players={};var Os=v().navigator;A.prototype.options_={techOrder:M.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Os&&(Os.languages&&Os.languages[0]||Os.userLanguage||Os.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){A.prototype[e]=function(){return this.techGet_(e)}}),Is.forEach(function(e){A.prototype[`handleTech${w(e)}_`]=function(){return this.trigger(e)}}),S.registerComponent("Player",A);const Ns="plugin",Us="activePlugins_",Bs={},Fs=e=>Bs.hasOwnProperty(e),Hs=e=>Fs(e)?Bs[e]:void 0,zs=(e,t)=>{e[Us]=e[Us]||{},e[Us][t]=!0},Vs=(e,t,i)=>{i=(i?"before":"")+"pluginsetup";e.trigger(i,t),e.trigger(i+":"+t.name,t)},Gs=(i,r)=>(r.prototype.name=i,function(...e){Vs(this,{name:i,plugin:r,instance:null},!0);const t=new r(this,...e);return this[i]=()=>t,Vs(this,t.getEventHash()),t});class L{constructor(e){if(this.constructor===L)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),hr(this),delete this.trigger,cr(this,this.constructor.defaultState),zs(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return ji(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){var{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[Us][e]=!1,this.player=this.state=null,t[e]=Gs(e,Bs[e])}static isBasic(e){e="string"==typeof e?Hs(e):e;return"function"==typeof e&&!L.prototype.isPrototypeOf(e.prototype)}static registerPlugin(e,t){if("string"!=typeof e)throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Fs(e))h.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(A.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if("function"!=typeof t)throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return Bs[e]=t,e!==Ns&&(L.isBasic(t)?A.prototype[e]=(r=e,n=t,Object.keys(n).forEach(function(e){i[e]=n[e]}),i):A.prototype[e]=Gs(e,t)),t;function i(){Vs(this,{name:r,plugin:n,instance:null},!0);var e=n.apply(this,arguments);return zs(this,r),Vs(this,{name:r,plugin:n,instance:e}),e}var r,n}static deregisterPlugin(e){if(e===Ns)throw new Error("Cannot de-register base plugin.");Fs(e)&&(delete Bs[e],delete A.prototype[e])}static getPlugins(e=Object.keys(Bs)){let i;return e.forEach(e=>{var t=Hs(e);t&&((i=i||{})[e]=t)}),i}static getPluginVersion(e){e=Hs(e);return e&&e.VERSION||""}}function Ws(e,i,r,n){{var s=i+` is deprecated and will be removed in ${e}.0; please use ${r} instead.`,a=n;let t=!1;return function(...e){return t||h.warn(s),t=!0,a.apply(this,e)}}}L.getPlugin=Hs,L.BASE_PLUGIN_NAME=Ns,L.registerPlugin(Ns,L),A.prototype.usingPlugin=function(e){return!!this[Us]&&!0===this[Us][e]},A.prototype.hasPlugin=function(e){return!!Fs(e)};const js=e=>0===e.indexOf("#")?e.slice(1):e;function I(e,t,i){let r=I.getPlayer(e);if(r)t&&h.warn(`Player "${e}" is already initialised. Options will not be applied.`),i&&r.ready(i);else{const n="string"==typeof e?Ai("#"+js(e)):e;if(!ii(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");n.ownerDocument.defaultView&&n.ownerDocument.body.contains(n)||h.warn("The element supplied is not included in the DOM"),!0===(t=t||{}).restoreEl&&(t.restoreEl=(n.parentNode&&n.parentNode.hasAttribute("data-vjs-player")?n.parentNode:n).cloneNode(!0)),Tt("beforesetup").forEach(e=>{e=e(n,u(t));Pt(e)&&!Array.isArray(e)?t=u(t,e):h.error("please return an object in beforesetup hooks")});e=S.getComponent("Player");r=new e(n,t,i),Tt("setup").forEach(e=>e(r))}return r}if((I.hooks_=bt,I.hooks=Tt,I.hook=function(e,t){Tt(e,t)},I.hookOnce=function(r,e){Tt(r,[].concat(e).map(t=>{const i=(...e)=>(_t(r,i),t(...e));return i}))},I.removeHook=_t,!0!==v().VIDEOJS_NO_DYNAMIC_STYLE&&ti())&&!Ai(".vjs-styles-defaults")){Os=Ui("vjs-styles-defaults");const e=Ai("head");e&&e.insertBefore(Os,e.firstChild),Bi(Os,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}Oi(1,I),I.VERSION="8.0.4",I.options=A.prototype.options_,I.getPlayers=()=>A.players,I.getPlayer=e=>{var t=A.players;let i;if("string"==typeof e){var r=js(e),n=t[r];if(n)return n;i=Ai("#"+r)}else i=e;if(ii(i)){const{player:e,playerId:s}=i;if(e||t[s])return e||t[s]}},I.getAllPlayers=()=>Object.keys(A.players).map(e=>A.players[e]).filter(Boolean),I.players=A.players,I.getComponent=S.getComponent,I.registerComponent=(e,t)=>{M.isTech(t)&&h.warn(`The ${e} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),S.registerComponent.call(S,e,t)},I.getTech=M.getTech,I.registerTech=M.registerTech,I.use=function(e,t){Qr[e]=Qr[e]||[],Qr[e].push(t)},Object.defineProperty(I,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(I.middleware,"TERMINATOR",{value:tn,writeable:!1,enumerable:!0}),I.browser=Qt,I.obj=e,I.mergeOptions=Ws(9,"videojs.mergeOptions","videojs.obj.merge",u),I.defineLazyProperty=Ws(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",kt),I.bind=Ws(9,"videojs.bind","native Function.prototype.bind",x),I.registerPlugin=L.registerPlugin,I.deregisterPlugin=L.deregisterPlugin,I.plugin=(e,t)=>(h.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),L.registerPlugin(e,t)),I.getPlugins=L.getPlugins,I.getPlugin=L.getPlugin,I.getPluginVersion=L.getPluginVersion,I.addLanguage=function(e,t){return e=(""+e).toLowerCase(),I.options.languages=u(I.options.languages,{[e]:t}),I.options.languages[e]},I.log=h,I.createLogger=Ct,I.time=wr,I.createTimeRange=Ws(9,"videojs.createTimeRange","videojs.time.createTimeRanges",vr),I.createTimeRanges=Ws(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",vr),I.formatTime=Ws(9,"videojs.formatTime","videojs.time.formatTime",xr),I.setFormatTime=Ws(9,"videojs.setFormatTime","videojs.time.setFormatTime",br),I.resetFormatTime=Ws(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Tr),I.parseUrl=Ws(9,"videojs.parseUrl","videojs.url.parseUrl",Hr),I.isCrossOrigin=Ws(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",Gr),I.EventTarget=Qi,I.any=Xi,I.on=b,I.one=qi,I.off=T,I.trigger=ji,I.xhr=N(),I.TextTrack=Xr,I.AudioTrack=Yr,I.VideoTrack=$r,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(e=>{I[e]=function(){return h.warn(`videojs.${e}() is deprecated; use videojs.dom.${e}() instead`),Pi[e].apply(null,arguments)}}),I.computedStyle=Ws(9,"videojs.computedStyle","videojs.dom.computedStyle",Ii),I.dom=Pi,I.fn=Ji,I.num=Cn,I.str=fr,I.url=Wr;class qs{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get:()=>t.enabled_(),set(e){t.enabled_(e)}}),t}}class Xs extends I.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get:()=>e.selectedIndex_}),Object.defineProperty(e,"length",{get:()=>e.levels_.length}),e}addQualityLevel(e){var t=this.getQualityLevelById(e.id);if(!t){const i=this.levels_.length;t=new qs(e),""+i in this||Object.defineProperty(this,i,{get(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"})}return t}removeQualityLevel(i){let r=null;for(let e=0,t=this.length;e<t;e++)if(this[e]===i){r=this.levels_.splice(e,1)[0],this.selectedIndex_===e?this.selectedIndex_=-1:this.selectedIndex_>e&&this.selectedIndex_--;break}return r&&this.trigger({qualityLevel:i,type:"removequalitylevel"}),r}getQualityLevelById(i){for(let e=0,t=this.length;e<t;e++){var r=this[e];if(r.id===i)return r}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Xs.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const i in Xs.prototype.allowedEvents_)Xs.prototype["on"+i]=null;function Ys(e){{var t=this;I.mergeOptions({},e);const i=t.qualityLevels,r=new Xs,n=function(){r.dispose(),t.qualityLevels=i,t.off("dispose",n)};return t.on("dispose",n),t.qualityLevels=()=>r,t.qualityLevels.VERSION="3.0.0",r}}(I.registerPlugin||I.plugin)("qualityLevels",Ys),Ys.VERSION="3.0.0";const $s=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=v().location&&v().location.href||"");var i="function"==typeof v().URL,r=/^\/\//.test(e),n=!v().location&&!/\/\//i.test(e);return i?e=new(v().URL)(e,v().location||"http://example.com"):/\/\//i.test(e)||(e=B().buildAbsoluteURL(v().location&&v().location.href||"",e)),i?(i=new URL(t,e),n?i.href.slice(18):r?i.href.slice(i.protocol.length):i.href):B().buildAbsoluteURL(e,t)},Ks=(e,t)=>t&&t.responseURL&&e!==t.responseURL?t.responseURL:e,Js=e=>I.log.debug?I.log.debug.bind(I,"VHS:",e+" >"):function(){};function P(...e){var t=I.obj||I;return(t.merge||t.mergeOptions).apply(t,e)}function R(...e){var t=I.time||I;return(t.createTimeRanges||t.createTimeRanges).apply(t,e)}function Zs(e,t){var i=[];let r;if(e&&e.length)for(r=0;r<e.length;r++)t(e.start(r),e.end(r))&&i.push([e.start(r),e.end(r)]);return R(i)}function Qs(e,i){return Zs(e,function(e,t){return e-.1<=i&&i<=t+.1})}function ea(e,t){return Zs(e,function(e){return e-da>=t})}function ta(e){if(e&&e.length&&e.end)return e.end(e.length-1)}function ia(t,i){let r=0;if(t&&t.length)for(let e=0;e<t.length;e++){var n=t.start(e),s=t.end(e);s<i||(r+=n<i&&i<=s?s-i:s-n)}return r}function ra(e,n,t){var i;return(n=void 0===n?e.mediaSequence+e.segments.length:n)<e.mediaSequence?0:(i=function(e){let t=0,i=n-e.mediaSequence,r=e.segments[i];if(r){if(void 0!==r.start)return{result:r.start,precise:!0};if(void 0!==r.end)return{result:r.end-r.duration,precise:!0}}for(;i--;){if(void 0!==(r=e.segments[i]).end)return{result:t+r.end,precise:!0};if(t+=ma(e,r),void 0!==r.start)return{result:t+r.start,precise:!0}}return{result:t,precise:!1}}(e)).precise?i.result:(e=function(e){let t,i=0,r=n-e.mediaSequence;for(;r<e.segments.length;r++){if(void 0!==(t=e.segments[r]).start)return{result:t.start-i,precise:!0};if(i+=ma(e,t),void 0!==t.end)return{result:t.end-i,precise:!0}}return{result:-1,precise:!1}}(e)).precise?e.result:i.result+t}function na(e,t,i){if(!e)return 0;if("number"!=typeof i&&(i=0),void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return v()[1/0]}return ra(e,t,i)}function sa({defaultDuration:t,durationList:i,startIndex:r,endIndex:n}){let s=0;if(n<r&&([r,n]=[n,r]),r<0){for(let e=r;e<Math.min(0,n);e++)s+=t;r=0}for(let e=r;e<n;e++)s+=i[e].duration;return s}function aa(e,t,i,r){if(!e||!e.segments)return null;if(e.endList)return na(e);if(null===t)return null;t=t||0;let n=ra(e,e.mediaSequence+e.segments.length,t);return i&&(n-=r="number"==typeof r?r:_a(null,e)),Math.max(0,n)}function oa(e){return e.excludeUntil&&e.excludeUntil>Date.now()}function la(e){return e.excludeUntil&&e.excludeUntil===1/0}function ha(e){var t=oa(e);return!e.disabled&&!t}function ua(e,t){return t.attributes&&t.attributes[e]}function ca(e,t){var i=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{};let r=!1;for(const e in i){for(const n in i[e])if(r=t(i[e][n]),r)break;if(r)break}return!!r}const da=1/30,pa=t=>{var i=[];if(!t||!t.length)return"";for(let e=0;e<t.length;e++)i.push(t.start(e)+" => "+t.end(e));return i.join(", ")},fa=t=>{var i=[];for(let e=0;e<t.length;e++)i.push({start:t.start(e),end:t.end(e)});return i},ma=(t,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(e){i+=e.duration}),(e.preloadHints||[]).forEach(function(e){"PART"===e.type&&(i+=t.partTargetDuration)}),i},ga=e=>(e.segments||[]).reduce((i,r,n)=>(r.parts?r.parts.forEach(function(e,t){i.push({duration:e.duration,segmentIndex:n,partIndex:t,part:e,segment:r})}):i.push({duration:r.duration,segmentIndex:n,partIndex:null,segment:r,part:null}),i),[]),va=e=>{e=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return e&&e.parts||[]},ya=({preloadSegment:e})=>{var t;if(e)return{parts:e,preloadHints:t}=e,(t||[]).reduce((e,t)=>e+("PART"===t.type?1:0),0)+(e&&e.length?e.length:0)},_a=(e,t)=>{return t.endList?0:e&&e.suggestedPresentationDelay?e.suggestedPresentationDelay:(e=0<va(t).length)&&t.serverControl&&t.serverControl.partHoldBack?t.serverControl.partHoldBack:e&&t.partTargetDuration?3*t.partTargetDuration:t.serverControl&&t.serverControl.holdBack?t.serverControl.holdBack:t.targetDuration?3*t.targetDuration:0},ba=(e,t)=>{if(1===e.playlists.length)return!0;const i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(e=>!!ha(e)&&(e.attributes.BANDWIDTH||0)<i).length},Ta=(e,t)=>!(!e&&!t||!e&&t||e&&!t||e!==t&&(!e.id||!t.id||e.id!==t.id)&&(!e.resolvedUri||!t.resolvedUri||e.resolvedUri!==t.resolvedUri)&&(!e.uri||!t.uri||e.uri!==t.uri)),xa=t=>{if(!t||!t.playlists||!t.playlists.length)return ca(t,e=>e.playlists&&e.playlists.length||e.uri);for(let e=0;e<t.playlists.length;e++){const i=t.playlists[e],r=i.attributes&&i.attributes.CODECS;if(!(r&&r.split(",").every(e=>le(e))||ca(t,e=>Ta(i,e))))return!1}return!0};var k={liveEdgeDelay:_a,duration:na,seekable:function(e,t,i){var r=t||0,e=aa(e,t,!0,i);return null===e?R():R(r,e)},getMediaInfoForTime:function({playlist:t,currentTime:i,startingSegmentIndex:r,startingPartIndex:n,startTime:s,exactManifestTimings:a}){let o=i-s;var l=ga(t);let h=0;for(let e=0;e<l.length;e++){const i=l[e];if(r===i.segmentIndex&&("number"!=typeof n||"number"!=typeof i.partIndex||n===i.partIndex)){h=e;break}}if(o<0){if(0<h)for(let e=h-1;0<=e;e--){const r=l[e];if(o+=r.duration,a){if(o<0)continue}else if(o+da<=0)continue;return{partIndex:r.partIndex,segmentIndex:r.segmentIndex,startTime:s-sa({defaultDuration:t.targetDuration,durationList:l,startIndex:h,endIndex:e})}}return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:i}}if(h<0){for(let e=h;e<0;e++)if((o-=t.targetDuration)<0)return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:i};h=0}for(let e=h;e<l.length;e++){const r=l[e];if(o-=r.duration,a){if(0<o)continue}else if(0<=o-da)continue;return{partIndex:r.partIndex,segmentIndex:r.segmentIndex,startTime:s+sa({defaultDuration:t.targetDuration,durationList:l,startIndex:h,endIndex:e})}}return{segmentIndex:l[l.length-1].segmentIndex,partIndex:l[l.length-1].partIndex,startTime:i}},isEnabled:ha,isDisabled:function(e){return e.disabled},isExcluded:oa,isIncompatible:la,playlistEnd:aa,isAes:function(t){for(let e=0;e<t.segments.length;e++)if(t.segments[e].key)return!0;return!1},hasAttribute:ua,estimateSegmentRequestTime:function(e,t,i,r=0){return ua("BANDWIDTH",i)?(e*i.attributes.BANDWIDTH-8*r)/t:NaN},isLowestEnabledRendition:ba,isAudioOnly:xa,playlistMatch:Ta,segmentDurationWithParts:ma};function wa(e){var t=e.segments||[],i=e.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints)for(let e=0;e<i.preloadHints.length;e++)if("MAP"===i.preloadHints[e].type)return t;i.duration=e.targetDuration,i.preload=!0,t.push(i)}return t}const Sa=I["log"],Ea=(n,s)=>{n.mediaGroups&&["AUDIO","SUBTITLES"].forEach(e=>{if(n.mediaGroups[e])for(const i in n.mediaGroups[e])for(const r in n.mediaGroups[e][i]){var t=n.mediaGroups[e][i][r];s(t,e,i,r)}})},Ma=({playlist:e,uri:t,id:i})=>{e.id=i,e.playlistErrors_=0,t&&(e.uri=t),e.attributes=e.attributes||{}},Ca=(s,e)=>{s.uri=e;for(let e=0;e<s.playlists.length;e++)if(!s.playlists[e].uri){const a="placeholder-uri-"+e;s.playlists[e].uri=a}const a=xa(s);Ea(s,(e,t,i,r)=>{const n=`placeholder-uri-${t}-${i}-`+r;if(!e.playlists||!e.playlists.length){if(a&&"AUDIO"===t&&!e.uri)for(let e=0;e<s.playlists.length;e++){const a=s.playlists[e];if(a.attributes&&a.attributes.AUDIO&&a.attributes.AUDIO===i)return}e.playlists=[F({},e)]}e.playlists.forEach(function(e,t){var i=t+"-"+n;e.uri?e.resolvedUri=e.resolvedUri||$s(s.uri,e.uri):(e.uri=0===t?n:i,e.resolvedUri=e.uri),e.id=e.id||i,e.attributes=e.attributes||{},s.playlists[e.id]=e,s.playlists[e.uri]=e})});{var t=s;let e=t.playlists.length;for(;e--;){var i=t.playlists[e];Ma({playlist:i,id:e+"-"+i.uri}),i.resolvedUri=$s(t.uri,i.uri),t.playlists[i.id]=i,(t.playlists[i.uri]=i).attributes.BANDWIDTH||Sa.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}var r;r=s,Ea(r,e=>{e.uri&&(e.resolvedUri=$s(r.uri,e.uri))})},Aa=I["EventTarget"],La=(e,t)=>{!e.resolvedUri&&e.uri&&(e.resolvedUri=$s(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=$s(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=$s(t,e.map.uri)),e.map&&e.map.key&&!e.map.key.resolvedUri&&(e.map.key.resolvedUri=$s(t,e.map.key.uri)),e.parts&&e.parts.length&&e.parts.forEach(e=>{e.resolvedUri||(e.resolvedUri=$s(t,e.uri))}),e.preloadHints&&e.preloadHints.length&&e.preloadHints.forEach(e=>{e.resolvedUri||(e.resolvedUri=$s(t,e.uri))})},Ia=(e,t)=>e===t||e.segments&&t.segments&&e.segments.length===t.segments.length&&e.endList===t.endList&&e.mediaSequence===t.mediaSequence&&e.preloadSegment===t.preloadSegment,Pa=(e,n,t=Ia)=>{var i=P(e,{}),r=i.playlists[n.id];if(!r)return null;if(t(r,n))return null;n.segments=wa(n);const s=P(r,n);if(s.preloadSegment&&!n.preloadSegment&&delete s.preloadSegment,r.segments){if(n.skip){n.segments=n.segments||[];for(let e=0;e<n.skip.skippedSegments;e++)n.segments.unshift({skipped:!0})}s.segments=((e,t,i)=>{var r=e.slice(),n=t.slice(),s=(i=i||0,[]);let a;for(let e=0;e<n.length;e++){const t=r[e+i],o=n[e];t?(a=t.map||a,s.push(((t,i)=>{if(!t)return i;var r=P(t,i);if(t.preloadHints&&!i.preloadHints&&delete r.preloadHints,t.parts&&!i.parts)delete r.parts;else if(t.parts&&i.parts)for(let e=0;e<i.parts.length;e++)t.parts&&t.parts[e]&&(r.parts[e]=P(t.parts[e],i.parts[e]));return!t.skipped&&i.skipped&&(r.skipped=!1),t.preload&&!i.preload&&(r.preload=!1),r})(t,o))):(a&&!o.map&&(o.map=a),s.push(o))}return s})(r.segments,n.segments,n.mediaSequence-r.mediaSequence)}s.segments.forEach(e=>{La(e,s.resolvedUri)});for(let e=0;e<i.playlists.length;e++)i.playlists[e].id===n.id&&(i.playlists[e]=s);return i.playlists[n.id]=s,i.playlists[n.uri]=s,Ea(e,(t,e,i,r)=>{if(t.playlists)for(let e=0;e<t.playlists.length;e++)n.id===t.playlists[e].id&&(t.playlists[e]=s)}),i},Ra=(e,t)=>{var i=e.segments||[],i=i[i.length-1],r=i&&i.parts&&i.parts[i.parts.length-1],r=r&&r.duration||i&&i.duration;return t&&r?1e3*r:500*(e.partTargetDuration||e.targetDuration||10)};class ka extends Aa{constructor(e,t,i={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Js("PlaylistLoader");var{withCredentials:i=!1}=i,e=(this.src=e,this.vhs_=t,this.withCredentials=i,t.options_);this.customTagParsers=e&&e.customTagParsers||[],this.customTagMappers=e&&e.customTagMappers||[],this.llhls=e&&e.llhls,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if("HAVE_METADATA"===this.state){var t=this.media();let e=$s(this.main.uri,t.uri);this.llhls&&(e=((t,i)=>{if(!i.endList&&i.serverControl){const r={};if(i.serverControl.canBlockReload){const t=i["preloadSegment"];let e=i.mediaSequence+i.segments.length;if(t){const v=t.parts||[],n=ya(i)-1;-1<n&&n!=v.length-1&&(r._HLS_part=n),(-1<n||v.length)&&e--}r._HLS_msn=e}if(i.serverControl&&i.serverControl.canSkipUntil&&(r._HLS_skip=i.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(r).length){const i=new(v().URL)(t);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(e){r.hasOwnProperty(e)&&i.searchParams.set(e,r[e])}),t=i.toString()}}return t})(e,t)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:e,withCredentials:this.withCredentials},(e,t)=>{if(this.request)return e?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):void this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})})}}playlistRequestError(e,t,i){var{uri:t,id:r}=t;this.request=null,i&&(this.state=i),this.error={playlist:this.main.playlists[r],status:e.status,message:`HLS playlist request error at URL: ${t}.`,responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")}parseManifest_({url:t,manifestString:i}){{var[{onwarn:i,oninfo:e,manifestString:r,customTagParsers:n=[],customTagMappers:s=[],llhls:a}]=[{onwarn:({message:e})=>this.logger_(`m3u8-parser warn for ${t}: `+e),oninfo:({message:e})=>this.logger_(`m3u8-parser info for ${t}: `+e),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls}];const o=new K,l=(i&&o.on("warn",i),e&&o.on("info",e),n.forEach(e=>o.addParser(e)),s.forEach(e=>o.addTagMapper(e)),o.push(r),o.end(),o.manifest);if(a||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(e){l.hasOwnProperty(e)&&delete l[e]}),l.segments&&l.segments.forEach(function(t){["parts","preloadHints"].forEach(function(e){t.hasOwnProperty(e)&&delete t[e]})})),!l.targetDuration){let e=10;l.segments&&l.segments.length&&(e=l.segments.reduce((e,t)=>Math.max(e,t.duration),0)),i&&i("manifest has no targetDuration defaulting to "+e),l.targetDuration=e}if((n=va(l)).length&&!l.partTargetDuration){const e=n.reduce((e,t)=>Math.max(e,t.duration),0);i&&(i("manifest has no partTargetDuration defaulting to "+e),Sa.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),l.partTargetDuration=e}return l}}haveMetadata({playlistString:e,playlistObject:t,url:i,id:r}){this.request=null,this.state="HAVE_METADATA";t=t||this.parseManifest_({url:i,manifestString:e}),t.lastRequest=Date.now(),Ma({playlist:t,uri:i,id:r}),e=Pa(this.main,t);this.targetDuration=t.partTargetDuration||t.targetDuration,this.pendingMedia_=null,e?(this.main=e,this.media_=this.main.playlists[r]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Ra(this.media(),!!e)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),v().clearTimeout(this.mediaUpdateTimeout),v().clearTimeout(this.finalRenditionTimeout),this.off()}stopRequest(){var e;this.request&&(e=this.request,this.request=null,e.onreadystatechange=null,e.abort())}media(i,e){if(!i)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof i){if(!this.main.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.main.playlists[i]}if(v().clearTimeout(this.finalRenditionTimeout),e){const e=(i.partTargetDuration||i.targetDuration)/2*1e3||5e3;void(this.finalRenditionTimeout=v().setTimeout(this.media.bind(this,i,!1),e))}else{const r=this.state,t=!this.media_||i.id!==this.media_.id,n=this.main.playlists[i.id];if(n&&n.endList||i.endList&&i.segments.length)this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=i,t&&(this.trigger("mediachanging"),"HAVE_MAIN_MANIFEST"===r?this.trigger("loadedmetadata"):this.trigger("mediachange"));else if(this.updateMediaUpdateTimeout_(Ra(i,!0)),t){if(this.state="SWITCHING_MEDIA",this.request){if(i.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=i,this.request=this.vhs_.xhr({uri:i.resolvedUri,withCredentials:this.withCredentials},(e,t)=>{if(this.request){if(i.lastRequest=Date.now(),i.resolvedUri=Ks(i.resolvedUri,t),e)return this.playlistRequestError(this.request,i,r);this.haveMetadata({playlistString:t.responseText,url:i.uri,id:i.id}),"HAVE_MAIN_MANIFEST"===r?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}}pause(){this.mediaUpdateTimeout&&(v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var t=this.media();if(e){const e=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=v().setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},e)}else this.started?t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=v().setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){this.started=!0,"object"==typeof this.src?(this.src.uri||(this.src.uri=v().location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0)):this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,t)=>{if(this.request){if(this.request=null,e)return this.error={status:t.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:t.responseText,code:2},"HAVE_NOTHING"===this.state&&(this.started=!1),this.trigger("error");this.src=Ks(this.src,t);e=this.parseManifest_({manifestString:t.responseText,url:this.src});this.setupInitialPlaylist(e)}})}srcUri(){return"string"==typeof this.src?this.src:this.src.uri}setupInitialPlaylist(e){var t,i,r,n;this.state="HAVE_MAIN_MANIFEST",e.playlists?(this.main=e,Ca(this.main,this.srcUri()),e.playlists.forEach(t=>{t.segments=wa(t),t.segments.forEach(e=>{La(e,t.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0])):(t=this.srcUri()||v().location.href,this.main=(r="0-"+(i=t),(n={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:v().location.href,resolvedUri:v().location.href,playlists:[{uri:i,id:r,resolvedUri:i,attributes:{}}]}).playlists[r]=n.playlists[0],n.playlists[i]=n.playlists[0],n),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata"))}}function Da(e,t,i,r){var n="arraybuffer"===e.responseType?e.response:e.responseText;!t&&n&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=n.byteLength||n.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),i.headers&&(e.responseHeaders=i.headers),t&&"ETIMEDOUT"===t.code&&(e.timedout=!0),r(t=t||e.aborted||200===i.statusCode||206===i.statusCode||0===i.statusCode?t:new Error("XHR Failed with a response of: "+(e&&(n||e.responseText))),e)}function Oa(){function a(e,i){e=P({timeout:45e3},e);var t=a.beforeRequest||I.Vhs.xhr.beforeRequest;if(t&&"function"==typeof t){const s=t(e);s&&(e=s)}const r=(!0===I.Vhs.xhr.original?za:I.Vhs.xhr)(e,function(e,t){return Da(r,e,t,i)}),n=r.abort;return r.abort=function(){return r.aborted=!0,n.apply(r,arguments)},r.uri=e.uri,r.requestTime=Date.now(),r}return a.original=!0,a}function Na(e){var t={};return e.byterange&&(t.Range="bytes="+(e=e.byterange).offset+"-"+("bigint"==typeof e.offset||"bigint"==typeof e.length?v().BigInt(e.offset)+v().BigInt(e.length)-v().BigInt(1):e.offset+e.length-1)),t}function Ua(e,t){return e=e.toString(16),"00".substring(0,2-e.length)+e+(t%2?" ":"")}function Ba(e){return 32<=e&&e<126?String.fromCharCode(e):"."}function Fa(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}function Ha(e){return e.resolvedUri}const za=I["xhr"],Va=function(i){const r={};return Object.keys(i).forEach(e=>{var t=i[e];ie(t)?r[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:r[e]=t}),r},Ga=e=>{var t=Array.prototype.slice.call(e);let i,r,n="";for(let e=0;e<t.length/16;e++)i=t.slice(16*e,16*e+16).map(Ua).join(""),r=t.slice(16*e,16*e+16).map(Ba).join(""),n+=i+" "+r+"\n";return n};Os=Object.freeze({__proto__:null,createTransferableMessage:Va,initSegmentId:Fa,segmentKeyId:Ha,hexDump:Ga,tagDump:({bytes:e})=>Ga(e),textRanges:e=>{let t,i="";for(t=0;t<e.length;t++)i+=(r=e,n=t,r.start(n)+"-"+r.end(n)+" ");var r,n;return i}});function Wa(t,i){if(!Ia(t,i))return!1;if(t.sidx&&i.sidx&&(t.sidx.offset!==i.sidx.offset||t.sidx.length!==i.sidx.length))return!1;if(!t.sidx&&i.sidx||t.sidx&&!i.sidx)return!1;if(t.segments&&!i.segments||!t.segments&&i.segments)return!1;if(t.segments||i.segments)for(let e=0;e<t.segments.length;e++){var r=t.segments[e],n=i.segments[e];if(r.uri!==n.uri)return!1;if(r.byterange||n.byterange){r=r.byterange,n=n.byterange;if(r&&!n||!r&&n)return!1;if(r.offset!==n.offset||r.length!==n.length)return!1}}return!0}const ja=({programTime:e,playlist:t,retryCount:i=2,seekTo:r,pauseAfterSeek:n=!0,tech:s,callback:a})=>{var o,l,h;if(a)return void 0!==e&&t&&r?t.endList||s.hasStarted_?(t=>{if(!t.segments||0===t.segments.length)return!1;for(let e=0;e<t.segments.length;e++)if(!t.segments[e].dateTimeObject)return!1;return!0})(t)?(h=((e,t)=>{let i;try{i=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;let r=t.segments[0];if(i<r.dateTimeObject)return null;for(let e=0;e<t.segments.length-1&&(r=t.segments[e],!(i<t.segments[e+1].dateTimeObject));e++);var n=t.segments[t.segments.length-1],s=n.dateTimeObject,a=n.videoTimingInfo?(a=n.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:n.duration+.25*n.duration;return i>new Date(s.getTime()+1e3*a)?null:{segment:r=i>s?n:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:k.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"}})(e,t))?(l=((e,t)=>{let i,r;try{i=new Date(e),r=new Date(t)}catch(e){}t=i.getTime();return(r.getTime()-t)/1e3})((o=h.segment).dateTimeObject,e),"estimate"===h.type?0===i?a({message:e+" is not buffered yet. Try again"}):(r(h.estimatedStart+l),void s.one("seeked",()=>{ja({programTime:e,playlist:t,retryCount:i-1,seekTo:r,pauseAfterSeek:n,tech:s,callback:a})})):(h=o.start+l,s.one("seeked",()=>a(null,s.currentTime())),n&&s.pause(),void r(h))):a({message:e+" was not found in the stream"}):a({message:"programDateTime tags must be provided in the manifest "+t.resolvedUri}):a({message:"player must be playing a live stream to start buffering"}):a({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});throw new Error("seekToProgramTime: callback must be provided")},qa=(e,t)=>{if(4===e.readyState)return t()},Xa=I["EventTarget"],Ya=(e,t)=>{var i={};for(const s in e){var r=e[s].sidx;if(r){const e=Ie(r);if(!t[e])break;var n=t[e].sidxInfo;n=n,r=r,(Boolean(!n.map&&!r.map)||Boolean(n.map&&r.map&&n.map.byterange.offset===r.map.byterange.offset&&n.map.byterange.length===r.map.byterange.length))&&n.uri===r.uri&&n.byterange.offset===r.byterange.offset&&n.byterange.length===r.byterange.length&&(i[e]=t[e])}}return i};class $a extends Xa{constructor(e,t,i={},r){super(),this.mainPlaylistLoader_=r||this,r||(this.isMain_=!0);var{withCredentials:r=!1}=i;if(this.vhs_=t,this.withCredentials=r,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Js("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,t,i){return!this.request||(this.request=null,e?(this.error="object"!=typeof e||e instanceof Error?{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2}:e,i&&(this.state=i),this.trigger("error"),!0):void 0)}addSidxSegments_(a,r,n){const s=a.sidx&&Ie(a.sidx);if(a.sidx&&s&&!this.mainPlaylistLoader_.sidxMapping_[s]){const o=Ks(a.sidx.resolvedUri),l=(t,i)=>{if(!this.requestErrored_(t,i,r)){t=this.mainPlaylistLoader_.sidxMapping_;let e;try{e=st()(m(i.response).subarray(8))}catch(e){return void this.requestErrored_(e,i,r)}return t[s]={sidxInfo:a.sidx,sidx:e},Ee(a,e,a.sidx.resolvedUri),n(!0)}};this.request=((e,t,n)=>{let r,s=[],a=!1;function o(e,t,i,r){return t.abort(),a=!0,n(e,t,i,r)}function i(e,t){var i;if(!a)return e?o(e,t,"",s):(i=t.responseText.substring(s&&s.byteLength||0,t.responseText.length),s=function(){for(var e,t,i,r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(n=n.filter(function(e){return e&&(e.byteLength||e.length)&&"string"!=typeof e})).length<=1?m(n[0]):(e=n.reduce(function(e,t,i){return e+(t.byteLength||t.length)},0),t=new Uint8Array(e),i=0,n.forEach(function(e){e=m(e),t.set(e,i),i+=e.byteLength}),t)}(s,re(i,!0)),r=r||Qe(s),s.length<10||r&&s.length<r+2||"ts"===(i=vt(s))&&s.length<188||!i&&s.length<376?qa(t,()=>o(e,t,"",s)):o(null,t,i,s))}const l={uri:e,beforeSend(e){e.overrideMimeType("text/plain; charset=x-user-defined"),e.addEventListener("progress",function({}){return Da(e,null,{statusCode:e.status},i)})}},h=t(l,function(e,t){return Da(h,e,t,i)});return h})(o,this.vhs_.xhr,(e,t,i,r)=>{var n,s;return e?l(e,t):i&&"mp4"===i?({offset:n,length:s}=a.sidx.byterange,r.length>=s+n?l(e,{response:r.subarray(n,n+s),status:t.status,uri:t.uri}):void(this.request=this.vhs_.xhr({uri:o,responseType:"arraybuffer",headers:Na({byterange:a.sidx.byterange})},l))):l({status:t.status,message:`Unsupported ${i||"unknown"} container type for sidx segment at URL: `+o,response:"",playlist:a,internal:!0,playlistExclusionDuration:1/0,code:2},t)})}else this.mediaRequest_=v().setTimeout(()=>n(!1),0)}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},v().clearTimeout(this.minimumUpdatePeriodTimeout_),v().clearTimeout(this.mediaRequest_),v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){var e;this.request&&(e=this.request,this.request=null,e.onreadystatechange=null,e.abort())}media(t){if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if("string"==typeof t){if(!this.mainPlaylistLoader_.main.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.mainPlaylistLoader_.main.playlists[t]}var e=!this.media_||t.id!==this.media_.id;e&&this.loadedPlaylists_[t.id]&&this.loadedPlaylists_[t.id].endList?(this.state="HAVE_METADATA",this.media_=t,e&&(this.trigger("mediachanging"),this.trigger("mediachange"))):e&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(t,i,e=>{this.haveMetadata({startingState:i,playlist:t})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,this.mediaRequest_=null,this.refreshMedia_(t.id),"HAVE_MAIN_MANIFEST"===e?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(v().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)}load(e){v().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var t=this.media();if(e){const e=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=v().setTimeout(()=>this.load(),e)}else this.started?t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){this.started=!0,this.isMain_?this.requestMain_((e,t)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])}):this.mediaRequest_=v().setTimeout(()=>this.haveMain_(),0)}requestMain_(r){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(e,t)=>{if(!this.requestErrored_(e,t)){const i=t.responseText!==this.mainPlaylistLoader_.mainXml_;return this.mainPlaylistLoader_.mainXml_=t.responseText,t.responseHeaders&&t.responseHeaders.date?this.mainLoaded_=Date.parse(t.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Ks(this.mainPlaylistLoader_.srcUrl,t),i?(this.handleMain_(),void this.syncClientServerClock_(()=>r(t,i))):r(t,i)}"HAVE_NOTHING"===this.state&&(this.started=!1)})}syncClientServerClock_(i){const r=(e=>{e=Ze(e);if(!(e=d(e,"UTCTiming")[0]))return null;var t=p(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;default:throw new Error("UNSUPPORTED_UTC_TIMING_SCHEME")}return t})(this.mainPlaylistLoader_.mainXml_);return null===r?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),i()):"DIRECT"===r.method?(this.mainPlaylistLoader_.clientOffset_=r.value-Date.now(),i()):void(this.request=this.vhs_.xhr({uri:$s(this.mainPlaylistLoader_.srcUrl,r.value),method:r.method,withCredentials:this.withCredentials},(e,t)=>{if(this.request)return e?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),i()):(e="HEAD"===r.method?t.responseHeaders&&t.responseHeaders.date?Date.parse(t.responseHeaders.date):this.mainLoaded_:Date.parse(t.responseText),this.mainPlaylistLoader_.clientOffset_=e-Date.now(),void i())}))}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;var e=this.mainPlaylistLoader_.main;let t=(({mainXml:e,srcUrl:t,clientOffset:i,sidxMapping:r,previousManifest:n})=>{e=e,i={manifestUri:t,clientOffset:i,sidxMapping:r,previousManifest:n},e=((e,t)=>{var{manifestUri:t="",NOW:i=Date.now(),clientOffset:r=0}=t,n=d(e,"Period");if(!n.length)throw new Error("INVALID_NUMBER_OF_PERIOD");const s=d(e,"Location"),a=p(e),o=$e([t],d(e,"BaseURL")),l=(a.type=a.type||"static",a.sourceDuration=a.mediaPresentationDuration||0,a.NOW=i,a.clientOffset=r,s.length&&(a.locations=s.map(je)),[]);return n.forEach((e,t)=>{var i,r,n=p(e),t=l[t-1];n.start=({attributes:t,priorPeriodAttributes:i,mpdType:r}=[{attributes:n,priorPeriodAttributes:t?t.attributes:null,mpdType:a.type}][0],"number"==typeof t.start?t.start:i&&"number"==typeof i.start&&"number"==typeof i.duration?i.start+i.duration:i||"static"!==r?null:0),l.push({node:e,attributes:n})}),{locations:a.locations,representationInfo:ye(l.map(Je(a,o)))}})(Ze(e),i),r=e.representationInfo.map(We);n=Be({dashPlaylists:r,locations:e.locations,sidxMapping:i.sidxMapping,previousManifest:i.previousManifest});return Ca(n,t),n})({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(t=((t,i,r)=>{let s=!0,a=P(t,{duration:i.duration,minimumUpdatePeriod:i.minimumUpdatePeriod,timelineStarts:i.timelineStarts});for(let e=0;e<i.playlists.length;e++){var n=i.playlists[e];if(n.sidx){const t=Ie(n.sidx);r&&r[t]&&r[t].sidx&&Ee(n,r[t].sidx,n.sidx.resolvedUri)}n=Pa(a,n,Wa);n&&(a=n,s=!1)}return Ea(i,(e,t,i,r)=>{var n;e.playlists&&e.playlists.length&&(n=e.playlists[0].id,e=Pa(a,e.playlists[0],Wa))&&((a=e).mediaGroups[t][i][r].playlists[0]=a.playlists[n],s=!1)}),(s=i.minimumUpdatePeriod!==t.minimumUpdatePeriod?!1:s)?null:a})(e,t,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=t||e;var i=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return i&&i!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=i),(!e||t&&t.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(t)}updateMinimumUpdatePeriodTimeout_(){var e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(v().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;0===t&&(e.media()?t=1e3*e.media().targetDuration:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),"number"!=typeof t||t<=0?t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`):this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=v().setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((e,n)=>{let s=Ya(e.playlists,n);return Ea(e,(e,t,i,r)=>{if(e.playlists&&e.playlists.length){const t=e.playlists;s=P(s,Ya(t,n))}}),s})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,e=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,i=!this.media_||this.media_!==t[e];if(i?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const e=()=>{this.media().endList||(this.mediaUpdateTimeout=v().setTimeout(()=>{this.trigger("mediaupdatetimeout"),e()},Ra(this.media(),Boolean(i))))};e()}this.trigger("loadedplaylist")}}var D={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};function Ka(e){return e.on=e.addEventListener,e.off=e.removeEventListener,e}function Ja(r){return function(){const e=function(t){try{return URL.createObjectURL(new Blob([t],{type:"application/javascript"}))}catch(e){var i=new BlobBuilder;return i.append(t),URL.createObjectURL(i.getBlob())}}(r),t=Ka(new Worker(e)),i=(t.objURL=e,t.terminate);return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),i.call(this)},t}}function Za(e){return`var browserWorkerPolyFill = ${Ka.toString()};
browserWorkerPolyFill(self);
`+e}function Qa(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)}const eo=Za(Qa(function(){function e(){this.init=function(){var s={};this.on=function(e,t){s[e]||(s[e]=[]),s[e]=s[e].concat(t)},this.off=function(e,t){return!!s[e]&&(t=s[e].indexOf(t),s[e]=s[e].slice(),s[e].splice(t,1),-1<t)},this.trigger=function(e){var t,i,r,n;if(t=s[e])if(2===arguments.length)for(r=t.length,i=0;i<r;++i)t[i].call(this,arguments[1]);else{for(n=[],i=arguments.length,i=1;i<arguments.length;++i)n.push(arguments[i]);for(r=t.length,i=0;i<r;++i)t[i].apply(this,n)}},this.dispose=function(){s={}}}}var k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==oi.g?oi.g:"undefined"!=typeof self?self:{};e.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),this.on("partialdone",function(e){t.partialFlush(e)}),this.on("endedtimeline",function(e){t.endTimeline(e)}),this.on("reset",function(e){t.reset(e)}),t},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var D,l,B,F,H,z,V,G,W,t,j,q,X,i=e,Y=Math.pow(2,32),$={getUint64:function(e){var t,e=new DataView(e.buffer,e.byteOffset,e.byteLength);return e.getBigUint64?(t=e.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(t):t:e.getUint32(0)*Y+e.getUint32(4)},MAX_UINT32:Y},K=$.MAX_UINT32;if(l={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(var r in l)l.hasOwnProperty(r)&&(l[r]=[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3)]);B=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),H=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),F=new Uint8Array([0,0,0,1]),Ae=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Le=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),z={video:Ae,audio:Le},W=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),G=new Uint8Array([0,0,0,0,0,0,0,0]),t=new Uint8Array([0,0,0,0,0,0,0,0]),j=t,q=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),X=t,V=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}function J(e,t){var i={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return i.dataOffset=t,i.compositionTimeOffset=e.pts-e.dts,i.duration=e.duration,i.size=4*e.length,i.size+=e.byteLength,e.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i}function d(e){for(var t=[];e--;)t.push(0);return t}function n(e){e=e||{},n.prototype.init.call(this),this.parse708captions_="boolean"!=typeof e.parse708captions||e.parse708captions,this.captionPackets_=[],this.ccStreams_=[new y(0,0),new y(0,1),new y(1,0),new y(1,1)],this.parse708captions_&&(this.cc708Stream_=new v({captionServices:e.captionServices})),this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))}function o(e){return 32<=e&&e<=127||160<=e&&e<=255}function s(e){this.windowNum=e,this.reset()}function a(e,t,i){this.serviceNum=e,this.text="",this.currentWindow=new s(-1),this.windows=[],this.stream=i,"string"==typeof t&&this.createTextDecoder(t)}function h(e){return null===e?"":(e=Ue[e]||e,String.fromCharCode(e))}function u(){for(var e=[],t=15;t--;)e.push("");return e}function Z(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}function Q(e){var t,i;Q.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===i&&(i=e.dts),e.dts=Z(e.dts,i),e.pts=Z(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){t=i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}var ee,te,ie,re,ne,se,c=function(e){for(var t,i=[],r=0,n=1;n<arguments.length;n++)i.push(arguments[n]);for(n=i.length;n--;)r+=i[n].byteLength;for(t=new Uint8Array(r+8),new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(0,t.byteLength),t.set(e,4),n=0,r=8;n<i.length;n++)t.set(i[n],r),r+=i[n].byteLength;return t},ae=function(){return c(l.dinf,c(l.dref,W))},oe=function(e){return c(l.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},le=function(e){return c(l.hdlr,z[e])},he=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),c(l.mdhd,t)},ue=function(e){return c(l.mdia,he(e),le(e.type),de(e))},ce=function(e){return c(l.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},de=function(e){return c(l.minf,"video"===e.type?c(l.vmhd,V):c(l.smhd,G),ae(),ge(e))},pe=function(e){for(var t=e.length,i=[];t--;)i[t]=we(e[t]);return c.apply(null,[l.mvex].concat(i))},fe=function(e){e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return c(l.mvhd,e)},me=function(e){for(var t,i=e.samples||[],r=new Uint8Array(4+i.length),n=0;n<i.length;n++)t=i[n].flags,r[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return c(l.sdtp,r)},ge=function(e){return c(l.stbl,ve(e),c(l.stts,X),c(l.stsc,j),c(l.stsz,q),c(l.stco,t))},ve=function(e){return c(l.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),("video"===e.type?ye:_e)(e))},ye=function(e){for(var t=e.sps||[],i=e.pps||[],r=[],n=[],s=0;s<t.length;s++)r.push((65280&t[s].byteLength)>>>8),r.push(255&t[s].byteLength),r=r.concat(Array.prototype.slice.call(t[s]));for(s=0;s<i.length;s++)n.push((65280&i[s].byteLength)>>>8),n.push(255&i[s].byteLength),n=n.concat(Array.prototype.slice.call(i[s]));var a,o=[l.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c(l.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([t.length],r,[i.length],n))),c(l.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))];return e.sarRatio&&(a=e.sarRatio[0],e=e.sarRatio[1],o.push(c(l.pasp,new Uint8Array([(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])))),c.apply(null,o)},_e=function(e){return c(l.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),oe(e))},be=function(e){e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return c(l.tkhd,e)},Te=function(e){var t,i=c(l.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),r=Math.floor(e.baseMediaDecodeTime/K),n=Math.floor(e.baseMediaDecodeTime%K),r=c(l.tfdt,new Uint8Array([1,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n]));return"audio"===e.type?(t=Ce(e,92),c(l.traf,i,r,t)):(n=me(e),t=Ce(e,n.length+92),c(l.traf,i,r,t,n))},xe=function(e){return e.duration=e.duration||4294967295,c(l.trak,be(e),ue(e))},we=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),c(l.trex,t)},Se=function(e,t){var i=0,r=0,n=0,s=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(n=4),void 0!==e[0].compositionTimeOffset)&&(s=8),[0,0,i|r|n|s,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},Ee=function(e,t){var i,r,n,s,a;for(t+=20+16*(n=e.samples||[]).length,e=Se(n,t),(r=new Uint8Array(e.length+16*n.length)).set(e),i=e.length,a=0;a<n.length;a++)s=n[a],r[i++]=(4278190080&s.duration)>>>24,r[i++]=(16711680&s.duration)>>>16,r[i++]=(65280&s.duration)>>>8,r[i++]=255&s.duration,r[i++]=(4278190080&s.size)>>>24,r[i++]=(16711680&s.size)>>>16,r[i++]=(65280&s.size)>>>8,r[i++]=255&s.size,r[i++]=s.flags.isLeading<<2|s.flags.dependsOn,r[i++]=s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,r[i++]=61440&s.flags.degradationPriority,r[i++]=15&s.flags.degradationPriority,r[i++]=(4278190080&s.compositionTimeOffset)>>>24,r[i++]=(16711680&s.compositionTimeOffset)>>>16,r[i++]=(65280&s.compositionTimeOffset)>>>8,r[i++]=255&s.compositionTimeOffset;return c(l.trun,r)},Me=function(e,t){var i,r,n,s,a;for(t+=20+8*(n=e.samples||[]).length,e=Se(n,t),(i=new Uint8Array(e.length+8*n.length)).set(e),r=e.length,a=0;a<n.length;a++)s=n[a],i[r++]=(4278190080&s.duration)>>>24,i[r++]=(16711680&s.duration)>>>16,i[r++]=(65280&s.duration)>>>8,i[r++]=255&s.duration,i[r++]=(4278190080&s.size)>>>24,i[r++]=(16711680&s.size)>>>16,i[r++]=(65280&s.size)>>>8,i[r++]=255&s.size;return c(l.trun,i)},Ce=function(e,t){return("audio"===e.type?Me:Ee)(e,t)},Ae={ftyp:D=function(){return c(l.ftyp,B,F,B,H)},mdat:function(e){return c(l.mdat,e)},moof:function(e,t){for(var i=[],r=t.length;r--;)i[r]=Te(t[r]);return c.apply(null,[l.moof,ce(e)].concat(i))},moov:ee=function(e){for(var t=e.length,i=[];t--;)i[t]=xe(e[t]);return c.apply(null,[l.moov,fe(4294967295)].concat(i).concat(pe(e)))},initSegment:function(e){var t,i=D(),e=ee(e);return(t=new Uint8Array(i.byteLength+e.byteLength)).set(i),t.set(e,i.byteLength),t}},Le={groupNalsIntoFrames:function(e){var t,i,r=[],n=[];for(n.byteLength=0,n.nalCount=0,t=r.byteLength=n.duration=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(r.length&&(r.duration=i.dts-r.dts,n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r)),(r=[i]).byteLength=i.data.byteLength,r.pts=i.pts,r.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(r.keyFrame=!0),r.duration=i.dts-r.dts,r.byteLength+=i.data.byteLength,r.push(i));return n.length&&(!r.duration||r.duration<=0)&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r),n},groupFramesIntoGops:function(e){var t,i,r=[],n=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(r.length&&(n.push(r),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration),(r=[i]).nalCount=i.length,r.byteLength=i.byteLength,r.pts=i.pts,r.dts=i.dts,r.duration=i.duration):(r.duration+=i.duration,r.nalCount+=i.length,r.byteLength+=i.byteLength,r.push(i));return n.length&&r.duration<=0&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration,n.push(r),n},extendFirstKeyFrame:function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},generateSampleTable:function(e,t){for(var i,r,n,s=t||0,a=[],o=0;o<e.length;o++)for(r=e[o],i=0;i<r.length;i++)n=r[i],s+=(n=J(n,s)).size,a.push(n);return a},concatenateNalData:function(e){for(var t,i,r,n,s,a=0,o=e.byteLength,l=e.nalCount,h=new Uint8Array(o+4*l),u=new DataView(h.buffer),c=0;c<e.length;c++)for(r=e[c],t=0;t<r.length;t++)for(n=r[t],i=0;i<n.length;i++)s=n[i],u.setUint32(a,s.data.byteLength),h.set(s.data,a+=4),a+=s.data.byteLength;return h},generateSampleTableForFrame:function(e,t){var i=[],e=J(e,t||0);return i.push(e),i},concatenateNalDataForFrame:function(e){for(var t,i=0,r=e.byteLength,n=e.length,s=new Uint8Array(r+4*n),a=new DataView(s.buffer),o=0;o<e.length;o++)t=e[o],a.setUint32(i,t.data.byteLength),s.set(t.data,i+=4),i+=t.data.byteLength;return s}},p=[33,16,5,32,164,27],Ie=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],f={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:ie=function(e){return 9e4*e},secondsToAudioTs:re=function(e,t){return e*t},videoTsToSeconds:ne=function(e){return e/9e4},audioTsToSeconds:se=function(e,t){return e/t},audioTsToVideoTs:function(e,t){return ie(se(e,t))},videoTsToAudioTs:function(e,t){return re(ne(e),t)},metadataTsToSeconds:function(e,t,i){return ne(i?e:e-t)}},m=f,Pe={prefixWithSilence:function(e,t,i,r){var n,s,a,o,l,h,u=0,c=0;if(t.length&&(l=m.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),n=Math.ceil(m.ONE_SECOND_IN_TS/(e.samplerate/1024)),i&&r&&(l=l-Math.max(i,r),c=(u=Math.floor(l/n))*n),!(u<1||c>m.ONE_SECOND_IN_TS/2))){for(te||(h={96e3:[p,[227,64],d(154),[56]],88200:[p,[231],d(170),[56]],64e3:[p,[248,192],d(240),[56]],48e3:[p,[255,192],d(268),[55,148,128],d(54),[112]],44100:[p,[255,192],d(268),[55,163,128],d(84),[112]],32e3:[p,[255,192],d(268),[55,234],d(226),[112]],24e3:[p,[255,192],d(268),[55,255,128],d(268),[111,112],d(126),[224]],16e3:[p,[255,192],d(268),[55,255,128],d(268),[111,255],d(269),[223,108],d(195),[1,192]],12e3:[Ie,d(268),[3,127,248],d(268),[6,255,240],d(268),[13,255,224],d(268),[27,253,128],d(259),[56]],11025:[Ie,d(268),[3,127,248],d(268),[6,255,240],d(268),[13,255,224],d(268),[27,255,192],d(268),[55,175,128],d(108),[112]],8e3:[Ie,d(268),[3,121,16],d(47),[7]]},te=Object.keys(h).reduce(function(e,t){return e[t]=new Uint8Array(h[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),s=(s=te[e.samplerate])||t[0].data,a=0;a<u;a++)o=t[0],t.splice(0,0,{data:s,dts:o.dts-n,pts:o.pts-n});return e.baseMediaDecodeTime-=Math.floor(m.videoTsToAudioTs(c,e.samplerate)),c}},trimAdtsFramesByEarliestDts:function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},generateSampleTable:function(e){for(var t,i=[],r=0;r<e.length;r++)t=e[r],i.push({size:t.data.byteLength,duration:1024});return i},concatenateFrameData:function(e){for(var t,i=0,r=new Uint8Array(function(e){for(var t=0,i=0;i<e.length;i++)t+=e[i].data.byteLength;return t}(e)),n=0;n<e.length;n++)t=e[n],r.set(t.data,i),i+=t.data.byteLength;return r}},Re=f.ONE_SECOND_IN_TS,ke={clearDtsInfo:function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),t=e.timelineStartInfo.baseMediaDecodeTime,t+=i,t=Math.max(0,t),"audio"===e.type&&(t*=e.samplerate/Re,t=Math.floor(t)),t},collectDtsInfo:function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))}},De={parseSei:function(e){for(var t=0,i={payloadType:-1,payloadSize:0},r=0,n=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)n+=255,t++;if(n+=e[t++],!i.payload&&4===r){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){i.payloadType=r,i.payloadSize=n,i.payload=e.subarray(t,t+n);break}i.payload=void 0}t+=n,n=r=0}return i},parseUserData:function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var i,r,n,s,a=[];if(64&t[0])for(r=31&t[0],i=0;i<r;i++)s={type:3&t[2+(n=3*i)],pts:e},4&t[2+n]&&(s.ccData=t[3+n]<<8|t[4+n],a.push(s));return a},discardEmulationPreventionBytes:function(e){for(var t=e.byteLength,i=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(i.push(r+2),r+=2):r++;if(0===i.length)return e;for(var n=t-i.length,s=new Uint8Array(n),a=0,r=0;r<n;a++,r++)a===i[0]&&(a++,i.shift()),s[r]=e[a];return s},USER_DATA_REGISTERED_ITU_T_T35:4},g=i,Oe=De,Ne=((n.prototype=new g).push=function(e){var t;"sei_rbsp"===e.nalUnitType&&(t=Oe.parseSei(e.escapedRBSP)).payload&&t.payloadType===Oe.USER_DATA_REGISTERED_ITU_T_T35&&(t=Oe.parseUserData(t))&&(e.dts<this.latestDts_?this.ignoreNextEqualDts_=!0:e.dts===this.latestDts_&&this.ignoreNextEqualDts_?(this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1)):(t=Oe.parseCaptionPackets(e.pts,t),this.captionPackets_=this.captionPackets_.concat(t),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts))},n.prototype.flushCCStreams=function(t){this.ccStreams_.forEach(function(e){return"flush"===t?e.flush():e.partialFlush()},this)},n.prototype.flushStream=function(e){this.captionPackets_.length&&(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)},this),this.captionPackets_.length=0),this.flushCCStreams(e)},n.prototype.flush=function(){return this.flushStream("flush")},n.prototype.partialFlush=function(){return this.flushStream("partialFlush")},n.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},n.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},n.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},n.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},n.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)},n.prototype.dispatchCea708Packet=function(e){this.parse708captions_&&this.cc708Stream_.push(e)},{127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600}),v=(s.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},s.prototype.getText=function(){return this.rows.join("\n")},s.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},s.prototype.newLine=function(e){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(e),0<this.rows.length&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},s.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},s.prototype.addText=function(e){this.rows[this.rowIdx]+=e},s.prototype.backspace=function(){var e;this.isEmpty()||(e=this.rows[this.rowIdx],this.rows[this.rowIdx]=e.substr(0,e.length-1))},a.prototype.init=function(e,t){this.startPts=e;for(var i=0;i<8;i++)this.windows[i]=new s(i),"function"==typeof t&&(this.windows[i].beforeRowOverflow=t)},a.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]},a.prototype.createTextDecoder=function(t){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(t)}catch(e){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+t+" encoding. "+e})}},function(e){e=e||{},v.prototype.init.call(this);var t,i=this,r=e.captionServices||{},n={};Object.keys(r).forEach(e=>{t=r[e],/^SERVICE/.test(e)&&(n[e]=t.encoding)}),this.serviceEncodings=n,this.current708Packet=null,this.services={},this.push=function(e){3!==e.type&&null!==i.current708Packet||i.new708Packet(),i.add708Bytes(e)}}),Ue=(v.prototype=new g,v.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},v.prototype.add708Bytes=function(e){var t=e.ccData,i=t>>>8,t=255&t;this.current708Packet.ptsVals.push(e.pts),this.current708Packet.data.push(i),this.current708Packet.data.push(t)},v.prototype.push708Packet=function(){var e,t=this.current708Packet,i=t.data,r=null,n=0,s=i[n++];for(t.seq=s>>6,t.sizeCode=63&s;n<i.length;n++)e=31&(s=i[n++]),7==(r=s>>5)&&0<e&&(r=i[n++]),this.pushServiceBlock(r,n,e),0<e&&(n+=e-1)},v.prototype.pushServiceBlock=function(e,t,i){for(var r,n=t,s=this.current708Packet.data,a=(a=this.services[e])||this.initService(e,n);n<t+i&&n<s.length;n++)r=s[n],o(r)?n=this.handleText(n,a):24===r?n=this.multiByteCharacter(n,a):16===r?n=this.extendedCommands(n,a):128<=r&&r<=135?n=this.setCurrentWindow(n,a):152<=r&&r<=159?n=this.defineWindow(n,a):136===r?n=this.clearWindows(n,a):140===r?n=this.deleteWindows(n,a):137===r?n=this.displayWindows(n,a):138===r?n=this.hideWindows(n,a):139===r?n=this.toggleWindows(n,a):151===r?n=this.setWindowAttributes(n,a):144===r?n=this.setPenAttributes(n,a):145===r?n=this.setPenColor(n,a):146===r?n=this.setPenLocation(n,a):143===r?a=this.reset(n,a):8===r?a.currentWindow.backspace():12===r?a.currentWindow.clearText():13===r?a.currentWindow.pendingNewLine=!0:14===r?a.currentWindow.clearText():141===r&&n++},v.prototype.extendedCommands=function(e,t){var i=this.current708Packet.data[++e];return e=o(i)?this.handleText(e,t,{isExtended:!0}):e},v.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]},v.prototype.initService=function(t,e){var i,r,n=this;return(i="SERVICE"+t)in this.serviceEncodings&&(r=this.serviceEncodings[i]),this.services[t]=new a(t,r,n),this.services[t].init(this.getPts(e),function(e){n.flushDisplayed(e,n.services[t])}),this.services[t]},v.prototype.handleText=function(e,t,i){var r,n=i&&i.isExtended,i=i&&i.isMultiByte,s=this.current708Packet.data,a=n?4096:0,o=s[e],s=s[e+1],l=t.currentWindow,s=t.textDecoder_&&!n?(i?(r=[o,s],e++):r=[o],t.textDecoder_.decode(new Uint8Array(r))):(i=Ne[n=a|o]||n,4096&n&&n===i?"":String.fromCharCode(i));return l.pendingNewLine&&!l.isEmpty()&&l.newLine(this.getPts(e)),l.pendingNewLine=!1,l.addText(s),e},v.prototype.multiByteCharacter=function(e,t){var i=this.current708Packet.data,r=i[e+1],i=i[e+2];return e=o(r)&&o(i)?this.handleText(++e,t,{isMultiByte:!0}):e},v.prototype.setCurrentWindow=function(e,t){var i=7&this.current708Packet.data[e];return t.setCurrentWindow(i),e},v.prototype.defineWindow=function(e,t){var i=this.current708Packet.data,r=i[e],t=(t.setCurrentWindow(7&r),t.currentWindow),r=i[++e];return t.visible=(32&r)>>5,t.rowLock=(16&r)>>4,t.columnLock=(8&r)>>3,t.priority=7&r,r=i[++e],t.relativePositioning=(128&r)>>7,t.anchorVertical=127&r,r=i[++e],t.anchorHorizontal=r,r=i[++e],t.anchorPoint=(240&r)>>4,t.rowCount=15&r,r=i[++e],t.columnCount=63&r,r=i[++e],t.windowStyle=(56&r)>>3,t.penStyle=7&r,t.virtualRowCount=t.rowCount+1,e},v.prototype.setWindowAttributes=function(e,t){var i=this.current708Packet.data,t=(i[e],t.currentWindow.winAttr),r=i[++e];return t.fillOpacity=(192&r)>>6,t.fillRed=(48&r)>>4,t.fillGreen=(12&r)>>2,t.fillBlue=3&r,r=i[++e],t.borderType=(192&r)>>6,t.borderRed=(48&r)>>4,t.borderGreen=(12&r)>>2,t.borderBlue=3&r,r=i[++e],t.borderType+=(128&r)>>5,t.wordWrap=(64&r)>>6,t.printDirection=(48&r)>>4,t.scrollDirection=(12&r)>>2,t.justify=3&r,r=i[++e],t.effectSpeed=(240&r)>>4,t.effectDirection=(12&r)>>2,t.displayEffect=3&r,e},v.prototype.flushDisplayed=function(e,t){for(var i=[],r=0;r<8;r++)t.windows[r].visible&&!t.windows[r].isEmpty()&&i.push(t.windows[r].getText());t.endPts=e,t.text=i.join("\n\n"),this.pushCaption(t),t.startPts=e},v.prototype.pushCaption=function(e){""!==e.text&&(this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum}),e.text="",e.startPts=e.endPts)},v.prototype.displayWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible=1);return e},v.prototype.hideWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible=0);return e},v.prototype.toggleWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible^=1);return e},v.prototype.clearWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&t.windows[n].clearText();return e},v.prototype.deleteWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&t.windows[n].reset();return e},v.prototype.setPenAttributes=function(e,t){var i=this.current708Packet.data,t=(i[e],t.currentWindow.penAttr),r=i[++e];return t.textTag=(240&r)>>4,t.offset=(12&r)>>2,t.penSize=3&r,r=i[++e],t.italics=(128&r)>>7,t.underline=(64&r)>>6,t.edgeType=(56&r)>>3,t.fontStyle=7&r,e},v.prototype.setPenColor=function(e,t){var i=this.current708Packet.data,t=(i[e],t.currentWindow.penColor),r=i[++e];return t.fgOpacity=(192&r)>>6,t.fgRed=(48&r)>>4,t.fgGreen=(12&r)>>2,t.fgBlue=3&r,r=i[++e],t.bgOpacity=(192&r)>>6,t.bgRed=(48&r)>>4,t.bgGreen=(12&r)>>2,t.bgBlue=3&r,r=i[++e],t.edgeRed=(48&r)>>4,t.edgeGreen=(12&r)>>2,t.edgeBlue=3&r,e},v.prototype.setPenLocation=function(e,t){var i=this.current708Packet.data,r=(i[e],t.currentWindow.penLoc);return t.currentWindow.pendingNewLine=!0,t=i[++e],r.row=15&t,t=i[++e],r.column=63&t,e},v.prototype.reset=function(e,t){var i=this.getPts(e);return this.flushDisplayed(i,t),this.initService(t.serviceNum,e)},{42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496}),Be=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],y=function(e,t){y.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,r,n,s;(t=32639&e.ccData)!==this.lastControlCode_?(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),i=t>>>8,r=255&t,t!==this.PADDING_&&(t===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":t===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),s=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=s,this.startPts_=e.pts):t===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(e.pts)):t===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(e.pts)):t===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(e.pts)):t===this.CARRIAGE_RETURN_?(this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts):t===this.BACKSPACE_?"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):t===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(e.pts),this.displayed_=u()):t===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=u():t===this.RESUME_DIRECT_CAPTIONING_?("paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=u()),this.mode_="paintOn",this.startPts_=e.pts):this.isSpecialCharacter(i,r)?(n=h((i=(3&i)<<8)|r),this[this.mode_](e.pts,n),this.column_++):this.isExtCharacter(i,r)?("popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),n=h((i=(3&i)<<8)|r),this[this.mode_](e.pts,n),this.column_++):this.isMidRowCode(i,r)?(this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"])):this.isOffsetControlCode(i,r)?this.column_+=3&r:this.isPAC(i,r)?(s=Be.indexOf(7968&t),"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])):this.isNormalChar(i)&&(0===r&&(r=null),n=h(i),n+=h(r),this[this.mode_](e.pts,n),this.column_+=n.length))):this.lastControlCode_=null}},g=(y.prototype=new g,y.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e,t){try{return e.trim()}catch(e){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+t+"."}),""}},this).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},y.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=u(),this.nonDisplayed_=u(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},y.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},y.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},y.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},y.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},y.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},y.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},y.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},y.prototype.isNormalChar=function(e){return 32<=e&&e<=127},y.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=u(),this.displayed_=u()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},y.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);t=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,t)},y.prototype.clearFormatting=function(e){var t;this.formatting_.length&&(t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},""),this.formatting_=[],this[this.mode_](e,t))},y.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=i+=t},y.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t},y.prototype.shiftRowsUp_=function(){for(var e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},y.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t},{CaptionStream:n,Cea608Stream:y,Cea708Stream:v}),Fe={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},He=i;Q.prototype=new He;function ze(e,t,i){for(var r="",n=t;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}function _(e,t,i){return decodeURIComponent(ze(e,t,i))}function b(e,t,i){return unescape(ze(e,t,i))}function Ve(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var Ge,He=Q,We=Z,je=Fe,qe=(e,t,i)=>{if(e)for(var r=i;r<e.length;r++)if(e[r]===t)return r;return-1},Xe={APIC:function(e){var t,i=1;3!==e.data[0]||(t=qe(e.data,0,1))<0||(e.mimeType=b(e.data,1,t),e.pictureType=e.data[i=t+1],(t=qe(e.data,0,++i))<0)||(e.description=_(e.data,i,t),i=t+1,"--\x3e"===e.mimeType?e.url=b(e.data,i,e.data.length):e.pictureData=e.data.subarray(i,e.data.length))},"T*":function(e){3===e.data[0]&&(e.value=_(e.data,1,e.data.length).replace(/\0*$/,""),e.values=e.value.split("\0"))},TXXX:function(e){var t;3===e.data[0]&&-1!==(t=qe(e.data,0,1))&&(e.description=_(e.data,1,t),e.value=_(e.data,t+1,e.data.length).replace(/\0*$/,""),e.data=e.value)},"W*":function(e){e.url=b(e.data,0,e.data.length).replace(/\0.*$/,"")},WXXX:function(e){var t;3===e.data[0]&&-1!==(t=qe(e.data,0,1))&&(e.description=_(e.data,1,t),e.url=b(e.data,t+1,e.data.length).replace(/\0.*$/,""))},PRIV:function(e){for(var t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=b(e.data,0,t);break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Ge=function(e){var t,i={descriptor:e&&e.descriptor},l=0,h=[],u=0;if(Ge.prototype.init.call(this),this.dispatchType=je.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,r,n,s,a,o;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(u=0,h.length=0),0===h.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(h.push(e),u+=e.data.byteLength,1===h.length&&(l=Ve(e.data.subarray(6,10)),l+=10),!(u<l)){for(t={data:new Uint8Array(l),frames:[],pts:h[0].pts,dts:h[0].dts},s=0;s<l;)t.data.set(h[0].data.subarray(0,l-s),s),s+=h[0].data.byteLength,u-=h[0].data.byteLength,h.shift();i=10,64&t.data[5]&&(i=(i+=4)+Ve(t.data.subarray(10,14)),l-=Ve(t.data.subarray(16,20)));do{if((r=Ve(t.data.subarray(i+4,i+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}}while((n={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+r+10)}).key=n.id,Xe[n.id]?Xe[n.id](n):"T"===n.id[0]?Xe["T*"](n):"W"===n.id[0]&&Xe["W*"](n),"com.apple.streaming.transportStreamTimestamp"===n.owner&&(o=(1&(a=n.data)[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2,o=(o*=4)+(3&a[7]),n.timeStamp=o,void 0===t.pts&&void 0===t.dts&&(t.pts=n.timeStamp,t.dts=n.timeStamp),this.trigger("timestamp",n)),t.frames.push(n),(i=i+10+r)<l);this.trigger("data",t)}}}).prototype=new i;var Ye,$e,Ke,Je,Ze=Ge,Qe=i,T=g,x=Fe,et=((Ye=function(){var n=new Uint8Array(188),s=0;Ye.prototype.init.call(this),this.push=function(e){var t,i=0,r=188;for(s?((t=new Uint8Array(e.byteLength+s)).set(n.subarray(0,s)),t.set(e,s),s=0):t=e;r<t.byteLength;)71!==t[i]||71!==t[r]?(i++,r++):(this.trigger("data",t.subarray(i,r)),i+=188,r+=188);i<t.byteLength&&(n.set(t.subarray(i),0),s=t.byteLength-i)},this.flush=function(){188===s&&71===n[0]&&(this.trigger("data",n),s=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){s=0,this.trigger("reset")}}).prototype=new Qe,($e=function(){var r,n,s,a;$e.prototype.init.call(this),(a=this).packetsWaitingForPmt=[],this.programMapTable=void 0,r=function(e,t){var i=0;t.payloadUnitStartIndicator&&(i+=e[i]+1),("pat"===t.type?n:s)(e.subarray(i),t)},n=function(e,t){t.section_number=e[7],t.last_section_number=e[8],a.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=a.pmtPid},s=function(e,t){var i,r;if(1&e[5]){for(a.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<i;){var n=e[r],s=(31&e[r+1])<<8|e[r+2];n===x.H264_STREAM_TYPE&&null===a.programMapTable.video?a.programMapTable.video=s:n===x.ADTS_STREAM_TYPE&&null===a.programMapTable.audio?a.programMapTable.audio=s:n===x.METADATA_STREAM_TYPE&&(a.programMapTable["timed-metadata"][s]=n),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=a.programMapTable}},this.push=function(e){var t={},i=4;if(t.payloadUnitStartIndicator=!!(64&e[1]),t.pid=31&e[1],t.pid<<=8,t.pid|=e[2],1<(48&e[3])>>>4&&(i+=e[i]+1),0===t.pid)t.type="pat",r(e.subarray(i),t),this.trigger("data",t);else if(t.pid===this.pmtPid)for(t.type="pmt",r(e.subarray(i),t),this.trigger("data",t);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,i,t]):this.processPes_(e,i,t)},this.processPes_=function(e,t,i){i.pid===this.programMapTable.video?i.streamType=x.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=x.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new Qe,$e.STREAM_TYPES={h264:27,adts:15},(Ke=function(){function r(e,t,i){var r,n,s,a,o=new Uint8Array(e.size),l={type:t},h=0,u=0;if(e.data.length&&!(e.size<9)){for(l.trackId=e.data[0].pid,h=0;h<e.data.length;h++)r=e.data[h],o.set(r.data,u),u+=r.data.byteLength;s=l,a=(n=o)[0]<<16|n[1]<<8|n[2],s.data=new Uint8Array,1==a&&(s.packetLength=6+(n[4]<<8|n[5]),s.dataAlignmentIndicator=0!=(4&n[6]),192&(a=n[7])&&(s.pts=(14&n[9])<<27|(255&n[10])<<20|(254&n[11])<<12|(255&n[12])<<5|(254&n[13])>>>3,s.pts*=4,s.pts+=(6&n[13])>>>1,s.dts=s.pts,64&a)&&(s.dts=(14&n[14])<<27|(255&n[15])<<20|(254&n[16])<<12|(255&n[17])<<5|(254&n[18])>>>3,s.dts*=4,s.dts+=(6&n[18])>>>1),s.data=n.subarray(9+n[8])),a="video"===t||l.packetLength<=e.size,(i||a)&&(e.size=0,e.data.length=0),a&&c.trigger("data",l)}}var t,c=this,n=!1,s={data:[],size:0},a={data:[],size:0},o={data:[],size:0};Ke.prototype.init.call(this),this.push=function(i){({pat:function(){},pes:function(){var e,t;switch(i.streamType){case x.H264_STREAM_TYPE:e=s,t="video";break;case x.ADTS_STREAM_TYPE:e=a,t="audio";break;case x.METADATA_STREAM_TYPE:e=o,t="timed-metadata";break;default:return}i.payloadUnitStartIndicator&&r(e,t,!0),e.data.push(i),e.size+=i.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]};null!==(t=i.programMapTable).video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),n=!0,c.trigger("data",e)}})[i.type]()},this.reset=function(){s.size=0,s.data.length=0,a.size=0,a.data.length=0,this.trigger("reset")},this.flushStreams_=function(){r(s,"video"),r(a,"audio"),r(o,"timed-metadata")},this.flush=function(){var e;!n&&t&&(e={type:"metadata",tracks:[]},null!==t.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),c.trigger("data",e)),n=!1,this.flushStreams_(),this.trigger("done")}}).prototype=new Qe,{PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Ye,TransportParseStream:$e,ElementaryStream:Ke,TimestampRolloverStream:He,CaptionStream:T.CaptionStream,Cea608Stream:T.Cea608Stream,Cea708Stream:T.Cea708Stream,MetadataStream:Ze});for(Je in x)x.hasOwnProperty(Je)&&(et[Je]=x[Je]);var tt,Qe=et,it=f.ONE_SECOND_IN_TS,rt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(tt=function(l){var h,u=0;tt.prototype.init.call(this),this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:`adts skiping bytes ${e} to ${t} in frame ${u} outside syncword`})},this.push=function(e){var t,i,r,n,s,a,o=0;if(l||(u=0),"audio"===e.type){for(h&&h.length?(r=h,(h=new Uint8Array(r.byteLength+e.data.byteLength)).set(r),h.set(e.data,r.byteLength)):h=e.data;o+7<h.length;)if(255===h[o]&&240==(246&h[o+1])){if("number"==typeof a&&(this.skipWarn_(a,o),a=null),i=2*(1&~h[o+1]),t=(3&h[o+3])<<11|h[o+4]<<3|(224&h[o+5])>>5,s=(n=1024*(1+(3&h[o+6])))*it/rt[(60&h[o+2])>>>2],h.byteLength-o<t)break;this.trigger("data",{pts:e.pts+u*s,dts:e.dts+u*s,sampleCount:n,audioobjecttype:1+(h[o+2]>>>6&3),channelcount:(1&h[o+2])<<2|(192&h[o+3])>>>6,samplerate:rt[(60&h[o+2])>>>2],samplingfrequencyindex:(60&h[o+2])>>>2,samplesize:16,data:h.subarray(o+7+i,o+t)}),u++,o+=t}else"number"!=typeof a&&(a=o),o++;"number"==typeof a&&(this.skipWarn_(a,o),a=null),h=h.subarray(o)}},this.flush=function(){u=0,this.trigger("done")},this.reset=function(){h=void 0,this.trigger("reset")},this.endTimeline=function(){h=void 0,this.trigger("endedtimeline")}}).prototype=new i;function nt(r){var n=r.byteLength,s=0,a=0;this.length=function(){return 8*n},this.bitsAvailable=function(){return 8*n+a},this.loadWord=function(){var e=r.byteLength-n,t=new Uint8Array(4),i=Math.min(4,n);if(0===i)throw new Error("no bytes available");t.set(r.subarray(e,e+i)),s=new DataView(t.buffer).getUint32(0),a=8*i,n-=i},this.skipBits=function(e){var t;e<a||(e=(e-=a)-8*(t=Math.floor(e/8)),n-=t,this.loadWord()),s<<=e,a-=e},this.readBits=function(e){var t=Math.min(a,e),i=s>>>32-t;return 0<(a-=t)?s<<=t:0<n&&this.loadWord(),0<(t=e-t)?i<<t|this.readBits(t):i},this.skipLeadingZeros=function(){for(var e=0;e<a;++e)if(0!=(s&2147483648>>>e))return s<<=e,a-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}var st,at,ot,He=tt,T=i;(at=function(){var r,n,s=0;at.prototype.init.call(this),this.push=function(e){for(var t,i=(n=n?((t=new Uint8Array(n.byteLength+e.data.byteLength)).set(n),t.set(e.data,n.byteLength),t):e.data).byteLength;s<i-3;s++)if(1===n[s+2]){r=s+5;break}for(;r<i;)switch(n[r]){case 0:if(0!==n[r-1])r+=2;else if(0!==n[r-2])r++;else{for(s+3!==r-2&&this.trigger("data",n.subarray(s+3,r-2));1!==n[++r]&&r<i;);s=r-2,r+=3}break;case 1:0!==n[r-1]||0!==n[r-2]?r+=3:(this.trigger("data",n.subarray(s+3,r-2)),s=r-2,r+=3);break;default:r+=3}n=n.subarray(s),r-=s,s=0},this.reset=function(){n=null,s=0,this.trigger("reset")},this.flush=function(){n&&3<n.byteLength&&this.trigger("data",n.subarray(s+3)),n=null,s=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new T,ot={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(st=function(){var i,r,n,s,a,o,m,t=new at;st.prototype.init.call(this),(i=this).push=function(e){"video"===e.type&&(r=e.trackId,n=e.pts,s=e.dts,t.push(e))},t.on("data",function(e){var t={trackId:r,pts:n,dts:s,data:e,nalUnitTypeCode:31&e[0]};switch(t.nalUnitTypeCode){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp",t.escapedRBSP=a(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp",t.escapedRBSP=a(e.subarray(1)),t.config=o(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp"}i.trigger("data",t)}),t.on("done",function(){i.trigger("done")}),t.on("partialdone",function(){i.trigger("partialdone")}),t.on("reset",function(){i.trigger("reset")}),t.on("endedtimeline",function(){i.trigger("endedtimeline")}),this.flush=function(){t.flush()},this.partialFlush=function(){t.partialFlush()},this.reset=function(){t.reset()},this.endTimeline=function(){t.endTimeline()},m=function(e,t){for(var i=8,r=8,n=0;n<e;n++)i=0===(r=0!==r?(i+t.readExpGolomb()+256)%256:r)?i:r},a=function(e){for(var t=e.byteLength,i=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(i.push(r+2),r+=2):r++;if(0===i.length)return e;for(var n=t-i.length,s=new Uint8Array(n),a=0,r=0;r<n;a++,r++)a===i[0]&&(a++,i.shift()),s[r]=e[a];return s},o=function(e){var t,i,r,n,s,a,o,l=0,h=0,u=0,c=0,d=[1,1],e=(t=new nt(e)).readUnsignedByte(),p=t.readUnsignedByte(),f=t.readUnsignedByte();if(t.skipUnsignedExpGolomb(),ot[e]&&(3===(r=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(a=3!==r?8:12,o=0;o<a;o++)t.readBoolean()&&m(o<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(r=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===r)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),i=t.readUnsignedExpGolomb(),o=0;o<i;o++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),r=t.readUnsignedExpGolomb(),n=t.readUnsignedExpGolomb(),0===(s=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(l=t.readUnsignedExpGolomb(),h=t.readUnsignedExpGolomb(),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:d=[1,1];break;case 2:d=[12,11];break;case 3:d=[10,11];break;case 4:d=[16,11];break;case 5:d=[40,33];break;case 6:d=[24,11];break;case 7:d=[20,11];break;case 8:d=[32,11];break;case 9:d=[80,33];break;case 10:d=[18,11];break;case 11:d=[15,11];break;case 12:d=[64,33];break;case 13:d=[160,99];break;case 14:d=[4,3];break;case 15:d=[3,2];break;case 16:d=[2,1];break;case 255:d=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}d&&(d[0],d[1])}return{profileIdc:e,levelIdc:f,profileCompatibility:p,width:16*(r+1)-2*l-2*h,height:(2-s)*(n+1)*16-2*u-2*c,sarRatio:d}}}).prototype=new T;function lt(e,t){var i=0<=(i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9])?i:0;return(16&e[t+5])>>4?20+i:10+i}function ht(e,t){return e.length-t<10||e[t]!=="I".charCodeAt(0)||e[t+1]!=="D".charCodeAt(0)||e[t+2]!=="3".charCodeAt(0)?t:(t+=lt(e,t),ht(e,t))}function ut(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var ct,Ze=st,dt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],T={isLikelyAacData:function(e){var t=ht(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},parseId3TagSize:lt,parseAdtsSize:function(e,t){var i=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|i},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return dt[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i=10;64&e[5]&&(i=(i+=4)+ut(e.subarray(10,14)));do{if((t=ut(e.subarray(i+4,i+8)))<1)return null;if("PRIV"===String.fromCharCode(e[i],e[i+1],e[i+2],e[i+3]))for(var r,n,s=e.subarray(i+10,i+t+10),a=0;a<s.byteLength;a++)if(0===s[a]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t){for(var i="",r=0;r<t;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i}(s,a)))return n=(1&(r=s.subarray(a+1))[3])<<30|r[4]<<22|r[5]<<14|r[6]<<6|r[7]>>>2,(n*=4)+(3&r[7]);break}}while((i=i+10+t)<e.byteLength);return null}},pt=T;(ct=function(){var s=new Uint8Array,a=0;ct.prototype.init.call(this),this.setTimestamp=function(e){a=e},this.push=function(e){var t,i,r=0,n=0;for(s.length?(i=s.length,(s=new Uint8Array(e.byteLength+i)).set(s.subarray(0,i)),s.set(e,i)):s=e;3<=s.length-n;)if(s[n]!=="I".charCodeAt(0)||s[n+1]!=="D".charCodeAt(0)||s[n+2]!=="3".charCodeAt(0))if(255!=(255&s[n])||240!=(240&s[n+1]))n++;else{if(s.length-n<7)break;if(n+(r=pt.parseAdtsSize(s,n))>s.length)break;t={type:"audio",data:s.subarray(n,n+r),pts:a,dts:a},this.trigger("data",t),n+=r}else{if(s.length-n<10)break;if(n+(r=pt.parseId3TagSize(s,n))>s.length)break;t={type:"timed-metadata",data:s.subarray(n,n+r)},this.trigger("data",t),n+=r}i=s.length-n,s=0<i?s.subarray(n):new Uint8Array},this.reset=function(){s=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){s=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new i;function ft(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++){var n=i[r];"headOfPipeline"!==n&&t[n].on&&t[n].on("log",At.bind(e,n))}}function mt(e,t){var i;if(e.length===t.length){for(i=0;i<e.length;i++)if(e[i]!==t[i])return;return 1}}function gt(e,t,i,r,n,s){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(r-t),pts:e+(n-i)},prependedContentDuration:s,baseMediaDecodeTime:e}}var vt,yt,w,S=Ae,E=Le,_t=Pe,M=ke,C=Qe,bt=f,Tt=He,xt=Ze,wt=ct,St=T.isLikelyAacData,Et=f.ONE_SECOND_IN_TS,Mt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Ct=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],At=function(e,t){t.stream=e,this.trigger("log",t)},Lt=function(s,a){var o=[],l=0,h=0,u=1/0,c=(a=a||{}).firstSequenceNumber||0;Lt.prototype.init.call(this),this.push=function(t){M.collectDtsInfo(s,t),s&&Mt.forEach(function(e){s[e]=t[e]}),o.push(t)},this.setEarliestDts=function(e){l=e},this.setVideoBaseMediaDecodeTime=function(e){u=e},this.setAudioAppendStart=function(e){h=e},this.flush=function(){var e,t,i,r,n;0!==o.length&&(e=_t.trimAdtsFramesByEarliestDts(o,s,l),s.baseMediaDecodeTime=M.calculateTrackBaseMediaDecodeTime(s,a.keepOriginalTimestamps),n=_t.prefixWithSilence(s,e,h,u),s.samples=_t.generateSampleTable(e),i=S.mdat(_t.concatenateFrameData(e)),o=[],r=S.moof(c,[s]),t=new Uint8Array(r.byteLength+i.byteLength),c++,t.set(r),t.set(i,r.byteLength),M.clearDtsInfo(s),i=Math.ceil(1024*Et/s.samplerate),e.length&&(r=e.length*i,this.trigger("segmentTimingInfo",gt(bt.audioTsToVideoTs(s.baseMediaDecodeTime,s.samplerate),e[0].dts,e[0].pts,e[0].dts+r,e[0].pts+r,n||0)),this.trigger("timingInfo",{start:e[0].pts,end:e[0].pts+r})),this.trigger("data",{track:s,boxes:t})),this.trigger("done","AudioSegmentStream")},this.reset=function(){M.clearDtsInfo(s),o=[],this.trigger("reset")}};Lt.prototype=new i,(vt=function(a,s){var t,i,o=[],h=[],l=(s=s||{}).firstSequenceNumber||0;vt.prototype.init.call(this),delete a.minPTS,this.gopCache_=[],this.push=function(e){M.collectDtsInfo(a,e),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,a.sps=[e.data],Ct.forEach(function(e){a[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.data,a.pps=[e.data]),o.push(e)},this.flush=function(){for(var e,t,i,r,n=0;o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();if(0!==o.length){if(e=E.groupNalsIntoFrames(o),(e=E.groupFramesIntoGops(e))[0][0].keyFrame||((r=this.getGopForFusion_(o[0],a))?(n=r.duration,e.unshift(r),e.byteLength+=r.byteLength,e.nalCount+=r.nalCount,e.pts=r.pts,e.dts=r.dts,e.duration+=r.duration):e=E.extendFirstKeyFrame(e)),h.length){if(!(r=s.alignGopsAtEnd?this.alignGopsAtEnd_(e):this.alignGopsAtStart_(e)))return this.gopCache_.unshift({gop:e.pop(),pps:a.pps,sps:a.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");M.clearDtsInfo(a),e=r}M.collectDtsInfo(a,e),a.samples=E.generateSampleTable(e),r=S.mdat(E.concatenateNalData(e)),a.baseMediaDecodeTime=M.calculateTrackBaseMediaDecodeTime(a,s.keepOriginalTimestamps),this.trigger("processedGopsInfo",e.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),t=e[0],i=e[e.length-1],this.trigger("segmentTimingInfo",gt(a.baseMediaDecodeTime,t.dts,t.pts,i.dts+i.duration,i.pts+i.duration,n)),this.trigger("timingInfo",{start:e[0].pts,end:e[e.length-1].pts+e[e.length-1].duration}),this.gopCache_.unshift({gop:e.pop(),pps:a.pps,sps:a.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.trigger("baseMediaDecodeTime",a.baseMediaDecodeTime),this.trigger("timelineStartInfo",a.timelineStartInfo),t=S.moof(l,[a]),i=new Uint8Array(t.byteLength+r.byteLength),l++,i.set(t),i.set(r,t.byteLength),this.trigger("data",{track:a,boxes:i})}this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),o=[],this.gopCache_.length=0,h.length=0,this.trigger("reset")},this.resetStream_=function(){M.clearDtsInfo(a),i=t=void 0},this.getGopForFusion_=function(e){for(var t,i,r,n=1/0,s=0;s<this.gopCache_.length;s++)i=(r=this.gopCache_[s]).gop,a.pps&&mt(a.pps[0],r.pps[0])&&a.sps&&mt(a.sps[0],r.sps[0])&&(i.dts<a.timelineStartInfo.dts||-1e4<=(i=e.dts-i.dts-i.duration)&&i<=45e3&&(!t||i<n)&&(t=r,n=i));return t?t.gop:null},this.alignGopsAtStart_=function(e){for(var t,i,r,n,s=e.byteLength,a=e.nalCount,o=e.duration,l=t=0;l<h.length&&t<e.length&&(i=h[l],r=e[t],i.pts!==r.pts);)r.pts>i.pts?l++:(t++,s-=r.byteLength,a-=r.nalCount,o-=r.duration);return 0===t?e:t===e.length?null:((n=e.slice(t)).byteLength=s,n.duration=o,n.nalCount=a,n.pts=n[0].pts,n.dts=n[0].dts,n)},this.alignGopsAtEnd_=function(e){for(var t,i,r,n,s=h.length-1,a=e.length-1,o=null,l=!1;0<=s&&0<=a;){if(t=h[s],i=e[a],t.pts===i.pts){l=!0;break}t.pts>i.pts?s--:(s===h.length-1&&(o=a),a--)}return l||null!==o?0===(r=l?a:o)?e:(n=(r=e.slice(r)).reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0}),r.byteLength=n.byteLength,r.duration=n.duration,r.nalCount=n.nalCount,r.pts=r[0].pts,r.dts=r[0].dts,r):null},this.alignGopsWith=function(e){h=e}}).prototype=new i,((w=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,w.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new i).flush=function(e){var t,i,r,n=0,s={captions:[],captionStreams:{},metadata:[],info:{}},a=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(a=this.videoTrack.timelineStartInfo.pts,Ct.forEach(function(e){s.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(a=this.audioTrack.timelineStartInfo.pts,Mt.forEach(function(e){s.info[e]=this.audioTrack[e]},this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,e=S.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(e.byteLength),s.initSegment.set(e),s.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)s.data.set(this.pendingBoxes[r],n),n+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=bt.metadataTsToSeconds(t.startPts,a,this.keepOriginalTimestamps),t.endTime=bt.metadataTsToSeconds(t.endPts,a,this.keepOriginalTimestamps),s.captionStreams[t.stream]=!0,s.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(i=this.pendingMetadata[r]).cueTime=bt.metadataTsToSeconds(i.pts,a,this.keepOriginalTimestamps),s.metadata.push(i);for(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),r=0;r<s.captions.length;r++)t=s.captions[r],this.trigger("caption",t);for(r=0;r<s.metadata.length;r++)i=s.metadata[r],this.trigger("id3Frame",i)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},w.prototype.setRemux=function(e){this.remuxTracks=e},(yt=function(r){var n,s,a=this,i=!0;yt.prototype.init.call(this),r=r||{},this.baseMediaDecodeTime=r.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new C.MetadataStream,t.aacStream=new wt,t.audioTimestampRolloverStream=new C.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new C.TimestampRolloverStream("timed-metadata"),t.adtsStream=new Tt,t.coalesceStream=new w(r,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type&&"audio"!==e.type||t.audioSegmentStream||(s=s||{timelineStartInfo:{baseMediaDecodeTime:a.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new Lt(s,r),t.audioSegmentStream.on("log",a.getLogTrigger_("audioSegmentStream")),t.audioSegmentStream.on("timingInfo",a.trigger.bind(a,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream),a.trigger("trackinfo",{hasAudio:!!s,hasVideo:!!n}))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done")),ft(this,t)},this.setupTsPipeline=function(){var i={};(this.transmuxPipeline_=i).type="ts",i.metadataStream=new C.MetadataStream,i.packetStream=new C.TransportPacketStream,i.parseStream=new C.TransportParseStream,i.elementaryStream=new C.ElementaryStream,i.timestampRolloverStream=new C.TimestampRolloverStream,i.adtsStream=new Tt,i.h264Stream=new xt,i.captionStream=new C.CaptionStream(r),i.coalesceStream=new w(r,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",function(e){var t;if("metadata"===e.type){for(t=e.tracks.length;t--;)n||"video"!==e.tracks[t].type?s||"audio"!==e.tracks[t].type||((s=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime):(n=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=a.baseMediaDecodeTime;n&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new vt(n,r),i.videoSegmentStream.on("log",a.getLogTrigger_("videoSegmentStream")),i.videoSegmentStream.on("timelineStartInfo",function(e){s&&!r.keepOriginalTimestamps&&(s.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts-a.baseMediaDecodeTime))}),i.videoSegmentStream.on("processedGopsInfo",a.trigger.bind(a,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",a.trigger.bind(a,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",function(e){s&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),i.videoSegmentStream.on("timingInfo",a.trigger.bind(a,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),s&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new Lt(s,r),i.audioSegmentStream.on("log",a.getLogTrigger_("audioSegmentStream")),i.audioSegmentStream.on("timingInfo",a.trigger.bind(a,"audioTimingInfo")),i.audioSegmentStream.on("segmentTimingInfo",a.trigger.bind(a,"audioSegmentTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),a.trigger("trackinfo",{hasAudio:!!s,hasVideo:!!n})}}),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",function(e){e.dispatchType=i.metadataStream.dispatchType,a.trigger("id3Frame",e)}),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done")),ft(this,i)},this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;r.keepOriginalTimestamps||(this.baseMediaDecodeTime=e),s&&(s.timelineStartInfo.dts=void 0,s.timelineStartInfo.pts=void 0,M.clearDtsInfo(s),t.audioTimestampRolloverStream)&&t.audioTimestampRolloverStream.discontinuity(),n&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,M.clearDtsInfo(n),t.captionStream.reset()),t.timestampRolloverStream&&t.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){s&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(e){var t=this.transmuxPipeline_;r.remux=e,t&&t.coalesceStream&&t.coalesceStream.setRemux(e)},this.alignGopsWith=function(e){n&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.getLogTrigger_=function(t){var i=this;return function(e){e.stream=t,i.trigger("log",e)}},this.push=function(e){var t;i&&((t=St(e))&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1),this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new i;function It(e){return e>>>0}function Pt(e){var t="";return(t+=String.fromCharCode(e[0]))+String.fromCharCode(e[1])+String.fromCharCode(e[2])+String.fromCharCode(e[3])}function Rt(e,t){var i,r,n,s=[];if(!t.length)return null;for(i=0;i<e.byteLength;)r=zt(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]),n=Vt(e.subarray(i+4,i+8)),r=1<r?i+r:e.byteLength,n===t[0]&&(1===t.length?s.push(e.subarray(i+8,r)):(n=Rt(e.subarray(i+8,r),t.slice(1))).length&&(s=s.concat(n))),i=r;return s}function kt(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}function Dt(){var t,l,h,d,p,i,r=!1;this.isInitialized=function(){return r},this.init=function(e){t=new qt,r=!0,i=!!e&&e.isPartial,t.on("data",function(e){e.startTime=e.startPts/d,e.endTime=e.endPts/d,p.captions.push(e),p.captionStreams[e.stream]=!0}),t.on("log",function(e){p.logs.push(e)})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||h===e[0]&&d===t[h])},this.parse=function(e,t,i){var r,n,u,s,c,a;if(!this.isInitialized())return null;if(!t||!i)return null;if(this.isNewInit(t,i))h=t[0],d=i[h];else if(null===h||!d)return l.push(e),null;for(;0<l.length;){var o=l.shift();this.parse(o,t,i)}return n=d,(r=null===(r=h)?null:(u=r,s=L(e=e,["moof","traf"]),e=L(e,["mdat"]),c={},a=[],e.forEach(function(e,t){t=s[t];a.push({mdat:e,traf:t})}),a.forEach(function(e){var t,i,r,n,s,a=e.mdat,e=e.traf,o=L(e,["tfhd"]),o=$t(o[0]),l=o.trackId,h=L(e,["tfdt"]),h=0<h.length?Xt(h[0]).baseMediaDecodeTime:0,e=L(e,["trun"]);u===l&&0<e.length&&(t=h,i=o.defaultSampleDuration||0,r=o.defaultSampleSize||0,n=o.trackId,s=[],e.forEach(function(e){e=Yt(e).samples;e.forEach(function(e){void 0===e.duration&&(e.duration=i),void 0===e.size&&(e.size=r),e.trackId=n,e.dts=t,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),"bigint"==typeof t?(e.pts=t+Kt.BigInt(e.compositionTimeOffset),t+=Kt.BigInt(e.duration)):(e.pts=t+e.compositionTimeOffset,t+=e.duration)}),s=s.concat(e)}),h=function(e,t,i){for(var r,n,s=new DataView(e.buffer,e.byteOffset,e.byteLength),a={logs:[],seiNals:[]},o=0;o+4<e.length;o+=r)if(r=s.getUint32(o),o+=4,!(r<=0))switch(31&e[o]){case 6:var l=e.subarray(o+1,o+1+r),h=function(e,t){for(var i=e,r=0;r<t.length;r++){var n=t[r];if(i<n.size)return n;i-=n.size}return null}(o,t),l={nalUnitType:"sei_rbsp",size:r,data:l,escapedRBSP:jt(l),trackId:i};if(h)l.pts=h.pts,l.dts=h.dts,n=h;else{if(!n){a.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+o+" for trackId "+i+". See mux.js#223."});break}l.pts=n.pts,l.dts=n.dts}a.seiNals.push(l)}return a}(a,s,l),c[l]||(c[l]={seiNals:[],logs:[]}),c[l].seiNals=c[l].seiNals.concat(h.seiNals),c[l].logs=c[l].logs.concat(h.logs))}),{seiNals:(e=c[r]||{}).seiNals,logs:e.logs,timescale:n}))&&r.logs&&(p.logs=p.logs.concat(r.logs)),null!==r&&r.seiNals?(this.pushNals(r.seiNals),this.flushStream(),p):p.logs.length?{logs:p.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach(function(e){t.push(e)})},this.flushStream=function(){if(!this.isInitialized())return null;i?t.partialFlush():t.flush()},this.clearParsedCaptions=function(){p.captions=[],p.captionStreams={},p.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){l=[],d=h=null,p?this.clearParsedCaptions():p={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()}function A(e){return("00"+e.toString(16)).slice(-2)}function Ot(e){var t=31&e[1];return(t<<=8)|e[2]}function Nt(e){return!!(64&e[1])}function Ut(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function Bt(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}function Ft(e,t){var i,r,n;return(e=(O.aac.isLikelyAacData(e)?function(e){for(var t,i,r=!1,n=0,s=null,a=null,o=0,l=0;3<=e.length-l;){switch(O.aac.parseType(e,l)){case"timed-metadata":e.length-l<10?r=!0:(o=O.aac.parseId3TagSize(e,l))>e.length?r=!0:(null===a&&(t=e.subarray(l,l+o),a=O.aac.parseAacTimestamp(t)),l+=o);break;case"audio":e.length-l<7?r=!0:(o=O.aac.parseAdtsSize(e,l))>e.length?r=!0:(null===s&&(t=e.subarray(l,l+o),s=O.aac.parseSampleRate(t)),n++,l+=o);break;default:l++}if(r)return null}return null===s||null===a?null:{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*n*(i=R/s),pts:a+1024*n*i}]}}:function(e){for(var t,i,r={pid:null,table:null},n={},s=e,a=r,o=0,l=N;l<s.byteLength;)if(s[o]!==U||s[l]!==U)o++,l++;else{switch(t=s.subarray(o,l),O.ts.parseType(t,a.pid)){case"pat":a.pid=O.ts.parsePat(t);break;case"pmt":var h=O.ts.parsePmt(t);a.table=a.table||{},Object.keys(h).forEach(function(e){a.table[e]=h[e]})}o+=N,l+=N}for(i in r.table)if(r.table.hasOwnProperty(i))switch(r.table[i]){case si.H264_STREAM_TYPE:n.video=[],v=S=w=x=T=g=m=f=p=d=c=u=void 0;for(var u,c,d,p,f,m,g,v,y=e,_=r,b=n,T=0,x=N,w=!1,S={data:[],size:0};x<y.byteLength;)if(y[T]!==U||y[x]!==U)T++,x++;else{if(u=y.subarray(T,x),"pes"===O.ts.parseType(u,_.pid)&&(c=O.ts.parsePesType(u,_.table),d=O.ts.parsePayloadUnitStartIndicator(u),"video"===c)&&(d&&!w&&(p=O.ts.parsePesTime(u))&&(p.type="video",b.video.push(p),w=!0),!b.firstKeyFrame)){if(d&&0!==S.size){for(f=new Uint8Array(S.size),m=0;S.data.length;)g=S.data.shift(),f.set(g,m),m+=g.byteLength;O.ts.videoPacketContainsKeyFrame(f)&&((v=O.ts.parsePesTime(f))?(b.firstKeyFrame=v,b.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")),S.size=0}S.data.push(u),S.size+=u.byteLength}if(w&&b.firstKeyFrame)break;T+=N,x+=N}for(T=(x=y.byteLength)-N,w=!1;0<=T;)if(y[T]!==U||y[x]!==U)T--,x--;else{if(u=y.subarray(T,x),"pes"===O.ts.parseType(u,_.pid)&&(c=O.ts.parsePesType(u,_.table),d=O.ts.parsePayloadUnitStartIndicator(u),"video"===c)&&d&&(p=O.ts.parsePesTime(u))&&(p.type="video",b.video.push(p),w=!0),w)break;T-=N,x-=N}0===n.video.length&&delete n.video;break;case si.ADTS_STREAM_TYPE:n.audio=[],D=k=R=A=C=M=E=void 0;for(var E,M,C,A,L=e,I=r,P=n,R=0,k=N,D=!1;k<=L.byteLength;)if(L[R]!==U||L[k]!==U&&k!==L.byteLength)R++,k++;else{if(E=L.subarray(R,k),"pes"===O.ts.parseType(E,I.pid)&&(M=O.ts.parsePesType(E,I.table),C=O.ts.parsePayloadUnitStartIndicator(E),"audio"===M)&&C&&(A=O.ts.parsePesTime(E))&&(A.type="audio",P.audio.push(A),D=!0),D)break;R+=N,k+=N}for(R=(k=L.byteLength)-N,D=!1;0<=R;)if(L[R]!==U||L[k]!==U&&k!==L.byteLength)R--,k--;else{if(E=L.subarray(R,k),"pes"===O.ts.parseType(E,I.pid)&&(M=O.ts.parsePesType(E,I.table),C=O.ts.parsePayloadUnitStartIndicator(E),"audio"===M)&&C&&(A=O.ts.parsePesTime(E))&&(A.type="audio",P.audio.push(A),D=!0),D)break;R-=N,k-=N}0===n.audio.length&&delete n.audio}return n})(e))&&(e.audio||e.video)?(t=t,(i=e).audio&&i.audio.length&&(void 0!==(r=t)&&!isNaN(r)||(r=i.audio[0].dts),i.audio.forEach(function(e){e.dts=P(e.dts,r),e.pts=P(e.pts,r),e.dtsTime=e.dts/R,e.ptsTime=e.pts/R})),i.video&&i.video.length&&(void 0!==(n=t)&&!isNaN(n)||(n=i.video[0].dts),i.video.forEach(function(e){e.dts=P(e.dts,n),e.pts=P(e.pts,n),e.dtsTime=e.dts/R,e.ptsTime=e.pts/R}),i.firstKeyFrame)&&((t=i.firstKeyFrame).dts=P(t.dts,n),t.pts=P(t.pts,n),t.dtsTime=t.dts/R,t.ptsTime=t.pts/R),e):null}var Ht=yt,zt=It,Vt=Pt,Gt=It,Wt=$.getUint64,jt=(Pe="undefined"!=typeof window?window:void 0!==k?k:"undefined"!=typeof self?self:{},De.discardEmulationPreventionBytes),qt=g.CaptionStream,L=Rt,Xt=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4))};return t.baseMediaDecodeTime=1===t.version?Wt(e.subarray(4)):Gt(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),t},Yt=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&i.flags[2],s=4&i.flags[2],a=1&i.flags[1],o=2&i.flags[1],l=4&i.flags[1],h=8&i.flags[1],u=r.getUint32(4),c=8;for(n&&(i.dataOffset=r.getInt32(c),c+=4),s&&u&&(t={flags:kt(e.subarray(c,c+4))},c+=4,a&&(t.duration=r.getUint32(c),c+=4),o&&(t.size=r.getUint32(c),c+=4),h&&(t.compositionTimeOffset=1===i.version?r.getInt32(c):r.getUint32(c),c+=4),i.samples.push(t),u--);u--;)t={},a&&(t.duration=r.getUint32(c),c+=4),o&&(t.size=r.getUint32(c),c+=4),l&&(t.flags=kt(e.subarray(c,c+4)),c+=4),h&&(t.compositionTimeOffset=1===i.version?r.getInt32(c):r.getUint32(c),c+=4),i.samples.push(t);return i},$t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),e={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4)},i=1&e.flags[2],r=2&e.flags[2],n=8&e.flags[2],s=16&e.flags[2],a=32&e.flags[2],o=65536&e.flags[0],l=131072&e.flags[0],h=8;return i&&(h+=4,e.baseDataOffset=t.getUint32(12),h+=4),r&&(e.sampleDescriptionIndex=t.getUint32(h),h+=4),n&&(e.defaultSampleDuration=t.getUint32(h),h+=4),s&&(e.defaultSampleSize=t.getUint32(h),h+=4),a&&(e.defaultSampleFlags=t.getUint32(h)),o&&(e.durationIsEmpty=!0),!i&&l&&(e.baseDataOffsetIsMoof=!0),e},Kt=Pe,Jt=It,I=Rt,Zt=Pt,Qt=$.getUint64,ei=Pe,ti=function(e){var t=0===e[0]?12:20;return Jt(e[t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])},ii=function(s,e){e=I(e,["moof","traf"]).reduce(function(e,t){var i=I(t,["tfhd"])[0],i=Jt(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),i=s[i]||9e4,t=I(t,["tfdt"])[0],r=new DataView(t.buffer,t.byteOffset,t.byteLength);let n;return"bigint"==typeof(t=1===t[0]?Qt(t.subarray(4,12)):r.getUint32(4))?n=t/ei.BigInt(i):"number"!=typeof t||isNaN(t)||(n=t/i),e=(n=n<Number.MAX_SAFE_INTEGER?Number(n):n)<e?n:e},1/0);return"bigint"==typeof e||isFinite(e)?e:0},ri=function(e){var e=I(e,["moov","trak"]),s=[];return e.forEach(function(e){var t,i={},r=I(e,["tkhd"])[0],n=(r&&(n=(r=new DataView(r.buffer,r.byteOffset,r.byteLength)).getUint8(0),i.id=0===n?r.getUint32(12):r.getUint32(20)),I(e,["mdia","hdlr"])[0]),n=(n&&(r=Zt(n.subarray(8,12)),i.type="vide"===r?"video":"soun"===r?"audio":r),I(e,["mdia","minf","stbl","stsd"])[0]),r=(n&&(r=n.subarray(8),i.codec=Zt(r.subarray(4,8)),n=I(r,[i.codec])[0])&&(/^[asm]vc[1-9]$/i.test(i.codec)?(t=n.subarray(78),"avcC"===Zt(t.subarray(4,8))&&11<t.length?(i.codec+=".",i.codec+=A(t[9]),i.codec+=A(t[10]),i.codec+=A(t[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)?(t=n.subarray(28),"esds"===Zt(t.subarray(4,8))&&20<t.length&&0!==t[19]?(i.codec+="."+A(t[19]),i.codec+="."+A(t[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"):i.codec=i.codec.toLowerCase()),I(e,["mdia","mdhd"])[0]);r&&(i.timescale=ti(r)),s.push(i)}),s},ni=Fe,si=Fe,P=We,O={},R=(O.ts={parseType:function(e,t){e=Ot(e);return 0===e?"pat":e===t?"pmt":t?"pes":null},parsePat:function(e){var t=Nt(e),i=4+Ut(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=Nt(e),r=4+Ut(e);if(i&&(r+=e[r]+1),1&e[r+5]){for(var n=3+((15&e[r+1])<<8|e[r+2])-4,s=12+((15&e[r+10])<<8|e[r+11]);s<n;){var a=r+s;t[(31&e[a+1])<<8|e[a+2]]=e[a],s+=5+((15&e[a+3])<<8|e[a+4])}return t}},parsePayloadUnitStartIndicator:Nt,parsePesType:function(e,t){switch(t[Ot(e)]){case ni.H264_STREAM_TYPE:return"video";case ni.ADTS_STREAM_TYPE:return"audio";case ni.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){var t,i,r;return!Nt(e)||(t=4+Ut(e))>=e.byteLength?null:(r=null,192&(i=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&i)&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1),r)},videoPacketContainsKeyFrame:function(e){for(var t=4+Ut(e),i=e.subarray(t),r=0,n=0,s=!1;n<i.byteLength-3;n++)if(1===i[n+2]){r=n+5;break}for(;r<i.byteLength;)switch(i[r]){case 0:if(0!==i[r-1])r+=2;else if(0!==i[r-2])r++;else{for(n+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===Bt(31&i[n+3])&&(s=!0);1!==i[++r]&&r<i.length;);n=r-2,r+=3}break;case 1:0!==i[r-1]||0!==i[r-2]?r+=3:("slice_layer_without_partitioning_rbsp_idr"===Bt(31&i[n+3])&&(s=!0),n=r-2,r+=3);break;default:r+=3}return i=i.subarray(n),r-=n,n=0,s=i&&3<i.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===Bt(31&i[n+3])?!0:s}},O.aac=T,f.ONE_SECOND_IN_TS),N=188,U=71;class ai{constructor(e,t){this.options=t||{},this.self=e,this.init()}init(){var i,e;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Ht(this.options),i=this.self,(e=this.transmuxer).on("data",function(e){var t=e.initSegment,t=(e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},e.data);e.data=t.buffer,i.postMessage({action:"data",segment:e,byteOffset:t.byteOffset,byteLength:t.byteLength},[e.data])}),e.on("done",function(e){i.postMessage({action:"done"})}),e.on("gopInfo",function(e){i.postMessage({action:"gopInfo",gopInfo:e})}),e.on("videoSegmentTimingInfo",function(e){var t={start:{decode:f.videoTsToSeconds(e.start.dts),presentation:f.videoTsToSeconds(e.start.pts)},end:{decode:f.videoTsToSeconds(e.end.dts),presentation:f.videoTsToSeconds(e.end.pts)},baseMediaDecodeTime:f.videoTsToSeconds(e.baseMediaDecodeTime)};e.prependedContentDuration&&(t.prependedContentDuration=f.videoTsToSeconds(e.prependedContentDuration)),i.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}),e.on("audioSegmentTimingInfo",function(e){var t={start:{decode:f.videoTsToSeconds(e.start.dts),presentation:f.videoTsToSeconds(e.start.pts)},end:{decode:f.videoTsToSeconds(e.end.dts),presentation:f.videoTsToSeconds(e.end.pts)},baseMediaDecodeTime:f.videoTsToSeconds(e.baseMediaDecodeTime)};e.prependedContentDuration&&(t.prependedContentDuration=f.videoTsToSeconds(e.prependedContentDuration)),i.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:t})}),e.on("id3Frame",function(e){i.postMessage({action:"id3Frame",id3Frame:e})}),e.on("caption",function(e){i.postMessage({action:"caption",caption:e})}),e.on("trackinfo",function(e){i.postMessage({action:"trackinfo",trackInfo:e})}),e.on("audioTimingInfo",function(e){i.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:f.videoTsToSeconds(e.start),end:f.videoTsToSeconds(e.end)}})}),e.on("videoTimingInfo",function(e){i.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:f.videoTsToSeconds(e.start),end:f.videoTsToSeconds(e.end)}})}),e.on("log",function(e){i.postMessage({action:"log",log:e})})}pushMp4Captions(e){this.captionParser||(this.captionParser=new Dt,this.captionParser.init());var t=new Uint8Array(e.data,e.byteOffset,e.byteLength),e=this.captionParser.parse(t,e.trackIds,e.timescales);this.self.postMessage({action:"mp4Captions",captions:e&&e.captions||[],logs:e&&e.logs||[],data:t.buffer},[t.buffer])}probeMp4StartTime({timescales:e,data:t}){e=ii(e,t);this.self.postMessage({action:"probeMp4StartTime",startTime:e,data:t},[t.buffer])}probeMp4Tracks({data:e}){var t=ri(e);this.self.postMessage({action:"probeMp4Tracks",tracks:t,data:e},[e.buffer])}probeTs({data:e,baseStartTime:t}){t="number"!=typeof t||isNaN(t)?void 0:t*f.ONE_SECOND_IN_TS,t=Ft(e,t);let i=null;t&&((i={hasVideo:t.video&&2===t.video.length||!1,hasAudio:t.audio&&2===t.audio.length||!1}).hasVideo&&(i.videoStart=t.video[0].ptsTime),i.hasAudio)&&(i.audioStart=t.audio[0].ptsTime),this.self.postMessage({action:"probeTs",result:i,data:e},[e.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(e){e=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(e)}reset(){this.transmuxer.reset()}setTimestampOffset(e){e=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(f.secondsToVideoTs(e)))}setAudioAppendStart(e){this.transmuxer.setAudioAppendStart(Math.ceil(f.secondsToVideoTs(e.appendStart)))}setRemux(e){this.transmuxer.setRemux(e.remux)}flush(e){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}self.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new ai(self,e.data.options):(this.messageHandlers||(this.messageHandlers=new ai(self)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}));var to=Ja(eo);const io=i=>{const{transmuxer:r,bytes:e,audioAppendStart:t,gopsToAlignWith:n,remux:s,onData:a,onTrackInfo:o,onAudioTimingInfo:l,onVideoTimingInfo:h,onVideoSegmentTimingInfo:u,onAudioSegmentTimingInfo:c,onId3:d,onCaptions:p,onDone:f,onEndedTimeline:m,onTransmuxerLog:g,isEndOfTimeline:v}=i,y={buffer:[]};let _=v;if(r.onmessage=e=>{var t;r.currentTransmux!==i||("data"===e.data.action&&((e,t,i)=>{var{type:r,initSegment:n,captions:s,captionStreams:a,metadata:o,videoFrameDtsTime:l,videoFramePtsTime:h}=e.data.segment,t=(t.buffer.push({captions:s,captionStreams:a,metadata:o}),e.data.segment.boxes||{data:e.data.segment.data}),s={type:r,data:new Uint8Array(t.data,t.data.byteOffset,t.data.byteLength),initSegment:new Uint8Array(n.data,n.byteOffset,n.byteLength)};void 0!==l&&(s.videoFrameDtsTime=l),void 0!==h&&(s.videoFramePtsTime=h),i(s)})(e,y,a),"trackinfo"===e.data.action&&o(e.data.trackInfo),"gopInfo"===e.data.action&&(t=e,y.gopInfo=t.data.gopInfo),"audioTimingInfo"===e.data.action&&l(e.data.audioTimingInfo),"videoTimingInfo"===e.data.action&&h(e.data.videoTimingInfo),"videoSegmentTimingInfo"===e.data.action&&u(e.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===e.data.action&&c(e.data.audioSegmentTimingInfo),"id3Frame"===e.data.action&&d([e.data.id3Frame],e.data.id3Frame.dispatchType),"caption"===e.data.action&&p(e.data.caption),"endedtimeline"===e.data.action&&(_=!1,m()),"log"===e.data.action&&g(e.data.log),"transmuxed"!==e.data.type)||_||(r.onmessage=null,{transmuxedData:t,callback:e}=[{transmuxedData:y,callback:f}][0],t.buffer=[],e(t),ro(r))},t&&r.postMessage({action:"setAudioAppendStart",appendStart:t}),Array.isArray(n)&&r.postMessage({action:"alignGopsWith",gopsToAlignWith:n}),void 0!==s&&r.postMessage({action:"setRemux",remux:s}),e.byteLength){const i=e instanceof ArrayBuffer?e:e.buffer,t=e instanceof ArrayBuffer?0:e.byteOffset;r.postMessage({action:"push",data:i,byteOffset:t,byteLength:e.byteLength},[i])}v&&r.postMessage({action:"endTimeline"}),r.postMessage({action:"flush"})},ro=e=>{e.currentTransmux=null,e.transmuxQueue.length&&(e.currentTransmux=e.transmuxQueue.shift(),"function"==typeof e.currentTransmux?e.currentTransmux():io(e.currentTransmux))},no=(e,t)=>{e.postMessage({action:t}),ro(e)};var so=e=>{(e=e).currentTransmux?e.transmuxQueue.push(no.bind(null,e,"reset")):(e.currentTransmux="reset",no(e,"reset"))};function ao({id:t,key:e,encryptedBytes:i,decryptionWorker:r},n){const s=e=>{if(e.data.source===t){r.removeEventListener("message",s);const t=e.data.decrypted;n(new Uint8Array(t.bytes,t.byteOffset,t.byteLength))}};var a;r.addEventListener("message",s),a=e.bytes.slice?e.bytes.slice():new Uint32Array(Array.prototype.slice.call(e.bytes)),r.postMessage(Va({source:t,encrypted:i,key:a,iv:e.iv}),[i.buffer,a.buffer])}function oo(e){const r={};return e.forEach(({mediaType:e,type:t,details:i})=>{r[e]=r[e]||[],r[e].push(oe(""+t+i))}),Object.keys(r).forEach(function(e){1<r[e].length?(wo(`multiple ${e} codecs found as attributes: ${r[e].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),r[e]=null):r[e]=r[e][0]}),r}function lo(e){let t=0;return e.audio&&t++,e.video&&t++,t}function ho(e,t){var i=t.attributes||{},r=oo(function(){var e=t.attributes||{};if(e.CODECS)return J(e.CODECS)}()||[]);if(So(e,t)&&!r.audio&&!((e,t)=>{if(!So(e,t))return!0;var t=t.attributes||{},i=e.mediaGroups.AUDIO[t.AUDIO];for(const e in i)if(!i[e].uri&&!i[e].playlists)return!0;return!1})(e,t)){const t=oo(function(e,t){if(e.mediaGroups.AUDIO&&t){var i=e.mediaGroups.AUDIO[t];if(i)for(var r in i){r=i[r];if(r.default&&r.playlists)return J(r.playlists[0].attributes.CODECS)}}return null}(e,i.AUDIO)||[]);t.audio&&(r.audio=t.audio)}return r}function uo(e,t){return(e=e&&v().getComputedStyle(e))?e[t]:""}function co(e,t){let i,r;return i=(i=e.attributes.BANDWIDTH?e.attributes.BANDWIDTH:i)||v().Number.MAX_VALUE,r=(r=t.attributes.BANDWIDTH?t.attributes.BANDWIDTH:r)||v().Number.MAX_VALUE,i-r}const po=function(t){const i=t.transmuxer,r=t.endAction||t.action,n=t.callback,e=F({},t,{endAction:null,transmuxer:null,callback:null}),s=e=>{e.data.action===r&&(i.removeEventListener("message",s),e.data.data&&(e.data.data=new Uint8Array(e.data.data,t.byteOffset||0,t.byteLength||e.data.data.byteLength),t.data)&&(t.data=e.data.data),n(e.data))};if(i.addEventListener("message",s),t.data){const r=t.data instanceof ArrayBuffer,n=(e.byteOffset=r?0:t.data.byteOffset,e.byteLength=t.data.byteLength,[r?t.data:t.data.buffer]);i.postMessage(e,n)}else i.postMessage(e)},fo=-101,mo=-102,go=e=>{e.forEach(e=>{e.abort()})},vo=(e,t)=>t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:fo,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:mo,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:2,xhr:t}:"arraybuffer"===t.responseType&&0===t.response.byteLength?{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:2,xhr:t}:null,yo=(n,s,a)=>(e,t)=>{var i=t.response,e=vo(e,t);if(e)return a(e,n);if(16!==i.byteLength)return a({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:2,xhr:t},n);var e=new DataView(i),r=new Uint32Array([e.getUint32(0),e.getUint32(4),e.getUint32(8),e.getUint32(12)]);for(let e=0;e<s.length;e++)s[e].bytes=r;return a(null,n)},_o=(i,r)=>{var e,t=vt(i.map.bytes);if("mp4"!==t)return e=i.map.resolvedUri||i.map.uri,r({internal:!0,message:`Found unsupported ${t||"unknown"} container for initialization segment at URL: `+e,code:2});po({action:"probeMp4Tracks",data:i.map.bytes,transmuxer:i.transmuxer,callback:({tracks:e,data:t})=>(i.map.bytes=t,e.forEach(function(e){i.map.tracks=i.map.tracks||{},i.map.tracks[e.type]||"number"==typeof(i.map.tracks[e.type]=e).id&&e.timescale&&(i.map.timescales=i.map.timescales||{},i.map.timescales[e.id]=e.timescale)}),r(null))})},bo=({segment:i,bytes:t,trackInfoFn:r,timingInfoFn:e,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:d})=>{const p=i.map&&i.map.tracks||{},f=Boolean(p.audio&&p.video);let m=e.bind(null,i,"audio","start");const g=e.bind(null,i,"audio","end");let v=e.bind(null,i,"video","start");const y=e.bind(null,i,"video","end");po({action:"probeTs",transmuxer:i.transmuxer,data:t,baseStartTime:i.baseStartTime,callback:e=>{i.bytes=t=e.data;var e=e.result;e&&(r(i,{hasAudio:e.hasAudio,hasVideo:e.hasVideo,isMuxed:f}),r=null,e.hasAudio&&!f&&m(e.audioStart),e.hasVideo&&v(e.videoStart),m=null,v=null),(e={bytes:t,transmuxer:i.transmuxer,audioAppendStart:i.audioAppendStart,gopsToAlignWith:i.gopsToAlignWith,remux:f,onData:e=>{e.type="combined"===e.type?"video":e.type,u(i,e)},onTrackInfo:e=>{r&&(f&&(e.isMuxed=!0),r(i,e))},onAudioTimingInfo:e=>{m&&void 0!==e.start&&(m(e.start),m=null),g&&void 0!==e.end&&g(e.end)},onVideoTimingInfo:e=>{v&&void 0!==e.start&&(v(e.start),v=null),y&&void 0!==e.end&&y(e.end)},onVideoSegmentTimingInfo:e=>{n(e)},onAudioSegmentTimingInfo:e=>{s(e)},onId3:(e,t)=>{a(i,e,t)},onCaptions:e=>{o(i,[e])},isEndOfTimeline:l,onEndedTimeline:()=>{h()},onTransmuxerLog:d,onDone:e=>{c&&(e.type="combined"===e.type?"video":e.type,c(null,i,e))}}).transmuxer.currentTransmux?e.transmuxer.transmuxQueue.push(e):(e.transmuxer.currentTransmux=e,io(e))}})},To=({segment:i,bytes:r,trackInfoFn:e,timingInfoFn:n,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:t,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:d})=>{let p=new Uint8Array(r);if(f=p,0<ot(f,["moof"]).length){i.isFmp4=!0;const s=i.map["tracks"],a={isFmp4:!0,hasVideo:!!s.video,hasAudio:!!s.audio},o=(s.audio&&s.audio.codec&&"enca"!==s.audio.codec&&(a.audioCodec=s.audio.codec),s.video&&s.video.codec&&"encv"!==s.video.codec&&(a.videoCodec=s.video.codec),s.video&&s.audio&&(a.isMuxed=!0),e(i,a),e=>{u(i,{data:p,type:a.hasAudio&&!a.isMuxed?"audio":"video"}),e&&e.length&&t(i,e),c(null,i,{})});po({action:"probeMp4StartTime",timescales:i.map.timescales,data:p,transmuxer:i.transmuxer,callback:({data:e,startTime:t})=>{r=e.buffer,i.bytes=p=e,a.hasAudio&&!a.isMuxed&&n(i,"audio","start",t),a.hasVideo&&n(i,"video","start",t),s.video&&e.byteLength&&i.transmuxer?po({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:i.transmuxer,data:p,timescales:i.map.timescales,trackIds:[s.video.id],callback:e=>{r=e.data.buffer,i.bytes=p=e.data,e.logs.forEach(function(e){d(P(e,{stream:"mp4CaptionParser"}))}),o(e.captions)}}):o()}})}else i.transmuxer?(void 0===i.container&&(i.container=vt(p)),"ts"!==i.container&&"aac"!==i.container?(e(i,{hasAudio:!1,hasVideo:!1}),c(null,i,{})):bo({segment:i,bytes:r,trackInfoFn:e,timingInfoFn:n,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:a,id3Fn:o,captionsFn:t,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:d})):c(null,i,{});var f},xo=({xhr:e,xhrOptions:t,decryptionWorker:i,segment:r,abortFn:n,progressFn:s,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:h,id3Fn:u,captionsFn:c,isEndOfTimeline:d,endedTimelineFn:p,dataFn:f,doneFn:m,onTransmuxerLog:g})=>{const v=[],y=(({activeXhrs:t,decryptionWorker:f,trackInfoFn:m,timingInfoFn:g,videoSegmentTimingInfoFn:v,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:b,isEndOfTimeline:T,endedTimelineFn:x,dataFn:w,doneFn:S,onTransmuxerLog:E})=>{let i=0,r=!1;return(e,p)=>{if(!r){if(e)return r=!0,go(t),S(e,p);if((i+=1)===t.length){const i=function(){var e,t,i,r,n,s,a,o,l,h,u,c,d;p.encryptedBytes?({decryptionWorker:e,segment:t,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:d}=[{decryptionWorker:f,segment:p,trackInfoFn:m,timingInfoFn:g,videoSegmentTimingInfoFn:v,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:b,isEndOfTimeline:T,endedTimelineFn:x,dataFn:w,doneFn:S,onTransmuxerLog:E}][0],ao({id:t.requestId,key:t.key,encryptedBytes:t.encryptedBytes,decryptionWorker:e},e=>{t.bytes=e,To({segment:t,bytes:t.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:d})})):To({segment:p,bytes:p.bytes,trackInfoFn:m,timingInfoFn:g,videoSegmentTimingInfoFn:v,audioSegmentTimingInfoFn:y,id3Fn:_,captionsFn:b,isEndOfTimeline:T,endedTimelineFn:x,dataFn:w,doneFn:S,onTransmuxerLog:E})};if(p.endOfAllRequests=Date.now(),p.map&&p.map.encryptedBytes&&!p.map.bytes)return ao({decryptionWorker:f,id:p.requestId+"-init",encryptedBytes:p.map.encryptedBytes,key:p.map.key},e=>{p.map.bytes=e,_o(p,e=>{if(e)return go(t),S(e,p);i()})});i()}}}})({activeXhrs:v,decryptionWorker:i,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:h,id3Fn:u,captionsFn:c,isEndOfTimeline:d,endedTimelineFn:p,dataFn:f,doneFn:m,onTransmuxerLog:g});if(r.key&&!r.key.bytes){const i=[r.key],n=(r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&i.push(r.map.key),e(P(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),yo(r,i,y)));v.push(n)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const i=e(P(t,{uri:r.map.key.resolvedUri,responseType:"arraybuffer"}),yo(r,[r.map.key],y));v.push(i)}const i=P(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:Na(r.map)}),n=({segment:_,finishProcessingFn:b}=[{segment:r,finishProcessingFn:y}][0],(e,t)=>{var e=vo(e,t);return e?b(e,_):(e=new Uint8Array(t.response),_.map.key?(_.map.encryptedBytes=e,b(null,_)):(_.map.bytes=e,void _o(_,function(e){if(e)return e.xhr=t,e.status=t.status,b(e,_);b(null,_)})))}),s=e(i,n);v.push(s)}var _,b,T,x,w,S,E,i=P(t,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:Na(r)}),a=e(i,({segment:T,finishProcessingFn:x,responseType:w}=[{segment:r,finishProcessingFn:y,responseType:i.responseType}][0],(e,t)=>{var e=vo(e,t);return e?x(e,T):(e="arraybuffer"!==w&&t.responseText?(t=>{var i=new Uint8Array(new ArrayBuffer(t.length));for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return i.buffer})(t.responseText.substring(T.lastReachedChar||0)):t.response,T.stats={bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0},T.key?T.encryptedBytes=new Uint8Array(e):T.bytes=new Uint8Array(e),x(null,T))}));a.addEventListener("progress",({segment:S,progressFn:E}=[{segment:r,progressFn:s}][0],e=>{if(!e.target.aborted)return S.stats=P(S.stats,(i=(t=e).target,(i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-i.requestTime||0}).bytesReceived=t.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i)),!S.stats.firstBytesReceivedAt&&S.stats.bytesReceived&&(S.stats.firstBytesReceivedAt=Date.now()),E(e,S);var t,i})),v.push(a);const M={};return v.forEach(e=>{var t,i;e.addEventListener("loadend",({loadendState:t,abortFn:i}=[{loadendState:M,abortFn:n}][0],e=>{e.target.aborted&&i&&!t.calledAbortFn&&(i(),t.calledAbortFn=!0)}))}),()=>go(v)},wo=Js("CodecUtils"),So=(e,t)=>{t=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&t.AUDIO&&e.mediaGroups.AUDIO[t.AUDIO]},Eo=Js("PlaylistSelector"),Mo=function(e){var t;if(e&&e.playlist)return t=e.playlist,JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})},Co=function(e,r){const n=e.slice();e.sort(function(e,t){var i=r(e,t);return 0===i?n.indexOf(e)-n.indexOf(t):i})};function Ao(o,t,l,h,u,c){if(o){var d={bandwidth:t,width:l,height:h,limitRenditionByPlayerDimensions:u};let e=o.playlists,n=(k.isAudioOnly(o)&&(e=c.getAudioTrackPlaylists_(),d.audioOnly=!0),e.map(e=>{var t=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,i=e.attributes&&e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,r=e.attributes&&e.attributes.BANDWIDTH;return{bandwidth:r||v().Number.MAX_VALUE,width:t,height:i,playlist:e}})),s=(Co(n,(e,t)=>e.bandwidth-t.bandwidth),(n=n.filter(e=>!k.isIncompatible(e.playlist))).filter(e=>k.isEnabled(e.playlist)));o=(s=s.length?s:n.filter(e=>!k.isDisabled(e.playlist))).filter(e=>e.bandwidth*D.BANDWIDTH_VARIANCE<t);let a=o[o.length-1];var p=o.filter(e=>e.bandwidth===a.bandwidth)[0];if(!1===u){const o=p||s[0]||n[0];if(o&&o.playlist){let e=p?"bandwidthBestRep":"sortedPlaylistReps";return s[0]&&(e="enabledPlaylistReps"),Eo(`choosing ${Mo(o)} using ${e} with options`,d),o.playlist}}else{u=o.filter(e=>e.width&&e.height),o=(Co(u,(e,t)=>e.width-t.width),u.filter(e=>e.width===l&&e.height===h)),o=(a=o[o.length-1],o.filter(e=>e.bandwidth===a.bandwidth)[0]);let t,e,i,r;if(o||(t=u.filter(e=>e.width>l||e.height>h),e=t.filter(e=>e.width===t[0].width&&e.height===t[0].height),a=e[e.length-1],i=e.filter(e=>e.bandwidth===a.bandwidth)[0]),c.leastPixelDiffSelector){const o=u.map(e=>(e.pixelDiff=Math.abs(e.width-l)+Math.abs(e.height-h),e));Co(o,(e,t)=>e.pixelDiff===t.pixelDiff?t.bandwidth-e.bandwidth:e.pixelDiff-t.pixelDiff),r=o[0]}c=r||i||o||p||s[0]||n[0];if(c&&c.playlist){let e="sortedPlaylistReps";return r?e="leastPixelDiffRep":i?e="resolutionPlusOneRep":o?e="resolutionBestRep":p?e="bandwidthBestRep":s[0]&&(e="enabledPlaylistReps"),Eo(`choosing ${Mo(c)} using ${e} with options`,d),c.playlist}}return Eo("could not choose a playlist with options",d),null}}function Lo(){var e=this.useDevicePixelRatio&&v().devicePixelRatio||1;return Ao(this.playlists.main,this.systemBandwidth,parseInt(uo(this.tech_.el(),"width"),10)*e,parseInt(uo(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.playlistController_)}function Io(e,t,i){let r,n;if(i&&i.cues)for(r=i.cues.length;r--;)(n=i.cues[r]).startTime>=e&&n.endTime<=t&&i.removeCue(n)}const Po=e=>"number"==typeof e&&isFinite(e),Ro=e=>{var{startOfSegment:t,duration:i,segment:r,part:n,playlist:{mediaSequence:s,id:a,segments:o=[]},mediaIndex:l,partIndex:h,timeline:u}=e,o=o.length-1;let c="mediaIndex/partIndex increment";e.getMediaInfoForTime?c=`getMediaInfoForTime (${e.getMediaInfoForTime})`:e.isSyncRequest&&(c="getSyncSegmentCandidate (isSyncRequest)"),e.independent&&(c+=" with independent "+e.independent);var d="number"==typeof h,e=e.segment.uri?"segment":"pre-segment",p=d?ya({preloadSegment:r})-1:0;return e+` [${s+l}/${s+o}]`+(d?` part [${h}/${p}]`:"")+` segment start/end [${r.start} => ${r.end}]`+(d?` part start/end [${n.start} => ${n.end}]`:"")+` startOfSegment [${t}]`+` duration [${i}]`+` timeline [${u}]`+` selected by [${c}]`+` playlist [${a}]`},ko=e=>e+"TimingInfo",Do=({timelineChangeController:e,currentTimeline:t,segmentTimeline:i,loaderType:r,audioDisabled:n})=>{if(t!==i){if("audio"===r){const t=e.lastTimelineChange({type:"main"});return!t||t.to!==i}if("main"===r&&n){const t=e.pendingTimelineChange({type:"audio"});return!t||t.to!==i}}return!1},Oo=({segmentDuration:e,maxDuration:t})=>!!e&&Math.round(e)>t+da;class No extends I.EventTarget{constructor(e,t=0){if(super(),!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=11<=I.browser.IE_VERSION,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=Js(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),"main"===this.loaderType_&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),"audio"===this.loaderType_&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){{var e={remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_};const t=new to,i=(t.currentTransmux=null,t.transmuxQueue=[],t.terminate);return t.terminate=()=>(t.currentTransmux=null,t.transmuxQueue.length=0,i.call(t)),t.postMessage({action:"init",options:e}),t}}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&v().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,v().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==e:(this.state="READY",!0)}error(e){return void 0!==e&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&so(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){var e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return R();if("main"===this.loaderType_){var{hasAudio:e,hasVideo:t,isMuxed:i}=e;if(t&&e&&!this.audioDisabled_&&!i)return this.sourceUpdater_.buffered();if(t)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;var i=Fa(e);let r=this.initSegments_[i];return t&&!r&&e.bytes&&(this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),r||e}segmentKey(e,t=!1){if(!e)return null;var i=Ha(e);let r=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[i]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});t={resolvedUri:(r||e).resolvedUri};return r&&(t.bytes=r.bytes),t}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(t,i={}){if(t){var r=this.playlist_,n=this.pendingSegment_;this.playlist_=t,this.xhrOptions_=i,"INIT"===this.state&&(t.syncInfo={mediaSequence:t.mediaSequence,time:0},"main"===this.loaderType_)&&this.syncController_.setDateTimeMappingForStart(t);let e=null;if(r&&(r.id?e=r.id:r.uri&&(e=r.uri)),this.logger_(`playlist update [${e} => ${t.id||t.uri}]`),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(r&&r.uri===t.uri){i=t.mediaSequence-r.mediaSequence;if(this.logger_(`live window shift [${i}]`),null!==this.mediaIndex)if(this.mediaIndex-=i,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const t=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!t.parts||!t.parts.length||!t.parts[this.partIndex])){const t=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=t}}n&&(n.mediaIndex-=i,n.mediaIndex<0?(n.mediaIndex=null,n.partIndex=null):(0<=n.mediaIndex&&(n.segment=t.segments[n.mediaIndex]),0<=n.partIndex&&n.segment.parts&&(n.part=n.segment.parts[n.partIndex]))),this.syncController_.saveExpiredSegmentInfo(r,t)}else null!==this.mediaIndex&&(t.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate")}}pause(){this.checkBufferTimeout_&&(v().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return null===this.checkBufferTimeout_}resetEverything(e){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&so(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(a,t,i=()=>{},r=!1){if((t=t===1/0?this.duration_():t)<=a)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){let e=1;var n=()=>{0===--e&&i()};!r&&this.audioDisabled_||(e++,this.sourceUpdater_.removeAudio(a,t,n)),!r&&"main"!==this.loaderType_||(this.gopBuffer_=((t,i,e)=>{var r=Math.ceil((a-e)*yt.ONE_SECOND_IN_TS),n=Math.ceil((i-e)*yt.ONE_SECOND_IN_TS),i=t.slice();let s=t.length;for(;s--&&!(t[s].pts<=n););if(-1!==s){let e=s+1;for(;e--&&!(t[e].pts<=r););e=Math.max(e,0),i.splice(e,s-e+1)}return i})(this.gopBuffer_,t,this.timeMapping_),e++,this.sourceUpdater_.removeVideo(a,t,n));for(const i in this.inbandTextTracks_)Io(a,t,this.inbandTextTracks_[i]);Io(a,t,this.segmentMetadataTrack_),n()}else this.logger_("skipping remove because no source updater or starting media info")}monitorBuffer_(){this.checkBufferTimeout_&&v().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=v().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&v().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=v().setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){var e;this.sourceUpdater_.updating()||(e=this.chooseNextRequest_())&&("number"==typeof e.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,i=this.partIndex){var r;return!(!t||!this.mediaSource_)&&(r="number"==typeof e&&t.segments[e],e=e+1===t.segments.length,i=!r||!r.parts||i+1===r.parts.length,t.endList)&&"open"===this.mediaSource_.readyState&&e&&i}chooseNextRequest_(){const e=this.buffered_(),t=ta(e)||0,i=ia(e,this.currentTime_()),r=!this.hasPlayed_()&&1<=i,n=i>=this.goalBufferLength_(),s=this.playlist_.segments;if(!s.length||r||n)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(a.isSyncRequest)a.mediaIndex=function(t,i,r){i=i||[];var n=[];let s=0;for(let e=0;e<i.length;e++){var a=i[e];if(t===a.timeline&&(n.push(e),(s+=a.duration)>r))return e}return 0===n.length?0:n[n.length-1]}(this.currentTimeline_,s,t);else if(null!==this.mediaIndex){const e=s[this.mediaIndex],i="number"==typeof this.partIndex?this.partIndex:-1;a.startOfSegment=e.end||t,e.parts&&e.parts[i+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=i+1):a.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:e,startTime:i,partIndex:r}=k.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?t:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});a.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+t:"currentTime "+this.currentTime_(),a.mediaIndex=e,a.startOfSegment=i,a.partIndex=r}var o=s[a.mediaIndex];let l=o&&"number"==typeof a.partIndex&&o.parts&&o.parts[a.partIndex];if(!o||"number"==typeof a.partIndex&&!l)return null;if("number"!=typeof a.partIndex&&o.parts&&(a.partIndex=0,l=o.parts[0]),!i&&l&&!l.independent)if(0===a.partIndex){const e=s[a.mediaIndex-1],t=e.parts&&e.parts.length&&e.parts[e.parts.length-1];t&&t.independent&&(--a.mediaIndex,a.partIndex=e.parts.length-1,a.independent="previous segment")}else o.parts[a.partIndex-1].independent&&(--a.partIndex,a.independent="previous part");o=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return a.mediaIndex>=s.length-1&&o&&!this.seeking_()?null:this.generateSegmentInfo_(a)}generateSegmentInfo_(e){var{independent:e,playlist:t,mediaIndex:i,startOfSegment:r,isSyncRequest:n,partIndex:s,forceTimestampOffset:a,getMediaInfoForTime:o}=e,l=t.segments[i],h="number"==typeof s&&l.parts[s],i={requestId:"segment-loader-"+Math.random(),uri:h&&h.resolvedUri||l.resolvedUri,mediaIndex:i,partIndex:h?s:null,isSyncRequest:n,startOfSegment:r,playlist:t,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:l.timeline,duration:h&&h.duration||l.duration,segment:l,part:h,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:o,independent:e},s=void 0!==a?a:this.isPendingTimestampOffset_,n=(i.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:l.timeline,currentTimeline:this.currentTimeline_,startOfSegment:r,buffered:this.buffered_(),overrideCheck:s}),ta(this.sourceUpdater_.audioBuffered()));return"number"==typeof n&&(i.audioAppendStart=n-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(i.gopsToAlignWith=((e,t,i)=>{if(null==t||!e.length)return[];var r=Math.ceil((t-i+3)*yt.ONE_SECOND_IN_TS);let n;for(n=0;n<e.length&&!(e[n].pts>r);n++);return e.slice(n)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),i}timestampOffsetForSegment_(e){return{segmentTimeline:e,currentTimeline:t,startOfSegment:i,buffered:r,overrideCheck:n}=[e][0],n||e!==t?!(e<t)&&r.length?r.end(r.length-1):i:null;var t,i,r,n}earlyAbortWhenNeeded_(t){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3)){var e=this.currentTime_(),i=t.bandwidth,r=this.pendingSegment_.duration,t=k.estimateSegmentRequestTime(r,i,this.playlist_,t.bytesReceived),n=([n,s,a=1]=[this.buffered_(),e,this.vhs_.tech_.playbackRate()],((n.length?n.end(n.length-1):0)-s)/a-1);if(!(t<=n)){var s=function(e){const{main:t,currentTime:i,bandwidth:r,duration:n,segmentDuration:s,timeUntilRebuffer:a,currentTimeline:o,syncController:l}=e,h=t.playlists.filter(e=>!k.isIncompatible(e));let u=h.filter(k.isEnabled);var e=(u=u.length?u:h.filter(e=>!k.isDisabled(e))).filter(k.hasAttribute.bind(null,"BANDWIDTH")).map(e=>{var t=l.getSyncPoint(e,n,o,i)?1:2;return{playlist:e,rebufferingImpact:k.estimateSegmentRequestTime(s,r,e)*t-a}}),c=e.filter(e=>e.rebufferingImpact<=0);return Co(c,(e,t)=>co(t.playlist,e.playlist)),c.length?c[0]:(Co(e,(e,t)=>e.rebufferingImpact-t.rebufferingImpact),e[0]||null)}({main:this.vhs_.playlists.main,currentTime:e,bandwidth:i,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:n,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(s){var a=t-n-s.rebufferingImpact;let e=.5;n<=da&&(e=1),!s.playlist||s.playlist.uri===this.playlist_.uri||a<e||(this.bandwidth=s.playlist.attributes.BANDWIDTH*D.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}}handleAbort_(e){this.logger_("Aborting "+Ro(e)),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId)||this.trigger("progress")}handleTrackInfo_(e,t){this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId)||this.checkForIllegalMediaSwitch(t)||(function(t,i){if(!(!t&&!i||!t&&i||t&&!i)){if(t===i)return 1;var r=Object.keys(t).sort(),n=Object.keys(i).sort();if(r.length===n.length){for(let e=0;e<r.length;e++){var s=r[e];if(s!==n[e])return;if(t[s]!==i[s])return}return 1}}}(this.currentMediaInfo_,t=t||{})||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(e.requestId))||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())}handleTimingInfo_(e,t,i,r){var n;this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId)||((e=this.pendingSegment_)[n=ko(t)]=e[n]||{},e[n][i]=r,this.logger_(`timinginfo: ${t} - ${i} - `+r),this.hasEnoughInfoToAppend_()&&this.processCallQueue_())}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(0===t.length)this.logger_("SegmentLoader received no captions from a caption event");else if(this.pendingSegment_.hasAppendedData_){const d=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),p={};t.forEach(e=>{p[e.stream]=p[e.stream]||{startTime:1/0,captions:[],endTime:0};var t=p[e.stream];t.startTime=Math.min(t.startTime,e.startTime+d),t.endTime=Math.max(t.endTime,e.endTime+d),t.captions.push(e)}),Object.keys(p).forEach(e=>{var{startTime:t,endTime:i,captions:r}=p[e],n=this.inbandTextTracks_,s=(this.logger_(`adding cues from ${t} -> ${i} for `+e),n),a=this.vhs_.tech_,o=e;if(!s[o]){a.trigger({type:"usage",name:"vhs-608"});let r=o;/^cc708_/.test(o)&&(r="SERVICE"+o.split("_")[1]);var l=a.textTracks().getTrackById(r);if(l)s[o]=l;else{let e=o,t=o,i=!1;l=(a.options_.vhs&&a.options_.vhs.captionServices||{})[r];l&&(e=l.label,t=l.language,i=l.default),s[o]=a.addRemoteTextTrack({kind:"captions",id:r,default:i,label:e,language:t},!1).track}}Io(t,i,n[e]);var{inbandTextTracks:h,captionArray:l,timestampOffset:u}={captionArray:r,inbandTextTracks:n,timestampOffset:d};if(l){const c=v().WebKitDataCue||v().VTTCue;l.forEach(e=>{var t=e.stream;h[t].addCue(new c(e.startTime+u,e.endTime+u,e.text))})}}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t))}handleId3_(e,t,i){if(this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId))if(this.pendingSegment_.hasAppendedData_){var r,n=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),[{inbandTextTracks:s,metadataArray:a,timestampOffset:o,videoDuration:l}]=(a=this.inbandTextTracks_,r=i,s=this.vhs_.tech_,a.metadataTrack_||(a.metadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,a.metadataTrack_.inBandMetadataTrackDispatchType=r),[{inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:n,videoDuration:this.duration_()}]);if(a){const c=v().WebKitDataCue||v().VTTCue,d=s.metadataTrack_;if(d&&(a.forEach(e=>{const r=e.cueTime+o;!("number"!=typeof r||v().isNaN(r)||r<0)&&r<1/0&&e.frames.forEach(e=>{var t,i=new c(r,r,e.value||e.url||e.data||"");i.frame=e,i.value=e,t=i,Object.defineProperties(t.frame,{id:{get:()=>(I.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key)},value:{get:()=>(I.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data)},privateData:{get:()=>(I.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data)}}),d.addCue(i)})}),d.cues)&&d.cues.length){var h=d.cues,u=[];for(let e=0;e<h.length;e++)h[e]&&u.push(h[e]);const p=u.reduce((e,t)=>{var i=e[t.startTime]||[];return i.push(t),e[t.startTime]=i,e},{}),f=Object.keys(p).sort((e,t)=>Number(e)-Number(t));f.forEach((e,t)=>{const i=p[e],r=Number(f[t+1])||l;i.forEach(e=>{e.endTime=r})})}}}else this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i))}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){var e=this.callQueue_;this.callQueue_=[],e.forEach(e=>e())}processLoadQueue_(){var e=this.loadQueue_;this.loadQueue_=[],e.forEach(e=>e())}hasEnoughInfoToLoad_(){var e;return"audio"!==this.loaderType_||!(!(e=this.pendingSegment_)||this.getCurrentMediaInfo_()&&Do({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}hasEnoughInfoToAppend_(){var e,t,i,r;return!!this.sourceUpdater_.ready()&&!(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_||(e=this.pendingSegment_,t=this.getCurrentMediaInfo_(),!e)||!t||({hasAudio:t,hasVideo:i,isMuxed:r}=t,i&&!e.videoTimingInfo)||t&&!this.audioDisabled_&&!r&&!e.audioTimingInfo||Do({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(t,i){if(this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId))if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())this.callQueue_.push(this.handleData_.bind(this,t,i));else{var r=this.pendingSegment_;if(this.setTimeMapping_(r.timeline),this.updateMediaSecondsLoaded_(r.part||r.segment),"closed"!==this.mediaSource_.readyState){if(t.map&&(t.map=this.initSegmentForMap(t.map,!0),r.segment.map=t.map),t.key&&this.segmentKey(t.key,!0),r.isFmp4=t.isFmp4,r.timingInfo=r.timingInfo||{},r.isFmp4)this.trigger("fmp4"),r.timingInfo.start=r[ko(i.type)].start;else{const t=this.getCurrentMediaInfo_(),i="main"===this.loaderType_&&t&&t.hasVideo;let e;i&&(e=r.videoTimingInfo.start),r.timingInfo.start=this.trueSegmentStart_({currentStart:r.timingInfo.start,playlist:r.playlist,mediaIndex:r.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:i,firstVideoFrameTimeForData:e,videoTimingInfo:r.videoTimingInfo,audioTimingInfo:r.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(r,i.type),this.updateSourceBufferTimestampOffset_(r),r.isSyncRequest){this.updateTimingInfoEnd_(r),this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:"main"===this.loaderType_});const t=this.chooseNextRequest_();if(t.mediaIndex!==r.mediaIndex||t.partIndex!==r.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}r.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(r,i)}}}updateAppendInitSegmentStatus(e,t){"main"!==this.loaderType_||"number"!=typeof e.timestampOffset||e.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:i,playlist:r}){if(i){const e=Fa(i);if(this.activeInitSegmentId_===e)return null;t=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=e}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=r,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i},r){var n=this.sourceUpdater_.audioBuffered(),s=this.sourceUpdater_.videoBuffered(),a=(1<n.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+fa(n).join(", ")),1<s.length&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+fa(s).join(", ")),n.length?n.start(0):0),o=n.length?n.end(n.length-1):0,l=s.length?s.start(0):0,h=s.length?s.end(s.length-1):0;o-a<=1&&h-l<=1?(this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${i.byteLength}, audio buffer: ${fa(n).join(", ")}, video buffer: ${fa(s).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error")):(this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:i})),o=this.currentTime_()-1,this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+o),this.remove(0,o,()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=v().setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},1e3)},!0))}handleAppendError_({segmentInfo:e,type:t,bytes:i},r){r&&(22!==r.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",r),this.error(`${t} append of ${i.length}b failed for segment #${e.mediaIndex} in playlist `+e.playlist.id),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i}))}appendToSourceBuffer_({segmentInfo:t,type:e,initSegment:i,data:r,bytes:n}){if(!n){const t=[r];let e=r.byteLength;i&&(t.unshift(i),e+=i.byteLength),n=(e=>{let t,i=0;return e.bytes&&(t=new Uint8Array(e.bytes),e.segments.forEach(e=>{t.set(e,i),i+=e.byteLength})),t})({bytes:e,segments:t})}this.sourceUpdater_.appendBuffer({segmentInfo:t,type:e,bytes:n},this.handleAppendError_.bind(this,{segmentInfo:t,type:e,bytes:n}))}handleSegmentTimingInfo_(e,t,i){this.pendingSegment_&&t===this.pendingSegment_.requestId&&((t=this.pendingSegment_.segment)[e=e+"TimingInfo"]||(t[e]={}),t[e].transmuxerPrependedSeconds=i.prependedContentDuration||0,t[e].transmuxedPresentationStart=i.start.presentation,t[e].transmuxedDecodeStart=i.start.decode,t[e].transmuxedPresentationEnd=i.end.presentation,t[e].transmuxedDecodeEnd=i.end.decode,t[e].baseMediaDecodeTime=i.baseMediaDecodeTime)}appendData_(e,t){var{type:i,data:r}=t;r&&r.byteLength&&("audio"===i&&this.audioDisabled_||(t=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null}),this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:t,data:r})))}loadSegment_(t){this.state="WAITING",this.pendingSegment_=t,this.trimBackBuffer_(t),"number"==typeof t.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(t):this.loadQueue_.push(()=>{var e=F({},t,{forceTimestampOffset:!0});F(t,this.generateSegmentInfo_(e)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(t)})}updateTransmuxerAndRequestSegment_(r){this.shouldUpdateTransmuxerTimestampOffset_(r.timestampOffset)&&(this.gopBuffer_.length=0,r.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:r.timestampOffset}));var e=this.createSimplifiedSegmentObj_(r),t=this.isEndOfStream_(r.mediaIndex,r.playlist,r.partIndex),i=null!==this.mediaIndex,n=r.timeline!==this.currentTimeline_&&0<r.timeline,t=t||i&&n;this.logger_("Requesting "+Ro(r)),e.map&&!e.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),r.abortRequests=xo({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:e,abortFn:this.handleAbort_.bind(this,r),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",r.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",r.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:t,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:e,level:t,stream:i})=>{this.logger_(Ro(r)+` logged from transmuxer stream ${i} as a ${t}: `+e)}})}trimBackBuffer_(e){var t=((e,t,i)=>{let r=t-D.BACK_BUFFER_LENGTH;return e.length&&(r=Math.max(r,e.start(0))),Math.min(t-i,r)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<t&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,i=e.part,r={resolvedUri:(i||t).resolvedUri,byterange:(i||t).byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},n=e.playlist.segments[e.mediaIndex-1];if(n&&n.timeline===t.timeline&&(n.videoTimingInfo?r.baseStartTime=n.videoTimingInfo.transmuxedDecodeEnd:n.audioTimingInfo&&(r.baseStartTime=n.audioTimingInfo.transmuxedDecodeEnd)),t.key){const i=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key=this.segmentKey(t.key),r.key.iv=i}return t.map&&(r.map=this.initSegmentForMap(t.map)),r}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){this.pendingSegment_.byteLength=t.bytesReceived,e<1/60?this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record 0.016666666666666666`):(this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime)}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,i){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));else if(this.saveTransferStats_(t.stats),this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId)return e?(this.pendingSegment_=null,this.state="READY",e.code===mo?void 0:(this.pause(),e.code===fo?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")))):(e=this.pendingSegment_,this.saveBandwidthRelatedStats_(e.duration,t.stats),e.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=((e,t,i)=>{if(!t.length)return e;if(i)return t.slice();var r=t[0].pts;let n=0;for(;n<e.length&&!(e[n].pts>=r);n++);return e.slice(0,n).concat(t)})(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),void this.waitForAppendsToComplete_(e))}setTimeMapping_(e){e=this.syncController_.mappingForTimeline(e);null!==e&&(this.timeMapping_=e)}updateMediaSecondsLoaded_(e){"number"==typeof e.start&&"number"==typeof e.end?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return null!==e&&("main"===this.loaderType_&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:i,firstVideoFrameTimeForData:r,currentVideoTimestampOffset:n,useVideoTimingInfo:s,videoTimingInfo:a,audioTimingInfo:o}){return void 0!==e?e:s?(e=t.segments[i-1],0!==i&&e&&void 0!==e.start&&e.end===r+n?a.start:r):o.start}waitForAppendsToComplete_(e){var t,i,r=this.getCurrentMediaInfo_(e);r?({hasAudio:r,hasVideo:i,isMuxed:t}=r,i="main"===this.loaderType_&&i,r=!this.audioDisabled_&&r&&!t,e.waitingOnAppends=0,e.hasAppendedData_?(i&&e.waitingOnAppends++,r&&e.waitingOnAppends++,i&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),r&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))):(e.timingInfo||"number"!=typeof e.timestampOffset||(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e))):(this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error"))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,0===e.waitingOnAppends&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){i=this.loaderType_,t=this.getCurrentMediaInfo_();var t,i="main"===i&&t&&e?e.hasAudio||e.hasVideo?t.hasVideo&&!e.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&e.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null;return!!i&&(this.error({message:i,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(t){if(null!==t.timestampOffset&&"number"==typeof t.timingInfo.start&&!t.changedTimestampOffset&&"main"===this.loaderType_){let e=!1;t.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:t.segment.videoTimingInfo,audioTimingInfo:t.segment.audioTimingInfo,timingInfo:t.timingInfo}),t.changedTimestampOffset=!0,t.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(t.timestampOffset),e=!0),t.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(t.timestampOffset),e=!0),e&&this.trigger("timestampoffset")}}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:i}){return this.useDtsForTimestampOffset_?e&&"number"==typeof e.transmuxedDecodeStart?e.transmuxedDecodeStart:t&&"number"==typeof t.transmuxedDecodeStart?t.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};var t=this.getMediaInfo_(),t="main"===this.loaderType_&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;t&&(e.timingInfo.end="number"==typeof t.end?t.end:t.start+e.duration)}handleAppendsDone_(){var e,t,i,r,n,s;this.pendingSegment_&&this.trigger("appendsdone"),this.pendingSegment_?(e=this.pendingSegment_,this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:"main"===this.loaderType_}),t=e,(t="hls"===(s=this.sourceType_)&&(s=(e=>{let r=0;return["video","audio"].forEach(function(t){t=e[t+"TimingInfo"];if(t){var{start:t,end:i}=t;let e;"bigint"==typeof t||"bigint"==typeof i?e=v().BigInt(i)-v().BigInt(t):"number"==typeof t&&"number"==typeof i&&(e=i-t),void 0!==e&&e>r&&(r=e)}}),r="bigint"==typeof r&&r<Number.MAX_SAFE_INTEGER?Number(r):r})({audioTimingInfo:t.audioTimingInfo,videoTimingInfo:t.videoTimingInfo}))&&(i=t.playlist.targetDuration,n=Oo({segmentDuration:s,maxDuration:2*i}),r=Oo({segmentDuration:s,maxDuration:i}),s=`Segment with index ${t.mediaIndex} from playlist ${t.playlist.id} has a duration of ${s} when the reported duration is ${t.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`,n||r)?{severity:n?"warn":"info",message:s}:null)&&("warn"===t.severity?I.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)?this.logger_("Throwing away un-appended sync request "+Ro(e)):(this.logger_("Appended "+Ro(e)),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),i=e.segment,r=e.part,n=i.end&&this.currentTime_()-i.end>3*e.playlist.targetDuration,s=r&&r.end&&this.currentTime_()-r.end>3*e.playlist.partTargetDuration,n||s?(this.logger_(`bad ${n?"segment":"part"} `+Ro(e)),this.resetEverything()):(null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()))):(this.state="READY",this.paused()||this.monitorBuffer_())}recordThroughput_(e){var t,i;e.duration<1/60?this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record 0.016666666666666666`):(t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,e=Math.floor(e.byteLength/i*8*1e3),this.throughput.rate+=(e-t)/++this.throughput.count)}addSegmentMetadataCue_(e){var t,i,r,n;this.segmentMetadataTrack_&&(t=(n=e.segment).start,i=n.end,Po(t))&&Po(i)&&(Io(t,i,this.segmentMetadataTrack_),r=v().WebKitDataCue||v().VTTCue,n={custom:n.custom,dateTimeObject:n.dateTimeObject,dateTimeString:n.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:t,end:i},(e=new r(t,i,JSON.stringify(n))).value=n,this.segmentMetadataTrack_.addCue(e))}}function Uo(){}const Bo=function(e){return"string"!=typeof e?e:e.replace(/./,e=>e.toUpperCase())},Fo=["video","audio"],Ho=(e,t)=>{var i=t[e+"Buffer"];return i&&i.updating||t.queuePending[e]},zo=(i,r)=>{if(0!==r.queue.length){let e=0,t=r.queue[e];if("mediaSource"!==t.type){if("mediaSource"!==i&&r.ready()&&"closed"!==r.mediaSource.readyState&&!Ho(i,r)){if(t.type!==i){if(null===(e=((t,i)=>{for(let e=0;e<i.length;e++){var r=i[e];if("mediaSource"===r.type)return null;if(r.type===t)return e}return null})(i,r.queue)))return;t=r.queue[e]}return r.queue.splice(e,1),(r.queuePending[i]=t).action(i,r),t.doneFn?void 0:(r.queuePending[i]=null,void zo(i,r))}}else r.updating()||"closed"===r.mediaSource.readyState||(r.queue.shift(),t.action(r),t.doneFn&&t.doneFn(),zo("audio",r),zo("video",r))}},Vo=(e,t)=>{var i=t[e+"Buffer"],r=Bo(e);i&&(i.removeEventListener("updateend",t[`on${r}UpdateEnd_`]),i.removeEventListener("error",t[`on${r}Error_`]),t.codecs[e]=null,t[e+"Buffer"]=null)},Go=(e,t)=>e&&t&&-1!==Array.prototype.indexOf.call(e.sourceBuffers,t),Wo=(r,n)=>(e,t)=>{var i=t[e+"Buffer"];if(Go(t.mediaSource,i)){t.logger_(`Removing ${r} to ${n} from ${e}Buffer`);try{i.remove(r,n)}catch(i){t.logger_(`Remove ${r} to ${n} from ${e}Buffer failed`)}}},jo=r=>(e,t)=>{var i=t[e+"Buffer"];Go(t.mediaSource,i)&&(t.logger_(`Setting ${e}timestampOffset to `+r),i.timestampOffset=r)},qo=i=>(e,t)=>{i()},Xo=({type:e,sourceUpdater:t,action:i,doneFn:r,name:n})=>{t.queue.push({type:e,action:i,doneFn:r,name:n}),zo(e,t)},Yo=(t,i)=>e=>{if(i.queuePending[t]){const e=i.queuePending[t].doneFn;i.queuePending[t]=null,e&&e(i[t+"Error_"])}zo(t,i)};class $o extends I.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>zo("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Js("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=Yo("video",this),this.onAudioUpdateEnd_=Yo("audio",this),this.onVideoError_=e=>{this.videoError_=e},this.onAudioError_=e=>{this.audioError_=e},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){var r,n;Xo({type:"mediaSource",sourceUpdater:this,action:(r=e,n=t,e=>{var t=Bo(r),i=Z(n),i=(e.logger_(`Adding ${r}Buffer with codec ${n} to mediaSource`),e.mediaSource.addSourceBuffer(i));i.addEventListener("updateend",e[`on${t}UpdateEnd_`]),i.addEventListener("error",e[`on${t}Error_`]),e.codecs[r]=n,e[r+"Buffer"]=i}),name:"addSourceBuffer"})}abort(e){Xo({type:e,sourceUpdater:this,action:(e,t)=>{if("open"===t.mediaSource.readyState){var i=t[e+"Buffer"];if(Go(t.mediaSource,i)){t.logger_(`calling abort on ${e}Buffer`);try{i.abort()}catch(t){I.log.warn(`Failed to abort on ${e}Buffer`,t)}}}},name:"abort"})}removeSourceBuffer(e){var i;this.canRemoveSourceBuffer()?Xo({type:"mediaSource",sourceUpdater:this,action:(i=e,e=>{var t=e[i+"Buffer"];if(Vo(i,e),Go(e.mediaSource,t)){e.logger_(`Removing ${i}Buffer with codec ${e.codecs[i]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(e){I.log.warn(`Failed to removeSourceBuffer ${i}Buffer`,e)}}}),name:"removeSourceBuffer"}):I.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!I.browser.IE_VERSION&&!I.browser.IS_FIREFOX&&v().MediaSource&&v().MediaSource.prototype&&"function"==typeof v().MediaSource.prototype.removeSourceBuffer}static canChangeType(){return v().SourceBuffer&&v().SourceBuffer.prototype&&"function"==typeof v().SourceBuffer.prototype.changeType}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){var n;this.canChangeType()?Xo({type:e,sourceUpdater:this,action:(n=t,(e,t)=>{var i=t[e+"Buffer"],r=Z(n);Go(t.mediaSource,i)&&t.codecs[e]!==n&&(t.logger_(`changing ${e}Buffer codec from ${t.codecs[e]} to `+n),i.changeType(r),t.codecs[e]=n)}),name:"changeType"}):I.log.error("changeType is not supported!")}addOrChangeSourceBuffers(i){if(!i||"object"!=typeof i||0===Object.keys(i).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(i).forEach(e=>{var t=i[e];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(e,t);this.canChangeType()&&this.changeType(e,t)})}appendBuffer(e,t){var r,n,s,{segmentInfo:i,type:a,bytes:o}=e;if(this.processedAppend_=!0,"audio"===a&&this.videoBuffer&&!this.videoAppendQueued_)this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${o.length} until video append`);else if(Xo({type:a,sourceUpdater:this,action:(r=o,n=i||{mediaIndex:-1},(t,i)=>{var e=i[t+"Buffer"];if(Go(i.mediaSource,e)){i.logger_(`Appending segment ${n.mediaIndex}'s ${r.length} bytes to ${t}Buffer`);try{e.appendBuffer(r)}catch(e){i.logger_(`Error with code ${e.code} `+(22===e.code?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${n.mediaIndex} to ${t}Buffer`),i.queuePending[t]=null,s(e)}}}),doneFn:s=t,name:"appendBuffer"}),"video"===a&&(this.videoAppendQueued_=!0,this.delayedAudioAppendQueue_.length)){const e=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${e.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,e.forEach(e=>{this.appendBuffer.apply(this,e)})}}audioBuffered(){return Go(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:R()}videoBuffered(){return Go(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:R()}buffered(){var e=Go(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=Go(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;{if(t&&!e)return this.audioBuffered();if(e&&!t)return this.videoBuffered();{var n=this.audioBuffered(),s=this.videoBuffered();let e=null,t=null,i=0;var a=[],o=[];if(!(n&&n.length&&s&&s.length))return R();let r=n.length;for(;r--;)a.push({time:n.start(r),type:"start"}),a.push({time:n.end(r),type:"end"});for(r=s.length;r--;)a.push({time:s.start(r),type:"start"}),a.push({time:s.end(r),type:"end"});for(a.sort(function(e,t){return e.time-t.time}),r=0;r<a.length;r++)"start"===a[r].type?2===++i&&(e=a[r].time):"end"===a[r].type&&1===--i&&(t=a[r].time),null!==e&&null!==t&&(o.push([e,t]),e=null,t=null);return R(o)}}}setDuration(e,t=Uo){var i;Xo({type:"mediaSource",sourceUpdater:this,action:(i=e,e=>{e.logger_("Setting mediaSource duration to "+i);try{e.mediaSource.duration=i}catch(e){I.log.warn("Failed to set media source duration",e)}}),name:"duration",doneFn:t})}endOfStream(e=null,t=Uo){var i;"string"!=typeof e&&(e=void 0),Xo({type:"mediaSource",sourceUpdater:this,action:(i=e,e=>{if("open"===e.mediaSource.readyState){e.logger_(`Calling mediaSource endOfStream(${i||""})`);try{e.mediaSource.endOfStream(i)}catch(e){I.log.warn("Failed to call media source endOfStream",e)}}}),name:"endOfStream",doneFn:t})}removeAudio(e,t,i=Uo){this.audioBuffered().length&&0!==this.audioBuffered().end(0)?Xo({type:"audio",sourceUpdater:this,action:Wo(e,t),doneFn:i,name:"remove"}):i()}removeVideo(e,t,i=Uo){this.videoBuffered().length&&0!==this.videoBuffered().end(0)?Xo({type:"video",sourceUpdater:this,action:Wo(e,t),doneFn:i,name:"remove"}):i()}updating(){return!(!Ho("audio",this)&&!Ho("video",this))}audioTimestampOffset(e){return void 0!==e&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Xo({type:"audio",sourceUpdater:this,action:jo(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return void 0!==e&&this.videoBuffer&&this.videoTimestampOffset!==e&&(Xo({type:"video",sourceUpdater:this,action:jo(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&Xo({type:"audio",sourceUpdater:this,action:qo(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&Xo({type:"video",sourceUpdater:this,action:qo(e),name:"callback"})}dispose(){this.trigger("dispose"),Fo.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[e+"QueueCallback"](()=>Vo(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Ko=e=>decodeURIComponent(escape(String.fromCharCode.apply(null,e))),Jo=new Uint8Array("\n\n".split("").map(e=>e.charCodeAt(0)));class Zo extends No{constructor(e,t={}){super(e,t),this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){var e;return this.subtitlesTrack_&&this.subtitlesTrack_.cues&&this.subtitlesTrack_.cues.length?R([[(e=this.subtitlesTrack_.cues)[0].startTime,e[e.length-1].startTime]]):R()}initSegmentForMap(e,t=!1){if(!e)return null;var i=Fa(e);let r=this.initSegments_[i];if(t&&!r&&e.bytes){const t=Jo.byteLength+e.bytes.byteLength,n=new Uint8Array(t);n.set(e.bytes),n.set(Jo,e.bytes.byteLength),this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:n}}return r||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return void 0!==e&&(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_())&&this.init_(),this.subtitlesTrack_}remove(e,t){Io(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e)if(null===this.syncController_.timestampOffsetForTimeline(e.timeline)){const e=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",e),void(this.state="WAITING_ON_TIMELINE")}else this.loadSegment_(e)}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(t,i,r){if(this.subtitlesTrack_)if(this.saveTransferStats_(i.stats),this.pendingSegment_)if(t)t.code===fo&&this.handleTimeout_(),t.code===mo?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(t);else{var e=this.pendingSegment_,n=(this.saveBandwidthRelatedStats_(e.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending"),e.segment);if(n.map&&(n.map.bytes=i.map.bytes),e.bytes=i.bytes,"function"!=typeof v().WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){let e;const v=()=>{this.subtitlesTrack_.tech_.off("vttjsloaded",e),this.stopForError({message:"Error loading vtt.js"})};e=()=>{this.subtitlesTrack_.tech_.off("vttjserror",v),this.segmentRequestFinished_(t,i,r)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",e),void this.subtitlesTrack_.tech_.one("vttjserror",v)}else{n.requested=!0;try{this.parseVTTCues_(e)}catch(t){return void this.stopForError({message:t.message})}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.cues.length?e.timingInfo={start:e.cues[0].startTime,end:e.cues[e.cues.length-1].endTime}:e.timingInfo={start:e.startOfSegment,end:e.startOfSegment+e.duration},e.isSyncRequest)this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";else{e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,e.cues.forEach(e=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(v().VTTCue)(e.startTime,e.endTime,e.text):e)});var s=this.subtitlesTrack_,a=s.cues;if(a)for(let i=0;i<a.length;i++){var o=[];let t=0;for(let e=0;e<a.length;e++)a[i].startTime===a[e].startTime&&a[i].endTime===a[e].endTime&&a[i].text===a[e].text&&1<++t&&o.push(a[e]);o.length&&o.forEach(e=>s.removeCue(e))}this.handleAppendsDone_()}}}else this.state="READY",this.mediaRequestsAborted+=1;else this.state="READY"}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(t){let e,i=!1;"function"==typeof v().TextDecoder?e=new(v().TextDecoder)("utf8"):(e=v().WebVTT.StringDecoder(),i=!0);var r=new(v().WebVTT.Parser)(v(),v().vttjs,e);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=t.cues.push.bind(t.cues),r.ontimestampmap=e=>{t.timestampmap=e},r.onparsingerror=e=>{I.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){let e=t.segment.map.bytes;i&&(e=Ko(e)),r.parse(e)}let n=t.bytes;i&&(n=Ko(n)),r.parse(n),r.flush()}updateTimeMapping_(e,t,i){var r=e.segment;if(t)if(e.cues.length){const n=e.timestampmap,s=n.MPEGTS/yt.ONE_SECOND_IN_TS-n.LOCAL+t.mapping;if(e.cues.forEach(e=>{e.startTime+=s,e.endTime+=s}),!i.syncInfo){const t=e.cues[0].startTime,n=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(t,n-r.duration)}}}else r.empty=!0}}const Qo=[{name:"VOD",run:(e,t,i,r,n)=>i!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(t,i,e,r,n)=>{if(!Object.keys(t.timelineToDatetimeMappings).length)return null;let s=null,a=null;var o=ga(i);n=n||0;for(let e=0;e<o.length;e++){const r=o[i.endList||0===n?e:o.length-(e+1)],h=r.segment,u=t.timelineToDatetimeMappings[h.timeline];if(u&&h.dateTimeObject){let t=h.dateTimeObject.getTime()/1e3+u;if(h.parts&&"number"==typeof r.partIndex)for(let e=0;e<r.partIndex;e++)t+=h.parts[e].duration;var l=Math.abs(n-t);if(null!==a&&(0===l||a<l))break;a=l,s={time:t,segmentIndex:r.segmentIndex,partIndex:r.partIndex}}}return s}},{name:"Segment",run:(t,i,r,n,s)=>{let a=null,o=null;s=s||0;var l=ga(i);for(let e=0;e<l.length;e++){const r=l[i.endList||0===s?e:l.length-(e+1)],h=r.segment,u=r.part&&r.part.start||h&&h.start;if(h.timeline===n&&void 0!==u){const t=Math.abs(s-u);if(null!==o&&o<t)break;(!a||null===o||o>=t)&&(o=t,a={time:u,segmentIndex:r.segmentIndex,partIndex:r.partIndex})}}return a}},{name:"Discontinuity",run:(i,r,e,t,n)=>{let s=null;if(n=n||0,r.discontinuityStarts&&r.discontinuityStarts.length){let t=null;for(let e=0;e<r.discontinuityStarts.length;e++){var a=r.discontinuityStarts[e],o=r.discontinuitySequence+e+1,o=i.discontinuities[o];if(o){const i=Math.abs(n-o.time);if(null!==t&&t<i)break;(!s||null===t||t>=i)&&(t=i,s={time:o.time,segmentIndex:a,partIndex:null})}}}return s}},{name:"Playlist",run:(e,t,i,r,n)=>t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null}:null}];class el extends I.EventTarget{constructor(e=0){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=Js("SyncController")}getSyncPoint(e,t,i,r){e=this.runStrategies_(e,t,i,r);return e.length?this.selectSyncPoint_(e,{key:"time",value:r}):null}getExpiredTime(e,t){return e&&e.segments&&(t=this.runStrategies_(e,t,e.discontinuitySequence,0)).length?(0<(t=this.selectSyncPoint_(t,{key:"segmentIndex",value:0})).segmentIndex&&(t.time*=-1),Math.abs(t.time+sa({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:t.segmentIndex,endIndex:0}))):null}runStrategies_(t,i,r,n){var s=[];for(let e=0;e<Qo.length;e++){var a=Qo[e],o=a.run(this,t,i,r,n);o&&(o.strategy=a.name,s.push({strategy:a.name,syncPoint:o}))}return s}selectSyncPoint_(t,i){let r=t[0].syncPoint,n=Math.abs(t[0].syncPoint[i.key]-i.value),s=t[0].strategy;for(let e=1;e<t.length;e++){var a=Math.abs(t[e].syncPoint[i.key]-i.value);a<n&&(n=a,r=t[e].syncPoint,s=t[e].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${s}]: [time:${r.time}, segmentIndex:`+r.segmentIndex+("number"==typeof r.partIndex?",partIndex:"+r.partIndex:"")+"]"),r}saveExpiredSegmentInfo(t,i){const r=i.mediaSequence-t.mediaSequence;if(86400<r)I.log.warn(`Not saving expired segment info. Media sequence gap ${r} is too large.`);else for(let e=r-1;0<=e;e--){const r=t.segments[e];if(r&&void 0!==r.start){i.syncInfo={mediaSequence:t.mediaSequence+e,time:r.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){var t;this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject&&(t=(e=e.segments[0]).dateTimeObject.getTime()/1e3,this.timelineToDatetimeMappings[e.timeline]=-t)}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){var i=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),r=e.segment,i=(i&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:r.start})),r.dateTimeObject);r.discontinuity&&t&&i&&(this.timelineToDatetimeMappings[r.timeline]=-i.getTime()/1e3)}timestampOffsetForTimeline(e){return void 0===this.timelines[e]?null:this.timelines[e].time}mappingForTimeline(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,i){var r=e.segment,n=e.part;let s,a,o=this.timelines[e.timeline];if("number"==typeof e.timestampOffset)o={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=o,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${o.time}] [mapping: ${o.mapping}]`)),s=e.startOfSegment;else{if(!o)return!1;s=t.start+o.mapping}return a=t.end+o.mapping,n&&(n.start=s,n.end=a),(!r.start||s<r.start)&&(r.start=s),r.end=a,!0}saveDiscontinuitySyncInfo_(t){var i=t.playlist,r=t.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let e=0;e<i.discontinuityStarts.length;e++){var n=i.discontinuityStarts[e],s=i.discontinuitySequence+e+1,a=n-t.mediaIndex,o=Math.abs(a);(!this.discontinuities[s]||this.discontinuities[s].accuracy>o)&&(a=a<0?r.start-sa({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:t.mediaIndex,endIndex:n}):r.end+sa({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:t.mediaIndex+1,endIndex:n}),this.discontinuities[s]={time:a,accuracy:o})}}dispose(){this.trigger("dispose"),this.off()}}class tl extends I.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:i}){return"number"==typeof t&&"number"==typeof i&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:i}){return"number"==typeof t&&"number"==typeof i&&(this.lastTimelineChanges_[e]={type:e,from:t,to:i},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}var il=Ja(Za(Qa(function(){(i=t.prototype).on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},i.off=function(e,t){return!!this.listeners[e]&&(t=this.listeners[e].indexOf(t),this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(t,1),-1<t)},i.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),s=t.length,a=0;a<s;++a)t[a].apply(this,n)},i.dispose=function(){this.listeners={}},i.pipe=function(t){this.on("data",function(e){t.push(e)})};var e=t;function t(){this.listeners={}}let u=null;class m{constructor(e){let t,i,r;u=u||function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],i=e[1],r=t[4],n=i[4];let s,a,o;var l=[],h=[];let u,c,d,p,f,m;for(s=0;s<256;s++)h[(l[s]=s<<1^283*(s>>7))^s]=s;for(a=o=0;!r[a];a^=u||1,o=h[o]||1)for(p=(p=o^o<<1^o<<2^o<<3^o<<4)>>8^255&p^99,d=l[c=l[u=l[n[r[a]=p]=a]]],m=16843009*d^65537*c^257*u^16843008*a,f=257*l[p]^16843008*p,s=0;s<4;s++)t[s][a]=f=f<<24^f>>>8,i[s][p]=m=m<<24^m>>>8;for(s=0;s<5;s++)t[s]=t[s].slice(0),i[s]=i[s].slice(0);return e}(),this._tables=[[u[0][0].slice(),u[0][1].slice(),u[0][2].slice(),u[0][3].slice(),u[0][4].slice()],[u[1][0].slice(),u[1][1].slice(),u[1][2].slice(),u[1][3].slice(),u[1][4].slice()]];var n=this._tables[0][4],s=this._tables[1],a=e.length;let o=1;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size");var l=e.slice(0),h=[];for(this._key=[l,h],t=a;t<4*a+28;t++)r=l[t-1],(t%a==0||8===a&&t%a==4)&&(r=n[r>>>24]<<24^n[r>>16&255]<<16^n[r>>8&255]<<8^n[255&r],t%a==0)&&(r=r<<8^r>>>24^o<<24,o=o<<1^283*(o>>7)),l[t]=l[t-a]^r;for(i=0;t;i++,t--)r=l[3&i?t:t-4],h[i]=t<=4||i<4?r:s[0][n[r>>>24]]^s[1][n[r>>16&255]]^s[2][n[r>>8&255]]^s[3][n[255&r]]}decrypt(e,t,i,r,n,s){var a=this._key[1];let o,l,h,u=e^a[0],c=r^a[1],d=i^a[2],p=t^a[3];var f=a.length/4-2;let m,g=4;var e=this._tables[1],v=e[0],y=e[1],_=e[2],b=e[3],T=e[4];for(m=0;m<f;m++)o=v[u>>>24]^y[c>>16&255]^_[d>>8&255]^b[255&p]^a[g],l=v[c>>>24]^y[d>>16&255]^_[p>>8&255]^b[255&u]^a[g+1],h=v[d>>>24]^y[p>>16&255]^_[u>>8&255]^b[255&c]^a[g+2],p=v[p>>>24]^y[u>>16&255]^_[c>>8&255]^b[255&d]^a[g+3],g+=4,u=o,c=l,d=h;for(m=0;m<4;m++)n[(3&-m)+s]=T[u>>>24]<<24^T[c>>16&255]<<16^T[d>>8&255]<<8^T[255&p]^a[g++],o=u,u=c,c=d,d=p,p=o}}class l extends e{constructor(){super(e),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}function g(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}class h{constructor(e,t,i,r){const n=h.STEP,s=new Int32Array(e.buffer),a=new Uint8Array(e.byteLength);let o=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(s.subarray(o,o+n),t,i,a)),o=n;o<s.length;o+=n)i=new Uint32Array([g(s[o-4]),g(s[o-3]),g(s[o-2]),g(s[o-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(o,o+n),t,i,a));this.asyncStream_.push(function(){var e;r(null,(e=a).subarray(0,e.byteLength-e[e.byteLength-1]))})}static get STEP(){return 32e3}decryptChunk_(t,i,r,n){return function(){var e=function(e,t,i){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),n=new m(Array.prototype.slice.call(t)),t=new Uint8Array(e.byteLength),s=new Int32Array(t.buffer);let a,o,l,h,u,c,d,p,f;for(a=i[0],o=i[1],l=i[2],h=i[3],f=0;f<r.length;f+=4)u=g(r[f]),c=g(r[f+1]),d=g(r[f+2]),p=g(r[f+3]),n.decrypt(u,c,d,p,s,f),s[f]=g(s[f]^a),s[f+1]=g(s[f+1]^o),s[f+2]=g(s[f+2]^l),s[f+3]=g(s[f+3]^h),a=u,o=c,l=d,h=p;return t}(t,i,r);n.set(e,t.byteOffset)}}}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==oi.g?oi.g:"undefined"!=typeof self?self:{},i=("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{}).BigInt||Number;i("0x1"),i("0x100"),i("0x10000"),i("0x1000000"),i("0x100000000"),i("0x10000000000"),i("0x1000000000000"),i("0x100000000000000"),i("0x10000000000000000"),i=new Uint16Array([65484]),255!==(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength))[0]&&i[0],self.onmessage=function(e){const i=e.data,t=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),r=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),n=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new h(t,r,n,function(e,t){self.postMessage(function(r){const n={};return Object.keys(r).forEach(e=>{var t=r[e],i=t;("function"===ArrayBuffer.isView?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer)?n[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:n[e]=t}),n}({source:i.source,decrypted:t}),[t.buffer])})}})));const rl=(e,t)=>{e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},nl=(e,t)=>{(t.activePlaylistLoader=e).load()},sl={AUDIO:(s,a)=>()=>{var{segmentLoaders:{[s]:e},mediaTypes:{[s]:t},excludePlaylist:i}=a,e=(rl(e,t),t.activeTrack()),r=t.activeGroup(),r=(r.filter(e=>e.default)[0]||r[0]).id,n=t.tracks[r];if(e!==n){I.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const s in t.tracks)t.tracks[s].enabled=t.tracks[s]===n;t.onTrackChanged()}else i({error:{message:"Problem encountered loading the default audio track."}})},SUBTITLES:(i,r)=>()=>{var{segmentLoaders:{[i]:e},mediaTypes:{[i]:t}}=r,e=(I.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),rl(e,t),t.activeTrack());e&&(e.mode="disabled"),t.onTrackChanged()}},al={AUDIO:(e,t,i)=>{if(!t)return;const{tech:r,requestOptions:n,segmentLoaders:{[e]:s}}=i;t.on("loadedmetadata",()=>{var e=t.media();s.playlist(e,n),(!r.paused()||e.endList&&"none"!==r.preload())&&s.load()}),t.on("loadedplaylist",()=>{s.playlist(t.media(),n),r.paused()||s.load()}),t.on("error",sl[e](e,i))},SUBTITLES:(e,t,i)=>{const{tech:r,requestOptions:n,segmentLoaders:{[e]:s},mediaTypes:{[e]:a}}=i;t.on("loadedmetadata",()=>{var e=t.media();s.playlist(e,n),s.track(a.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&s.load()}),t.on("loadedplaylist",()=>{s.playlist(t.media(),n),r.paused()||s.load()}),t.on("error",sl[e](e,i))}},ol={AUDIO:(i,r)=>{const{vhs:n,sourceType:s,segmentLoaders:{[i]:a},requestOptions:o,main:{mediaGroups:l},mediaTypes:{[i]:{groups:h,tracks:u,logger_:c}},mainPlaylistLoader:d}=r,p=xa(d.main);l[i]&&0!==Object.keys(l[i]).length||(l[i]={main:{default:{default:!0}}},p&&(l[i].main.default.playlists=d.main.playlists));for(const a in l[i]){h[a]||(h[a]=[]);for(const f in l[i][a]){let e,t=l[i][a][f];if(e=p?(c(`AUDIO group '${a}' label '${f}' is a main playlist`),t.isMainPlaylist=!0,null):"vhs-json"===s&&t.playlists?new ka(t.playlists[0],n,o):t.resolvedUri?new ka(t.resolvedUri,n,o):t.playlists&&"dash"===s?new $a(t.playlists[0],n,o,d):null,t=P({id:f,playlistLoader:e},t),al[i](i,t.playlistLoader,r),h[a].push(t),void 0===u[f]){const i=new I.AudioTrack({id:f,kind:(e=>{let t=e.default?"main":"alternative";return t=e.characteristics&&0<=e.characteristics.indexOf("public.accessibility.describes-video")?"main-desc":t})(t),enabled:!1,language:t.language,default:t.default,label:f});u[f]=i}}}a.on("error",sl[i](i,r))},SUBTITLES:(i,r)=>{const{tech:n,vhs:s,sourceType:a,segmentLoaders:{[i]:o},requestOptions:l,main:{mediaGroups:h},mediaTypes:{[i]:{groups:u,tracks:c}},mainPlaylistLoader:d}=r;for(const o in h[i]){u[o]||(u[o]=[]);for(const p in h[i][o])if(!h[i][o][p].forced){let e,t=h[i][o][p];if("hls"===a)e=new ka(t.resolvedUri,s,l);else if("dash"===a){if(!t.playlists.filter(e=>e.excludeUntil!==1/0).length)return;e=new $a(t.playlists[0],s,l,d)}else"vhs-json"===a&&(e=new ka(t.playlists?t.playlists[0]:t.resolvedUri,s,l));if(t=P({id:p,playlistLoader:e},t),al[i](i,t.playlistLoader,r),u[o].push(t),void 0===c[p]){const i=n.addRemoteTextTrack({id:p,kind:"subtitles",default:t.default&&t.autoselect,language:t.language,label:p},!1).track;c[p]=i}}}o.on("error",sl[i](i,r))},"CLOSED-CAPTIONS":(t,i)=>{var{tech:r,main:{mediaGroups:e},mediaTypes:{[t]:{groups:n,tracks:s}}}=i;for(const i in e[t]){n[i]||(n[i]=[]);for(const l in e[t][i]){var a=e[t][i][l];if(/^(?:CC|SERVICE)/.test(a.instreamId)){var o=r.options_.vhs&&r.options_.vhs.captionServices||{};let e={label:l,language:a.language,instreamId:a.instreamId,default:a.default&&a.autoselect};if(void 0===(e=o[e.instreamId]?P(e,o[e.instreamId]):e).default&&delete e.default,n[i].push(P({id:l},a)),void 0===s[l]){const t=r.addRemoteTextTrack({id:e.instreamId,kind:"captions",default:e.default,language:e.language,label:e.label},!1).track;s[l]=t}}}}}},ll=(t,i)=>{for(let e=0;e<t.length;e++){if(Ta(i,t[e]))return!0;if(t[e].playlists&&ll(t[e].playlists,i))return!0}return!1},hl={AUDIO:(t,i)=>()=>{var{[t]:{tracks:e}}=i["mediaTypes"];for(const t in e)if(e[t].enabled)return e[t];return null},SUBTITLES:(t,i)=>()=>{var{[t]:{tracks:e}}=i["mediaTypes"];for(const t in e)if("showing"===e[t].mode||"hidden"===e[t].mode)return e[t];return null}};let ul;const cl=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"];class dl extends I.EventTarget{constructor(e){super();var{src:t,withCredentials:i,tech:r,bandwidth:n,externVhs:s,useCueTags:a,playlistExclusionDuration:o,enableLowInitialPlaylist:l,sourceType:h,cacheEncryptionKeys:u,bufferBasedABR:c,leastPixelDiffSelector:d,captionServices:p}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let f=e["maxPlaylistRetries"];null==f&&(f=1/0),ul=s,this.bufferBasedABR=Boolean(c),this.leastPixelDiffSelector=Boolean(d),this.withCredentials=i,this.tech_=r,this.vhs_=r.vhs,this.sourceType_=h,this.useCueTags_=a,this.playlistExclusionDuration=o,this.maxPlaylistRetries=f,this.enableLowInitialPlaylist=l,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:i,maxPlaylistRetries:f,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{const t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Uo,activeTrack:Uo,getActiveGroup:Uo,onGroupChanged:Uo,onTrackChanged:Uo,lastTrack_:null,logger_:Js(`MediaGroups[${e}]`)}}),t})(),this.mediaSource=new(v().MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=R(),this.hasPlayed_=!1,this.syncController_=new el(e),this.segmentMetadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new il,this.sourceUpdater_=new $o(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new tl;s={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:p,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:n,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:u,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings},this.mainPlaylistLoader_=new("dash"===this.sourceType_?$a:ka)(t,this.vhs_,this.requestOptions_),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new No(P(s,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new No(P(s,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new Zo(P(s,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks}),e),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),cl.forEach(e=>{this[e+"_"]=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}.bind(this,e)}),this.logger_=Js("pc"),this.triggeredFmp4Usage=!1,"none"===this.tech_.preload()?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1,c="none"===this.tech_.preload()?"play":"loadstart";this.tech_.one(c,()=>{const e=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-e,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){var e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return-1===e||-1===t?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){var t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,i){var r=this.media(),r=r&&(r.id||r.uri),n=e.id||e.uri;r&&r!==n&&(this.logger_(`switch media ${r} -> ${n} from `+t),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+t})),this.mainPlaylistLoader_.media(e,i)}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=v().setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(v().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const t=this.main(),i=t&&t.playlists||[];if(!t||!t.mediaGroups||!t.mediaGroups.AUDIO)return i;const e=t.mediaGroups.AUDIO,r=Object.keys(e);let n;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)n=this.mediaTypes_.AUDIO.activeTrack();else{const t=e.main||r.length&&e[r[0]];for(const i in t)if(t[i].default){n={label:i};break}}if(!n)return i;var s=[];for(const i in e)if(e[i][n.label]){const r=e[i][n.label];if(r.playlists&&r.playlists.length)s.push.apply(s,r.playlists);else if(r.uri)s.push(r);else if(t.playlists.length)for(let e=0;e<t.playlists.length;e++){const r=t.playlists[e];r.attributes&&r.attributes.AUDIO&&r.attributes.AUDIO===i&&s.push(r)}}return s.length?s:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{var e=this.mainPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;ba(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,e.endList&&"none"!==this.tech_.preload()&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load());{var s={sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)};["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{ol[e](e,s)});const{mediaTypes:d,mainPlaylistLoader:i,tech:r,vhs:n,segmentLoaders:{AUDIO:a,main:o}}=s;if(["AUDIO","SUBTITLES"].forEach(e=>{var t,i,l,h,r,n,o,u,a,c;d[e].activeGroup=(a=e,c=s,t=>{var{mainPlaylistLoader:e,mediaTypes:{[a]:{groups:i}}}=c,r=e.media();if(!r)return null;let n=null;r.attributes[a]&&(n=i[r.attributes[a]]);var s=Object.keys(i);if(!n)if("AUDIO"===a&&1<s.length&&xa(c.main))for(let e=0;e<s.length;e++){const c=i[s[e]];if(ll(c,r)){n=c;break}}else i.main?n=i.main:1===s.length&&(n=i[s[0]]);return void 0===t?n:null!==t&&n&&n.filter(e=>e.id===t.id)[0]||null}),d[e].activeTrack=hl[e](e,s),d[e].onGroupChanged=(o=e,u=s,()=>{var{segmentLoaders:{[o]:e,main:t},mediaTypes:{[o]:i}}=u,r=i.activeTrack(),n=i.getActiveGroup(),s=i.activePlaylistLoader,a=i.lastGroup_;n&&a&&n.id===a.id||(i.lastGroup_=n,i.lastTrack_=r,rl(e,i),n&&!n.isMainPlaylist&&(n.playlistLoader?(e.resyncLoader(),nl(n.playlistLoader,i)):s&&t.resetEverything()))}),d[e].onGroupChanging=(r=e,n=s,()=>{var{segmentLoaders:{[r]:e},mediaTypes:{[r]:t}}=n;t.lastGroup_=null,e.abort(),e.pause()}),d[e].onTrackChanged=(l=e,h=s,()=>{const{mainPlaylistLoader:e,segmentLoaders:{[l]:t,main:i},mediaTypes:{[l]:r}}=h,n=r.activeTrack(),s=r.getActiveGroup(),a=r.activePlaylistLoader,o=r.lastTrack_;if((!o||!n||o.id!==n.id)&&(r.lastGroup_=s,r.lastTrack_=n,rl(t,r),s)){if(s.isMainPlaylist){if(!n||!o||n.id===o.id)return;const l=h.vhs.playlistController_,t=l.selectPlaylist();return l.media()===t?void 0:(r.logger_(`track change. Switching main audio from ${o.id} to `+n.id),e.pause(),i.resetEverything(),void l.fastQualityChange_(t))}if("AUDIO"===l){if(!s.playlistLoader)return i.setAudio(!0),void i.resetEverything();t.setAudio(!0),i.setAudio(!1)}a!==s.playlistLoader&&(t.track&&t.track(n),t.resetEverything()),nl(s.playlistLoader,r)}}),d[e].getActiveGroup=([t,i]=[e,s["mediaTypes"]],()=>{var e=i[t].activeTrack();return e?i[t].activeGroup(e):null})}),t=d.AUDIO.activeGroup()){const s=(t.filter(e=>e.default)[0]||t[0]).id;d.AUDIO.tracks[s].enabled=!0,d.AUDIO.onGroupChanged(),d.AUDIO.onTrackChanged(),(d.AUDIO.getActiveGroup().playlistLoader?(o.setAudio(!1),a):o).setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(e=>d[e].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(e=>d[e].onGroupChanging())});const l=()=>{d.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"})};r.audioTracks().addEventListener("change",l),r.remoteTextTracks().addEventListener("change",d.SUBTITLES.onTrackChanged),n.on("dispose",()=>{r.audioTracks().removeEventListener("change",l),r.remoteTextTracks().removeEventListener("change",d.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(const s in d.AUDIO.tracks)r.audioTracks().addTrack(d.AUDIO.tracks[s])}this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let t=this.mainPlaylistLoader_.media();if(!t){let e;if(this.excludeUnsupportedVariants_(),!(e=(e=this.enableLowInitialPlaylist?this.selectInitialPlaylist():e)||this.selectPlaylist())||!this.shouldSwitchToMedia_(e))return;if(this.initialMedia_=e,this.switchMedia_(this.initialMedia_,"initial"),"vhs-json"!==this.sourceType_||!this.initialMedia_.segments)return;t=this.initialMedia_}this.handleUpdatedMediaPlaylist(t)}),this.mainPlaylistLoader_.on("error",()=>{var e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{var e=this.mainPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;ba(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{var e=this.mainPlaylistLoader_.media();"playlist-unchanged"!==e.lastExcludeReason_&&this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){var i=e.mediaGroups||{};let r=!0;e=Object.keys(i.AUDIO);for(const e in i.AUDIO)for(const t in i.AUDIO[e])i.AUDIO[e][t].uri||(r=!1);r&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),ul.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),e.length&&1<Object.keys(i.AUDIO[e[0]]).length&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(t){var e=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,i=this.tech_.currentTime(),r=this.bufferLowWaterLine(),n=this.bufferHighWaterLine(),{currentPlaylist:i,buffered:e,currentTime:t,nextPlaylist:r,bufferLowWaterLine:n,bufferHighWaterLine:s,duration:a,bufferBasedABR:o,log:l}=[{buffered:this.tech_.buffered(),currentTime:i,currentPlaylist:e,nextPlaylist:t,bufferLowWaterLine:r,bufferHighWaterLine:n,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_}][0];if(r){var h=`allowing switch ${i&&i.id||"null"} -> `+r.id;if(!i)return l(h+" as current playlist is not set"),!0;if(r.id!==i.id){var u=Boolean(Qs(e,t).length);if(!i.endList)return u||"number"!=typeof i.partTargetDuration?(l(h+" as current playlist is live"),!0):(l(`not ${h} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);u=ia(e,t),e=o?D.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:D.MAX_BUFFER_LOW_WATER_LINE;if(a<e)return l(h+` as duration < max low water line (${a} < ${e})`),!0;t=r.attributes.BANDWIDTH,a=i.attributes.BANDWIDTH;if(t<a&&(!o||u<s)){let e=h+` as next bandwidth < current bandwidth (${t} < ${a})`;return o&&(e+=` and forwardBuffer < bufferHighWaterLine (${u} < ${s})`),l(e),!0}if((!o||a<t)&&n<=u){let e=h+` as forwardBuffer >= bufferLowWaterLine (${u} >= ${n})`;return o&&(e+=` and next bandwidth > current bandwidth (${t} > ${a})`),l(e),!0}l(`not ${h} as no switching criteria met`)}}else I.log.warn("We received no playlist to switch to. Please check your stream.");return!1}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{var e=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",e=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:120}))});var e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();var e=this.getCodecsOrExclude_();e&&this.sourceUpdater_.addOrChangeSourceBuffers(e)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){e!==this.mainPlaylistLoader_.media()?(this.switchMedia_(e,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{I.browser.IE_VERSION||I.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())})):this.logger_("skipping fastQualityChange because new media is same as old")}play(){var e;if(!this.setupFirstPlay())return this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load(),e=this.tech_.seekable(),this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList){const e=this.seekable();if(!e.length)return!1;if(I.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay"),this.tech_.setCurrentTime(e.end(0)),this.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(e.end(0))}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){var e;this.tryToCreateSourceBuffers_(),this.tech_.autoplay()&&void 0!==(e=this.tech_.play())&&"function"==typeof e.then&&e.then(null,e=>{}),this.trigger("sourceopen")}handleSourceEnded_(){var e,t;this.inbandTextTracks_.metadataTrack_&&(e=this.inbandTextTracks_.metadataTrack_.cues)&&e.length&&(t=this.duration(),e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t)}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;var t;this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.mainSegmentLoader_.getCurrentMediaInfo_(),e=(t&&!t.hasVideo||e)&&this.audioSegmentLoader_.ended_),e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){var t,i;return!!this.seekable().length&&null!==(t=this.syncController_.getExpiredTime(e,this.duration()))&&(e=ul.Playlist.playlistEnd(e,t),t=this.tech_.currentTime(),(i=this.tech_.buffered()).length?(i=i.end(i.length-1))-t<=.1&&e-i<=.1:e-t<=.1)}excludePlaylist({playlistToExclude:r=this.mainPlaylistLoader_.media(),error:e={},playlistExclusionDuration:t}){if(r=r||this.mainPlaylistLoader_.media(),t=t||e.playlistExclusionDuration||this.playlistExclusionDuration,r){r.playlistErrors_++;var n=this.mainPlaylistLoader_.main.playlists,i=n.filter(ha),i=1===i.length&&i[0]===r;if(1===n.length&&t!==1/0)return I.log.warn(`Problem encountered with playlist ${r.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(i);if(i){let i=!1;n.forEach(e=>{var t;e!==r&&void 0!==(t=e.excludeUntil)&&t!==1/0&&(i=!0,delete e.excludeUntil)}),i&&(I.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}n=r.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*t,r.excludeUntil=n,e.reason&&(r.lastExcludeReason_=e.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});var s,t=this.selectPlaylist();if(t)return n=e.internal?this.logger_:I.log.warn,s=e.message?" "+e.message:"",n(`${e.internal?"Internal problem":"Problem"} encountered with playlist ${r.id}.${s} Switching to playlist ${t.id}.`),t.attributes.AUDIO!==r.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),t.attributes.SUBTITLES!==r.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),n=t.targetDuration/2*1e3||5e3,s="number"==typeof t.lastRequest&&Date.now()-t.lastRequest<=n,this.switchMedia_(t,"exclude",i||s);this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error")}else this.error=e,"open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network")}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(i,e){const r=[],t="all"===i;!t&&"main"!==i||r.push(this.mainPlaylistLoader_);var n=[];!t&&"audio"!==i||n.push("AUDIO"),!t&&"subtitle"!==i||(n.push("CLOSED-CAPTIONS"),n.push("SUBTITLES")),n.forEach(e=>{e=this.mediaTypes_[e]&&this.mediaTypes_[e].activePlaylistLoader;e&&r.push(e)}),["main","audio","subtitle"].forEach(e=>{var t=this[e+"SegmentLoader_"];!t||i!==e&&"all"!==i||r.push(t)}),r.forEach(t=>e.forEach(e=>{"function"==typeof t[e]&&t[e]()}))}setCurrentTime(e){var t=Qs(this.tech_.buffered(),e);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}duration(){var e;return this.mainPlaylistLoader_&&(e=this.mainPlaylistLoader_.media())?e.endList?this.mediaSource?this.mediaSource.duration:ul.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let i;if(this.mainPlaylistLoader_){var r=this.mainPlaylistLoader_.media();if(r){var n=this.syncController_.getExpiredTime(r,this.duration());if(null!==n){var s=this.mainPlaylistLoader_.main,a=ul.Playlist.seekable(r,n,ul.Playlist.liveEdgeDelay(s,r));if(0!==a.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(r=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(r,this.duration())))return;if(0===(i=ul.Playlist.seekable(r,n,ul.Playlist.liveEdgeDelay(s,r))).length)return}let e,t;this.seekable_&&this.seekable_.length&&(e=this.seekable_.end(0),t=this.seekable_.start(0)),!i||i.start(0)>a.end(0)||a.start(0)>i.end(0)?this.seekable_=a:this.seekable_=R([[(i.start(0)>a.start(0)?i:a).start(0),(i.end(0)<a.end(0)?i:a).end(0)]]),this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===e&&this.seekable_.start(0)===t||(this.logger_(`seekable updated [${pa(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}}}}}updateDuration(t){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)this.updateDuration_=this.updateDuration.bind(this,t),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);else{if(t){const t=this.seekable();return t.length?void((isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1))):void 0}t=this.tech_.buffered();let e=ul.Playlist.duration(this.mainPlaylistLoader_.media());0<t.length&&(e=Math.max(e,t.end(t.length-1))),this.mediaSource.duration!==e&&this.sourceUpdater_.setDuration(e)}}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{var t=this.mediaTypes_[e].groups;for(const e in t)t[e].forEach(e=>{e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){var e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),e=!e||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!t||!e)}getCodecsOrExclude_(){const n={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},e=(n.video=n.main,ho(this.main(),this.media())),s={},t=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(n.main.hasVideo&&(s.video=e.video||n.main.videoCodec||"avc1.4d400d"),n.main.isMuxed&&(s.video+=","+(e.audio||n.main.audioCodec||"mp4a.40.2")),(n.main.hasAudio&&!n.main.isMuxed||n.audio.hasAudio||t)&&(s.audio=e.audio||n.main.audioCodec||n.audio.audioCodec||"mp4a.40.2",n.audio.isFmp4=(n.main.hasAudio&&!n.main.isMuxed?n.main:n.audio).isFmp4),s.audio||s.video){const a={};let r;if(["video","audio"].forEach(function(e){if(s.hasOwnProperty(e)&&(t=n[e].isFmp4,i=s[e],!(t?Q:ee)(i))){const t=n[e].isFmp4?"browser":"muxer";a[t]=a[t]||[],a[t].push(s[e]),"audio"===e&&(r=t)}var t,i}),t&&r&&this.media().attributes.AUDIO){const n=this.media().attributes.AUDIO;this.main().playlists.forEach(e=>{(e.attributes&&e.attributes.AUDIO)===n&&e!==this.media()&&(e.excludeUntil=1/0)}),this.logger_(`excluding audio group ${n} as ${r} does not support codec(s): "${s.audio}"`)}if(!Object.keys(a).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const n=[];if(["video","audio"].forEach(e=>{var t=(J(this.sourceUpdater_.codecs[e]||"")[0]||{}).type,i=(J(s[e]||"")[0]||{}).type;t&&i&&t.toLowerCase()!==i.toLowerCase()&&n.push(`"${this.sourceUpdater_.codecs[e]}" -> "${s[e]}"`)}),n.length)return void this.excludePlaylist({playlistToExclude:this.media(),error:{message:`Codec switching not supported: ${n.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0})}return s}{const n=Object.keys(a).reduce((e,t)=>(e&&(e+=", "),e+`${t} does not support codec(s): "${a[t].join(",")}"`),"")+".";this.excludePlaylist({playlistToExclude:this.media(),error:{internal:!0,message:n},playlistExclusionDuration:1/0})}}else this.excludePlaylist({playlistToExclude:this.media(),error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0})}tryToCreateSourceBuffers_(){var e;"open"!==this.mediaSource.readyState||this.sourceUpdater_.hasCreatedSourceBuffers()||this.areMediaTypesKnown_()&&(e=this.getCodecsOrExclude_())&&(this.sourceUpdater_.createSourceBuffers(e),e=[e.video,e.audio].filter(Boolean).join(","),this.excludeIncompatibleVariants_(e))}excludeUnsupportedVariants_(){const r=this.main().playlists,n=[];Object.keys(r).forEach(e=>{var t,i,e=r[e];-1===n.indexOf(e.id)&&(n.push(e.id),i=[],!(t=ho(this.main,e)).audio||ee(t.audio)||Q(t.audio)||i.push("audio codec "+t.audio),!t.video||ee(t.video)||Q(t.video)||i.push("video codec "+t.video),t.text&&"stpp.ttml.im1t"===t.text&&i.push("text codec "+t.text),i.length)&&(e.excludeUntil=1/0,this.logger_(`excluding ${e.id} for unsupported: `+i.join(", ")))})}excludeIncompatibleVariants_(e){const n=[],s=this.main().playlists,t=oo(J(e)),a=lo(t),o=t.video&&J(t.video)[0]||null,l=t.audio&&J(t.audio)[0]||null;Object.keys(s).forEach(e=>{e=s[e];if(-1===n.indexOf(e.id)&&e.excludeUntil!==1/0){n.push(e.id);var t=[],i=ho(this.mainPlaylistLoader_.main,e),r=lo(i);if(i.audio||i.video){if(r!==a&&t.push(`codec count "${r}" !== "${a}"`),!this.sourceUpdater_.canChangeType()){const e=i.video&&J(i.video)[0]||null,n=i.audio&&J(i.audio)[0]||null;e&&o&&e.type.toLowerCase()!==o.type.toLowerCase()&&t.push(`video codec "${e.type}" !== "${o.type}"`),n&&l&&n.type.toLowerCase()!==l.type.toLowerCase()&&t.push(`audio codec "${n.type}" !== "${l.type}"`)}t.length&&(e.excludeUntil=1/0,this.logger_(`excluding ${e.id}: `+t.join(" && ")))}}})}updateAdCues_(e){let t=0;var i=this.seekable(),[r,n,s=0]=(i.length&&(t=i.start(0)),[e,this.cueTagsTrack_,t]);if(r.segments){let t,i=s;for(let e=0;e<r.segments.length;e++){var a=r.segments[e];if(t=t||function(e,t){var i=e.cues;for(let e=0;e<i.length;e++){var r=i[e];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null}(n,i+a.duration/2)){if("cueIn"in a){t.endTime=i,t.adEndTime=i,i+=a.duration,t=null;continue}if(i<t.endTime){i+=a.duration;continue}t.endTime+=a.duration}else if("cueOut"in a&&((t=new(v().VTTCue)(i,i+a.duration,a.cueOut)).adStartTime=i,t.adEndTime=i+parseFloat(a.cueOut),n.addCue(t)),"cueOutCont"in a){const[r,s]=a.cueOutCont.split("/").map(parseFloat);(t=new(v().VTTCue)(i,i+a.duration,"")).adStartTime=i-r,t.adEndTime=t.adStartTime+s,n.addCue(t)}i+=a.duration}}}goalBufferLength(){var e=this.tech_.currentTime(),t=D.GOAL_BUFFER_LENGTH,i=D.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,D.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,r)}bufferLowWaterLine(){var e=this.tech_.currentTime(),t=D.BUFFER_LOW_WATER_LINE,i=D.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,D.MAX_BUFFER_LOW_WATER_LINE),n=Math.max(t,D.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.bufferBasedABR?n:r)}bufferHighWaterLine(){return D.BUFFER_HIGH_WATER_LINE}}class pl{constructor(e,t,i){var n,s,a,r=e["playlistController_"],o=r.fastQualityChange_.bind(r);if(t.attributes){const e=t.attributes.RESOLUTION;this.width=e&&e.width,this.height=e&&e.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=ho(r.main(),t),this.playlist=t,this.id=i,this.enabled=(n=e.playlists,s=t.id,a=o,e=>{var t=n.main.playlists[s],i=la(t),r=ha(t);return void 0===e?r:(e?delete t.disabled:t.disabled=!0,e===r||i||(a(),e?n.trigger("renditionenabled"):n.trigger("renditiondisabled")),e)})}}const fl=["seeking","seeked","pause","playing","error"];class ml{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Js("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),i=()=>this.monitorCurrentTime_(),r=()=>this.techWaiting_(),n=()=>this.resetTimeUpdate_(),s=this.playlistController_,a=["main","subtitle","audio"],o={},l=(a.forEach(e=>{o[e]={reset:()=>this.resetSegmentDownloads_(e),updateend:()=>this.checkSegmentDownloads_(e)},s[e+"SegmentLoader_"].on("appendsdone",o[e].updateend),s[e+"SegmentLoader_"].on("playlistupdate",o[e].reset),this.tech_.on(["seeked","seeking"],o[e].reset)}),t=>{["main","audio"].forEach(e=>{s[e+"SegmentLoader_"][t]("appended",this.seekingAppendCheck_)})});this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),l("off"))},this.clearSeekingAppendCheck_=()=>l("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),l("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",r),this.tech_.on(fl,n),this.tech_.on("canplay",i),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",r),this.tech_.off(fl,n),this.tech_.off("canplay",i),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),a.forEach(e=>{s[e+"SegmentLoader_"].off("appendsdone",o[e].updateend),s[e+"SegmentLoader_"].off("playlistupdate",o[e].reset),this.tech_.off(["seeked","seeking"],o[e].reset)}),this.checkCurrentTimeTimeout_&&v().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&v().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=v().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){var t=this.playlistController_[e+"SegmentLoader_"];0<this[e+"StalledDownloads_"]&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[e+"StalledDownloads_"]=0,this[e+"Buffered_"]=t.buffered_()}checkSegmentDownloads_(e){var t=this.playlistController_,i=t[e+"SegmentLoader_"],r=i.buffered_(),n=function(t,i){if(t!==i){if(!t&&i||!i&&t)return!0;if(t.length!==i.length)return!0;for(let e=0;e<t.length;e++)if(t.start(e)!==i.start(e)||t.end(e)!==i.end(e))return!0}return!1}(this[e+"Buffered_"],r);this[e+"Buffered_"]=r,n?this.resetSegmentDownloads_(e):(this[e+"StalledDownloads_"]++,this.logger_(`found #${this[e+"StalledDownloads_"]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:i.playlist_&&i.playlist_.id,buffered:fa(r)}),this[e+"StalledDownloads_"]<10||(this.logger_(e+" loader stalled download exclusion"),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),"subtitle"!==e&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0})))}checkCurrentTime_(){var e,t;if(!this.tech_.paused()&&!this.tech_.seeking())return e=this.tech_.currentTime(),t=this.tech_.buffered(),this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1))?this.techWaiting_():void(5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e))}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const e=this.seekable(),t=this.tech_.currentTime();let i;if(this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(i=e.end(e.length-1)),this.beforeSeekableWindow_(e,t)){const t=e.start(0);i=t+(t===e.end(0)?0:.1)}if(void 0!==i)return this.logger_(`Trying to seek outside of seekable at time ${t} with seekable range ${pa(e)}. Seeking to ${i}.`),this.tech_.setCurrentTime(i),!0;var r=this.playlistController_.sourceUpdater_,n=this.tech_.buffered(),s=r.audioBuffer?r.audioBuffered():null,r=r.videoBuffer?r.videoBuffered():null,a=this.media(),o=a.partTargetDuration||2*(a.targetDuration-da),l=[s,r];for(let e=0;e<l.length;e++)if(l[e]&&ia(l[e],t)<o)return!1;a=ea(n,t);return 0!==a.length&&(i=a.start(0)+.1,this.logger_(`Buffered region starts (${a.start(0)})  just beyond seek point (${t}). Seeking to ${i}.`),this.tech_.setCurrentTime(i),!0)}waiting_(){var e,t;if(!this.techWaiting_())return e=this.tech_.currentTime(),t=this.tech_.buffered(),(t=Qs(t,e)).length&&e+3<=t.end(0)?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${t.start(0)} -> ${t.end(0)}]. Attempting to resume playback by seeking to the current time.`),void this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})):void 0}techWaiting_(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const i=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) `+i),this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const i=this.tech_.vhs.playlistController_.sourceUpdater_,r=this.tech_.buffered();return this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:t})?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0):0<(e=ea(r,t)).length&&(this.logger_(`Stopped at ${t} and seeking to `+e.start(0)),this.resetTimeUpdate_(),this.skipTheGap_(t),!0)}afterSeekableWindow_(e,t,i,r=!1){if(!e.length)return!1;let n=e.end(e.length-1)+.1;return t>(n=!i.endList&&r?e.end(e.length-1)+3*i.targetDuration:n)}beforeSeekableWindow_(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:t,audioBuffered:i,currentTime:r}){if(t){let e;var n,s;return t.length&&i.length?(n=Qs(t,r-3),s=Qs(t,r),(i=Qs(i,r)).length&&!s.length&&n.length&&(e={start:n.end(0),end:i.end(0)})):ea(t,r).length||(e=this.gapFromVideoUnderflow_(t,r)),!!e&&(this.logger_(`Encountered a gap in video from ${e.start} to ${e.end}. Seeking to current time `+r),!0)}}skipTheGap_(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),t=ea(t,i);this.resetTimeUpdate_(),0!==t.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",t.start(0)),this.tech_.setCurrentTime(t.start(0)+da),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,t){var i=function(t){if(t.length<2)return R();var i=[];for(let e=1;e<t.length;e++){var r=t.end(e-1),n=t.start(e);i.push([r,n])}return R(i)}(e);for(let e=0;e<i.length;e++){var r=i.start(e),n=i.end(e);if(t-r<4&&2<t-r)return{start:r,end:n}}return null}}function gl(t,e){let i=0,r=0;function n(e){null!=e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",l),t.src(e),t.trigger({type:"usage",name:"vhs-error-reload"}),t.play())}function s(){if(Date.now()-i<1e3*o.errorInterval)t.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(o.getSource&&"function"==typeof o.getSource)return i=Date.now(),o.getSource.call(t,n);I.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function a(){t.off("loadedmetadata",l),t.off("error",s),t.off("dispose",a)}const o=P(vl,e),l=(t.ready(()=>{t.trigger({type:"usage",name:"vhs-error-reload-initialized"})}),function(){r&&t.currentTime(r)});t.on("error",s),t.on("dispose",a),t.reloadSourceOnError=function(e){a(),gl(t,e)}}const vl={errorInterval:30,getSource(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}};function yl(t,e){var i=e.media();let r=-1;for(let e=0;e<t.length;e++)if(t[e].id===i.id){r=e;break}t.selectedIndex_=r,t.trigger({selectedIndex:r,type:"change"})}const O={PlaylistLoader:ka,Playlist:k,utils:Os,STANDARD_PLAYLIST_SELECTOR:Lo,INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.main.playlists.filter(k.isEnabled);return Co(e,(e,t)=>co(e,t)),e.filter(e=>!!ho(this.playlists.main,e).video)[0]||null},lastBandwidthSelector:Lo,movingAverageBandwidthSelector:function(t){let i=-1,r=-1;if(t<0||1<t)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var e=this.useDevicePixelRatio&&v().devicePixelRatio||1;return i<0&&(i=this.systemBandwidth,r=this.systemBandwidth),0<this.systemBandwidth&&this.systemBandwidth!==r&&(i=t*this.systemBandwidth+(1-t)*i,r=this.systemBandwidth),Ao(this.playlists.main,i,parseInt(uo(this.tech_.el(),"width"),10)*e,parseInt(uo(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:co,comparePlaylistResolution:function(e,t){let i,r;return i=(i=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width?e.attributes.RESOLUTION.width:i)||v().Number.MAX_VALUE,r=(r=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width?t.attributes.RESOLUTION.width:r)||v().Number.MAX_VALUE,i===r&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-r},xhr:Oa()},_l=(Object.keys(D).forEach(t=>{Object.defineProperty(O,t,{get:()=>(I.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),D[t]),set(e){I.log.warn(`using Vhs.${t} is UNSAFE be sure you know what you are doing`),"number"!=typeof e||e<0?I.log.warn(`value of Vhs.${t} must be greater than or equal to 0`):D[t]=e}})}),"videojs-vhs"),bl=(O.canPlaySource=function(){return I.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},()=>{if(!v().localStorage)return null;var e=v().localStorage.getItem(_l);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}});O.supportsNativeHls=function(){if(!a()||!a().createElement)return!1;const t=a().createElement("video");return!!I.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),O.supportsNativeDash=!!(a()&&a().createElement&&I.getTech("Html5").isSupported())&&/maybe|probably/i.test(a().createElement("video").canPlayType("application/dash+xml")),O.supportsTypeNatively=e=>"hls"===e?O.supportsNativeHls:"dash"===e&&O.supportsNativeDash,O.isSupported=function(){return I.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};class Tl extends I.getComponent("Component"){constructor(e,t,i){if(super(t,i.vhs),"number"==typeof i.initialBandwidth&&(this.options_.bandwidth=i.initialBandwidth),this.logger_=Js("VhsHandler"),t.options_&&t.options_.playerId){const e=I.getPlayer(t.options_.playerId);this.player_=e}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(a(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],e=>{var t=a().fullscreenElement||a().webkitFullscreenElement||a().mozFullScreenElement||a().msFullscreenElement;t&&t.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){var e;this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=!1!==this.options_.llhls,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,"number"!=typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage&&((e=bl())&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e)&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"})),"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=D.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===D.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(e=>{void 0!==this.source_[e]&&(this.options_[e]=this.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(e,t){e&&(this.setOptions_(),this.options_.src=0===(e=this.source_.src).toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(e.substring(e.indexOf(",")+1)):e,this.options_.tech=this.tech_,this.options_.externVhs=O,this.options_.sourceType=te(t),this.options_.seekTo=e=>{this.tech_.setCurrentTime(e)},this.playlistController_=new dl(this.options_),e=P({liveRangeSafeTimeDelta:.1},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_}),this.playbackWatcher_=new ml(e),this.playlistController_.on("error",()=>{var e=I.players[this.tech_.options_.playerId];let t=this.playlistController_.error;"object"!=typeof t||t.code?"string"==typeof t&&(t={message:t,code:3}):t.code=3,e.error(t)}),t=this.options_.bufferBasedABR?O.movingAverageBandwidthSelector(.55):O.STANDARD_PLAYLIST_SELECTOR,this.playlistController_.selectPlaylist=(this.selectPlaylist||t).bind(this),this.playlistController_.selectInitialPlaylist=O.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(e){this.playlistController_.selectPlaylist=e.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(e){this.playlistController_.mainSegmentLoader_.throughput.rate=e,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let e=this.playlistController_.mainSegmentLoader_.bandwidth;var t=v().navigator.connection||v().navigator.mozConnection||v().navigator.webkitConnection;return this.options_.useNetworkInformationApi&&t&&(t=1e3*t.downlink*1e3,e=1e7<=t&&1e7<=e?Math.max(e,t):t),e},set(e){this.playlistController_.mainSegmentLoader_.bandwidth=e,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){var e=1/(this.bandwidth||1),t=0<this.throughput?1/this.throughput:0;return Math.floor(1/(e+t))},set(){I.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>fa(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>fa(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{if(this.options_.useBandwidthFromLocalStorage){var e={bandwidth:this.bandwidth,throughput:Math.round(this.throughput)};if(v().localStorage){var t=(t=bl())?P(t,e):e;try{v().localStorage.setItem(_l,JSON.stringify(t))}catch(e){return}}}}),this.playlistController_.on("selectedinitialmedia",()=>{var i;(i=this).representations=()=>{var e=i.playlistController_.main(),e=xa(e)?i.playlistController_.getAudioTrackPlaylists_():e.playlists;return e?e.filter(e=>!la(e)).map((e,t)=>new pl(i,e,e.id)):[]}}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el())&&(this.mediaSourceUrl_=v().URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){var e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),(({player:r,sourceKeySystems:e,audioMedia:t,mainPlaylists:i})=>{if(!r.eme.initializeMediaKeys)return Promise.resolve();t=t?i.concat([t]):i,o=Object.keys(e);const n=t.reduce((e,r)=>{var t;return r.contentProtection&&(t=o.reduce((e,t)=>{var i=r.contentProtection[t];return i&&i.pssh&&(e[t]={pssh:i.pssh}),e},{}),Object.keys(t).length)&&e.push(t),e},[]),s=[],a=[];var o;return n.forEach(e=>{a.push(new Promise((e,t)=>{r.tech_.one("keysessioncreated",e)})),s.push(new Promise((t,i)=>{r.eme.initializeMediaKeys({keySystems:e},e=>{e?i(e):t()})}))}),Promise.race([Promise.all(s),Promise.race(a)])})({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(e=>{this.logger_("error while creating EME key session",e),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){var e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,e=(({player:e,sourceKeySystems:t,media:i,audioMedia:r})=>{t=((e,t,i)=>{if(!e)return e;let r={};t&&t.attributes&&t.attributes.CODECS&&(r=oo(J(t.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(r.audio=i.attributes.CODECS);var n=Z(r.video),s=Z(r.audio),a={};for(const i in e)a[i]={},s&&(a[i].audioContentType=s),n&&(a[i].videoContentType=n),t.contentProtection&&t.contentProtection[i]&&t.contentProtection[i].pssh&&(a[i].pssh=t.contentProtection[i].pssh),"string"==typeof e[i]&&(a[i].url=e[i]);return P(e,a)})(t,i,r);return!(!t||(e.currentSource().keySystems=t)&&!e.eme&&(I.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),1))})({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});this.player_.tech_.on("keystatuschange",e=>{if("output-restricted"===e.status){e=this.playlistController_.main();if(e&&e.playlists){const t=[];e.playlists.forEach(e=>{e&&e.attributes&&e.attributes.RESOLUTION&&720<=e.attributes.RESOLUTION.height&&(!e.excludeUntil||e.excludeUntil<1/0)&&(e.excludeUntil=1/0,t.push(e))}),t.length&&(I.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...t),this.playlistController_.fastQualityChange_())}}}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),11!==I.browser.IE_VERSION&&e?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){var e=I.players[this.tech_.options_.playerId];e&&e.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{var t,e;t=this.qualityLevels_,(e=this).representations().forEach(e=>{t.addQualityLevel(e)}),yl(t,e.playlists)}),this.playlists.on("mediachange",()=>{yl(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":"3.0.0","mux.js":"6.2.0","mpd-parser":"1.0.1","m3u8-parser":"6.0.0","aes-decrypter":"4.0.1"}}version(){return this.constructor.version()}canChangeType(){return $o.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&v().URL.revokeObjectURL&&(v().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){var i,r,{playlist:e,time:t,callback:n}={playlist:this.playlistController_.media(),time:e,callback:t};if(n)return e&&void 0!==t?(e=((t,i)=>{if(!i||!i.segments||0===i.segments.length)return null;let r,n=0;for(let e=0;e<i.segments.length&&(r=i.segments[e],!(t<=(n=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:n+r.duration)));e++);var e=i.segments[i.segments.length-1];if(e.videoTimingInfo&&e.videoTimingInfo.transmuxedPresentationEnd<t)return null;if(t>n){if(t>n+.25*e.duration)return null;r=e}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:n-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}})(t,e))?"estimate"===e.type?n({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:e.estimatedStart}):(i={mediaSeconds:t},(t=(e=e.segment).dateTimeObject?(r=e.videoTimingInfo.transmuxerPrependedSeconds,r=t-(e.videoTimingInfo.transmuxedPresentationStart+r),new Date(e.dateTimeObject.getTime()+1e3*r)):null)&&(i.programDateTime=t.toISOString()),n(null,i)):n({message:"valid programTime was not found"}):n({message:"getProgramTime: playlist and time must be provided"});throw new Error("getProgramTime: callback must be provided")}seekToProgramTime(e,t,i=!0,r=2){return ja({programTime:e,playlist:this.playlistController_.media(),retryCount:r,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}const xl={name:"videojs-http-streaming",VERSION:"3.0.0",canHandleSource(e,t={}){t=P(I.options,t);return xl.canPlayType(e.type,t)},handleSource(e,t,i={}){i=P(I.options,i);return t.vhs=new Tl(e,t,i),t.vhs.xhr=Oa(),t.vhs.src(e.src,e.type),t.vhs},canPlayType(e,t={}){var{vhs:{overrideNative:t=!I.browser.IS_ANY_SAFARI}={}}=P(I.options,t),e=te(e);return!e||O.supportsTypeNatively(e)&&!t?"":"maybe"}};Q("avc1.4d400d,mp4a.40.2")&&I.getTech("Html5").registerSourceHandler(xl,0),I.VhsHandler=Tl,I.VhsSourceHandler=xl,I.Vhs=O,I.use||I.registerComponent("Vhs",O),I.options.vhs=I.options.vhs||{},I.getPlugin&&I.getPlugin("reloadSourceOnError")||I.registerPlugin("reloadSourceOnError",function(e){gl(this,e)})},545:(e,t,i)=>{var r=i(1192),e=e.exports={WebVTT:i(285),VTTCue:i(9038),VTTRegion:i(1058)},n=(r.vttjs=e,r.WebVTT=e.WebVTT,e.VTTCue),s=e.VTTRegion,a=r.VTTCue,o=r.VTTRegion;e.shim=function(){r.VTTCue=n,r.VTTRegion=s},e.restore=function(){r.VTTCue=a,r.VTTRegion=o},r.VTTCue||e.shim()},285:(e,t,i)=>{var i=i(930),r=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=e,new n};function n(){}function l(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function c(e){function t(e,t,i,r){return 3600*(0|e)+60*(0|t)+(0|i)+(0|r)/1e3}e=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return e?e[3]?t(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?t(e[1],e[2],0,e[4]):t(0,e[1],e[2],e[4]):null}function h(){this.values=r(null)}function u(e,t,i,r){var n,s,a=r?e.split(r):[e];for(n in a)"string"==typeof a[n]&&2===(s=a[n].split(i)).length&&t(s[0].trim(),s[1].trim())}((l.prototype=r(Error.prototype)).constructor=l).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},h.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var d=i.createElement&&i.createElement("textarea"),p={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},f={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},m={v:"title",lang:"lang"},g={rt:"ruby"};function s(e,t){for(var i,r,n=e.document.createElement("div"),s=n,a=[];null!==(u=void 0,u=t?(u=(u=t.match(/^([^<]*)(<[^>]*>?)?/))[1]||u[2],t=t.substr(u.length),u):null);)if("<"!==u[0])s.appendChild(e.document.createTextNode((l=u,d.innerHTML=l,l=d.textContent,d.textContent="",l)));else{if("/"===u[1]){a.length&&a[a.length-1]===u.substr(2).replace(">","")&&(a.pop(),s=s.parentNode);continue}var o,l=c(u.substr(1,u.length-2));if(l){o=e.document.createProcessingInstruction("timestamp",l),s.appendChild(o);continue}var h,u=u.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!u)continue;if(i=u[1],r=u[3],h=void 0,h=p[i],!(o=h?(h=e.document.createElement(h),(i=m[i])&&r&&(h[i]=r.trim()),h):null))continue;if(i=s,g[(r=o).localName]&&g[r.localName]!==i.localName)continue;u[2]&&((h=u[2].split(".")).forEach(function(e){var t=/^bg_/.test(e),e=t?e.slice(3):e;f.hasOwnProperty(e)&&(e=f[e],o.style[t?"background-color":"color"]=e)}),o.className=h.join(" ")),a.push(u[1]),s.appendChild(o),s=o}return n}var a=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function o(e){var t=[],i="";if(e&&e.childNodes)for(s(t,e);i=function e(t){var i,r,n;return t&&t.length?(r=(i=t.pop()).textContent||i.innerText)?(n=r.match(/^.*(\n|\r)/))?n[t.length=0]:r:"ruby"===i.tagName?e(t):i.childNodes?(s(t,i),e(t)):void 0:null}(t);)for(var r=0;r<i.length;r++)if(function(e){for(var t=0;t<a.length;t++){var i=a[t];if(e>=i[0]&&e<=i[1])return 1}}(i.charCodeAt(r)))return"rtl";return"ltr";function s(e,t){for(var i=t.childNodes.length-1;0<=i;i--)e.push(t.childNodes[i])}}function v(){}function S(e,t,i){v.call(this),this.cue=t,this.cueDiv=s(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"},n=(this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:o(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv),0);switch(t.positionAlign){case"start":n=t.position;break;case"center":n=t.position-t.size/2;break;case"end":n=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(n,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(n,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,i,r,n;e.div&&(t=e.div.offsetHeight,i=e.div.offsetWidth,r=e.div.offsetTop,n=(n=(n=e.div.childNodes)&&n[0])&&n.getClientRects&&n.getClientRects(),e=e.div.getBoundingClientRect(),n=n?Math.max(n[0]&&n[0].height||0,e.height/n.length):0),this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||t,this.bottom=e.bottom||r+(e.height||t),this.width=e.width||i,this.lineHeight=void 0!==n?n:e.lineHeight}function y(){}v.prototype.applyStyles=function(e,t){for(var i in t=t||this.div,e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},v.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(S.prototype=r(v.prototype)).constructor=S,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||i}},y.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},y.convertCueToDOMTree=function(e,t){return e&&t?s(e,t):null},y.processCues=function(e,t,i){if(!e||!t||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",i.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return 1}(t))for(var n,s,a=[],o=E.getSimpleBoxPosition(r),l={font:Math.round(.05*o.height*100)/100+"px sans-serif"},h=0;h<t.length;h++){s=t[h],n=new S(e,s,l),r.appendChild(n.div),x=T=b=_=y=u=v=g=m=f=p=d=c=void 0;var u,c=n,d=o,p=a,f=new E(c),m=c.cue,g=function(){if("number"==typeof m.line&&(m.snapToLines||0<=m.line&&m.line<=100))return m.line;if(!m.track||!m.track.textTrackList||!m.track.textTrackList.mediaElement)return-1;for(var e=m.track,t=e.textTrackList,i=0,r=0;r<t.length&&t[r]!==e;r++)"showing"===t[r].mode&&i++;return-1*++i}(),v=[];if(m.snapToLines){switch(m.vertical){case"":v=["+y","-y"],u="height";break;case"rl":v=["+x","-x"],u="width";break;case"lr":v=["-x","+x"],u="width"}var y=f.lineHeight,_=y*Math.round(g),b=d[u]+y,T=v[0];Math.abs(_)>b&&(_=_<0?-1:1,_*=Math.ceil(b/y)*y),g<0&&(_+=""===m.vertical?d.height:d.width,v=v.reverse()),f.move(T,_)}else{var x=f.lineHeight/d.height*100;switch(m.lineAlign){case"center":g-=x/2;break;case"end":g-=x}switch(m.vertical){case"":c.applyStyles({top:c.formatStyle(g,"%")});break;case"rl":c.applyStyles({left:c.formatStyle(g,"%")});break;case"lr":c.applyStyles({right:c.formatStyle(g,"%")})}v=["+y","-x","+x","-y"],f=new E(c)}b=function(e,t){for(var i,r=new E(e),n=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(d,t[s])||e.within(d)&&e.overlapsAny(p);)e.move(t[s]);if(e.within(d))return e;var a=e.intersectPercentage(d);a<n&&(i=new E(e),n=a),e=new E(r)}return i||r}(f,v),c.move(b.toCSSCompatValues(d)),s.displayState=n.div,a.push(E.getSimpleBoxPosition(n))}else for(var w=0;w<t.length;w++)r.appendChild(t[w].displayState)},(y.Parser=function(e,t,i){i||(i=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof l))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t,r=this;function i(){for(var e=r.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var i=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,r.buffer=e.substr(t),i}function n(e){e.match(/X-TIMESTAMP-MAP/)?u(e,function(e,t){var i;"X-TIMESTAMP-MAP"===e&&(e=t,i=new h,u(e,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",c(t))}},/[^\d]:/,/,/),r.ontimestampmap)&&r.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})},/=/):u(e,function(e,t){var n;"Region"===e&&(e=t,n=new h,u(e,function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var i,r=t.split(",");2===r.length&&((i=new h).percent("x",r[0]),i.percent("y",r[1]),i.has("x")&&i.has("y"))&&(n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y")));break;case"scroll":n.alt(e,t,["up"])}},/=/,/\s/),n.has("id"))&&((e=new(r.vttjs.VTTRegion||r.window.VTTRegion)).width=n.get("width",100),e.lines=n.get("lines",3),e.regionAnchorX=n.get("regionanchorX",0),e.regionAnchorY=n.get("regionanchorY",100),e.viewportAnchorX=n.get("viewportanchorX",0),e.viewportAnchorY=n.get("viewportanchorY",100),e.scroll=n.get("scroll",""),r.onregion&&r.onregion(e),r.regionList.push({id:n.get("id"),region:e}))},/:/)}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var s=(t=i()).match(/^WEBVTT([ \t].*)?$/);if(!s||!s[0])throw new l(l.Errors.BadSignature);r.state="HEADER"}for(var a=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(a?a=!1:t=i(),r.state){case"HEADER":/:/.test(t)?n(t):t||(r.state="ID");continue;case"NOTE":t||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){r.state="NOTE";break}if(!t)continue;r.cue=new(r.vttjs.VTTCue||r.window.VTTCue)(0,0,"");try{r.cue.align="center"}catch(e){r.cue.align="middle"}if(r.state="CUE",-1===t.indexOf("--\x3e")){r.cue.id=t;continue}case"CUE":try{!function(t,e,s){var i=t;function r(){var e=c(t);if(null===e)throw new l(l.Errors.BadTimeStamp,"Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function n(){t=t.replace(/^\s+/,"")}if(n(),e.startTime=r(),n(),"--\x3e"!==t.substr(0,3))throw new l(l.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);t=t.substr(3),n(),e.endTime=r(),n();var a=t,o=new h;u(a,function(e,t){switch(e){case"region":for(var i=s.length-1;0<=i;i--)if(s[i].id===t){o.set(e,s[i].region);break}break;case"vertical":o.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),n=r[0];o.integer(e,n),o.percent(e,n)&&o.set("snapToLines",!1),o.alt(e,n,["auto"]),2===r.length&&o.alt("lineAlign",r[1],["start","center","end"]);break;case"position":r=t.split(","),o.percent(e,r[0]),2===r.length&&o.alt("positionAlign",r[1],["start","center","end"]);break;case"size":o.percent(e,t);break;case"align":o.alt(e,t,["start","center","end","left","right"])}},/:/,/\s/),e.region=o.get("region",null),e.vertical=o.get("vertical","");try{e.line=o.get("line","auto")}catch(a){}e.lineAlign=o.get("lineAlign","start"),e.snapToLines=o.get("snapToLines",!0),e.size=o.get("size",100);try{e.align=o.get("align","center")}catch(a){e.align=o.get("align","middle")}try{e.position=o.get("position","auto")}catch(a){e.position=o.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},e.align)}e.positionAlign=o.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},e.align)}(t,r.cue,r.regionList)}catch(e){r.reportOrThrowError(e),r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var o=-1!==t.indexOf("--\x3e");if(!t||o&&(a=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=t.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":t||(r.state="ID");continue}}}catch(e){r.reportOrThrowError(e),"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new l(l.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},e.exports=y},9038:e=>{var v={"":1,lr:1,rl:1},t={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function y(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function i(e,t,i){this.hasBeenReset=!1;var r="",n=!1,s=e,a=t,o=i,l=null,h="",u=!0,c="auto",d="start",p="auto",f="auto",m=100,g="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(e){r=""+e}},pauseOnExit:{enumerable:!0,get:function(){return n},set:function(e){n=!!e}},startTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");s=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");a=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return h},set:function(e){e="string"==typeof(e=e)&&!!v[e.toLowerCase()]&&e.toLowerCase();if(!1===e)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");h=e,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return u},set:function(e){u=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");c=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return d},set:function(e){e=y(e);e?(d=e,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return p},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");p=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return f},set:function(e){e=y(e);e?(f=e,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");m=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return g},set:function(e){e=y(e);if(!e)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");g=e,this.hasBeenReset=!0}}}),this.displayState=void 0}i.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=i},1058:e=>{var l={"":!0,up:!0};function h(e){return"number"==typeof e&&0<=e&&e<=100}e.exports=function(){var t=100,i=3,r=0,n=100,s=0,a=100,o="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!h(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");i=e}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(e){if(!h(e))throw new Error("RegionAnchorX must be between 0 and 100.");n=e}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!h(e))throw new Error("RegionAnchorY must be between 0 and 100.");r=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!h(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return s},set:function(e){if(!h(e))throw new Error("ViewportAnchorX must be between 0 and 100.");s=e}},scroll:{enumerable:!0,get:function(){return o},set:function(e){e="string"==typeof(e=e)&&!!l[e.toLowerCase()]&&e.toLowerCase();!1===e?console.warn("Scroll: an invalid or illegal string was specified."):o=e}}})}},8746:function(e){function t(e){return"__private_"+n+++"_"+e}function s(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e;throw new TypeError("attempted to use private field on non-instance")}function i(){}function r(e){var n=this;Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),this._onWheel=function(e){var t=s(n,h)[h],i=s(n,d)[d];i.deltaX=e.wheelDeltaX||-1*e.deltaX,i.deltaY=e.wheelDeltaY||-1*e.deltaY,o.isFirefox&&1===e.deltaMode&&(i.deltaX*=t.firefoxMultiplier,i.deltaY*=t.firefoxMultiplier),i.deltaX*=t.mouseMultiplier,i.deltaY*=t.mouseMultiplier,n._notify(e)},this._onMouseWheel=function(e){var t=s(n,d)[d];t.deltaX=e.wheelDeltaX||0,t.deltaY=e.wheelDeltaY||e.wheelDelta,n._notify(e)},this._onTouchStart=function(e){e=e.targetTouches?e.targetTouches[0]:e;s(n,p)[p].x=e.pageX,s(n,p)[p].y=e.pageY},this._onTouchMove=function(e){var t=s(n,h)[h],i=(t.preventTouch&&!e.target.classList.contains(t.unpreventTouchClass)&&e.preventDefault(),s(n,d)[d]),r=e.targetTouches?e.targetTouches[0]:e;i.deltaX=(r.pageX-s(n,p)[p].x)*t.touchMultiplier,i.deltaY=(r.pageY-s(n,p)[p].y)*t.touchMultiplier,s(n,p)[p].x=r.pageX,s(n,p)[p].y=r.pageY,n._notify(e)},this._onKeyDown=function(e){var t=s(n,d)[d],i=(t.deltaX=t.deltaY=0,window.innerHeight-40);switch(e.keyCode){case 37:case 38:t.deltaY=s(n,h)[h].keyStep;break;case 39:case 40:t.deltaY=-s(n,h)[h].keyStep;break;case 32:t.deltaY=i*(e.shiftKey?1:-1);break;default:return}n._notify(e)},s(this,u)[u]=window,e&&e.el&&(s(this,u)[u]=e.el,delete e.el),o=o||{hasWheelEvent:"onwheel"in document,hasMouseWheelEvent:"onmousewheel"in document,hasTouch:"ontouchstart"in document,hasTouchWin:navigator.msMaxTouchPoints&&1<navigator.msMaxTouchPoints,hasPointer:!!window.navigator.msPointerEnabled,hasKeyDown:"onkeydown"in document,isFirefox:-1<navigator.userAgent.indexOf("Firefox")},s(this,h)[h]=Object.assign({mouseMultiplier:1,touchMultiplier:2,firefoxMultiplier:15,keyStep:120,preventTouch:!1,unpreventTouchClass:"vs-touchmove-allowed",useKeyboard:!0,useTouch:!0},e),s(this,c)[c]=new a,s(this,d)[d]={y:0,x:0,deltaX:0,deltaY:0},s(this,p)[p]={x:null,y:null},s(this,f)[f]=null,void 0!==s(this,h)[h].passive&&(this.listenerOptions={passive:s(this,h)[h].passive})}var n,a,o,l,h,u,c,d,p,f;e.exports=(n=0,i.prototype={on:function(e,t,i){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var r=this;function n(){r.off(e,n),t.apply(i,arguments)}return n._=t,this.on(e,n,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),r=0,n=i.length;r<n;r++)i[r].fn.apply(i[r].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),r=i[e],n=[];if(r&&t)for(var s=0,a=r.length;s<a;s++)r[s].fn!==t&&r[s].fn._!==t&&n.push(r[s]);return n.length?i[e]=n:delete i[e],this}},(a=i).TinyEmitter=i,l="virtualscroll",h=t("options"),u=t("el"),c=t("emitter"),d=t("event"),p=t("touchStart"),f=t("bodyTouchAction"),(e=r.prototype)._notify=function(e){var t=s(this,d)[d];t.x+=t.deltaX,t.y+=t.deltaY,s(this,c)[c].emit(l,{x:t.x,y:t.y,deltaX:t.deltaX,deltaY:t.deltaY,originalEvent:e})},e._bind=function(){o.hasWheelEvent&&s(this,u)[u].addEventListener("wheel",this._onWheel,this.listenerOptions),o.hasMouseWheelEvent&&s(this,u)[u].addEventListener("mousewheel",this._onMouseWheel,this.listenerOptions),o.hasTouch&&s(this,h)[h].useTouch&&(s(this,u)[u].addEventListener("touchstart",this._onTouchStart,this.listenerOptions),s(this,u)[u].addEventListener("touchmove",this._onTouchMove,this.listenerOptions)),o.hasPointer&&o.hasTouchWin&&(s(this,f)[f]=document.body.style.msTouchAction,document.body.style.msTouchAction="none",s(this,u)[u].addEventListener("MSPointerDown",this._onTouchStart,!0),s(this,u)[u].addEventListener("MSPointerMove",this._onTouchMove,!0)),o.hasKeyDown&&s(this,h)[h].useKeyboard&&document.addEventListener("keydown",this._onKeyDown)},e._unbind=function(){o.hasWheelEvent&&s(this,u)[u].removeEventListener("wheel",this._onWheel),o.hasMouseWheelEvent&&s(this,u)[u].removeEventListener("mousewheel",this._onMouseWheel),o.hasTouch&&(s(this,u)[u].removeEventListener("touchstart",this._onTouchStart),s(this,u)[u].removeEventListener("touchmove",this._onTouchMove)),o.hasPointer&&o.hasTouchWin&&(document.body.style.msTouchAction=s(this,f)[f],s(this,u)[u].removeEventListener("MSPointerDown",this._onTouchStart,!0),s(this,u)[u].removeEventListener("MSPointerMove",this._onTouchMove,!0)),o.hasKeyDown&&s(this,h)[h].useKeyboard&&document.removeEventListener("keydown",this._onKeyDown)},e.on=function(e,t){s(this,c)[c].on(l,e,t);e=s(this,c)[c].e;e&&e[l]&&1===e[l].length&&this._bind()},e.off=function(e,t){s(this,c)[c].off(l,e,t);e=s(this,c)[c].e;(!e[l]||e[l].length<=0)&&this._unbind()},e.destroy=function(){s(this,c)[c].off(),this._unbind()},r)},9894:e=>{function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i,r=arguments[t];for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(this,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},9961:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var t=i(438),c=i(8746);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i,r=arguments[t];for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}function r(e,t){let i=e%t;return(0<t&&i<0||t<0&&0<i)&&(i+=t),i}const s=["duration","easing"];class d{to(t,e={}){var{duration:i=1,easing:r=e=>e}=e,e=function(e,t){if(null==e)return{};for(var i,r={},n=Object.keys(e),s=0;s<n.length;s++)0<=t.indexOf(i=n[s])||(r[i]=e[i]);return r}(e,s);this.target=t,this.fromKeys=n({},e),this.toKeys=n({},e),this.keys=Object.keys(n({},e)),this.keys.forEach(e=>{this.fromKeys[e]=t[e]}),this.duration=i,this.easing=r,this.currentTime=0,this.isRunning=!0}stop(){this.isRunning=!1}raf(e){if(this.isRunning){this.currentTime=Math.min(this.currentTime+e,this.duration);const i=1<=this.progress?1:this.easing(this.progress);this.keys.forEach(e=>{var t=this.fromKeys[e];this.target[e]=t+(this.toKeys[e]-t)*i}),1===i&&this.stop()}}get progress(){return this.currentTime/this.duration}}class a extends t.TinyEmitter{constructor({duration:e=1.2,easing:t=e=>Math.min(1,1.001-Math.pow(2,-10*e)),smooth:i=!0,mouseMultiplier:r=1,smoothTouch:n=!1,touchMultiplier:s=2,direction:a="vertical",gestureDirection:o="vertical",infinite:l=!1,wrapper:h=window,content:u=document.body}={}){super(),this.onWindowResize=()=>{this.wrapperWidth=window.innerWidth,this.wrapperHeight=window.innerHeight},this.onWrapperResize=([e])=>{e&&(e=e.contentRect,this.wrapperWidth=e.width,this.wrapperHeight=e.height)},this.onContentResize=([e])=>{e&&(e=e.contentRect,this.contentWidth=e.width,this.contentHeight=e.height)},this.onVirtualScroll=({deltaY:e,deltaX:t,originalEvent:i})=>{var r;"vertical"===this.gestureDirection&&0===e||"horizontal"===this.gestureDirection&&0===t||(r=!!i.composedPath().find(e=>e.hasAttribute&&e.hasAttribute("data-lenis-prevent")),i.ctrlKey)||r||(this.smooth=i.changedTouches?this.smoothTouch:this.options.smooth,this.stopped?i.preventDefault():this.smooth&&4!==i.buttons&&(this.smooth&&i.preventDefault(),r=0,r="both"===this.gestureDirection?t+e:"horizontal"===this.gestureDirection?t:e,this.targetScroll-=r,this.scrollTo(this.targetScroll)))},this.onScroll=e=>{this.isScrolling&&this.smooth||(this.targetScroll=this.scroll=this.lastScroll=this.wrapperNode[this.scrollProperty],this.notify())},window.lenisVersion="0.2.28",this.options={duration:e,easing:t,smooth:i,mouseMultiplier:r,smoothTouch:n,touchMultiplier:s,direction:a,gestureDirection:o,infinite:l,wrapper:h,content:u},this.duration=e,this.easing=t,this.smooth=i,this.mouseMultiplier=r,this.smoothTouch=n,this.touchMultiplier=s,this.direction=a,this.gestureDirection=o,this.infinite=l,this.wrapperNode=h,this.contentNode=u,this.wrapperNode.addEventListener("scroll",this.onScroll),this.wrapperNode===window?(this.wrapperNode.addEventListener("resize",this.onWindowResize),this.onWindowResize()):(this.wrapperHeight=this.wrapperNode.offsetHeight,this.wrapperWidth=this.wrapperNode.offsetWidth,this.wrapperObserver=new ResizeObserver(this.onWrapperResize),this.wrapperObserver.observe(this.wrapperNode)),this.contentHeight=this.contentNode.offsetHeight,this.contentWidth=this.contentNode.offsetWidth,this.contentObserver=new ResizeObserver(this.onContentResize),this.contentObserver.observe(this.contentNode),this.targetScroll=this.scroll=this.lastScroll=this.wrapperNode[this.scrollProperty],this.animate=new d;r=(null==(e=navigator)||null==(t=e.userAgentData)?void 0:t.platform)||(null==(i=navigator)?void 0:i.platform)||"unknown";this.virtualScroll=new c({el:this.wrapperNode,firefoxMultiplier:50,mouseMultiplier:this.mouseMultiplier*(r.includes("Win")||r.includes("Linux")?.84:.4),touchMultiplier:this.touchMultiplier,passive:!1,useKeyboard:!1,useTouch:!0}),this.virtualScroll.on(this.onVirtualScroll)}get scrollProperty(){return this.wrapperNode===window?"horizontal"===this.direction?"scrollX":"scrollY":"horizontal"===this.direction?"scrollLeft":"scrollTop"}start(){let e=this.wrapperNode;(e=this.wrapperNode===window?document.documentElement:e).classList.remove("lenis-stopped"),this.stopped=!1}stop(){let e=this.wrapperNode;(e=this.wrapperNode===window?document.documentElement:e).classList.add("lenis-stopped"),this.stopped=!0,this.animate.stop()}destroy(){var e;this.wrapperNode===window&&this.wrapperNode.removeEventListener("resize",this.onWindowResize),this.wrapperNode.removeEventListener("scroll",this.onScroll),this.virtualScroll.destroy(),null!=(e=this.wrapperObserver)&&e.disconnect(),this.contentObserver.disconnect()}get limit(){return"horizontal"===this.direction?this.contentWidth-this.wrapperWidth:this.contentHeight-this.wrapperHeight}raf(e){var t=e-(this.now||0);this.now=e,!this.stopped&&this.smooth&&(this.lastScroll=this.scroll,this.animate.raf(.001*t),this.scroll===this.targetScroll&&(this.lastScroll=this.scroll),this.isScrolling&&(this.setScroll(this.scroll),this.notify()),this.isScrolling=this.scroll!==this.targetScroll)}get velocity(){return this.scroll-this.lastScroll}setScroll(e){e=this.infinite?r(e,this.limit):e;"horizontal"===this.direction?this.wrapperNode.scrollTo(e,0):this.wrapperNode.scrollTo(0,e)}notify(){var e=this.infinite?r(this.scroll,this.limit):this.scroll;this.emit("scroll",{scroll:e,limit:this.limit,velocity:this.velocity,direction:0===this.velocity?0:0<this.velocity?1:-1,progress:e/this.limit})}scrollTo(r,{offset:e=0,immediate:t=!1,duration:n=this.duration,easing:s=this.easing}={}){if(null!=r&&!this.stopped){let i;if("number"==typeof r)i=r;else if("top"===r||"#top"===r)i=0;else if("bottom"===r)i=this.limit;else{let e;if("string"==typeof r)e=document.querySelector(r);else{if(null==r||!r.nodeType)return;e=r}if(!e)return;let t=0;if(this.wrapperNode!==window){const r=this.wrapperNode.getBoundingClientRect();t="horizontal"===this.direction?r.left:r.top}const n=e.getBoundingClientRect();i=("horizontal"===this.direction?n.left:n.top)+this.scroll-t}i+=e,this.targetScroll=this.infinite?i:Math.max(0,Math.min(i,this.limit)),!this.smooth||t?(this.animate.stop(),this.scroll=this.lastScroll=this.targetScroll,this.setScroll(this.targetScroll)):this.animate.to(this,{duration:n,easing:s,scroll:this.targetScroll})}}}},4599:(d,b,T)=>{"use strict";T.d(b,{CP7:()=>i,D1R:()=>He,DvJ:()=>rn,EJi:()=>Gl,EoG:()=>k,F5T:()=>e,FM8:()=>W,IOt:()=>zt,Ilk:()=>m,Kj0:()=>S,LY2:()=>O,M8C:()=>ii,Mig:()=>Mh,N$j:()=>So,NMF:()=>Nt,OdW:()=>Ao,OoA:()=>q,Ox3:()=>Eh,PMe:()=>yh,Pa4:()=>Pe,QRU:()=>Ih,SUY:()=>kh,Syv:()=>Ot,TUv:()=>wo,TlE:()=>E,Tme:()=>a,TyD:()=>Ae,USm:()=>ir,UY4:()=>jo,UlW:()=>Ut,Wid:()=>Vl,Wl3:()=>De,YLQ:()=>Ue,ZAu:()=>qa,Zp0:()=>Lh,ZzF:()=>_i,_C8:()=>Wl,_Li:()=>Me,_fP:()=>f,aH4:()=>Be,aLr:()=>Bi,aNw:()=>sh,anP:()=>Vn,blk:()=>Wo,cPb:()=>D,cek:()=>wh,dUE:()=>Jl,dpR:()=>uh,ehD:()=>Oe,ejS:()=>Go,hH6:()=>oh,iKG:()=>An,iLg:()=>Ql,iUV:()=>c,kB5:()=>to,knz:()=>G,m7l:()=>ih,nls:()=>Do,qyh:()=>Fe,rpg:()=>j,u9r:()=>w,uWy:()=>Ce,vBJ:()=>Ar,vmT:()=>dh,vpT:()=>eo,wem:()=>V,woe:()=>Ko,x12:()=>Ho,xEZ:()=>u,xsS:()=>Qa,yC1:()=>th,yGw:()=>Re,ybr:()=>Za,z$h:()=>Bt});const ke="137",Y=0,$=1,K=2,C=1,A=2,L=3,De=0,Me=1,Oe=2,X=0,J=1,Z=2,Q=3,ee=4,te=5,ie=100,re=101,ne=102,se=103,ae=104,oe=200,le=201,he=202,ue=203,ce=204,de=205,pe=206,fe=207,me=208,ge=209,ve=210,ye=0,_e=1,be=2,Te=3,xe=4,we=5,Se=6,Ee=7,I=0,P=1,R=2,Ne=0,k=1,O=4,N=301,U=302,B=303,F=304,H=306,z=307,j=1e3,Ce=1001,q=1002,Ae=1003,Ue=1004,Be=1005,V=1006,Fe=1007,He=1008,ze=1009,Ve=1010,Ge=1011,We=1012,je=1013,qe=1014,Xe=1015,Ye=1016,$e=1017,Ke=1018,Je=1020,Ze=1021,Qe=1022,Le=1023,et=1024,tt=1025,it=1026,rt=1027,nt=1028,st=1029,at=1030,ot=1031,lt=1033,ht=33776,ut=33777,ct=33778,dt=33779,pt=35840,ft=35841,mt=35842,gt=35843,vt=36196,yt=37492,_t=37496,bt=37808,Tt=37809,xt=37810,wt=37811,St=37812,Et=37813,Mt=37814,Ct=37815,At=37816,Lt=37817,It=37818,Pt=37819,Rt=37820,kt=37821,Dt=36492,Ot=2300,Nt=2301,Ut=1,Bt=2,Ft=3e3,G=3001,Ht=3201,zt=0,Vt=1,Gt="300 es",Wt=1035;class jt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){var i;return void 0!==this._listeners&&void 0!==(i=this._listeners)[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}}dispatchEvent(i){if(void 0!==this._listeners){var e=this._listeners[i.type];if(void 0!==e){i.target=this;var r=e.slice(0);for(let e=0,t=r.length;e<t;e++)r[e].call(this,i);i.target=null}}}}const n=[];for(let e=0;e<256;e++)n[e]=(e<16?"0":"")+e.toString(16);let qt=1234567;const Xt=Math.PI/180,Yt=180/Math.PI;function $t(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(n[255&e]+n[e>>8&255]+n[e>>16&255]+n[e>>24&255]+"-"+n[255&t]+n[t>>8&255]+"-"+n[t>>16&15|64]+n[t>>24&255]+"-"+n[63&i|128]+n[i>>8&255]+"-"+n[i>>16&255]+n[i>>24&255]+n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]).toUpperCase()}function Kt(e,t,i){return Math.max(t,Math.min(i,e))}function Jt(e,t){return(e%t+t)%t}function Zt(e,t,i){return(1-i)*e+i*t}function Qt(e){return 0==(e&e-1)&&0!==e}function ei(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function ti(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var ii=Object.freeze({__proto__:null,DEG2RAD:Xt,RAD2DEG:Yt,generateUUID:$t,clamp:Kt,euclideanModulo:Jt,mapLinear:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},inverseLerp:function(e,t,i){return e!==t?(i-e)/(t-e):0},lerp:Zt,damp:function(e,t,i,r){return Zt(e,t,1-Math.exp(-i*r))},pingpong:function(e,t=1){return t-Math.abs(Jt(e,2*t)-t)},smoothstep:function(e,t,i){return e<=t?0:i<=e?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:i<=e?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return((qt=16807*(qt=void 0!==e?e%2147483647:qt)%2147483647)-1)/2147483646},degToRad:function(e){return e*Xt},radToDeg:function(e){return e*Yt},isPowerOfTwo:Qt,ceilPowerOfTwo:ei,floorPowerOfTwo:ti,setQuaternionFromProperEuler:function(e,t,i,r,n){var s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),h=s((t+r)/2),u=a((t+r)/2),c=s((t-r)/2),d=a((t-r)/2),p=s((r-t)/2),f=a((r-t)/2);switch(n){case"XYX":e.set(o*u,l*c,l*d,o*h);break;case"YZY":e.set(l*d,o*u,l*c,o*h);break;case"ZXZ":e.set(l*c,l*d,o*u,o*h);break;case"XZX":e.set(o*u,l*f,l*p,o*h);break;case"YXY":e.set(l*p,o*u,l*f,o*h);break;case"ZYZ":e.set(l*f,l*p,o*u,o*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}});class W{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){var t=this.x,i=this.y,e=e.elements;return this.x=e[0]*t+e[3]*i+e[6],this.y=e[1]*t+e[4]*i+e[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){var t=this.x-e.x,e=this.y-e.y;return t*t+e*e}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){var i=Math.cos(t),t=Math.sin(t),r=this.x-e.x,n=this.y-e.y;return this.x=r*i-n*t+e.x,this.y=r*t+n*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}W.prototype.isVector2=!0;class v{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,n,s,a,o,l){var h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=t,h[4]=n,h[5]=o,h[6]=i,h[7]=s,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){var t=this.elements,e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){e=e.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){var e=e.elements,t=t.elements,i=this.elements,r=e[0],n=e[3],s=e[6],a=e[1],o=e[4],l=e[7],h=e[2],u=e[5],e=e[8],c=t[0],d=t[3],p=t[6],f=t[1],m=t[4],g=t[7],v=t[2],y=t[5],t=t[8];return i[0]=r*c+n*f+s*v,i[3]=r*d+n*m+s*y,i[6]=r*p+n*g+s*t,i[1]=a*c+o*f+l*v,i[4]=a*d+o*m+l*y,i[7]=a*p+o*g+l*t,i[2]=h*c+u*f+e*v,i[5]=h*d+u*m+e*y,i[8]=h*p+u*g+e*t,this}multiplyScalar(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){var e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],e=e[8];return t*s*e-t*a*l-i*n*e+i*a*o+r*n*l-r*s*o}invert(){var e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=h*s-a*l,c=a*o-h*n,d=l*n-s*o,p=t*u+i*c+r*d;return 0==p?this.set(0,0,0,0,0,0,0,0,0):(e[0]=u*(u=1/p),e[1]=(r*l-h*i)*u,e[2]=(a*i-r*s)*u,e[3]=c*u,e[4]=(h*t-r*o)*u,e[5]=(r*n-a*t)*u,e[6]=d*u,e[7]=(i*o-l*t)*u,e[8]=(s*t-i*n)*u,this)}transpose(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,n,s,a){var o=Math.cos(n),n=Math.sin(n);return this.set(i*o,i*n,-i*(o*s+n*a)+s+e,-r*n,r*o,-r*(-n*s+o*a)+a+t,0,0,1),this}scale(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){var t=Math.cos(e),e=Math.sin(e),i=this.elements,r=i[0],n=i[3],s=i[6],a=i[1],o=i[4],l=i[7];return i[0]=t*r+e*a,i[3]=t*n+e*o,i[6]=t*s+e*l,i[1]=-e*r+t*a,i[4]=-e*n+t*o,i[7]=-e*s+t*l,this}translate(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){var t=this.elements,i=e.elements;for(let e=0;e<9;e++)if(t[e]!==i[e])return!1;return!0}fromArray(t,i=0){for(let e=0;e<9;e++)this.elements[e]=t[e+i];return this}toArray(e=[],t=0){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function ri(t){for(let e=t.length-1;0<=e;--e)if(65535<t[e])return 1}function ni(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}v.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const si={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ai={h:0,s:0,l:0},oi={h:0,s:0,l:0};function li(e,t,i){return i<0&&(i+=1),1<i&&--i,i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}function hi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ui(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class m{constructor(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,i){return this.r=e,this.g=t,this.b=i,this}setHSL(e,t,i){return e=Jt(e,1),t=Kt(t,0,1),i=Kt(i,0,1),0===t?this.r=this.g=this.b=i:(this.r=li(t=2*i-(i=i<=.5?i*(1+t):i+t-i*t),i,e+1/3),this.g=li(t,i,e),this.b=li(t,i,e-1/3)),this}setStyle(t){function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let e;var n=r[1],s=r[2];switch(n){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,i(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,i(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const r=parseFloat(e[1])/360,a=parseInt(e[2],10)/100,o=parseInt(e[3],10)/100;return i(e[4]),this.setHSL(r,a,o)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=r[1],i=t.length;if(3===i)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===i)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this}setColorName(e){var t=si[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=hi(e.r),this.g=hi(e.g),this.b=hi(e.b),this}copyLinearToSRGB(e){return this.r=ui(e.r),this.g=ui(e.g),this.b=ui(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){var t=this.r,i=this.g,r=this.b,n=Math.max(t,i,r),s=Math.min(t,i,r);let a,o;var l=(s+n)/2;if(s===n)a=0,o=0;else{const e=n-s;switch(o=l<=.5?e/(n+s):e/(2-n-s),n){case t:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-t)/e+2;break;case r:a=(t-i)/e+4}a/=6}return e.h=a,e.s=o,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,i){return this.getHSL(ai),ai.h+=e,ai.s+=t,ai.l+=i,this.setHSL(ai.h,ai.s,ai.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ai),e.getHSL(oi);var e=Zt(ai.h,oi.h,t),i=Zt(ai.s,oi.s,t),t=Zt(ai.l,oi.l,t);return this.setHSL(e,i,t),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let ci;m.NAMES=si,m.prototype.isColor=!0,m.prototype.r=1,m.prototype.g=1,m.prototype.b=1;class di{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;var i;return 2048<(t=e instanceof HTMLCanvasElement?e:((ci=void 0===ci?ni("canvas"):ci).width=e.width,ci.height=e.height,i=ci.getContext("2d"),e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),ci)).width||2048<t.height?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var t=ni("canvas"),i=(t.width=e.width,t.height=e.height,t.getContext("2d")),r=(i.drawImage(e,0,0,e.width,e.height),i.getImageData(0,0,e.width,e.height)),n=r.data;for(let e=0;e<n.length;e++)n[e]=255*hi(n[e]/255);return i.putImageData(r,0,0),t}if(e.data){var s=e.data.slice(0);for(let e=0;e<s.length;e++)s instanceof Uint8Array||s instanceof Uint8ClampedArray?s[e]=Math.floor(255*hi(s[e]/255)):s[e]=hi(s[e]);return{data:s,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let pi=0;class u extends jt{constructor(e=u.DEFAULT_IMAGE,t=u.DEFAULT_MAPPING,i=Ce,r=Ce,n=V,s=He,a=Le,o=ze,l=1,h=Ft){super(),Object.defineProperty(this,"id",{value:pi++}),this.uuid=$t(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new W(0,0),this.repeat=new W(1,1),this.center=new W(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new v,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=$t()),!t&&void 0===e.images[r.uuid]){let i;if(Array.isArray(r)){i=[];for(let e=0,t=r.length;e<t;e++)r[e].isDataTexture?i.push(fi(r[e].image)):i.push(fi(r[e]))}else i=fi(r);e.images[r.uuid]={uuid:r.uuid,url:i}}i.image=r.uuid}return"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case j:e.x=e.x-Math.floor(e.x);break;case Ce:e.x=e.x<0?0:1;break;case q:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case j:e.y=e.y-Math.floor(e.y);break;case Ce:e.y=e.y<0?0:1;break;case q:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}return e}set needsUpdate(e){!0===e&&this.version++}}function fi(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?di.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}u.DEFAULT_IMAGE=void 0,u.DEFAULT_MAPPING=300,u.prototype.isTexture=!0;class Ie{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){var t=this.x,i=this.y,r=this.z,n=this.w,e=e.elements;return this.x=e[0]*t+e[4]*i+e[8]*r+e[12]*n,this.y=e[1]*t+e[5]*i+e[9]*r+e[13]*n,this.z=e[2]*t+e[6]*i+e[10]*r+e[14]*n,this.w=e[3]*t+e[7]*i+e[11]*r+e[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,n;const s=e.elements,a=s[0],o=s[4],l=s[8],h=s[1],u=s[5],c=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-h)<.01&&Math.abs(l-d)<.01&&Math.abs(c-p)<.01)if(Math.abs(o+h)<.1&&Math.abs(l+d)<.1&&Math.abs(c+p)<.1&&Math.abs(a+u+f-3)<.1)this.set(1,0,0,0);else{t=Math.PI;const e=(a+1)/2,s=(u+1)/2,m=(f+1)/2,g=(o+h)/4,v=(l+d)/4,y=(c+p)/4;e>s&&e>m?n=e<.01?(i=0,r=.707106781):(i=Math.sqrt(e),r=g/i,v/i):s>m?n=s<.01?(i=.707106781,r=0,.707106781):(r=Math.sqrt(s),i=g/r,y/r):m<.01?(i=.707106781,r=.707106781,n=0):(n=Math.sqrt(m),i=v/n,r=y/n),this.set(i,r,n,t)}else{let e=Math.sqrt((p-c)*(p-c)+(l-d)*(l-d)+(h-o)*(h-o));Math.abs(e)<.001&&(e=1),this.x=(p-c)/e,this.y=(l-d)/e,this.z=(h-o)/e,this.w=Math.acos((a+u+f-1)/2)}return this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ie.prototype.isVector4=!0;class mi extends jt{constructor(e,t,i={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Ie(0,0,e,t),this.scissorTest=!1,this.viewport=new Ie(0,0,e,t),this.texture=new u(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:V,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,i=1){this.width===e&&this.height===t&&this.depth===i||(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}mi.prototype.isWebGLRenderTarget=!0,class extends mi{constructor(e,t,i){super(e,t);var r=this.texture;this.texture=[];for(let e=0;e<i;e++)this.texture[e]=r.clone()}setSize(i,r,n=1){if(this.width!==i||this.height!==r||this.depth!==n){this.width=i,this.height=r,this.depth=n;for(let e=0,t=this.texture.length;e<t;e++)this.texture[e].image.width=i,this.texture[e].image.height=r,this.texture[e].image.depth=n;this.dispose()}return this.viewport.set(0,0,i,r),this.scissor.set(0,0,i,r),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture;for(let e=this.texture.length=0,t=i.texture.length;e<t;e++)this.texture[e]=i.texture[e].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class gi extends mi{constructor(e,t,i={}){super(e,t,i),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===i.ignoreDepth||i.ignoreDepth,this.useRenderToTexture=void 0!==i.useRenderToTexture&&i.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}gi.prototype.isWebGLMultisampleRenderTarget=!0;class f{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(t,i,r,n,s,a,o){let l=r[n+0],h=r[n+1],u=r[n+2],c=r[n+3];var d=s[a+0],p=s[a+1],f=s[a+2],a=s[a+3];if(0===o)t[i+0]=l,t[i+1]=h,t[i+2]=u,t[i+3]=c;else if(1===o)t[i+0]=d,t[i+1]=p,t[i+2]=f,t[i+3]=a;else{if(c!==a||l!==d||h!==p||u!==f){let e=1-o;const i=l*d+h*p+u*f+c*a,r=0<=i?1:-1,n=1-i*i;if(n>Number.EPSILON){const s=Math.sqrt(n),a=Math.atan2(s,i*r);e=Math.sin(e*a)/s,o=Math.sin(o*a)/s}const s=o*r;if(l=l*e+d*s,h=h*e+p*s,u=u*e+f*s,c=c*e+a*s,e===1-o){const t=1/Math.sqrt(l*l+h*h+u*u+c*c);l*=t,h*=t,u*=t,c*=t}}t[i]=l,t[i+1]=h,t[i+2]=u,t[i+3]=c}}static multiplyQuaternionsFlat(e,t,i,r,n,s){var a=i[r],o=i[r+1],l=i[r+2],i=i[r+3],r=n[s],h=n[s+1],u=n[s+2],n=n[s+3];return e[t]=a*n+i*r+o*u-l*h,e[t+1]=o*n+i*h+l*r-a*u,e[t+2]=l*n+i*u+a*h-o*r,e[t+3]=i*n-a*r-o*h-l*u,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,r=e._y,n=e._z,s=e._order,e=Math.cos,a=Math.sin,o=e(i/2),l=e(r/2),h=e(n/2),u=a(i/2),c=a(r/2),d=a(n/2);switch(s){case"XYZ":this._x=u*l*h+o*c*d,this._y=o*c*h-u*l*d,this._z=o*l*d+u*c*h,this._w=o*l*h-u*c*d;break;case"YXZ":this._x=u*l*h+o*c*d,this._y=o*c*h-u*l*d,this._z=o*l*d-u*c*h,this._w=o*l*h+u*c*d;break;case"ZXY":this._x=u*l*h-o*c*d,this._y=o*c*h+u*l*d,this._z=o*l*d+u*c*h,this._w=o*l*h-u*c*d;break;case"ZYX":this._x=u*l*h-o*c*d,this._y=o*c*h+u*l*d,this._z=o*l*d-u*c*h,this._w=o*l*h+u*c*d;break;case"YZX":this._x=u*l*h+o*c*d,this._y=o*c*h+u*l*d,this._z=o*l*d-u*c*h,this._w=o*l*h-u*c*d;break;case"XZY":this._x=u*l*h-o*c*d,this._y=o*c*h-u*l*d,this._z=o*l*d+u*c*h,this._w=o*l*h+u*c*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){var t=t/2,i=Math.sin(t);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(t),this._onChangeCallback(),this}setFromRotationMatrix(e){var e=e.elements,t=e[0],i=e[4],r=e[8],n=e[1],s=e[5],a=e[9],o=e[2],l=e[6],h=e[10],u=t+s+h;if(0<u){const e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(l-a)*e,this._y=(r-o)*e,this._z=(n-i)*e}else if(s<t&&h<t){const e=2*Math.sqrt(1+t-s-h);this._w=(l-a)/e,this._x=.25*e,this._y=(i+n)/e,this._z=(r+o)/e}else if(h<s){const e=2*Math.sqrt(1+s-t-h);this._w=(r-o)/e,this._x=(i+n)/e,this._y=.25*e,this._z=(a+l)/e}else{const e=2*Math.sqrt(1+h-t-s);this._w=(n-i)/e,this._x=(r+o)/e,this._y=(a+l)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=i,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Kt(this.dot(e),-1,1)))}rotateTowards(e,t){var i=this.angleTo(e);return 0!==i&&(t=Math.min(1,t/i),this.slerp(e,t)),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(e=1/e),this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){var i=e._x,r=e._y,n=e._z,e=e._w,s=t._x,a=t._y,o=t._z,t=t._w;return this._x=i*t+e*s+r*o-n*a,this._y=r*t+e*a+n*s-i*o,this._z=n*t+e*o+i*a-r*s,this._w=e*t-i*s-r*a-n*o,this._onChangeCallback(),this}slerp(t,i){if(0!==i){if(1===i)return this.copy(t);var r=this._x,n=this._y,s=this._z,a=this._w;let e=a*t._w+r*t._x+n*t._y+s*t._z;if(e<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,e=-e):this.copy(t),1<=e)this._w=a,this._x=r,this._y=n,this._z=s;else{t=1-e*e;if(t<=Number.EPSILON){const t=1-i;this._w=t*a+i*this._w,this._x=t*r+i*this._x,this._y=t*n+i*this._y,this._z=t*s+i*this._z,this.normalize()}else{var t=Math.sqrt(t),o=Math.atan2(t,e),l=Math.sin((1-i)*o)/t,i=Math.sin(i*o)/t;this._w=a*l+this._w*i,this._x=r*l+this._x*i,this._y=n*l+this._y*i,this._z=s*l+this._z*i}this._onChangeCallback()}}return this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){var e=Math.random(),t=Math.sqrt(1-e),e=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),e*Math.sin(r),e*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}f.prototype.isQuaternion=!0;class Pe{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(yi.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(yi.setFromAxisAngle(e,t))}applyMatrix3(e){var t=this.x,i=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[3]*i+e[6]*r,this.y=e[1]*t+e[4]*i+e[7]*r,this.z=e[2]*t+e[5]*i+e[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){var t=this.x,i=this.y,r=this.z,e=e.elements,n=1/(e[3]*t+e[7]*i+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*i+e[8]*r+e[12])*n,this.y=(e[1]*t+e[5]*i+e[9]*r+e[13])*n,this.z=(e[2]*t+e[6]*i+e[10]*r+e[14])*n,this}applyQuaternion(e){var t=this.x,i=this.y,r=this.z,n=e.x,s=e.y,a=e.z,e=e.w,o=e*t+s*r-a*i,l=e*i+a*t-n*r,h=e*r+n*i-s*t,t=-n*t-s*i-a*r;return this.x=o*e+t*-n+l*-a-h*-s,this.y=l*e+t*-s+h*-n-o*-a,this.z=h*e+t*-a+o*-s-l*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){var t=this.x,i=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*i+e[8]*r,this.y=e[1]*t+e[5]*i+e[9]*r,this.z=e[2]*t+e[6]*i+e[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){var i=e.x,r=e.y,e=e.z,n=t.x,s=t.y,t=t.z;return this.x=r*t-e*s,this.y=e*n-i*t,this.z=i*s-r*n,this}projectOnVector(e){var t=e.lengthSq();return 0===t?this.set(0,0,0):(t=e.dot(this)/t,this.copy(e).multiplyScalar(t))}projectOnPlane(e){return vi.copy(this).projectOnVector(e),this.sub(vi)}reflect(e){return this.sub(vi.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:(e=this.dot(e)/t,Math.acos(Kt(e,-1,1)))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){var t=this.x-e.x,i=this.y-e.y,e=this.z-e.z;return t*t+i*i+e*e}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){var r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){e=e.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),e=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=e,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Pe.prototype.isVector3=!0;const vi=new Pe,yi=new f;class _i{constructor(e=new Pe(1/0,1/0,1/0),t=new Pe(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(i){let r=1/0,n=1/0,s=1/0,a=-1/0,o=-1/0,l=-1/0;for(let e=0,t=i.length;e<t;e+=3){var h=i[e],u=i[e+1],c=i[e+2];h<r&&(r=h),u<n&&(n=u),c<s&&(s=c),h>a&&(a=h),u>o&&(o=u),c>l&&(l=c)}return this.min.set(r,n,s),this.max.set(a,o,l),this}setFromBufferAttribute(i){let r=1/0,n=1/0,s=1/0,a=-1/0,o=-1/0,l=-1/0;for(let e=0,t=i.count;e<t;e++){var h=i.getX(e),u=i.getY(e),c=i.getZ(e);h<r&&(r=h),u<n&&(n=u),c<s&&(s=c),h>a&&(a=h),u>o&&(o=u),c>l&&(l=c)}return this.min.set(r,n,s),this.max.set(a,o,l),this}setFromPoints(i){this.makeEmpty();for(let e=0,t=i.length;e<t;e++)this.expandByPoint(i[e]);return this}setFromCenterAndSize(e,t){t=Ti.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(t),this.max.copy(e).add(t),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(i,r=!1){i.updateWorldMatrix(!1,!1);var e=i.geometry;if(void 0!==e)if(r&&null!=e.attributes&&void 0!==e.attributes.position){const r=e.attributes.position;for(let e=0,t=r.count;e<t;e++)Ti.fromBufferAttribute(r,e).applyMatrix4(i.matrixWorld),this.expandByPoint(Ti)}else null===e.boundingBox&&e.computeBoundingBox(),xi.copy(e.boundingBox),xi.applyMatrix4(i.matrixWorld),this.union(xi);var n=i.children;for(let e=0,t=n.length;e<t;e++)this.expandByObject(n[e],r);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ti),Ti.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return i=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){return!this.isEmpty()&&(this.getCenter(Li),Ii.subVectors(this.max,Li),wi.subVectors(e.a,Li),Si.subVectors(e.b,Li),Ei.subVectors(e.c,Li),Mi.subVectors(Si,wi),Ci.subVectors(Ei,Si),Ai.subVectors(wi,Ei),!!ki([0,-Mi.z,Mi.y,0,-Ci.z,Ci.y,0,-Ai.z,Ai.y,Mi.z,0,-Mi.x,Ci.z,0,-Ci.x,Ai.z,0,-Ai.x,-Mi.y,Mi.x,0,-Ci.y,Ci.x,0,-Ai.y,Ai.x,0],wi,Si,Ei,Ii))&&!!ki([1,0,0,0,1,0,0,0,1],wi,Si,Ei,Ii)&&(Pi.crossVectors(Mi,Ci),ki([Pi.x,Pi.y,Pi.z],wi,Si,Ei,Ii))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ti.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Ti).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(bi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),bi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),bi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),bi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),bi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),bi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),bi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),bi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(bi)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}_i.prototype.isBox3=!0;const bi=[new Pe,new Pe,new Pe,new Pe,new Pe,new Pe,new Pe,new Pe],Ti=new Pe,xi=new _i,wi=new Pe,Si=new Pe,Ei=new Pe,Mi=new Pe,Ci=new Pe,Ai=new Pe,Li=new Pe,Ii=new Pe,Pi=new Pe,Ri=new Pe;function ki(i,r,n,s,a){for(let e=0,t=i.length-3;e<=t;e+=3){Ri.fromArray(i,e);var o=a.x*Math.abs(Ri.x)+a.y*Math.abs(Ri.y)+a.z*Math.abs(Ri.z),l=r.dot(Ri),h=n.dot(Ri),u=s.dot(Ri);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>o)return!1}return!0}const Di=new _i,Oi=new Pe,Ni=new Pe,Ui=new Pe;class Bi{constructor(e=new Pe,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(i,e){var r=this.center;void 0!==e?r.copy(e):Di.setFromPoints(i).getCenter(r);let n=0;for(let e=0,t=i.length;e<t;e++)n=Math.max(n,r.distanceToSquared(i[e]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){var i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Ui.subVectors(e,this.center);var t=Ui.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),i=.5*(e-this.radius);this.center.add(Ui.multiplyScalar(i/e)),this.radius+=i}return this}union(e){return(!0===this.center.equals(e.center)?Ni.set(0,0,1):Ni.subVectors(e.center,this.center).normalize()).multiplyScalar(e.radius),this.expandByPoint(Oi.copy(e.center).add(Ni)),this.expandByPoint(Oi.copy(e.center).sub(Ni)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Fi=new Pe,Hi=new Pe,zi=new Pe,Vi=new Pe,Gi=new Pe,Wi=new Pe,ji=new Pe;class qi{constructor(e=new Pe,t=new Pe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Fi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);e=t.dot(this.direction);return e<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){var t=Fi.subVectors(e,this.origin).dot(this.direction);return(t<0?this.origin:(Fi.copy(this.direction).multiplyScalar(t).add(this.origin),Fi)).distanceToSquared(e)}distanceSqToSegment(e,t,i,r){Hi.copy(e).add(t).multiplyScalar(.5),zi.copy(t).sub(e).normalize(),Vi.copy(this.origin).sub(Hi);var e=.5*e.distanceTo(t),t=-this.direction.dot(zi),n=Vi.dot(this.direction),s=-Vi.dot(zi),a=Vi.lengthSq(),o=Math.abs(1-t*t);let l,h,u,c;if(0<o)if(l=t*s-n,h=t*n-s,c=e*o,0<=l)if(h>=-c)if(h<=c){const e=1/o;l*=e,h*=e,u=l*(l+t*h+2*n)+h*(t*l+h+2*s)+a}else h=e,l=Math.max(0,-(t*h+n)),u=-l*l+h*(h+2*s)+a;else h=-e,l=Math.max(0,-(t*h+n)),u=-l*l+h*(h+2*s)+a;else u=h<=-c?(l=Math.max(0,-(-t*e+n)),h=0<l?-e:Math.min(Math.max(-e,-s),e),-l*l+h*(h+2*s)+a):h<=c?(l=0,(h=Math.min(Math.max(-e,-s),e))*(h+2*s)+a):(l=Math.max(0,-(t*e+n)),h=0<l?e:Math.min(Math.max(-e,-s),e),-l*l+h*(h+2*s)+a);else h=0<t?-e:e,l=Math.max(0,-(t*h+n)),u=-l*l+h*(h+2*s)+a;return i&&i.copy(this.direction).multiplyScalar(l).add(this.origin),r&&r.copy(zi).multiplyScalar(h).add(Hi),u}intersectSphere(e,t){Fi.subVectors(e.center,this.origin);var i=Fi.dot(this.direction),r=Fi.dot(Fi)-i*i,e=e.radius*e.radius;return e<r||(r=i+(e=Math.sqrt(e-r)),(i=i-e)<0&&r<0)?null:i<0?this.at(r,t):this.at(i,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(e=-(this.origin.dot(e.normal)+e.constant)/t)?e:null}intersectPlane(e,t){e=this.distanceToPlane(e);return null===e?null:this.at(e,t)}intersectsPlane(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,n,s,a,o;var l=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,c=this.origin;return r=0<=l?(i=(e.min.x-c.x)*l,(e.max.x-c.x)*l):(i=(e.max.x-c.x)*l,(e.min.x-c.x)*l),s=0<=h?(n=(e.min.y-c.y)*h,(e.max.y-c.y)*h):(n=(e.max.y-c.y)*h,(e.min.y-c.y)*h),i>s||n>r||((n>i||i!=i)&&(i=n),(s<r||r!=r)&&(r=s),o=0<=u?(a=(e.min.z-c.z)*u,(e.max.z-c.z)*u):(a=(e.max.z-c.z)*u,(e.min.z-c.z)*u),i>o)||a>r||((a>i||i!=i)&&(i=a),(r=o<r||r!=r?o:r)<0)?null:this.at(0<=i?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Fi)}intersectTriangle(e,t,i,r,n){Gi.subVectors(t,e),Wi.subVectors(i,e),ji.crossVectors(Gi,Wi);let s,a=this.direction.dot(ji);if(0<a){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Vi.subVectors(this.origin,e);t=s*this.direction.dot(Wi.crossVectors(Vi,Wi));return t<0||(i=s*this.direction.dot(Gi.cross(Vi)))<0||t+i>a||(r=-s*Vi.dot(ji))<0?null:this.at(r/a,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Re{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,n,s,a,o,l,h,u,c,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=n,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=h,g[10]=u,g[14]=c,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Re).fromArray(this.elements)}copy(e){var t=this.elements,e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this}copyPosition(e){var t=this.elements,e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this}setFromMatrix3(e){e=e.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){var t=this.elements,i=e.elements,r=1/Xi.setFromMatrixColumn(e,0).length(),n=1/Xi.setFromMatrixColumn(e,1).length(),e=1/Xi.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*n,t[5]=i[5]*n,t[6]=i[6]*n,t[7]=0,t[8]=i[8]*e,t[9]=i[9]*e,t[10]=i[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,n=e.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(r),l=Math.sin(r),h=Math.cos(n),u=Math.sin(n);if("XYZ"===e.order){const e=s*h,i=s*u,r=a*h,n=a*u;t[0]=o*h,t[4]=-o*u,t[8]=l,t[1]=i+r*l,t[5]=e-n*l,t[9]=-a*o,t[2]=n-e*l,t[6]=r+i*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*h,i=o*u,r=l*h,n=l*u;t[0]=e+n*a,t[4]=r*a-i,t[8]=s*l,t[1]=s*u,t[5]=s*h,t[9]=-a,t[2]=i*a-r,t[6]=n+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*h,i=o*u,r=l*h,n=l*u;t[0]=e-n*a,t[4]=-s*u,t[8]=r+i*a,t[1]=i+r*a,t[5]=s*h,t[9]=n-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*h,i=s*u,r=a*h,n=a*u;t[0]=o*h,t[4]=r*l-i,t[8]=e*l+n,t[1]=o*u,t[5]=n*l+e,t[9]=i*l-r,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,i=s*l,r=a*o,n=a*l;t[0]=o*h,t[4]=n-e*u,t[8]=r*u+i,t[1]=u,t[5]=s*h,t[9]=-a*h,t[2]=-l*h,t[6]=i*u+r,t[10]=e-n*u}else if("XZY"===e.order){const e=s*o,i=s*l,r=a*o,n=a*l;t[0]=o*h,t[4]=-u,t[8]=l*h,t[1]=e*u+n,t[5]=s*h,t[9]=i*u-r,t[2]=r*u-i,t[6]=a*h,t[10]=n*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose($i,e,Ki)}lookAt(e,t,i){var r=this.elements;return Qi.subVectors(e,t),0===Qi.lengthSq()&&(Qi.z=1),Qi.normalize(),Ji.crossVectors(i,Qi),0===Ji.lengthSq()&&(1===Math.abs(i.z)?Qi.x+=1e-4:Qi.z+=1e-4,Qi.normalize(),Ji.crossVectors(i,Qi)),Ji.normalize(),Zi.crossVectors(Qi,Ji),r[0]=Ji.x,r[4]=Zi.x,r[8]=Qi.x,r[1]=Ji.y,r[5]=Zi.y,r[9]=Qi.y,r[2]=Ji.z,r[6]=Zi.z,r[10]=Qi.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){var e=e.elements,t=t.elements,i=this.elements,r=e[0],n=e[4],s=e[8],a=e[12],o=e[1],l=e[5],h=e[9],u=e[13],c=e[2],d=e[6],p=e[10],f=e[14],m=e[3],g=e[7],v=e[11],e=e[15],y=t[0],_=t[4],b=t[8],T=t[12],x=t[1],w=t[5],S=t[9],E=t[13],M=t[2],C=t[6],A=t[10],L=t[14],I=t[3],P=t[7],R=t[11],t=t[15];return i[0]=r*y+n*x+s*M+a*I,i[4]=r*_+n*w+s*C+a*P,i[8]=r*b+n*S+s*A+a*R,i[12]=r*T+n*E+s*L+a*t,i[1]=o*y+l*x+h*M+u*I,i[5]=o*_+l*w+h*C+u*P,i[9]=o*b+l*S+h*A+u*R,i[13]=o*T+l*E+h*L+u*t,i[2]=c*y+d*x+p*M+f*I,i[6]=c*_+d*w+p*C+f*P,i[10]=c*b+d*S+p*A+f*R,i[14]=c*T+d*E+p*L+f*t,i[3]=m*y+g*x+v*M+e*I,i[7]=m*_+g*w+v*C+e*P,i[11]=m*b+g*S+v*A+e*R,i[15]=m*T+g*E+v*L+e*t,this}multiplyScalar(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){var e=this.elements,t=e[0],i=e[4],r=e[8],n=e[12],s=e[1],a=e[5],o=e[9],l=e[13],h=e[2],u=e[6],c=e[10],d=e[14];return e[3]*(+n*o*u-r*l*u-n*a*c+i*l*c+r*a*d-i*o*d)+e[7]*(+t*o*d-t*l*c+n*s*c-r*s*d+r*l*h-n*o*h)+e[11]*(+t*l*u-t*a*d-n*s*u+i*s*d+n*a*h-i*l*h)+e[15]*(-r*a*h-t*o*u+t*a*c+r*s*u-i*s*c+i*o*h)}transpose(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){var e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=e[9],c=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*c*l+f*o*d-a*m*d-u*o*g+a*c*g,y=p*c*l-h*m*l-p*o*d+s*m*d+h*o*g-s*c*g,_=h*f*l-p*u*l+p*a*d-s*f*d-h*a*g+s*u*g,b=p*u*o-h*f*o-p*a*c+s*f*c+h*a*m-s*u*m,T=t*v+i*y+r*_+n*b;return 0==T?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=v*(v=1/T),e[1]=(f*c*n-u*m*n-f*r*d+i*m*d+u*r*g-i*c*g)*v,e[2]=(a*m*n-f*o*n+f*r*l-i*m*l-a*r*g+i*o*g)*v,e[3]=(u*o*n-a*c*n-u*r*l+i*c*l+a*r*d-i*o*d)*v,e[4]=y*v,e[5]=(h*m*n-p*c*n+p*r*d-t*m*d-h*r*g+t*c*g)*v,e[6]=(p*o*n-s*m*n-p*r*l+t*m*l+s*r*g-t*o*g)*v,e[7]=(s*c*n-h*o*n+h*r*l-t*c*l-s*r*d+t*o*d)*v,e[8]=_*v,e[9]=(p*u*n-h*f*n-p*i*d+t*f*d+h*i*g-t*u*g)*v,e[10]=(s*f*n-p*a*n+p*i*l-t*f*l-s*i*g+t*a*g)*v,e[11]=(h*a*n-s*u*n-h*i*l+t*u*l+s*i*d-t*a*d)*v,e[12]=b*v,e[13]=(h*f*r-p*u*r+p*i*c-t*f*c-h*i*m+t*u*m)*v,e[14]=(p*a*r-s*f*r-p*i*o+t*f*o+s*i*m-t*a*m)*v,e[15]=(s*u*r-h*a*r+h*i*o-t*u*o-s*i*c+t*a*c)*v,this)}scale(e){var t=this.elements,i=e.x,r=e.y,e=e.z;return t[0]*=i,t[4]*=r,t[8]*=e,t[1]*=i,t[5]*=r,t[9]*=e,t[2]*=i,t[6]*=r,t[10]*=e,t[3]*=i,t[7]*=r,t[11]*=e,this}getMaxScaleOnAxis(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,e))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){var t=Math.cos(e),e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this}makeRotationY(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this}makeRotationZ(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){var i=Math.cos(t),t=Math.sin(t),r=1-i,n=e.x,s=e.y,e=e.z,a=r*n,o=r*s;return this.set(a*n+i,a*s-t*e,a*e+t*s,0,a*s+t*e,o*s+i,o*e-t*n,0,a*e-t*s,o*e+t*n,r*e*e+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,n,s){return this.set(1,i,n,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){var r=this.elements,n=t._x,s=t._y,a=t._z,t=t._w,o=n+n,l=s+s,h=a+a,u=n*o,c=n*l,n=n*h,d=s*l,s=s*h,a=a*h,o=t*o,l=t*l,t=t*h,h=i.x,p=i.y,i=i.z;return r[0]=(1-(d+a))*h,r[1]=(c+t)*h,r[2]=(n-l)*h,r[3]=0,r[4]=(c-t)*p,r[5]=(1-(u+a))*p,r[6]=(s+o)*p,r[7]=0,r[8]=(n+l)*i,r[9]=(s-o)*i,r[10]=(1-(u+d))*i,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){var r=this.elements;let n=Xi.set(r[0],r[1],r[2]).length();var s=Xi.set(r[4],r[5],r[6]).length(),a=Xi.set(r[8],r[9],r[10]).length(),e=(this.determinant()<0&&(n=-n),e.x=r[12],e.y=r[13],e.z=r[14],Yi.copy(this),1/n),r=1/s,o=1/a;return Yi.elements[0]*=e,Yi.elements[1]*=e,Yi.elements[2]*=e,Yi.elements[4]*=r,Yi.elements[5]*=r,Yi.elements[6]*=r,Yi.elements[8]*=o,Yi.elements[9]*=o,Yi.elements[10]*=o,t.setFromRotationMatrix(Yi),i.x=n,i.y=s,i.z=a,this}makePerspective(e,t,i,r,n,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,o=2*n/(i-r),l=(t+e)/(t-e),i=(i+r)/(i-r),r=-(s+n)/(s-n),s=-2*s*n/(s-n);return a[0]=2*n/(t-e),a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=o,a[9]=i,a[13]=0,a[2]=0,a[6]=0,a[10]=r,a[14]=s,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,n,s){var a=this.elements,o=1/(t-e),l=1/(i-r),h=1/(s-n),t=(t+e)*o,e=(i+r)*l,i=(s+n)*h;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-t,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-e,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-i,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){var t=this.elements,i=e.elements;for(let e=0;e<16;e++)if(t[e]!==i[e])return!1;return!0}fromArray(t,i=0){for(let e=0;e<16;e++)this.elements[e]=t[e+i];return this}toArray(e=[],t=0){var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}Re.prototype.isMatrix4=!0;const Xi=new Pe,Yi=new Re,$i=new Pe(0,0,0),Ki=new Pe(1,1,1),Ji=new Pe,Zi=new Pe,Qi=new Pe,er=new Re,tr=new f;class ir{constructor(e=0,t=0,i=0,r=ir.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){var e=e.elements,r=e[0],n=e[4],s=e[8],a=e[1],o=e[5],l=e[9],h=e[2],u=e[6],c=e[10];switch(t){case"XYZ":this._y=Math.asin(Kt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,c),this._z=Math.atan2(-n,r)):(this._x=Math.atan2(u,o),this._z=0);break;case"YXZ":this._x=Math.asin(-Kt(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,c),this._z=Math.atan2(a,o)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Kt(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,c),this._z=Math.atan2(-n,o)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Kt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,c),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-n,o));break;case"YZX":this._z=Math.asin(Kt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,o),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(s,c));break;case"XZY":this._z=Math.asin(-Kt(n,-1,1)),Math.abs(n)<.9999999?(this._x=Math.atan2(u,o),this._y=Math.atan2(s,r)):(this._x=Math.atan2(-l,c),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return er.makeRotationFromQuaternion(e),this.setFromRotationMatrix(er,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return tr.setFromEuler(this),this.setFromQuaternion(tr,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new Pe(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}ir.prototype.isEuler=!0,ir.DefaultOrder="XYZ",ir.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class rr{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let nr=0;const sr=new Pe,ar=new f,or=new Re,lr=new Pe,hr=new Pe,ur=new Pe,cr=new f,dr=new Pe(1,0,0),pr=new Pe(0,1,0),fr=new Pe(0,0,1),mr={type:"added"},gr={type:"removed"};class a extends jt{constructor(){super(),Object.defineProperty(this,"id",{value:nr++}),this.uuid=$t(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=a.DefaultUp.clone();const e=new Pe,t=new ir,i=new f,r=new Pe(1,1,1);t._onChange(function(){i.setFromEuler(t,!1)}),i._onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Re},normalMatrix:{value:new v}}),this.matrix=new Re,this.matrixWorld=new Re,this.matrixAutoUpdate=a.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new rr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ar.setFromAxisAngle(e,t),this.quaternion.multiply(ar),this}rotateOnWorldAxis(e,t){return ar.setFromAxisAngle(e,t),this.quaternion.premultiply(ar),this}rotateX(e){return this.rotateOnAxis(dr,e)}rotateY(e){return this.rotateOnAxis(pr,e)}rotateZ(e){return this.rotateOnAxis(fr,e)}translateOnAxis(e,t){return sr.copy(e).applyQuaternion(this.quaternion),this.position.add(sr.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(dr,e)}translateY(e){return this.translateOnAxis(pr,e)}translateZ(e){return this.translateOnAxis(fr,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(or.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?lr.copy(e):lr.set(e,t,i);e=this.parent;this.updateWorldMatrix(!0,!1),hr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?or.lookAt(hr,lr,this.up):or.lookAt(lr,hr,this.up),this.quaternion.setFromRotationMatrix(or),e&&(or.extractRotation(e.matrixWorld),ar.setFromRotationMatrix(or),this.quaternion.premultiply(ar.invert()))}add(e){if(1<arguments.length)for(let e=0;e<arguments.length;e++)this.add(arguments[e]);else e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),(e.parent=this).children.push(e),e.dispatchEvent(mr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this}remove(e){if(1<arguments.length)for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);else{var t=this.children.indexOf(e);-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(gr))}return this}removeFromParent(){var e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(gr)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),or.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),or.multiply(e.parent.matrixWorld)),e.applyMatrix4(or),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(i,r){if(this[i]===r)return this;for(let e=0,t=this.children.length;e<t;e++){var n=this.children[e].getObjectByProperty(i,r);if(void 0!==n)return n}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hr,e,ur),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hr,cr,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(i){i(this);var r=this.children;for(let e=0,t=r.length;e<t;e++)r[e].traverse(i)}traverseVisible(i){if(!1!==this.visible){i(this);var r=this.children;for(let e=0,t=r.length;e<t;e++)r[e].traverseVisible(i)}}traverseAncestors(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(i){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||i)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i=!(this.matrixWorldNeedsUpdate=!1));var r=this.children;for(let e=0,t=r.length;e<t;e++)r[e].updateMatrixWorld(i)}updateWorldMatrix(i,e){var t=this.parent;if(!0===i&&null!==t&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const i=this.children;for(let e=0,t=i.length;e<t;e++)i[e].updateWorldMatrix(!1,!0)}}toJSON(i){const r=void 0===i||"string"==typeof i,n={},s=(r&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),{});function a(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(i)),t.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor)&&(s.instanceColor=this.instanceColor.toJSON()),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(i).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(i).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=a(i.geometries,this.geometry);const r=this.geometry.parameters;if(void 0!==r&&void 0!==r.shapes){const n=r.shapes;if(Array.isArray(n))for(let e=0,t=n.length;e<t;e++){const s=n[e];a(i.shapes,s)}else a(i.shapes,n)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton)&&(a(i.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid),void 0!==this.material)if(Array.isArray(this.material)){const r=[];for(let e=0,t=this.material.length;e<t;e++)r.push(a(i.materials,this.material[e]));s.material=r}else s.material=a(i.materials,this.material);if(0<this.children.length){s.children=[];for(let e=0;e<this.children.length;e++)s.children.push(this.children[e].toJSON(i).object)}if(0<this.animations.length){s.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];s.animations.push(a(i.animations,n))}}if(r){const r=e(i.geometries),s=e(i.materials),a=e(i.textures),t=e(i.images),o=e(i.shapes),l=e(i.skeletons),h=e(i.animations);0<r.length&&(n.geometries=r),0<s.length&&(n.materials=s),0<a.length&&(n.textures=a),0<t.length&&(n.images=t),0<o.length&&(n.shapes=o),0<l.length&&(n.skeletons=l),0<h.length&&(n.animations=h)}return n.object=s,n;function e(e){var t=[];for(const r in e){var i=e[r];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){var i=t.children[e];this.add(i.clone())}return this}}a.DefaultUp=new Pe(0,1,0),a.DefaultMatrixAutoUpdate=!0,a.prototype.isObject3D=!0;const vr=new Pe,yr=new Pe,_r=new Pe,br=new Pe,Tr=new Pe,xr=new Pe,wr=new Pe,Sr=new Pe,Er=new Pe,Mr=new Pe;class p{constructor(e=new Pe,t=new Pe,i=new Pe){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),vr.subVectors(e,t),r.cross(vr);i=r.lengthSq();return 0<i?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,i,r,n){vr.subVectors(r,t),yr.subVectors(i,t),_r.subVectors(e,t);var r=vr.dot(vr),i=vr.dot(yr),e=vr.dot(_r),t=yr.dot(yr),s=yr.dot(_r),a=r*t-i*i;return 0==a?n.set(-2,-1,-1):n.set(1-(t=(t*e-i*s)*(n=1/a))-(a=(r*s-i*e)*n),a,t)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,br),0<=br.x&&0<=br.y&&br.x+br.y<=1}static getUV(e,t,i,r,n,s,a,o){return this.getBarycoord(e,t,i,r,br),o.set(0,0),o.addScaledVector(n,br.x),o.addScaledVector(s,br.y),o.addScaledVector(a,br.z),o}static isFrontFacing(e,t,i,r){return vr.subVectors(i,t),yr.subVectors(e,t),vr.cross(yr).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vr.subVectors(this.c,this.b),yr.subVectors(this.a,this.b),.5*vr.cross(yr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return p.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return p.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,n){return p.getUV(e,this.a,this.b,this.c,t,i,r,n)}containsPoint(e){return p.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return p.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){var i=this.a,r=this.b,n=this.c;let s,a;Tr.subVectors(r,i),xr.subVectors(n,i),Sr.subVectors(e,i);var o=Tr.dot(Sr),l=xr.dot(Sr);if(o<=0&&l<=0)return t.copy(i);Er.subVectors(e,r);var h=Tr.dot(Er),u=xr.dot(Er);if(0<=h&&u<=h)return t.copy(r);var c=o*u-h*l;if(c<=0&&0<=o&&h<=0)return s=o/(o-h),t.copy(i).addScaledVector(Tr,s);Mr.subVectors(e,n);var e=Tr.dot(Mr),d=xr.dot(Mr);return 0<=d&&e<=d?t.copy(n):(o=e*l-o*d)<=0&&0<=l&&d<=0?(a=l/(l-d),t.copy(i).addScaledVector(xr,a)):(l=h*d-e*u)<=0&&0<=u-h&&0<=e-d?(wr.subVectors(n,r),a=(u-h)/(u-h+(e-d)),t.copy(r).addScaledVector(wr,a)):(n=1/(l+o+c),s=o*n,a=c*n,t.copy(i).addScaledVector(Tr,s).addScaledVector(xr,a))}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Cr=0;class e extends jt{constructor(){super(),Object.defineProperty(this,"id",{value:Cr++}),this.uuid=$t(),this.name="",this.type="Material",this.fog=!0,this.blending=J,this.side=De,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ce,this.blendDst=de,this.blendEquation=ie,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Te,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){0<this._alphaTest!=0<e&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const r in e){var t,i=e[r];void 0===i?console.warn("THREE.Material: '"+r+"' parameter is undefined."):"shading"===r?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i):void 0!==(t=this[r])?t&&t.isColor?t.set(i):t&&t.isVector3&&i&&i.isVector3?t.copy(i):this[r]=i:console.warn("THREE."+this.type+": '"+r+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(const r in e){var i=e[r];delete i.metadata,t.push(i)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine)&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==J&&(i.blending=this.blending),this.side!==De&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const t=r(e.textures),n=r(e.images);0<t.length&&(i.textures=t),0<n.length&&(i.images=n)}return i}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes;let r=null;if(null!==i){const t=i.length;r=new Array(t);for(let e=0;e!==t;++e)r[e]=i[e].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}e.prototype.isMaterial=!0;class Ar extends e{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new m(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=I,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ar.prototype.isMeshBasicMaterial=!0;const r=new Pe,Lr=new W;class E{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(i,r,n){i*=this.itemSize,n*=r.itemSize;for(let e=0,t=this.itemSize;e<t;e++)this.array[i+e]=r.array[n+e];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(i){var r=this.array;let n=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];void 0===e&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",t),e=new m),r[n++]=e.r,r[n++]=e.g,r[n++]=e.b}return this}copyVector2sArray(i){var r=this.array;let n=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",t),e=new W),r[n++]=e.x,r[n++]=e.y}return this}copyVector3sArray(i){var r=this.array;let n=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",t),e=new Pe),r[n++]=e.x,r[n++]=e.y,r[n++]=e.z}return this}copyVector4sArray(i){var r=this.array;let n=0;for(let t=0,e=i.length;t<e;t++){let e=i[t];void 0===e&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",t),e=new Ie),r[n++]=e.x,r[n++]=e.y,r[n++]=e.z,r[n++]=e.w}return this}applyMatrix3(i){if(2===this.itemSize)for(let e=0,t=this.count;e<t;e++)Lr.fromBufferAttribute(this,e),Lr.applyMatrix3(i),this.setXY(e,Lr.x,Lr.y);else if(3===this.itemSize)for(let e=0,t=this.count;e<t;e++)r.fromBufferAttribute(this,e),r.applyMatrix3(i),this.setXYZ(e,r.x,r.y,r.z);return this}applyMatrix4(i){for(let e=0,t=this.count;e<t;e++)r.x=this.getX(e),r.y=this.getY(e),r.z=this.getZ(e),r.applyMatrix4(i),this.setXYZ(e,r.x,r.y,r.z);return this}applyNormalMatrix(i){for(let e=0,t=this.count;e<t;e++)r.x=this.getX(e),r.y=this.getY(e),r.z=this.getZ(e),r.applyNormalMatrix(i),this.setXYZ(e,r.x,r.y,r.z);return this}transformDirection(i){for(let e=0,t=this.count;e<t;e++)r.x=this.getX(e),r.y=this.getY(e),r.z=this.getZ(e),r.transformDirection(i),this.setXYZ(e,r.x,r.y,r.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}E.prototype.isBufferAttribute=!0;class Ir extends E{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Pr extends E{constructor(e,t,i){super(new Uint32Array(e),t,i)}}(class extends E{constructor(e,t,i){super(new Uint16Array(e),t,i)}}).prototype.isFloat16BufferAttribute=!0;class y extends E{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Rr=0;const kr=new Re,Dr=new a,Or=new Pe,Nr=new _i,Ur=new _i,h=new Pe;class w extends jt{constructor(){super(),Object.defineProperty(this,"id",{value:Rr++}),this.uuid=$t(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ri(e)?Pr:Ir)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){const t=(new v).getNormalMatrix(e);i.applyNormalMatrix(t),i.needsUpdate=!0}i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return kr.makeRotationFromQuaternion(e),this.applyMatrix4(kr),this}rotateX(e){return kr.makeRotationX(e),this.applyMatrix4(kr),this}rotateY(e){return kr.makeRotationY(e),this.applyMatrix4(kr),this}rotateZ(e){return kr.makeRotationZ(e),this.applyMatrix4(kr),this}translate(e,t,i){return kr.makeTranslation(e,t,i),this.applyMatrix4(kr),this}scale(e,t,i){return kr.makeScale(e,t,i),this.applyMatrix4(kr),this}lookAt(e){return Dr.lookAt(e),Dr.updateMatrix(),this.applyMatrix4(Dr.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Or).negate(),this.translate(Or.x,Or.y,Or.z),this}setFromPoints(i){var r=[];for(let e=0,t=i.length;e<t;e++){var n=i[e];r.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new y(r,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new _i);var e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Pe(-1/0,-1/0,-1/0),new Pe(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),i)for(let e=0,t=i.length;e<t;e++){var r=i[e];Nr.setFromBufferAttribute(r),this.morphTargetsRelative?(h.addVectors(this.boundingBox.min,Nr.min),this.boundingBox.expandByPoint(h),h.addVectors(this.boundingBox.max,Nr.max),this.boundingBox.expandByPoint(h)):(this.boundingBox.expandByPoint(Nr.min),this.boundingBox.expandByPoint(Nr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Bi);var r=this.attributes.position,n=this.morphAttributes.position;if(r&&r.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Pe,1/0);else if(r){var s=this.boundingSphere.center;if(Nr.setFromBufferAttribute(r),n)for(let e=0,t=n.length;e<t;e++){var a=n[e];Ur.setFromBufferAttribute(a),this.morphTargetsRelative?(h.addVectors(Nr.min,Ur.min),Nr.expandByPoint(h),h.addVectors(Nr.max,Ur.max),Nr.expandByPoint(h)):(Nr.expandByPoint(Ur.min),Nr.expandByPoint(Ur.max))}Nr.getCenter(s);let i=0;for(let e=0,t=r.count;e<t;e++)h.fromBufferAttribute(r,e),i=Math.max(i,s.distanceToSquared(h));if(n)for(let e=0,t=n.length;e<t;e++){var o=n[e],l=this.morphTargetsRelative;for(let e=0,t=o.count;e<t;e++)h.fromBufferAttribute(o,e),l&&(Or.fromBufferAttribute(r,e),h.add(Or)),i=Math.max(i,s.distanceToSquared(h))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,r=this.attributes;if(null===e||void 0===r.position||void 0===r.normal||void 0===r.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{const a=e.array,o=r.position.array,l=r.normal.array,h=r.uv.array,t=o.length/3,u=(void 0===r.tangent&&this.setAttribute("tangent",new E(new Float32Array(4*t),4)),r.tangent.array),c=[],d=[];for(let e=0;e<t;e++)c[e]=new Pe,d[e]=new Pe;const p=new Pe,f=new Pe,m=new Pe,g=new W,v=new W,y=new W,_=new Pe,b=new Pe;let i=this.groups;for(let e=0,t=(i=0===i.length?[{start:0,count:a.length}]:i).length;e<t;++e){const r=i[e],o=r.start;for(let e=o,t=o+r.count;e<t;e+=3)n(a[e+0],a[e+1],a[e+2])}const T=new Pe,x=new Pe,w=new Pe,S=new Pe;for(let e=0,t=i.length;e<t;++e){const r=i[e],o=r.start;for(let e=o,t=o+r.count;e<t;e+=3)s(a[e+0]),s(a[e+1]),s(a[e+2])}function n(e,t,i){p.fromArray(o,3*e),f.fromArray(o,3*t),m.fromArray(o,3*i),g.fromArray(h,2*e),v.fromArray(h,2*t),y.fromArray(h,2*i),f.sub(p),m.sub(p),v.sub(g),y.sub(g);var r=1/(v.x*y.y-y.x*v.y);isFinite(r)&&(_.copy(f).multiplyScalar(y.y).addScaledVector(m,-v.y).multiplyScalar(r),b.copy(m).multiplyScalar(v.x).addScaledVector(f,-y.x).multiplyScalar(r),c[e].add(_),c[t].add(_),c[i].add(_),d[e].add(b),d[t].add(b),d[i].add(b))}function s(e){w.fromArray(l,3*e),S.copy(w);var t=c[e],t=(T.copy(t),T.sub(w.multiplyScalar(w.dot(t))).normalize(),x.crossVectors(S,t),x.dot(d[e])<0?-1:1);u[4*e]=T.x,u[4*e+1]=T.y,u[4*e+2]=T.z,u[4*e+3]=t}}}computeVertexNormals(){var r=this.index,n=this.getAttribute("position");if(void 0!==n){let i=this.getAttribute("normal");if(void 0===i)i=new E(new Float32Array(3*n.count),3),this.setAttribute("normal",i);else for(let e=0,t=i.count;e<t;e++)i.setXYZ(e,0,0,0);var s=new Pe,a=new Pe,o=new Pe,l=new Pe,h=new Pe,u=new Pe,c=new Pe,d=new Pe;if(r)for(let e=0,t=r.count;e<t;e+=3){var p=r.getX(e+0),f=r.getX(e+1),m=r.getX(e+2);s.fromBufferAttribute(n,p),a.fromBufferAttribute(n,f),o.fromBufferAttribute(n,m),c.subVectors(o,a),d.subVectors(s,a),c.cross(d),l.fromBufferAttribute(i,p),h.fromBufferAttribute(i,f),u.fromBufferAttribute(i,m),l.add(c),h.add(c),u.add(c),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(f,h.x,h.y,h.z),i.setXYZ(m,u.x,u.y,u.z)}else for(let e=0,t=n.count;e<t;e+=3)s.fromBufferAttribute(n,e+0),a.fromBufferAttribute(n,e+1),o.fromBufferAttribute(n,e+2),c.subVectors(o,a),d.subVectors(s,a),c.cross(d),i.setXYZ(e+0,c.x,c.y,c.z),i.setXYZ(e+1,c.x,c.y,c.z),i.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(const o in i)if(void 0!==e.attributes[o]){var r=i[o].array,n=e.attributes[o],s=n.array,n=n.itemSize*t,a=Math.min(s.length,r.length-n);for(let e=0,t=n;e<a;e++,t++)r[t]=s[e]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)}normalizeNormals(){var i=this.attributes.normal;for(let e=0,t=i.count;e<t;e++)h.fromBufferAttribute(i,e),h.normalize(),i.setXYZ(e,h.x,h.y,h.z)}toNonIndexed(){function i(i,r){var n=i.array,s=i.itemSize,e=i.normalized,a=new n.constructor(r.length*s);let o=0,l=0;for(let e=0,t=r.length;e<t;e++){o=i.isInterleavedBufferAttribute?r[e]*i.data.stride+i.offset:r[e]*s;for(let e=0;e<s;e++)a[l++]=n[o++]}return new E(a,s,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const r=new w,n=this.index.array,s=this.attributes;for(const e in s){const a=i(s[e],n);r.setAttribute(e,a)}const e=this.morphAttributes;for(const s in e){const a=[],o=e[s];for(let e=0,t=o.length;e<t;e++){const s=i(o[e],n);a.push(s)}r.morphAttributes[s]=a}r.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let e=0,t=a.length;e<t;e++){const n=a[e];r.addGroup(n.start,n.count,n.materialIndex)}return r}toJSON(){var i={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),0<Object.keys(this.userData).length&&(i.userData=this.userData),void 0!==this.parameters){const r=this.parameters;for(const n in r)void 0!==r[n]&&(i[n]=r[n])}else{i.data={attributes:{}};const r=this.index,n=(null!==r&&(i.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)}),this.attributes);for(const r in n){const s=n[r];i.data.attributes[r]=s.toJSON(i.data)}const s={};let e=!1;for(const r in this.morphAttributes){const n=this.morphAttributes[r],a=[];for(let e=0,t=n.length;e<t;e++){const s=n[e];a.push(s.toJSON(i.data))}0<a.length&&(s[r]=a,e=!0)}e&&(i.data.morphAttributes=s,i.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;0<a.length&&(i.data.groups=JSON.parse(JSON.stringify(a)));var t=this.boundingSphere;null!==t&&(i.data.boundingSphere={center:t.center.toArray(),radius:t.radius})}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={},r=(this.name=e.name,e.index),n=(null!==r&&this.setIndex(r.clone(i)),e.attributes);for(const e in n){const r=n[e];this.setAttribute(e,r.clone(i))}var t=e.morphAttributes;for(const e in t){const r=[],n=t[e];for(let e=0,t=n.length;e<t;e++)r.push(n[e].clone(i));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;var s=e.groups;for(let e=0,t=s.length;e<t;e++){const i=s[e];this.addGroup(i.start,i.count,i.materialIndex)}var a=e.boundingBox,a=(null!==a&&(this.boundingBox=a.clone()),e.boundingSphere);return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}w.prototype.isBufferGeometry=!0;const Br=new Re,Fr=new qi,Hr=new Bi,zr=new Pe,Vr=new Pe,Gr=new Pe,Wr=new Pe,jr=new Pe,qr=new Pe,Xr=new Pe,Yr=new Pe,$r=new Pe,Kr=new W,Jr=new W,Zr=new W,Qr=new Pe,en=new Pe;class S extends a{constructor(e=new w,t=new Ar){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){var e=i.morphAttributes,t=Object.keys(e);if(0<t.length){const i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){var r=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}}}else{e=i.morphTargets;void 0!==e&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(r,n){const e=this.geometry,s=this.material,a=this.matrixWorld;if(void 0!==s&&(null===e.boundingSphere&&e.computeBoundingSphere(),Hr.copy(e.boundingSphere),Hr.applyMatrix4(a),!1!==r.ray.intersectsSphere(Hr))&&(Br.copy(a).invert(),Fr.copy(r.ray).applyMatrix4(Br),null===e.boundingBox||!1!==Fr.intersectsBox(e.boundingBox))){let i;if(e.isBufferGeometry){const a=e.index,d=e.attributes.position,p=e.morphAttributes.position,f=e.morphTargetsRelative,m=e.attributes.uv,g=e.attributes.uv2,v=e.groups,y=e.drawRange;if(null!==a)if(Array.isArray(s))for(let e=0,t=v.length;e<t;e++){var o=v[e],l=s[o.materialIndex];for(let e=Math.max(o.start,y.start),t=Math.min(a.count,Math.min(o.start+o.count,y.start+y.count));e<t;e+=3){const s=a.getX(e),_=a.getX(e+1),b=a.getX(e+2);(i=tn(this,l,r,Fr,d,p,f,m,g,s,_,b))&&(i.faceIndex=Math.floor(e/3),i.face.materialIndex=o.materialIndex,n.push(i))}}else for(let e=Math.max(0,y.start),t=Math.min(a.count,y.start+y.count);e<t;e+=3){var h=a.getX(e),u=a.getX(e+1),c=a.getX(e+2);(i=tn(this,s,r,Fr,d,p,f,m,g,h,u,c))&&(i.faceIndex=Math.floor(e/3),n.push(i))}else if(void 0!==d)if(Array.isArray(s))for(let e=0,t=v.length;e<t;e++){const a=v[e],T=s[a.materialIndex];for(let e=Math.max(a.start,y.start),t=Math.min(d.count,Math.min(a.start+a.count,y.start+y.count));e<t;e+=3)(i=tn(this,T,r,Fr,d,p,f,m,g,e,e+1,e+2))&&(i.faceIndex=Math.floor(e/3),i.face.materialIndex=a.materialIndex,n.push(i))}else for(let e=Math.max(0,y.start),t=Math.min(d.count,y.start+y.count);e<t;e+=3)(i=tn(this,s,r,Fr,d,p,f,m,g,e,e+1,e+2))&&(i.faceIndex=Math.floor(e/3),n.push(i))}else e.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function tn(e,i,r,t,n,s,a,o,l,h,u,c){zr.fromBufferAttribute(n,h),Vr.fromBufferAttribute(n,u),Gr.fromBufferAttribute(n,c);var d=e.morphTargetInfluences;if(s&&d){Xr.set(0,0,0),Yr.set(0,0,0),$r.set(0,0,0);for(let e=0,t=s.length;e<t;e++){const i=d[e],r=s[e];0!==i&&(Wr.fromBufferAttribute(r,h),jr.fromBufferAttribute(r,u),qr.fromBufferAttribute(r,c),a?(Xr.addScaledVector(Wr,i),Yr.addScaledVector(jr,i),$r.addScaledVector(qr,i)):(Xr.addScaledVector(Wr.sub(zr),i),Yr.addScaledVector(jr.sub(Vr),i),$r.addScaledVector(qr.sub(Gr),i)))}zr.add(Xr),Vr.add(Yr),Gr.add($r)}e.isSkinnedMesh&&(e.boneTransform(h,zr),e.boneTransform(u,Vr),e.boneTransform(c,Gr));n=function(e,t,i,r,n,s,a,o){if(null===(t.side===Me?r.intersectTriangle(a,s,n,!0,o):r.intersectTriangle(n,s,a,t.side!==Oe,o)))return null;en.copy(o),en.applyMatrix4(e.matrixWorld);r=i.ray.origin.distanceTo(en);return r<i.near||r>i.far?null:{distance:r,point:en.clone(),object:e}}(e,i,r,t,zr,Vr,Gr,Qr);if(n){o&&(Kr.fromBufferAttribute(o,h),Jr.fromBufferAttribute(o,u),Zr.fromBufferAttribute(o,c),n.uv=p.getUV(Qr,zr,Vr,Gr,Kr,Jr,Zr,new W)),l&&(Kr.fromBufferAttribute(l,h),Jr.fromBufferAttribute(l,u),Zr.fromBufferAttribute(l,c),n.uv2=p.getUV(Qr,zr,Vr,Gr,Kr,Jr,Zr,new W));const e={a:h,b:u,c:c,normal:new Pe,materialIndex:0};p.getNormal(zr,Vr,Gr,e.normal),n.face=e}return n}S.prototype.isMesh=!0;class rn extends w{constructor(e=1,t=1,i=1,r=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:n,depthSegments:s};const T=this,x=(r=Math.floor(r),n=Math.floor(n),s=Math.floor(s),[]),w=[],S=[],E=[];let M=0,C=0;function a(i,r,n,s,a,o,e,l,h,u,t){var c=o/h,d=e/u,p=o/2,f=e/2,m=l/2,g=h+1,v=u+1;let y=0,_=0;var b=new Pe;for(let t=0;t<v;t++){const T=t*d-f;for(let e=0;e<g;e++){const M=e*c-p;b[i]=M*s,b[r]=T*a,b[n]=m,w.push(b.x,b.y,b.z),b[i]=0,b[r]=0,b[n]=0<l?1:-1,S.push(b.x,b.y,b.z),E.push(e/h),E.push(1-t/u),y+=1}}for(let t=0;t<u;t++)for(let e=0;e<h;e++){const n=M+e+g*t,s=M+e+g*(t+1),a=M+(e+1)+g*(t+1),o=M+(e+1)+g*t;x.push(n,s,o),x.push(s,a,o),_+=6}T.addGroup(C,_,t),C+=_,M+=y}a("z","y","x",-1,-1,i,t,e,s,n,0),a("z","y","x",1,-1,i,t,-e,s,n,1),a("x","z","y",1,1,e,i,t,r,s,2),a("x","z","y",1,-1,e,i,-t,r,s,3),a("x","y","z",1,-1,e,t,i,r,n,4),a("x","y","z",-1,-1,e,t,-i,r,n,5),this.setIndex(x),this.setAttribute("position",new y(w,3)),this.setAttribute("normal",new y(S,3)),this.setAttribute("uv",new y(E,2))}static fromJSON(e){return new rn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function nn(e){var t={};for(const r in e){t[r]={};for(const n in e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function t(t){var i={};for(let e=0;e<t.length;e++){var r=nn(t[e]);for(const t in r)i[t]=r[t]}return i}const sn={clone:nn,merge:t};class an extends e{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=nn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){var t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){var i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return 0<Object.keys(r).length&&(t.extensions=r),t}}an.prototype.isShaderMaterial=!0;class on extends a{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Re,this.projectionMatrix=new Re,this.projectionMatrixInverse=new Re}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}on.prototype.isCamera=!0;class D extends on{constructor(e=50,t=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){e=.5*this.getFilmHeight()/e;this.fov=2*Yt*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){var e=Math.tan(.5*Xt*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Yt*Math.atan(Math.tan(.5*Xt*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,n,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Xt*this.fov)/this.zoom,i=2*t,r=this.aspect*i,n=-.5*r;var s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;n+=s.offsetX*r/e,t-=s.offsetY*i/a,r*=s.width/e,i*=s.height/a}const a=this.filmOffset;0!==a&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){e=super.toJSON(e);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}D.prototype.isPerspectiveCamera=!0;class ln extends a{constructor(e,t,i){super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget?console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."):(this.renderTarget=i,(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Pe(1,0,0)),this.add(i),(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Pe(-1,0,0)),this.add(i),(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,0,1),i.lookAt(new Pe(0,1,0)),this.add(i),(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,0,-1),i.lookAt(new Pe(0,-1,0)),this.add(i),(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Pe(0,0,1)),this.add(i),(i=new D(90,1,e,t)).layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Pe(0,0,-1)),this.add(i))}update(e,t){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,[r,n,s,a,o,l]=this.children,h=e.xr.enabled,u=e.getRenderTarget(),c=(e.xr.enabled=!1,i.texture.generateMipmaps);i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,n),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,o),i.texture.generateMipmaps=c,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class hn extends u{constructor(e,t,i,r,n,s,a,o,l,h){super(e=void 0!==e?e:[],t=void 0!==t?t:N,i,r,n,s,a,o,l,h),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}hn.prototype.isCubeTexture=!0;class un extends mi{constructor(e,t,i){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=i),super(e,e,t),t=t||{},this.texture=new hn(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:V}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Le,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var i=new rn(5,5,5),r=new an({name:"CubemapFromEquirect",uniforms:nn({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:Me,blending:X}),i=(r.uniforms.tEquirect.value=t,new S(i,r)),r=t.minFilter;return t.minFilter===He&&(t.minFilter=V),new ln(1,10,this).update(e,i),t.minFilter=r,i.geometry.dispose(),i.material.dispose(),this}clear(t,i,r,n){var e=t.getRenderTarget();for(let e=0;e<6;e++)t.setRenderTarget(this,e),t.clear(i,r,n);t.setRenderTarget(e)}}un.prototype.isWebGLCubeRenderTarget=!0;const cn=new Pe,dn=new Pe,pn=new v;class fn{constructor(e=new Pe(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){i=cn.subVectors(i,t).cross(dn.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){var i=e.delta(cn),r=this.normal.dot(i);return 0===r?0===this.distanceToPoint(e.start)?t.copy(e.start):null:(r=-(e.start.dot(this.normal)+this.constant)/r)<0||1<r?null:t.copy(i).multiplyScalar(r).add(e.start)}intersectsLine(e){var t=this.distanceToPoint(e.start),e=this.distanceToPoint(e.end);return t<0&&0<e||e<0&&0<t}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){t=t||pn.getNormalMatrix(e),e=this.coplanarPoint(cn).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize();return this.constant=-e.dot(t),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}fn.prototype.isPlane=!0;const mn=new Bi,gn=new Pe;class vn{constructor(e=new fn,t=new fn,i=new fn,r=new fn,n=new fn,s=new fn){this.planes=[e,t,i,r,n,s]}set(e,t,i,r,n,s){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(n),a[5].copy(s),this}copy(t){var i=this.planes;for(let e=0;e<6;e++)i[e].copy(t.planes[e]);return this}setFromProjectionMatrix(e){var t=this.planes,e=e.elements,i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],e=e[15];return t[0].setComponents(s-i,h-a,p-u,e-f).normalize(),t[1].setComponents(s+i,h+a,p+u,e+f).normalize(),t[2].setComponents(s+r,h+o,p+c,e+m).normalize(),t[3].setComponents(s-r,h-o,p-c,e-m).normalize(),t[4].setComponents(s-n,h-l,p-d,e-g).normalize(),t[5].setComponents(s+n,h+l,p+d,e+g).normalize(),this}intersectsObject(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),mn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(mn)}intersectsSprite(e){return mn.center.set(0,0,0),mn.radius=.7071067811865476,mn.applyMatrix4(e.matrixWorld),this.intersectsSphere(mn)}intersectsSphere(e){var t=this.planes,i=e.center,r=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(i)<r)return!1;return!0}intersectsBox(t){var i=this.planes;for(let e=0;e<6;e++){var r=i[e];if(gn.x=(0<r.normal.x?t.max:t.min).x,gn.y=(0<r.normal.y?t.max:t.min).y,gn.z=(0<r.normal.z?t.max:t.min).z,r.distanceToPoint(gn)<0)return!1}return!0}containsPoint(t){var i=this.planes;for(let e=0;e<6;e++)if(i[e].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function yn(){let i=null,e=!1,r=null,n=null;function s(e,t){r(e,t),n=i.requestAnimationFrame(s)}return{start:function(){!0!==e&&null!==r&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(e){r=e},setContext:function(e){i=e}}}function _n(a,e){const o=e.isWebGL2,l=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),l.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=l.get(e);t&&(a.deleteBuffer(t.buffer),l.delete(e))},update:function(e,t){if(e.isGLBufferAttribute){const a=l.get(e);void((!a||a.version<e.version)&&l.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}else{e.isInterleavedBufferAttribute&&(e=e.data);var i,r,n,s=l.get(e);void 0===s?l.set(e,function(e,t){var i=e.array,r=e.usage,n=a.createBuffer();a.bindBuffer(t,n),a.bufferData(t,i,r),e.onUploadCallback();let s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?e.isFloat16BufferAttribute?o?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(s=5121),{buffer:n,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,t)):s.version<e.version&&(i=s.buffer,t=t,n=(r=e).array,r=r.updateRange,a.bindBuffer(t,i),-1===r.count?a.bufferSubData(t,0,n):(o?a.bufferSubData(t,r.offset*n.BYTES_PER_ELEMENT,n,r.offset,r.count):a.bufferSubData(t,r.offset*n.BYTES_PER_ELEMENT,n.subarray(r.offset,r.offset+r.count)),r.count=-1),s.version=e.version)}}}}class bn extends w{constructor(e=1,i=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:r,heightSegments:n};const s=e/2,a=i/2,o=Math.floor(r),l=Math.floor(n),h=o+1,u=l+1,c=e/o,d=i/l,p=[],f=[],m=[],g=[];for(let t=0;t<u;t++){const i=t*d-a;for(let e=0;e<h;e++){const n=e*c-s;f.push(n,-i,0),m.push(0,0,1),g.push(e/o),g.push(1-t/l)}}for(let t=0;t<l;t++)for(let e=0;e<o;e++){const r=e+h*t,n=e+h*(t+1),s=e+1+h*(t+1),a=e+1+h*t;p.push(r,n,a),p.push(n,s,a)}this.setIndex(p),this.setAttribute("position",new y(f,3)),this.setAttribute("normal",new y(m,3)),this.setAttribute("uv",new y(g,2))}static fromJSON(e){return new bn(e.width,e.height,e.widthSegments,e.heightSegments)}}const x={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\treturn texture2D( envMap, uv ).rgb;\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},M={common:{diffuse:{value:new m(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new v},uv2Transform:{value:new v},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new W(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new m(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new m(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new v}},sprite:{diffuse:{value:new m(16777215)},opacity:{value:1},center:{value:new W(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new v}}},Tn={basic:{uniforms:t([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,M.fog]),vertexShader:x.meshbasic_vert,fragmentShader:x.meshbasic_frag},lambert:{uniforms:t([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,M.emissivemap,M.fog,M.lights,{emissive:{value:new m(0)}}]),vertexShader:x.meshlambert_vert,fragmentShader:x.meshlambert_frag},phong:{uniforms:t([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,M.emissivemap,M.bumpmap,M.normalmap,M.displacementmap,M.fog,M.lights,{emissive:{value:new m(0)},specular:{value:new m(1118481)},shininess:{value:30}}]),vertexShader:x.meshphong_vert,fragmentShader:x.meshphong_frag},standard:{uniforms:t([M.common,M.envmap,M.aomap,M.lightmap,M.emissivemap,M.bumpmap,M.normalmap,M.displacementmap,M.roughnessmap,M.metalnessmap,M.fog,M.lights,{emissive:{value:new m(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:x.meshphysical_vert,fragmentShader:x.meshphysical_frag},toon:{uniforms:t([M.common,M.aomap,M.lightmap,M.emissivemap,M.bumpmap,M.normalmap,M.displacementmap,M.gradientmap,M.fog,M.lights,{emissive:{value:new m(0)}}]),vertexShader:x.meshtoon_vert,fragmentShader:x.meshtoon_frag},matcap:{uniforms:t([M.common,M.bumpmap,M.normalmap,M.displacementmap,M.fog,{matcap:{value:null}}]),vertexShader:x.meshmatcap_vert,fragmentShader:x.meshmatcap_frag},points:{uniforms:t([M.points,M.fog]),vertexShader:x.points_vert,fragmentShader:x.points_frag},dashed:{uniforms:t([M.common,M.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:x.linedashed_vert,fragmentShader:x.linedashed_frag},depth:{uniforms:t([M.common,M.displacementmap]),vertexShader:x.depth_vert,fragmentShader:x.depth_frag},normal:{uniforms:t([M.common,M.bumpmap,M.normalmap,M.displacementmap,{opacity:{value:1}}]),vertexShader:x.meshnormal_vert,fragmentShader:x.meshnormal_frag},sprite:{uniforms:t([M.sprite,M.fog]),vertexShader:x.sprite_vert,fragmentShader:x.sprite_frag},background:{uniforms:{uvTransform:{value:new v},t2D:{value:null}},vertexShader:x.background_vert,fragmentShader:x.background_frag},cube:{uniforms:t([M.envmap,{opacity:{value:1}}]),vertexShader:x.cube_vert,fragmentShader:x.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:x.equirect_vert,fragmentShader:x.equirect_frag},distanceRGBA:{uniforms:t([M.common,M.displacementmap,{referencePosition:{value:new Pe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:x.distanceRGBA_vert,fragmentShader:x.distanceRGBA_frag},shadow:{uniforms:t([M.lights,M.fog,{color:{value:new m(0)},opacity:{value:1}}]),vertexShader:x.shadow_vert,fragmentShader:x.shadow_frag}};function xn(n,s,i,a,e,r){const o=new m(0);let l,h,u=!0===e?0:1,c=null,d=0,p=null;function f(e,t){i.buffers.color.setClear(e.r,e.g,e.b,t,r)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),u=t,f(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,f(o,u)},render:function(e,t){let i=!1,r=!0===t.isScene?t.background:null;r&&r.isTexture&&(r=s.get(r));t=n.xr,t=t.getSession&&t.getSession();null===(r=t&&"additive"===t.environmentBlendMode?null:r)?f(o,u):r&&r.isColor&&(f(r,1),i=!0),(n.autoClear||i)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),r&&(r.isCubeTexture||r.mapping===H)?(void 0===h&&((h=new S(new rn(1,1,1),new an({name:"BackgroundCubeMaterial",uniforms:nn(Tn.cube.uniforms),vertexShader:Tn.cube.vertexShader,fragmentShader:Tn.cube.fragmentShader,side:Me,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(h)),h.material.uniforms.envMap.value=r,h.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c===r&&d===r.version&&p===n.toneMapping||(h.material.needsUpdate=!0,c=r,d=r.version,p=n.toneMapping),e.unshift(h,h.geometry,h.material,0,0,null)):r&&r.isTexture&&(void 0===l&&((l=new S(new bn(2,2),new an({name:"BackgroundMaterial",uniforms:nn(Tn.background.uniforms),vertexShader:Tn.background.vertexShader,fragmentShader:Tn.background.fragmentShader,side:De,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(l)),!0===(l.material.uniforms.t2D.value=r).matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),c===r&&d===r.version&&p===n.toneMapping||(l.material.needsUpdate=!0,c=r,d=r.version,p=n.toneMapping),e.unshift(l,l.geometry,l.material,0,0,null))}}}function wn(c,d,p,f){const n=c.getParameter(34921),m=f.isWebGL2?null:d.get("OES_vertex_array_object"),g=f.isWebGL2||null!==m,v={},e=b(null);let y=e;function _(e){f.isWebGL2?c.bindVertexArray(e):m.bindVertexArrayOES(e)}function s(e){f.isWebGL2?c.deleteVertexArray(e):m.deleteVertexArrayOES(e)}function b(e){var t=[],i=[],r=[];for(let e=0;e<n;e++)t[e]=0,i[e]=0,r[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function T(){var i=y.newAttributes;for(let e=0,t=i.length;e<t;e++)i[e]=0}function x(e){w(e,0)}function w(e,t){var i=y.newAttributes,r=y.enabledAttributes,n=y.attributeDivisors;i[e]=1,0===r[e]&&(c.enableVertexAttribArray(e),r[e]=1),n[e]!==t&&((f.isWebGL2?c:d.get("ANGLE_instanced_arrays"))[f.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](e,t),n[e]=t)}function S(){var i=y.newAttributes,r=y.enabledAttributes;for(let e=0,t=r.length;e<t;e++)r[e]!==i[e]&&(c.disableVertexAttribArray(e),r[e]=0)}function E(e,t,i,r,n,s){!0!==f.isWebGL2||5124!==i&&5125!==i?c.vertexAttribPointer(e,t,i,r,n,s):c.vertexAttribIPointer(e,t,i,n,s)}function a(){t(),y!==e&&_((y=e).object)}function t(){e.geometry=null,e.program=null,e.wireframe=!1}return{setup:function(e,a,t,i,r){let n=!1;if(g){const d=function(e,t){var i=!0===a.wireframe;let r=v[e.id],n=(void 0===r&&(r={},v[e.id]=r),r[t.id]),s=(void 0===n&&(n={},r[t.id]=n),n[i]);return void 0===s&&(s=b(f.isWebGL2?c.createVertexArray():m.createVertexArrayOES()),n[i]=s),s}(i,t);if(y!==d&&_((y=d).object),n=function(e,t){var i=y.attributes,r=e.attributes;let n=0;for(const e in r){const t=i[e],s=r[e];if(void 0===t)return!0;if(t.attribute!==s)return!0;if(t.data!==s.data)return!0;n++}return y.attributesNum!==n||y.index!==t}(i,r)){var s=i;var o=r;var l={},h=s.attributes;let e=0;for(const s in h){const o=h[s],u={};(u.attribute=o).data&&(u.data=o.data),l[s]=u,e++}y.attributes=l,y.attributesNum=e,y.index=o}}else{const c=!0===a.wireframe;y.geometry===i.id&&y.program===t.id&&y.wireframe===c||(y.geometry=i.id,y.program=t.id,y.wireframe=c,n=!0)}!0===e.isInstancedMesh&&(n=!0),null!==r&&p.update(r,34963),n&&(function(e,t,i,r){if(!1!==f.isWebGL2||!e.isInstancedMesh&&!r.isInstancedBufferGeometry||null!==d.get("ANGLE_instanced_arrays")){T();const n=r.attributes,s=i.getAttributes(),a=t.defaultAttributeValues;for(const d in s){const f=s[d];if(0<=f.location){let t=n[d];if(void 0!==(t=void 0===t&&("instanceMatrix"===d&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===d)&&e.instanceColor?e.instanceColor:t)){const d=t.normalized,i=t.itemSize,n=p.get(t);if(void 0!==n){const s=n.buffer,a=n.type,o=n.bytesPerElement;if(t.isInterleavedBufferAttribute){const p=t.data,n=p.stride,l=t.offset;if(p&&p.isInstancedInterleavedBuffer){for(let e=0;e<f.locationSize;e++)w(f.location+e,p.meshPerAttribute);!0!==e.isInstancedMesh&&void 0===r._maxInstanceCount&&(r._maxInstanceCount=p.meshPerAttribute*p.count)}else for(let e=0;e<f.locationSize;e++)x(f.location+e);c.bindBuffer(34962,s);for(let e=0;e<f.locationSize;e++)E(f.location+e,i/f.locationSize,a,d,n*o,(l+i/f.locationSize*e)*o)}else{if(t.isInstancedBufferAttribute){for(let e=0;e<f.locationSize;e++)w(f.location+e,t.meshPerAttribute);!0!==e.isInstancedMesh&&void 0===r._maxInstanceCount&&(r._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<f.locationSize;e++)x(f.location+e);c.bindBuffer(34962,s);for(let e=0;e<f.locationSize;e++)E(f.location+e,i/f.locationSize,a,d,i*o,i/f.locationSize*e*o)}}}else if(void 0!==a){const p=a[d];if(void 0!==p)switch(p.length){case 2:c.vertexAttrib2fv(f.location,p);break;case 3:c.vertexAttrib3fv(f.location,p);break;case 4:c.vertexAttrib4fv(f.location,p);break;default:c.vertexAttrib1fv(f.location,p)}}}}S()}}(e,a,t,i),null!==r)&&c.bindBuffer(34963,p.get(r).buffer)},reset:a,resetDefaultState:t,dispose:function(){a();for(const i in v){var e=v[i];for(const r in e){var t=e[r];for(const n in t)s(t[n].object),delete t[n];delete e[r]}delete v[i]}},releaseStatesOfGeometry:function(e){if(void 0!==v[e.id]){var t=v[e.id];for(const e in t){var i=t[e];for(const e in i)s(i[e].object),delete i[e];delete t[e]}delete v[e.id]}},releaseStatesOfProgram:function(e){for(const r in v){var t=v[r];if(void 0!==t[e.id]){var i=t[e.id];for(const e in i)s(i[e].object),delete i[e];delete t[e.id]}}},initAttributes:T,enableAttribute:x,disableUnusedAttributes:S}}function Sn(s,a,o,e){const l=e.isWebGL2;let h;this.setMode=function(e){h=e},this.render=function(e,t){s.drawArrays(h,e,t),o.update(t,h,1)},this.renderInstances=function(i,r,n){if(0!==n){let e,t;if(l)e=s,t="drawArraysInstanced";else if(e=a.get("ANGLE_instanced_arrays"),t="drawArraysInstancedANGLE",null===e)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");e[t](h,i,r,n),o.update(r,h,n)}}}function En(t,i,e){let r;function n(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==e.precision?e.precision:"highp";var o=n(a),o=(o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o),s||i.has("WEBGL_draw_buffers")),e=!0===e.logarithmicDepthBuffer,l=t.getParameter(34930),h=t.getParameter(35660),u=t.getParameter(3379),c=t.getParameter(34076),d=t.getParameter(34921),p=t.getParameter(36347),f=t.getParameter(36348),m=t.getParameter(36349),g=0<h,v=s||i.has("OES_texture_float");return{isWebGL2:s,drawBuffers:o,getMaxAnisotropy:function(){var e;return r=void 0===r?!0===i.has("EXT_texture_filter_anisotropic")?(e=i.get("EXT_texture_filter_anisotropic"),t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)):0:r},getMaxPrecision:n,precision:a,logarithmicDepthBuffer:e,maxTextures:l,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:c,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v,maxSamples:s?t.getParameter(36183):0}}function Mn(l){const t=this;let h=null,u=0,c=!1,d=!1;const o=new fn,p=new v,f={value:null,needsUpdate:!1};function m(){f.value!==h&&(f.value=h,f.needsUpdate=0<u),t.numPlanes=u,t.numIntersection=0}function g(i,e,r,n){var s=null!==i?i.length:0;let a=null;if(0!==s){if(a=f.value,!0!==n||null===a){const t=r+4*s,n=e.matrixWorldInverse;p.getNormalMatrix(n),(null===a||a.length<t)&&(a=new Float32Array(t));for(let e=0,t=r;e!==s;++e,t+=4)o.copy(i[e]).applyMatrix4(n,p),o.normal.toArray(a,t),a[t+3]=o.constant}f.value=a,f.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,a}this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,i){var r=0!==e.length||t||0!==u||c;return c=t,h=g(e,i,0),u=e.length,r},this.beginShadows=function(){d=!0,g(null)},this.endShadows=function(){d=!1,m()},this.setState=function(t,e,i){var r=t.clippingPlanes,n=t.clipIntersection,s=t.clipShadows,a=l.get(t);if(!c||null===r||0===r.length||d&&!s)d?g(null):m();else{const l=d?0:u,t=4*l;var o=a.clippingState||null;f.value=o,o=g(r,e,t,i);for(let e=0;e!==t;++e)o[e]=h[e];a.clippingState=o,this.numIntersection=n?this.numPlanes:0,this.numPlanes+=l}}}function Cn(i){let r=new WeakMap;function n(e,t){return t===B?e.mapping=N:t===F&&(e.mapping=U),e}function s(e){var e=e.target,t=(e.removeEventListener("dispose",s),r.get(e));void 0!==t&&(r.delete(e),t.dispose())}return{get:function(e){if(e&&e.isTexture&&!1===e.isRenderTargetTexture){var t=e.mapping;if(t===B||t===F)return r.has(e)?n(r.get(e).texture,e.mapping):(t=e.image)&&0<t.height?((t=new un(t.height/2)).fromEquirectangularTexture(i,e),r.set(e,t),e.addEventListener("dispose",s),n(t.texture,e.mapping)):null}return e},dispose:function(){r=new WeakMap}}}Tn.physical={uniforms:t([Tn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new W(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new m(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new W},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new m(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new m(1,1,1)},specularColorMap:{value:null}}]),vertexShader:x.meshphysical_vert,fragmentShader:x.meshphysical_frag};class An extends on{constructor(e=-1,t=1,i=1,r=-1,n=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,n,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let n=i-e,s=i+e,a=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=e*this.view.offsetX,s=n+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){e=super.toJSON(e);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}An.prototype.isOrthographicCamera=!0;class Ln extends an{constructor(e){super(e),this.type="RawShaderMaterial"}}Ln.prototype.isRawShaderMaterial=!0;const In=Math.pow(2,8),Pn=[.125,.215,.35,.446,.526,.582],Rn=5+Pn.length,kn=new An,{_lodPlanes:Dn,_sizeLods:On,_sigmas:Nn}=function(){const i=[],r=[],n=[];let s=8;for(let t=0;t<Rn;t++){var a=Math.pow(2,s);r.push(a);let e=1/a;4<t?e=Pn[t-8+4-1]:0===t&&(e=0),n.push(e);var a=1/(a-1),o=-a/2,a=1+a/2,l=[o,o,a,o,a,a,o,o,a,a,o,a],h=new Float32Array(108),u=new Float32Array(72),c=new Float32Array(36);for(let e=0;e<6;e++){const r=e%3*2/3-1,n=2<e?0:-1,s=[r,n,0,r+2/3,n,0,r+2/3,1+n,0,r,n,0,r+2/3,1+n,0,r,1+n,0];h.set(s,18*e),u.set(l,12*e);var d=[e,e,e,e,e,e];c.set(d,6*e)}o=new w;o.setAttribute("position",new E(h,3)),o.setAttribute("uv",new E(u,2)),o.setAttribute("faceIndex",new E(c,1)),i.push(o),4<s&&s--}return{_lodPlanes:i,_sizeLods:r,_sigmas:n}}(),Un=new m;let Bn=null;const Fn=(1+Math.sqrt(5))/2,Hn=1/Fn,zn=[new Pe(1,1,1),new Pe(-1,1,1),new Pe(1,1,-1),new Pe(-1,1,-1),new Pe(0,Fn,Hn),new Pe(0,Fn,-Hn),new Pe(Hn,0,Fn),new Pe(-Hn,0,Fn),new Pe(Fn,Hn,0),new Pe(-Fn,Hn,0)];class Vn{constructor(e){var t;this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=(e=new Float32Array(20),t=new Pe(0,1,0),new Ln({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Bn=this._renderer.getRenderTarget();var n=this._allocateTargets();return this._sceneToCubeUV(e,i,r,n),0<t&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=qn(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=jn(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Dn.length;e++)Dn[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Bn),e.scissorTest=!1,Wn(e,0,0,e.width,e.height)}_fromTexture(e,t){Bn=this._renderer.getRenderTarget();t=t||this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){var t={magFilter:V,minFilter:V,generateMipmaps:!1,type:Ye,format:Le,encoding:Ft,depthBuffer:!1},i=Gn(t);return i.depthBuffer=!e,null===this._pingPongRenderTarget&&(this._pingPongRenderTarget=Gn(t)),i}_compileMaterial(e){e=new S(Dn[0],e);this._renderer.compile(e,kn)}_sceneToCubeUV(t,e,i,r){var n=new D(90,1,e,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,e=o.autoClear,i=o.toneMapping,l=(o.getClearColor(Un),o.toneMapping=Ne,o.autoClear=!1,new Ar({name:"PMREM.Background",side:Me,depthWrite:!1,depthTest:!1})),h=new S(new rn,l);let u=!1;var c=t.background;c?c.isColor&&(l.color.copy(c),t.background=null,u=!0):(l.color.copy(Un),u=!0);for(let e=0;e<6;e++){const i=e%3;0==i?(n.up.set(0,s[e],0),n.lookAt(a[e],0,0)):1==i?(n.up.set(0,0,s[e]),n.lookAt(0,a[e],0)):(n.up.set(0,s[e],0),n.lookAt(0,0,a[e])),Wn(r,i*In,2<e?In:0,In,In),o.setRenderTarget(r),u&&o.render(h,n),o.render(t,n)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=i,o.autoClear=e,t.background=c}_textureToCubeUV(e,t){var i=this._renderer,r=e.mapping===N||e.mapping===U,n=(r?(null===this._cubemapShader&&(this._cubemapShader=qn()),this._cubemapShader.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectShader&&(this._equirectShader=jn()),r?this._cubemapShader:this._equirectShader),s=new S(Dn[0],n),n=n.uniforms;n.envMap.value=e,r||n.texelSize.value.set(1/e.image.width,1/e.image.height),Wn(t,0,0,3*In,2*In),i.setRenderTarget(t),i.render(s,kn)}_applyPMREM(t){const e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let e=1;e<Rn;e++){const i=Math.sqrt(Nn[e]*Nn[e]-Nn[e-1]*Nn[e-1]),r=zn[(e-1)%zn.length];this._blur(t,e-1,e,i,r)}e.autoClear=i}_blur(e,t,i,r,n){var s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",n),this._halfBlur(s,e,i,i,r,"longitudinal",n)}_halfBlur(e,t,i,r,n,s,a){var o=this._renderer,l=this._blurMaterial,h=("latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!"),new S(Dn[r],l)),l=l.uniforms,u=On[i]-1,u=isFinite(n)?Math.PI/(2*u):2*Math.PI/39,c=n/u,d=isFinite(n)?1+Math.floor(3*c):20,p=(20<d&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${d} samples when the maximum is set to 20`),[]);let f=0;for(let e=0;e<20;++e){const t=e/c,i=Math.exp(-t*t/2);p.push(i),0===e?f+=i:e<d&&(f+=2*i)}for(let e=0;e<p.length;e++)p[e]=p[e]/f;l.envMap.value=e.texture,l.samples.value=d,l.weights.value=p,l.latitudinal.value="latitudinal"===s,a&&(l.poleAxis.value=a),l.dTheta.value=u,l.mipInt.value=8-i;n=On[r];Wn(t,3*Math.max(0,In-2*n),(0===r?0:2*In)+2*n*(4<r?r-8+4:0),3*n,2*n),o.setRenderTarget(t),o.render(h,kn)}}function Gn(e){e=new mi(3*In,3*In,e);return e.texture.mapping=H,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Wn(e,t,i,r,n){e.viewport.set(t,i,r,n),e.scissor.set(t,i,r,n)}function jn(){var e=new W(1,1);return new Ln({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = texture2D ( envMap, uv ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = texture2D ( envMap, uv ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function qn(){return new Ln({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function Xn(n){let s=new WeakMap,a=null;function o(e){var e=e.target,t=(e.removeEventListener("dispose",o),s.get(e));void 0!==t&&(s.delete(e),t.dispose())}return{get:function(e){if(e&&e.isTexture){var t,i=e.mapping,r=i===B||i===F,i=i===N||i===U;if(r||i)return e.isRenderTargetTexture&&!0===e.needsPMREMUpdate?(e.needsPMREMUpdate=!1,t=s.get(e),null===a&&(a=new Vn(n)),t=r?a.fromEquirectangular(e,t):a.fromCubemap(e,t),s.set(e,t),t.texture):s.has(e)?s.get(e).texture:(t=e.image,r&&t&&0<t.height||i&&t&&function(t){let i=0;for(let e=0;e<6;e++)void 0!==t[e]&&i++;return 6===i}(t)?(null===a&&(a=new Vn(n)),i=r?a.fromEquirectangular(e):a.fromCubemap(e),s.set(e,i),e.addEventListener("dispose",o),i.texture):null)}return e},dispose:function(){s=new WeakMap,null!==a&&(a.dispose(),a=null)}}}function Yn(i){const r={};function n(e){if(void 0!==r[e])return r[e];let t;switch(e){case"WEBGL_depth_texture":t=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:t=i.getExtension(e)}return r[e]=t}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function $n(e,o,i,r){const n={},l=new WeakMap;function s(e){var t=e.target;null!==t.index&&o.remove(t.index);for(const e in t.attributes)o.remove(t.attributes[e]);t.removeEventListener("dispose",s),delete n[t.id];e=l.get(t);e&&(o.remove(e),l.delete(t)),r.releaseStatesOfGeometry(t),!0===t.isInstancedBufferGeometry&&delete t._maxInstanceCount,i.memory.geometries--}function a(i){const r=[],n=i.index,s=i.attributes.position;let e=0;if(null!==n){const i=n.array;e=n.version;for(let e=0,t=i.length;e<t;e+=3){const n=i[e+0],s=i[e+1],l=i[e+2];r.push(n,s,s,l,l,n)}}else{const i=s.array;e=s.version;for(let e=0,t=i.length/3-1;e<t;e+=3){const i=e+0,n=e+1,s=e+2;r.push(i,n,n,s,s,i)}}var t=new(ri(r)?Pr:Ir)(r,1),a=(t.version=e,l.get(i));a&&o.remove(a),l.set(i,t)}return{get:function(e,t){return!0!==n[t.id]&&(t.addEventListener("dispose",s),n[t.id]=!0,i.memory.geometries++),t},update:function(e){const i=e.attributes;for(const e in i)o.update(i[e],34962);var t=e.morphAttributes;for(const e in t){const i=t[e];for(let e=0,t=i.length;e<t;e++)o.update(i[e],34962)}},getWireframeAttribute:function(e){var t,i=l.get(e);return(!i||null!==(t=e.index)&&i.version<t.version)&&a(e),l.get(e)}}}function Kn(s,a,o,e){const l=e.isWebGL2;let h,u,c;this.setMode=function(e){h=e},this.setIndex=function(e){u=e.type,c=e.bytesPerElement},this.render=function(e,t){s.drawElements(h,t,u,e*c),o.update(t,h,1)},this.renderInstances=function(i,r,n){if(0!==n){let e,t;if(l)e=s,t="drawElementsInstanced";else if(e=a.get("ANGLE_instanced_arrays"),t="drawElementsInstancedANGLE",null===e)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");e[t](h,r,u,i*c,n),o.update(r,h,n)}}}function Jn(e){const r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(e,t,i){switch(r.calls++,t){case 4:r.triangles+=i*(e/3);break;case 1:r.lines+=i*(e/2);break;case 3:r.lines+=i*(e-1);break;case 2:r.lines+=i*e;break;case 0:r.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t)}}}}class Zn extends u{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ae,this.minFilter=Ae,this.wrapR=Ce,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}function Qn(e,t){return e[0]-t[0]}function es(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ts(e,t){let i=1;t=(t.isInterleavedBufferAttribute?t.data:t).array;t instanceof Int8Array?i=127:t instanceof Int16Array?i=32767:t instanceof Int32Array?i=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",t),e.divideScalar(i)}function is(S,E,i){const M={},C=new Float32Array(8),A=new WeakMap,L=new Pe,I=[];for(let e=0;e<8;e++)I[e]=[e,0];return{update:function(r,n,e,s){var a=r.morphTargetInfluences;if(!0===E.isWebGL2){var o=n.morphAttributes.position.length;let e=A.get(n);if(void 0===e||e.count!==o){void 0!==e&&e.texture.dispose();var l=void 0!==n.morphAttributes.normal,h=n.morphAttributes.position,u=n.morphAttributes.normal||[],r=!0==l?2:1;let t=n.attributes.position.count*r,i=1;t>E.maxTextureSize&&(i=Math.ceil(t/E.maxTextureSize),t=E.maxTextureSize);const x=new Float32Array(t*i*4*o),w=new Zn(x,t,i,o);w.format=Le,w.type=Xe,w.needsUpdate=!0;var c=4*r;for(let e=0;e<o;e++){var d=h[e],p=u[e],f=t*i*4*e;for(let e=0;e<d.count;e++){L.fromBufferAttribute(d,e),!0===d.normalized&&ts(L,d);var m=e*c;x[f+m]=L.x,x[f+m+1]=L.y,x[f+m+2]=L.z,!(x[f+m+3]=0)==l&&(L.fromBufferAttribute(p,e),!0===p.normalized&&ts(L,p),x[f+m+4]=L.x,x[f+m+5]=L.y,x[f+m+6]=L.z,x[f+m+7]=0)}}e={count:o,texture:w,size:new W(t,i)},A.set(n,e),n.addEventListener("dispose",function e(){w.dispose(),A.delete(n),n.removeEventListener("dispose",e)})}let t=0;for(let e=0;e<a.length;e++)t+=a[e];r=n.morphTargetsRelative?1:1-t;s.getUniforms().setValue(S,"morphTargetBaseInfluence",r),s.getUniforms().setValue(S,"morphTargetInfluences",a),s.getUniforms().setValue(S,"morphTargetsTexture",e.texture,i),s.getUniforms().setValue(S,"morphTargetsTextureSize",e.size)}else{var g=void 0===a?0:a.length;let t=M[n.id];if(void 0===t||t.length!==g){t=[];for(let e=0;e<g;e++)t[e]=[e,0];M[n.id]=t}for(let e=0;e<g;e++){var v=t[e];v[0]=e,v[1]=a[e]}t.sort(es);for(let e=0;e<8;e++)e<g&&t[e][1]?(I[e][0]=t[e][0],I[e][1]=t[e][1]):(I[e][0]=Number.MAX_SAFE_INTEGER,I[e][1]=0);I.sort(Qn);var y=n.morphAttributes.position,_=n.morphAttributes.normal;let i=0;for(let e=0;e<8;e++){var b=I[e],T=b[0],b=b[1];T!==Number.MAX_SAFE_INTEGER&&b?(y&&n.getAttribute("morphTarget"+e)!==y[T]&&n.setAttribute("morphTarget"+e,y[T]),_&&n.getAttribute("morphNormal"+e)!==_[T]&&n.setAttribute("morphNormal"+e,_[T]),C[e]=b,i+=b):(y&&!0===n.hasAttribute("morphTarget"+e)&&n.deleteAttribute("morphTarget"+e),_&&!0===n.hasAttribute("morphNormal"+e)&&n.deleteAttribute("morphNormal"+e),C[e]=0)}r=n.morphTargetsRelative?1:1-i;s.getUniforms().setValue(S,"morphTargetBaseInfluence",r),s.getUniforms().setValue(S,"morphTargetInfluences",C)}}}}function rs(e,r,n,s){let a=new WeakMap;function o(e){e=e.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(e){var t=s.render.frame,i=e.geometry,i=r.get(e,i);return a.get(i)!==t&&(r.update(i),a.set(i,t)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor)&&n.update(e.instanceColor,34962),i},dispose:function(){a=new WeakMap}}}Zn.prototype.isDataTexture2DArray=!0;class ns extends u{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ae,this.minFilter=Ae,this.wrapR=Ce,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ns.prototype.isDataTexture3D=!0;const ss=new u,as=new Zn,os=new ns,ls=new hn,hs=[],us=[],cs=new Float32Array(16),ds=new Float32Array(9),ps=new Float32Array(4);function fs(i,r,n){var e=i[0];if(e<=0||0<e)return i;var t=r*n;let s=hs[t];if(void 0===s&&(s=new Float32Array(t),hs[t]=s),0!==r){e.toArray(s,0);for(let e=1,t=0;e!==r;++e)t+=n,i[e].toArray(s,t)}return s}function s(i,r){if(i.length===r.length){for(let e=0,t=i.length;e<t;e++)if(i[e]!==r[e])return;return 1}}function o(i,r){for(let e=0,t=r.length;e<t;e++)i[e]=r[e]}function ms(t,i){let r=us[i];void 0===r&&(r=new Int32Array(i),us[i]=r);for(let e=0;e!==i;++e)r[e]=t.allocateTextureUnit();return r}function gs(e,t){var i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function vs(e,t){var i=this.cache;void 0!==t.x?i[0]===t.x&&i[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y):s(i,t)||(e.uniform2fv(this.addr,t),o(i,t))}function ys(e,t){var i=this.cache;void 0!==t.x?i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z):void 0!==t.r?i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b):s(i,t)||(e.uniform3fv(this.addr,t),o(i,t))}function _s(e,t){var i=this.cache;void 0!==t.x?i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w):s(i,t)||(e.uniform4fv(this.addr,t),o(i,t))}function bs(e,t){var i=this.cache,r=t.elements;void 0===r?s(i,t)||(e.uniformMatrix2fv(this.addr,!1,t),o(i,t)):s(i,r)||(ps.set(r),e.uniformMatrix2fv(this.addr,!1,ps),o(i,r))}function Ts(e,t){var i=this.cache,r=t.elements;void 0===r?s(i,t)||(e.uniformMatrix3fv(this.addr,!1,t),o(i,t)):s(i,r)||(ds.set(r),e.uniformMatrix3fv(this.addr,!1,ds),o(i,r))}function xs(e,t){var i=this.cache,r=t.elements;void 0===r?s(i,t)||(e.uniformMatrix4fv(this.addr,!1,t),o(i,t)):s(i,r)||(cs.set(r),e.uniformMatrix4fv(this.addr,!1,cs),o(i,r))}function ws(e,t){var i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function Ss(e,t){var i=this.cache;s(i,t)||(e.uniform2iv(this.addr,t),o(i,t))}function Es(e,t){var i=this.cache;s(i,t)||(e.uniform3iv(this.addr,t),o(i,t))}function Ms(e,t){var i=this.cache;s(i,t)||(e.uniform4iv(this.addr,t),o(i,t))}function Cs(e,t){var i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function As(e,t){var i=this.cache;s(i,t)||(e.uniform2uiv(this.addr,t),o(i,t))}function Ls(e,t){var i=this.cache;s(i,t)||(e.uniform3uiv(this.addr,t),o(i,t))}function Is(e,t){var i=this.cache;s(i,t)||(e.uniform4uiv(this.addr,t),o(i,t))}function Ps(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.safeSetTexture2D(t||ss,n)}function Rs(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||os,n)}function ks(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.safeSetTextureCube(t||ls,n)}function Ds(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||as,n)}function Os(e,t){e.uniform1fv(this.addr,t)}function Ns(e,t){t=fs(t,this.size,2);e.uniform2fv(this.addr,t)}function Us(e,t){t=fs(t,this.size,3);e.uniform3fv(this.addr,t)}function Bs(e,t){t=fs(t,this.size,4);e.uniform4fv(this.addr,t)}function Fs(e,t){t=fs(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,t)}function Hs(e,t){t=fs(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,t)}function zs(e,t){t=fs(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,t)}function Vs(e,t){e.uniform1iv(this.addr,t)}function Gs(e,t){e.uniform2iv(this.addr,t)}function Ws(e,t){e.uniform3iv(this.addr,t)}function js(e,t){e.uniform4iv(this.addr,t)}function qs(e,t){e.uniform1uiv(this.addr,t)}function Xs(e,t){e.uniform2uiv(this.addr,t)}function Ys(e,t){e.uniform3uiv(this.addr,t)}function $s(e,t){e.uniform4uiv(this.addr,t)}function Ks(e,t,i){var r=t.length,n=ms(i,r);e.uniform1iv(this.addr,n);for(let e=0;e!==r;++e)i.safeSetTexture2D(t[e]||ss,n[e])}function Js(e,t,i){var r=t.length,n=ms(i,r);e.uniform1iv(this.addr,n);for(let e=0;e!==r;++e)i.setTexture3D(t[e]||os,n[e])}function Zs(e,t,i){var r=t.length,n=ms(i,r);e.uniform1iv(this.addr,n);for(let e=0;e!==r;++e)i.safeSetTextureCube(t[e]||ls,n[e])}function Qs(e,t,i){var r=t.length,n=ms(i,r);e.uniform1iv(this.addr,n);for(let e=0;e!==r;++e)i.setTexture2DArray(t[e]||as,n[e])}function ea(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function(){switch(t.type){case 5126:return gs;case 35664:return vs;case 35665:return ys;case 35666:return _s;case 35674:return bs;case 35675:return Ts;case 35676:return xs;case 5124:case 35670:return ws;case 35667:case 35671:return Ss;case 35668:case 35672:return Es;case 35669:case 35673:return Ms;case 5125:return Cs;case 36294:return As;case 36295:return Ls;case 36296:return Is;case 35678:case 36198:case 36298:case 36306:case 35682:return Ps;case 35679:case 36299:case 36307:return Rs;case 35680:case 36300:case 36308:case 36293:return ks;case 36289:case 36303:case 36311:case 36292:return Ds}}()}function ta(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(){switch(t.type){case 5126:return Os;case 35664:return Ns;case 35665:return Us;case 35666:return Bs;case 35674:return Fs;case 35675:return Hs;case 35676:return zs;case 5124:case 35670:return Vs;case 35667:case 35671:return Gs;case 35668:case 35672:return Ws;case 35669:case 35673:return js;case 5125:return qs;case 36294:return Xs;case 36295:return Ys;case 36296:return $s;case 35678:case 36198:case 36298:case 36306:case 35682:return Ks;case 35679:case 36299:case 36307:return Js;case 35680:case 36300:case 36308:case 36293:return Zs;case 36289:case 36303:case 36311:case 36292:return Qs}}()}function ia(e){this.id=e,this.seq=[],this.map={}}ta.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),o(t,e)},ia.prototype.setValue=function(i,r,n){var s=this.seq;for(let e=0,t=s.length;e!==t;++e){var a=s[e];a.setValue(i,r[a.id],n)}};const ra=/(\w+)(\])?(\[|\.)?/g;function na(e,t){e.seq.push(t),e.map[t.id]=t}function sa(t,i){this.seq=[],this.map={};const r=t.getProgramParameter(i,35718);for(let e=0;e<r;++e){const r=t.getActiveUniform(i,e);c=u=h=l=o=a=s=n=void 0;var n=r,s=t.getUniformLocation(i,r.name),a=this,o=n.name,l=o.length;for(ra.lastIndex=0;;){var h=ra.exec(o),u=ra.lastIndex;let t=h[1];var c="]"===h[2],h=h[3];if(c&&(t|=0),void 0===h||"["===h&&u+2===l){na(a,new(void 0===h?ea:ta)(t,n,s));break}{let e=a.map[t];void 0===e&&na(a,e=new ia(t)),a=e}}}}function aa(e,t,i){t=e.createShader(t);return e.shaderSource(t,i),e.compileShader(t),t}sa.prototype.setValue=function(e,t,i,r){t=this.map[t];void 0!==t&&t.setValue(e,i,r)},sa.prototype.setOptional=function(e,t,i){t=t[i];void 0!==t&&this.setValue(e,i,t)},sa.upload=function(i,r,n,s){for(let e=0,t=r.length;e!==t;++e){var a=r[e],o=n[a.id];!1!==o.needsUpdate&&a.setValue(i,o.value,s)}},sa.seqWithValue=function(i,r){var n=[];for(let e=0,t=i.length;e!==t;++e){var s=i[e];s.id in r&&n.push(s)}return n};let oa=0;function la(e,i,t){var r=e.getShaderParameter(i,35713),n=e.getShaderInfoLog(i).trim();return r&&""===n?"":t.toUpperCase()+"\n\n"+n+"\n\n"+function(){var t=e.getShaderSource(i).split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}()}function ha(e){return""!==e}function ua(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function ca(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const da=/^[ \t]*#include +<([\w\d./]+)>/gm;function pa(e){return e.replace(da,fa)}function fa(e,t){var i=x[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return pa(i)}const ma=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ga=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function va(e){return e.replace(ga,_a).replace(ma,ya)}function ya(e,t,i,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),_a(0,t,i,r)}function _a(e,t,i,r){let n="";for(let e=parseInt(t);e<parseInt(i);e++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return n}function ba(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ta(i,r,n,e){const s=i.getContext(),t=n.defines;var a=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===C?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===A?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===L&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case N:case U:e="ENVMAP_TYPE_CUBE";break;case H:case z:e="ENVMAP_TYPE_CUBE_UV"}return e}(),u=function(){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case U:case z:e="ENVMAP_MODE_REFRACTION"}return e}(),c=function(){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case I:e="ENVMAP_BLENDING_MULTIPLY";break;case P:e="ENVMAP_BLENDING_MIX";break;case R:e="ENVMAP_BLENDING_ADD"}return e}(),d=n.isWebGL2?"":[n.extensionDerivatives||n.envMapCubeUV||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ha).join("\n"),p=function(e){var t=[];for(const r in e){var i=e[r];!1!==i&&t.push("#define "+r+" "+i)}return t.join("\n")}(t),f=s.createProgram();let m,g,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(0<(m=[p].filter(ha).join("\n")).length&&(m+="\n"),0<(g=[d,p].filter(ha).join("\n")).length&&(g+="\n")):(m=[ba(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ha).join("\n"),g=[d,ba(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ne?"#define TONE_MAPPING":"",n.toneMapping!==Ne?x.tonemapping_pars_fragment:"",n.toneMapping!==Ne?function(e,t){let i;switch(t){case k:i="Linear";break;case 2:i="Reinhard";break;case 3:i="OptimizedCineon";break;case O:i="ACESFilmic";break;case 5:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.transparent?"":"#define OPAQUE",x.encodings_pars_fragment,(y="linearToOutputTexel",_=function(e){switch(e){case Ft:return["Linear","( value )"];case G:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(_=n.outputEncoding),"vec4 "+y+"( vec4 value ) { return LinearTo"+_[0]+_[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ha).join("\n")),a=ca(ua(pa(a),n),n),o=ca(ua(pa(o),n),n),a=va(a),o=va(o),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",n.glslVersion===Gt?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Gt?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);var y=v+g+o,_=aa(s,35633,v+m+a),o=aa(s,35632,y);if(s.attachShader(f,_),s.attachShader(f,o),void 0!==n.index0AttributeName?s.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&s.bindAttribLocation(f,0,"position"),s.linkProgram(f),i.debug.checkShaderErrors){const i=s.getProgramInfoLog(f).trim(),r=s.getShaderInfoLog(_).trim(),n=s.getShaderInfoLog(o).trim();let e=!0,t=!0;if(!1===s.getProgramParameter(f,35714)){e=!1;const r=la(s,_,"vertex"),n=la(s,o,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(f,35715)+"\n\nProgram Info Log: "+i+"\n"+r+"\n"+n)}else""!==i?console.warn("THREE.WebGLProgram: Program Info Log:",i):""!==r&&""!==n||(t=!1);t&&(this.diagnostics={runnable:e,programLog:i,vertexShader:{log:r,prefix:m},fragmentShader:{log:n,prefix:g}})}let b,T;return s.deleteShader(_),s.deleteShader(o),this.getUniforms=function(){return b=void 0===b?new sa(s,f):b},this.getAttributes=function(){return T=void 0===T?function(i,r){const n={},s=i.getProgramParameter(r,35721);for(let t=0;t<s;t++){const s=i.getActiveAttrib(r,t),a=s.name;let e=1;35674===s.type&&(e=2),35675===s.type&&(e=3),35676===s.type&&(e=4),n[a]={type:s.type,location:i.getAttribLocation(r,a),locationSize:e}}return n}(s,f):T},this.destroy=function(){e.releaseStatesOfProgram(this),s.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=oa++,this.cacheKey=r,this.usedTimes=1,this.program=f,this.vertexShader=_,this.fragmentShader=o,this}let xa=0;class wa{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){var t=e.vertexShader,i=e.fragmentShader,t=this._getShaderStage(t),i=this._getShaderStage(i),e=this._getShaderCacheForMaterial(e);return!1===e.has(t)&&(e.add(t),t.usedTimes++),!1===e.has(i)&&(e.add(i),i.usedTimes++),this}remove(e){var t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){var t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){var t,i=this.shaderCache;return!1===i.has(e)&&(t=new Sa,i.set(e,t)),i.get(e)}}class Sa{constructor(){this.id=xa++,this.usedTimes=0}}function Ea(m,g,v,y,_,e,b){const n=new rr,T=new wa,s=[],x=_.isWebGL2,w=_.logarithmicDepthBuffer,S=_.floatVertexTextures,E=_.maxVertexUniforms,M=_.vertexTextures;let C=_.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(e,t,i,r,n){var s=r.fog,r=e.isMeshStandardMaterial?r.environment:null,r=(e.isMeshStandardMaterial?v:g).get(e.envMap||r),a=A[e.type],o=n.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(S)return 1024;{const e=E,i=Math.floor((e-20)/4),r=Math.min(i,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}}(n):0;let l,h,u,c;if(null!==e.precision&&(C=_.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",C,"instead."),a){const m=Tn[a];l=m.vertexShader,h=m.fragmentShader}else l=e.vertexShader,h=e.fragmentShader,T.update(e),u=T.getVertexShaderID(e),c=T.getFragmentShaderID(e);var d=m.getRenderTarget(),p=0<e.alphaTest,f=0<e.clearcoat;return{isWebGL2:x,shaderID:a,shaderName:e.type,vertexShader:l,fragmentShader:h,defines:e.defines,customVertexShaderID:u,customFragmentShaderID:c,isRawShaderMaterial:!0===e.isRawShaderMaterial,glslVersion:e.glslVersion,precision:C,instancing:!0===n.isInstancedMesh,instancingColor:!0===n.isInstancedMesh&&null!==n.instanceColor,supportsVertexTextures:M,outputEncoding:null===d?m.outputEncoding:!0===d.isXRRenderTarget?d.texture.encoding:Ft,map:!!e.map,matcap:!!e.matcap,envMap:!!r,envMapMode:r&&r.mapping,envMapCubeUV:!!r&&(r.mapping===H||r.mapping===z),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Vt,tangentSpaceNormalMap:e.normalMapType===zt,decodeVideoTexture:!!e.map&&!0===e.map.isVideoTexture&&e.map.encoding===G,clearcoat:f,clearcoatMap:f&&!!e.clearcoatMap,clearcoatRoughnessMap:f&&!!e.clearcoatRoughnessMap,clearcoatNormalMap:f&&!!e.clearcoatNormalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,specularIntensityMap:!!e.specularIntensityMap,specularColorMap:!!e.specularColorMap,transparent:e.transparent,alphaMap:!!e.alphaMap,alphaTest:p,gradientMap:!!e.gradientMap,sheen:0<e.sheen,sheenColorMap:!!e.sheenColorMap,sheenRoughnessMap:!!e.sheenRoughnessMap,transmission:0<e.transmission,transmissionMap:!!e.transmissionMap,thicknessMap:!!e.thicknessMap,combine:e.combine,vertexTangents:!!e.normalMap&&!!n.geometry&&!!n.geometry.attributes.tangent,vertexColors:e.vertexColors,vertexAlphas:!0===e.vertexColors&&!!n.geometry&&!!n.geometry.attributes.color&&4===n.geometry.attributes.color.itemSize,vertexUvs:!!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatMap||e.clearcoatRoughnessMap||e.clearcoatNormalMap||e.displacementMap||e.transmissionMap||e.thicknessMap||e.specularIntensityMap||e.specularColorMap||e.sheenColorMap||e.sheenRoughnessMap),uvsVertexOnly:!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatNormalMap||0<e.transmission||e.transmissionMap||e.thicknessMap||e.specularIntensityMap||e.specularColorMap||0<e.sheen||e.sheenColorMap||e.sheenRoughnessMap||!e.displacementMap),fog:!!s,useFog:e.fog,fogExp2:s&&s.isFogExp2,flatShading:!!e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:w,skinning:!0===n.isSkinnedMesh&&0<o,maxBones:o,useVertexTexture:S,morphTargets:!!n.geometry&&!!n.geometry.morphAttributes.position,morphNormals:!!n.geometry&&!!n.geometry.morphAttributes.normal,morphTargetsCount:n.geometry&&n.geometry.morphAttributes.position?n.geometry.morphAttributes.position.length:0,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numDirLightShadows:t.directionalShadowMap.length,numPointLightShadows:t.pointShadowMap.length,numSpotLightShadows:t.spotShadowMap.length,numClippingPlanes:b.numPlanes,numClipIntersection:b.numIntersection,dithering:e.dithering,shadowMapEnabled:m.shadowMap.enabled&&0<i.length,shadowMapType:m.shadowMap.type,toneMapping:e.toneMapped?m.toneMapping:Ne,physicallyCorrectLights:m.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,doubleSided:e.side===Oe,flipSided:e.side===Me,depthPacking:void 0!==e.depthPacking&&e.depthPacking,index0AttributeName:e.index0AttributeName,extensionDerivatives:e.extensions&&e.extensions.derivatives,extensionFragDepth:e.extensions&&e.extensions.fragDepth,extensionDrawBuffers:e.extensions&&e.extensions.drawBuffers,extensionShaderTextureLOD:e.extensions&&e.extensions.shaderTextureLOD,rendererExtensionFragDepth:x||y.has("EXT_frag_depth"),rendererExtensionDrawBuffers:x||y.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:x||y.has("EXT_shader_texture_lod"),customProgramCacheKey:e.customProgramCacheKey()}},getProgramCacheKey:function(e){var t,i,r=[];if(e.shaderID?r.push(e.shaderID):(r.push(e.customVertexShaderID),r.push(e.customFragmentShaderID)),void 0!==e.defines)for(const m in e.defines)r.push(m),r.push(e.defines[m]);return!1===e.isRawShaderMaterial&&((t=r).push((i=e).precision),t.push(i.outputEncoding),t.push(i.envMapMode),t.push(i.combine),t.push(i.vertexUvs),t.push(i.fogExp2),t.push(i.sizeAttenuation),t.push(i.maxBones),t.push(i.morphTargetsCount),t.push(i.numDirLights),t.push(i.numPointLights),t.push(i.numSpotLights),t.push(i.numHemiLights),t.push(i.numRectAreaLights),t.push(i.numDirLightShadows),t.push(i.numPointLightShadows),t.push(i.numSpotLightShadows),t.push(i.shadowMapType),t.push(i.toneMapping),t.push(i.numClippingPlanes),t.push(i.numClipIntersection),t=r,i=e,n.disableAll(),i.isWebGL2&&n.enable(0),i.supportsVertexTextures&&n.enable(1),i.instancing&&n.enable(2),i.instancingColor&&n.enable(3),i.map&&n.enable(4),i.matcap&&n.enable(5),i.envMap&&n.enable(6),i.envMapCubeUV&&n.enable(7),i.lightMap&&n.enable(8),i.aoMap&&n.enable(9),i.emissiveMap&&n.enable(10),i.bumpMap&&n.enable(11),i.normalMap&&n.enable(12),i.objectSpaceNormalMap&&n.enable(13),i.tangentSpaceNormalMap&&n.enable(14),i.clearcoat&&n.enable(15),i.clearcoatMap&&n.enable(16),i.clearcoatRoughnessMap&&n.enable(17),i.clearcoatNormalMap&&n.enable(18),i.displacementMap&&n.enable(19),i.specularMap&&n.enable(20),i.roughnessMap&&n.enable(21),i.metalnessMap&&n.enable(22),i.gradientMap&&n.enable(23),i.alphaMap&&n.enable(24),i.alphaTest&&n.enable(25),i.vertexColors&&n.enable(26),i.vertexAlphas&&n.enable(27),i.vertexUvs&&n.enable(28),i.vertexTangents&&n.enable(29),i.uvsVertexOnly&&n.enable(30),i.fog&&n.enable(31),t.push(n.mask),n.disableAll(),i.useFog&&n.enable(0),i.flatShading&&n.enable(1),i.logarithmicDepthBuffer&&n.enable(2),i.skinning&&n.enable(3),i.useVertexTexture&&n.enable(4),i.morphTargets&&n.enable(5),i.morphNormals&&n.enable(6),i.premultipliedAlpha&&n.enable(7),i.shadowMapEnabled&&n.enable(8),i.physicallyCorrectLights&&n.enable(9),i.doubleSided&&n.enable(10),i.flipSided&&n.enable(11),i.depthPacking&&n.enable(12),i.dithering&&n.enable(13),i.specularIntensityMap&&n.enable(14),i.specularColorMap&&n.enable(15),i.transmission&&n.enable(16),i.transmissionMap&&n.enable(17),i.thicknessMap&&n.enable(18),i.sheen&&n.enable(19),i.sheenColorMap&&n.enable(20),i.sheenRoughnessMap&&n.enable(21),i.decodeVideoTexture&&n.enable(22),i.transparent&&n.enable(23),t.push(n.mask),r.push(m.outputEncoding)),r.push(e.customProgramCacheKey),r.join()},getUniforms:function(e){var t=A[e.type];let i;if(t){const e=Tn[t];i=sn.clone(e.uniforms)}else i=e.uniforms;return i},acquireProgram:function(i,r){let n;for(let e=0,t=s.length;e<t;e++){const i=s[e];if(i.cacheKey===r){++(n=i).usedTimes;break}}return void 0===n&&(n=new Ta(m,r,i,e),s.push(n)),n},releaseProgram:function(e){var t;0==--e.usedTimes&&(t=s.indexOf(e),s[t]=s[s.length-1],s.pop(),e.destroy())},releaseShaderCache:function(e){T.remove(e)},programs:s,dispose:function(){T.dispose()}}}function Ma(){let r=new WeakMap;return{get:function(e){let t=r.get(e);return void 0===t&&(t={},r.set(e,t)),t},remove:function(e){r.delete(e)},update:function(e,t,i){r.get(e)[t]=i},dispose:function(){r=new WeakMap}}}function Ca(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Aa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function La(){const o=[];let l=0;const a=[],h=[],u=[];function c(e,t,i,r,n,s){let a=o[l];return void 0===a?(a={id:e.id,object:e,geometry:t,material:i,groupOrder:r,renderOrder:e.renderOrder,z:n,group:s},o[l]=a):(a.id=e.id,a.object=e,a.geometry=t,a.material=i,a.groupOrder=r,a.renderOrder=e.renderOrder,a.z=n,a.group=s),l++,a}return{opaque:a,transmissive:h,transparent:u,init:function(){l=0,a.length=0,h.length=0,u.length=0},push:function(e,t,i,r,n,s){e=c(e,t,i,r,n,s);(0<i.transmission?h:!0===i.transparent?u:a).push(e)},unshift:function(e,t,i,r,n,s){e=c(e,t,i,r,n,s);(0<i.transmission?h:!0===i.transparent?u:a).unshift(e)},finish:function(){for(let e=l,t=o.length;e<t;e++){const l=o[e];if(null===l.id)break;l.id=null,l.object=null,l.geometry=null,l.material=null,l.group=null}},sort:function(e,t){1<a.length&&a.sort(e||Ca),1<h.length&&h.sort(t||Aa),1<u.length&&u.sort(t||Aa)}}}function Ia(){let r=new WeakMap;return{get:function(e,t){let i;return!1===r.has(e)?(i=new La,r.set(e,[i])):t>=r.get(e).length?(i=new La,r.get(e).push(i)):i=r.get(e)[t],i},dispose:function(){r=new WeakMap}}}function Pa(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Pe,color:new m};break;case"SpotLight":t={position:new Pe,direction:new Pe,color:new m,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Pe,color:new m,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Pe,skyColor:new m,groundColor:new m};break;case"RectAreaLight":t={color:new m,position:new Pe,halfWidth:new Pe,halfHeight:new Pe}}return i[e.id]=t}}}let Ra=0;function ka(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Da(_,b){const T=new Pa,x=function(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new W,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t}}}(),w={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)w.probe.push(new Pe);const u=new Pe,c=new Re,d=new Re;return{setup:function(i,r){let n=0,s=0,a=0;for(let e=0;e<9;e++)w.probe[e].set(0,0,0);let o=0,l=0,h=0,u=0,c=0,d=0,p=0,f=0;i.sort(ka);var m=!0!==r?Math.PI:1;for(let e=0,t=i.length;e<t;e++){const b=i[e],r=b.color,g=b.intensity,v=b.distance,y=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)n+=r.r*g*m,s+=r.g*g*m,a+=r.b*g*m;else if(b.isLightProbe)for(let e=0;e<9;e++)w.probe[e].addScaledVector(b.sh.coefficients[e],g);else if(b.isDirectionalLight){const _=T.get(b);if(_.color.copy(b.color).multiplyScalar(b.intensity*m),b.castShadow){const _=b.shadow,T=x.get(b);T.shadowBias=_.bias,T.shadowNormalBias=_.normalBias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize,w.directionalShadow[o]=T,w.directionalShadowMap[o]=y,w.directionalShadowMatrix[o]=b.shadow.matrix,d++}w.directional[o]=_,o++}else if(b.isSpotLight){const _=T.get(b);if(_.position.setFromMatrixPosition(b.matrixWorld),_.color.copy(r).multiplyScalar(g*m),_.distance=v,_.coneCos=Math.cos(b.angle),_.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),_.decay=b.decay,b.castShadow){const _=b.shadow,T=x.get(b);T.shadowBias=_.bias,T.shadowNormalBias=_.normalBias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize,w.spotShadow[h]=T,w.spotShadowMap[h]=y,w.spotShadowMatrix[h]=b.shadow.matrix,f++}w.spot[h]=_,h++}else if(b.isRectAreaLight){const _=T.get(b);_.color.copy(r).multiplyScalar(g),_.halfWidth.set(.5*b.width,0,0),_.halfHeight.set(0,.5*b.height,0),w.rectArea[u]=_,u++}else if(b.isPointLight){const _=T.get(b);if(_.color.copy(b.color).multiplyScalar(b.intensity*m),_.distance=b.distance,_.decay=b.decay,b.castShadow){const _=b.shadow,T=x.get(b);T.shadowBias=_.bias,T.shadowNormalBias=_.normalBias,T.shadowRadius=_.radius,T.shadowMapSize=_.mapSize,T.shadowCameraNear=_.camera.near,T.shadowCameraFar=_.camera.far,w.pointShadow[l]=T,w.pointShadowMap[l]=y,w.pointShadowMatrix[l]=b.shadow.matrix,p++}w.point[l]=_,l++}else if(b.isHemisphereLight){const _=T.get(b);_.skyColor.copy(b.color).multiplyScalar(g*m),_.groundColor.copy(b.groundColor).multiplyScalar(g*m),w.hemi[c]=_,c++}}0<u&&(b.isWebGL2||!0===_.has("OES_texture_float_linear")?(w.rectAreaLTC1=M.LTC_FLOAT_1,w.rectAreaLTC2=M.LTC_FLOAT_2):!0===_.has("OES_texture_half_float_linear")?(w.rectAreaLTC1=M.LTC_HALF_1,w.rectAreaLTC2=M.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),w.ambient[0]=n,w.ambient[1]=s,w.ambient[2]=a;const g=w.hash;g.directionalLength===o&&g.pointLength===l&&g.spotLength===h&&g.rectAreaLength===u&&g.hemiLength===c&&g.numDirectionalShadows===d&&g.numPointShadows===p&&g.numSpotShadows===f||(w.directional.length=o,w.spot.length=h,w.rectArea.length=u,w.point.length=l,w.hemi.length=c,w.directionalShadow.length=d,w.directionalShadowMap.length=d,w.pointShadow.length=p,w.pointShadowMap.length=p,w.spotShadow.length=f,w.spotShadowMap.length=f,w.directionalShadowMatrix.length=d,w.pointShadowMatrix.length=p,w.spotShadowMatrix.length=f,g.directionalLength=o,g.pointLength=l,g.spotLength=h,g.rectAreaLength=u,g.hemiLength=c,g.numDirectionalShadows=d,g.numPointShadows=p,g.numSpotShadows=f,w.version=Ra++)},setupView:function(i,e){let r=0,n=0,s=0,a=0,o=0;var l=e.matrixWorldInverse;for(let e=0,t=i.length;e<t;e++){var h=i[e];if(h.isDirectionalLight){const i=w.directional[r];i.direction.setFromMatrixPosition(h.matrixWorld),u.setFromMatrixPosition(h.target.matrixWorld),i.direction.sub(u),i.direction.transformDirection(l),r++}else if(h.isSpotLight){const i=w.spot[s];i.position.setFromMatrixPosition(h.matrixWorld),i.position.applyMatrix4(l),i.direction.setFromMatrixPosition(h.matrixWorld),u.setFromMatrixPosition(h.target.matrixWorld),i.direction.sub(u),i.direction.transformDirection(l),s++}else if(h.isRectAreaLight){const i=w.rectArea[a];i.position.setFromMatrixPosition(h.matrixWorld),i.position.applyMatrix4(l),d.identity(),c.copy(h.matrixWorld),c.premultiply(l),d.extractRotation(c),i.halfWidth.set(.5*h.width,0,0),i.halfHeight.set(0,.5*h.height,0),i.halfWidth.applyMatrix4(d),i.halfHeight.applyMatrix4(d),a++}else if(h.isPointLight){const i=w.point[n];i.position.setFromMatrixPosition(h.matrixWorld),i.position.applyMatrix4(l),n++}else if(h.isHemisphereLight){const i=w.hemi[o];i.direction.setFromMatrixPosition(h.matrixWorld),i.direction.transformDirection(l),i.direction.normalize(),o++}}},state:w}}function Oa(e,t){const i=new Da(e,t),r=[],n=[];return{init:function(){r.length=0,n.length=0},state:{lightsArray:r,shadowsArray:n,lights:i},setupLights:function(e){i.setup(r,e)},setupLightsView:function(e){i.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){n.push(e)}}}function Na(r,n){let s=new WeakMap;return{get:function(e,t=0){let i;return!1===s.has(e)?(i=new Oa(r,n),s.set(e,[i])):t>=s.get(e).length?(i=new Oa(r,n),s.get(e).push(i)):i=s.get(e)[t],i},dispose:function(){s=new WeakMap}}}class Ua extends e{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Ua.prototype.isMeshDepthMaterial=!0;class Ba extends e{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Pe,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Ba.prototype.isMeshDistanceMaterial=!0;const Fa="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Ha="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function za(d,p,e){let f=new vn;const m=new W,g=new W,v=new Ie,l=new Ua({depthPacking:Ht}),h=new Ba,u={},y=e.maxTextureSize,c={0:Me,1:De,2:Oe},_=new an({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new W},radius:{value:4}},vertexShader:Fa,fragmentShader:Ha}),b=_.clone();b.defines.HORIZONTAL_PASS=1;e=new w;e.setAttribute("position",new E(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new S(e,_),t=this;function x(i,e,r,t,n,s,a){let o=null;i=!0===t.isPointLight?i.customDistanceMaterial:i.customDepthMaterial;if(o=void 0!==i?i:!0===t.isPointLight?h:l,d.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&0<r.alphaTest){const d=o.uuid,i=r.uuid;let e=u[d],t=(void 0===e&&(e={},u[d]=e),e[i]);void 0===t&&(t=o.clone(),e[i]=t),o=t}return o.visible=r.visible,o.wireframe=r.wireframe,o.side=a===L?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:c[r.side],o.alphaMap=r.alphaMap,o.alphaTest=r.alphaTest,o.clipShadows=r.clipShadows,o.clippingPlanes=r.clippingPlanes,o.clipIntersection=r.clipIntersection,o.displacementMap=r.displacementMap,o.displacementScale=r.displacementScale,o.displacementBias=r.displacementBias,o.wireframeLinewidth=r.wireframeLinewidth,o.linewidth=r.linewidth,!0===t.isPointLight&&!0===o.isMeshDistanceMaterial&&(o.referencePosition.setFromMatrixPosition(t.matrixWorld),o.nearDistance=n,o.farDistance=s),o}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=C,this.render=function(i,r,n){if(!1!==t.enabled&&(!1!==t.autoUpdate||!1!==t.needsUpdate)&&0!==i.length){const e=d.getRenderTarget(),h=d.getActiveCubeFace(),u=d.getActiveMipmapLevel(),c=d.state;c.setBlending(X),c.buffers.color.setClear(1,1,1,1),c.buffers.depth.setTest(!0),c.setScissorTest(!1);for(let e=0,t=i.length;e<t;e++){const h=i[e],u=h.shadow;if(void 0===u)console.warn("THREE.WebGLShadowMap:",h,"has no shadow.");else if(!1!==u.autoUpdate||!1!==u.needsUpdate){m.copy(u.mapSize);const X=u.getFrameExtents();if(m.multiply(X),g.copy(u.mapSize),(m.x>y||m.y>y)&&(m.x>y&&(g.x=Math.floor(y/X.x),m.x=g.x*X.x,u.mapSize.x=g.x),m.y>y)&&(g.y=Math.floor(y/X.y),m.y=g.y*X.y,u.mapSize.y=g.y),null===u.map&&!u.isPointLightShadow&&this.type===L){const d={minFilter:V,magFilter:V,format:Le};u.map=new mi(m.x,m.y,d),u.map.texture.name=h.name+".shadowMap",u.mapPass=new mi(m.x,m.y,d),u.camera.updateProjectionMatrix()}if(null===u.map){const d={minFilter:Ae,magFilter:Ae,format:Le};u.map=new mi(m.x,m.y,d),u.map.texture.name=h.name+".shadowMap",u.camera.updateProjectionMatrix()}d.setRenderTarget(u.map),d.clear();var s=u.getViewportCount();for(let e=0;e<s;e++){const i=u.getViewport(e);v.set(g.x*i.x,g.y*i.y,g.x*i.z,g.y*i.w),c.viewport(v),u.updateMatrices(h,e),f=u.getFrustum(),function i(r,n,s,a,o){if(!1!==r.visible){if(r.layers.test(n.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&o===L)&&(!r.frustumCulled||f.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);const f=p.update(r),n=r.material;if(Array.isArray(n)){const p=f.groups;for(let e=0,t=p.length;e<t;e++){const L=p[e],h=n[L.materialIndex];if(h&&h.visible){const p=x(r,0,h,a,s.near,s.far,o);d.renderBufferDirect(s,null,f,p,r,L)}}}else if(n.visible){const p=x(r,0,n,a,s.near,s.far,o);d.renderBufferDirect(s,null,f,p,r,null)}}var l=r.children;for(let e=0,t=l.length;e<t;e++)i(l[e],n,s,a,o)}}(r,n,u.camera,h,this.type)}u.isPointLightShadow||this.type!==L||(a=u,o=n,l=void 0,l=p.update(T),_.defines.VSM_SAMPLES!==a.blurSamples&&(_.defines.VSM_SAMPLES=a.blurSamples,b.defines.VSM_SAMPLES=a.blurSamples,_.needsUpdate=!0,b.needsUpdate=!0),_.uniforms.shadow_pass.value=a.map.texture,_.uniforms.resolution.value=a.mapSize,_.uniforms.radius.value=a.radius,d.setRenderTarget(a.mapPass),d.clear(),d.renderBufferDirect(o,null,l,_,T,null),b.uniforms.shadow_pass.value=a.mapPass.texture,b.uniforms.resolution.value=a.mapSize,b.uniforms.radius.value=a.radius,d.setRenderTarget(a.map),d.clear(),d.renderBufferDirect(o,null,l,b,T,null)),u.needsUpdate=!1}}var a,o,l;t.needsUpdate=!1,d.setRenderTarget(e,h,u)}}}function Va(u,N,U){const i=U.isWebGL2,r=new function(){let t=!1;const s=new Ie;let i=null;const a=new Ie(0,0,0,0);return{setMask:function(e){i===e||t||(u.colorMask(e,e,e,e),i=e)},setLocked:function(e){t=e},setClear:function(e,t,i,r,n){!0===n&&(e*=r,t*=r,i*=r),s.set(e,t,i,r),!1===a.equals(s)&&(u.clearColor(e,t,i,r),a.copy(s))},reset:function(){t=!1,i=null,a.set(-1,0,0,0)}}},n=new function(){let t=!1,i=null,r=null,n=null;return{setTest:function(e){(e?P:R)(2929)},setMask:function(e){i===e||t||(u.depthMask(e),i=e)},setFunc:function(e){if(r!==e){if(e)switch(e){case ye:u.depthFunc(512);break;case _e:u.depthFunc(519);break;case be:u.depthFunc(513);break;case Te:u.depthFunc(515);break;case xe:u.depthFunc(514);break;case we:u.depthFunc(518);break;case Se:u.depthFunc(516);break;case Ee:u.depthFunc(517);break;default:u.depthFunc(515)}else u.depthFunc(515);r=e}},setLocked:function(e){t=e},setClear:function(e){n!==e&&(u.clearDepth(e),n=e)},reset:function(){t=!1,i=null,r=null,n=null}}},s=new function(){let t=!1,i=null,r=null,n=null,s=null,a=null,o=null,l=null,h=null;return{setTest:function(e){t||(e?P:R)(2960)},setMask:function(e){i===e||t||(u.stencilMask(e),i=e)},setFunc:function(e,t,i){r===e&&n===t&&s===i||(u.stencilFunc(e,t,i),r=e,n=t,s=i)},setOp:function(e,t,i){a===e&&o===t&&l===i||(u.stencilOp(e,t,i),a=e,o=t,l=i)},setLocked:function(e){t=e},setClear:function(e){h!==e&&(u.clearStencil(e),h=e)},reset:function(){t=!1,i=null,r=null,n=null,s=null,a=null,o=null,l=null,h=null}}};let t={},a={},o=new WeakMap,B=[],l=null,h=!1,c=null,d=null,p=null,f=null,m=null,g=null,v=null,y=!1,_=null,b=null,T=null,x=null,w=null;const F=u.getParameter(35661);let S=!1,e=0;var E=u.getParameter(7938);-1!==E.indexOf("WebGL")?(e=parseFloat(/^WebGL (\d)/.exec(E)[1]),S=1<=e):-1!==E.indexOf("OpenGL ES")&&(e=parseFloat(/^OpenGL ES (\d)/.exec(E)[1]),S=2<=e);let M=null,C={};const H=u.getParameter(3088),z=u.getParameter(2978),A=(new Ie).fromArray(H),L=(new Ie).fromArray(z);function V(e,t,i){var r=new Uint8Array(4),n=u.createTexture();u.bindTexture(e,n),u.texParameteri(e,10241,9728),u.texParameteri(e,10240,9728);for(let e=0;e<i;e++)u.texImage2D(t+e,0,6408,1,1,0,6408,5121,r);return n}const I={};function P(e){!0!==t[e]&&(u.enable(e),t[e]=!0)}function R(e){!1!==t[e]&&(u.disable(e),t[e]=!1)}I[3553]=V(3553,3553,1),I[34067]=V(34067,34069,6),r.setClear(0,0,0,1),n.setClear(1),s.setClear(0),P(2929),n.setFunc(Te),G(!1),W($),P(2884),O(X);const k={[ie]:32774,[re]:32778,[ne]:32779};if(i)k[se]=32775,k[ae]=32776;else{const u=N.get("EXT_blend_minmax");null!==u&&(k[se]=u.MIN_EXT,k[ae]=u.MAX_EXT)}const D={[oe]:0,[le]:1,[he]:768,[ce]:770,[ve]:776,[me]:774,[pe]:772,[ue]:769,[de]:771,[ge]:775,[fe]:773};function O(e,t,i,r,n,s,a,o){if(e!==X){if(!1===h&&(P(3042),h=!0),e===te)n=n||t,s=s||i,a=a||r,t===d&&n===m||(u.blendEquationSeparate(k[t],k[n]),d=t,m=n),i===p&&r===f&&s===g&&a===v||(u.blendFuncSeparate(D[i],D[r],D[s],D[a]),p=i,f=r,g=s,v=a),c=e,y=null;else if(e!==c||o!==y){if(d===ie&&m===ie||(u.blendEquation(32774),d=ie,m=ie),o)switch(e){case J:u.blendFuncSeparate(1,771,1,771);break;case Z:u.blendFunc(1,1);break;case Q:u.blendFuncSeparate(0,769,0,1);break;case ee:u.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case J:u.blendFuncSeparate(770,771,1,771);break;case Z:u.blendFunc(770,1);break;case Q:u.blendFuncSeparate(0,769,0,1);break;case ee:u.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}p=null,f=null,g=null,v=null,c=e,y=o}}else!0===h&&(R(3042),h=!1)}function G(e){_!==e&&(e?u.frontFace(2304):u.frontFace(2305),_=e)}function W(e){e!==Y?(P(2884),e!==b&&(e===$?u.cullFace(1029):e===K?u.cullFace(1028):u.cullFace(1032))):R(2884),b=e}function j(e,t,i){e?(P(32823),x===t&&w===i||(u.polygonOffset(t,i),x=t,w=i)):R(32823)}function q(e){void 0===e&&(e=33984+F-1),M!==e&&(u.activeTexture(e),M=e)}return{buffers:{color:r,depth:n,stencil:s},enable:P,disable:R,bindFramebuffer:function(e,t){return a[e]!==t&&(u.bindFramebuffer(e,t),a[e]=t,i&&(36009===e&&(a[36160]=t),36160===e)&&(a[36009]=t),!0)},drawBuffers:function(e,t){let i=B,r=!1;if(e)if(void 0===(i=o.get(t))&&(i=[],o.set(t,i)),e.isWebGLMultipleRenderTargets){const u=e.texture;if(i.length!==u.length||36064!==i[0]){for(let e=0,t=u.length;e<t;e++)i[e]=36064+e;i.length=u.length,r=!0}}else 36064!==i[0]&&(i[0]=36064,r=!0);else 1029!==i[0]&&(i[0]=1029,r=!0);r&&(U.isWebGL2?u.drawBuffers(i):N.get("WEBGL_draw_buffers").drawBuffersWEBGL(i))},useProgram:function(e){return l!==e&&(u.useProgram(e),l=e,!0)},setBlending:O,setMaterial:function(e,t){(e.side===Oe?R:P)(2884);let i=e.side===Me;G(i=t?!i:i),e.blending===J&&!1===e.transparent?O(X):O(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),n.setFunc(e.depthFunc),n.setTest(e.depthTest),n.setMask(e.depthWrite),r.setMask(e.colorWrite);t=e.stencilWrite;s.setTest(t),t&&(s.setMask(e.stencilWriteMask),s.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),s.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),j(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),(!0===e.alphaToCoverage?P:R)(32926)},setFlipSided:G,setCullFace:W,setLineWidth:function(e){e!==T&&(S&&u.lineWidth(e),T=e)},setPolygonOffset:j,setScissorTest:function(e){(e?P:R)(3089)},activeTexture:q,bindTexture:function(e,t){null===M&&q();let i=C[M];void 0===i&&(i={type:void 0,texture:void 0},C[M]=i),i.type===e&&i.texture===t||(u.bindTexture(e,t||I[e]),i.type=e,i.texture=t)},unbindTexture:function(){var e=C[M];void 0!==e&&void 0!==e.type&&(u.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{u.compressedTexImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{u.texImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{u.texImage3D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage2D:function(){try{u.texStorage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{u.texStorage3D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{u.texSubImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{u.texSubImage3D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{u.compressedTexSubImage2D.apply(u,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===A.equals(e)&&(u.scissor(e.x,e.y,e.z,e.w),A.copy(e))},viewport:function(e){!1===L.equals(e)&&(u.viewport(e.x,e.y,e.z,e.w),L.copy(e))},reset:function(){u.disable(3042),u.disable(2884),u.disable(2929),u.disable(32823),u.disable(3089),u.disable(2960),u.disable(32926),u.blendEquation(32774),u.blendFunc(1,0),u.blendFuncSeparate(1,0,1,0),u.colorMask(!0,!0,!0,!0),u.clearColor(0,0,0,0),u.depthMask(!0),u.depthFunc(513),u.clearDepth(1),u.stencilMask(4294967295),u.stencilFunc(519,0,4294967295),u.stencilOp(7680,7680,7680),u.clearStencil(0),u.cullFace(1029),u.frontFace(2305),u.polygonOffset(0,0),u.activeTexture(33984),u.bindFramebuffer(36160,null),!0===i&&(u.bindFramebuffer(36009,null),u.bindFramebuffer(36008,null)),u.useProgram(null),u.lineWidth(1),u.scissor(0,0,u.canvas.width,u.canvas.height),u.viewport(0,0,u.canvas.width,u.canvas.height),t={},M=null,C={},a={},o=new WeakMap,B=[],l=null,h=!1,c=null,d=null,p=null,f=null,m=null,g=null,v=null,y=!1,_=null,b=null,T=null,x=null,w=null,A.set(0,0,u.canvas.width,u.canvas.height),L.set(0,0,u.canvas.width,u.canvas.height),r.reset(),n.reset(),s.reset()}}}function Ga(f,a,m,g,l,v,h){const y=l.isWebGL2,t=l.maxTextures,U=l.maxCubemapSize,B=l.maxTextureSize,F=l.maxSamples,u=a.has("WEBGL_multisampled_render_to_texture")?a.get("WEBGL_multisampled_render_to_texture"):void 0,s=new WeakMap;let o,i=!1;try{i="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(f){}function c(e,t){return i?new OffscreenCanvas(e,t):ni("canvas")}function _(e,t,i,r){let n=1;if((n=e.width>r||e.height>r?r/Math.max(e.width,e.height):n)<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const r=t?ti:Math.floor,s=r(n*e.width),a=r(n*e.height);void 0===o&&(o=c(s,a));t=i?c(s,a):o;return t.width=s,t.height=a,t.getContext("2d").drawImage(e,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+a+")."),t}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+").")}return e}function b(e){return Qt(e.width)&&Qt(e.height)}function T(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ae&&e.minFilter!==V}function x(e){f.generateMipmap(e)}function w(e,t,i,r,n=!1){if(!1===y)return t;if(null!==e){if(void 0!==f[e])return f[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let s=t;return 6403===t&&(5126===i&&(s=33326),5131===i&&(s=33325),5121===i)&&(s=33321),33319===t&&(5126===i&&(s=33328),5131===i&&(s=33327),5121===i)&&(s=33323),33325!==(s=6408===t&&(5126===i&&(s=34836),5131===i&&(s=34842),5121===i&&(s=r===G&&!1===n?35907:32856),32819===i&&(s=32854),32820===i)?32855:s)&&33326!==s&&33327!==s&&33328!==s&&34842!==s&&34836!==s||a.get("EXT_color_buffer_float"),s}function S(e,t,i){return!0===T(e,i)||e.isFramebufferTexture&&e.minFilter!==Ae&&e.minFilter!==V?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&0<e.mipmaps.length?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function r(e){return e===Ae||e===Ue||e===Be?9728:9729}function n(e){var t,i,e=e.target;e.removeEventListener("dispose",n),t=e,void 0!==(i=g.get(t)).__webglInit&&(f.deleteTexture(i.__webglTexture),g.remove(t)),e.isVideoTexture&&s.delete(e),h.memory.textures--}function d(e){e=e.target;e.removeEventListener("dispose",d);{const i=e.texture,r=g.get(e),t=g.get(i);if(e){if(void 0!==t.__webglTexture&&(f.deleteTexture(t.__webglTexture),h.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)f.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&f.deleteRenderbuffer(r.__webglDepthbuffer[e]);else f.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&f.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&f.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&f.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&f.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,t=i.length;e<t;e++){const r=g.get(i[e]);r.__webglTexture&&(f.deleteTexture(r.__webglTexture),h.memory.textures--),g.remove(i[e])}g.remove(i),g.remove(e)}}}let p=0;function E(e,t){var i,r,n=g.get(e);if(e.isVideoTexture&&(i=e,r=h.render.frame,s.get(i)!==r&&(s.set(i,r),i.update())),0<e.version&&n.__version!==e.version){const m=e.image;if(void 0===m)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==m.complete)return void P(n,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}m.activeTexture(33984+t),m.bindTexture(3553,n.__webglTexture)}function M(t,e){var i=g.get(t);if(0<t.version&&i.__version!==t.version){var r=i,n=t,s=e;if(6===n.image.length){I(r,n),m.activeTexture(33984+s),m.bindTexture(34067,r.__webglTexture),f.pixelStorei(37440,n.flipY),f.pixelStorei(37441,n.premultiplyAlpha),f.pixelStorei(3317,n.unpackAlignment),f.pixelStorei(37443,0);var a=n&&(n.isCompressedTexture||n.image[0].isCompressedTexture),o=n.image[0]&&n.image[0].isDataTexture,l=[];for(let e=0;e<6;e++)l[e]=a||o?o?n.image[e].image:n.image[e]:_(n.image[e],!1,!0,U),l[e]=N(n,l[e]);var s=l[0],t=b(s)||y,h=v.convert(n.format,n.encoding),u=v.convert(n.type),c=w(n.internalFormat,h,u,n.encoding),d=y&&!0!==n.isVideoTexture,p=void 0===r.__version;let i,e=S(n,s,t);if(L(34067,n,t),a){d&&p&&m.texStorage2D(34067,e,c,s.width,s.height);for(let t=0;t<6;t++){i=l[t].mipmaps;for(let e=0;e<i.length;e++){const s=i[e];n.format!==Le?null!==h?d?m.compressedTexSubImage2D(34069+t,e,0,0,s.width,s.height,h,s.data):m.compressedTexImage2D(34069+t,e,c,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):d?m.texSubImage2D(34069+t,e,0,0,s.width,s.height,h,u,s.data):m.texImage2D(34069+t,e,c,s.width,s.height,0,h,u,s.data)}}}else{i=n.mipmaps,d&&p&&(0<i.length&&e++,m.texStorage2D(34067,e,c,l[0].width,l[0].height));for(let t=0;t<6;t++)if(o){d?m.texSubImage2D(34069+t,0,0,0,l[t].width,l[t].height,h,u,l[t].data):m.texImage2D(34069+t,0,c,l[t].width,l[t].height,0,h,u,l[t].data);for(let e=0;e<i.length;e++){const n=i[e].image[t].image;d?m.texSubImage2D(34069+t,e+1,0,0,n.width,n.height,h,u,n.data):m.texImage2D(34069+t,e+1,c,n.width,n.height,0,h,u,n.data)}}else{d?m.texSubImage2D(34069+t,0,0,0,h,u,l[t]):m.texImage2D(34069+t,0,c,h,u,l[t]);for(let e=0;e<i.length;e++){const n=i[e];d?m.texSubImage2D(34069+t,e+1,0,0,h,u,n.image[t]):m.texImage2D(34069+t,e+1,c,h,u,n.image[t])}}}T(n,t)&&x(34067),r.__version=n.version,n.onUpdate&&n.onUpdate(n)}}else m.activeTexture(33984+e),m.bindTexture(34067,i.__webglTexture)}const C={[j]:10497,[Ce]:33071,[q]:33648},A={[Ae]:9728,[Ue]:9984,[Be]:9986,[V]:9729,[Fe]:9985,[He]:9987};function L(e,t,i){if(i?(f.texParameteri(e,10242,C[t.wrapS]),f.texParameteri(e,10243,C[t.wrapT]),32879!==e&&35866!==e||f.texParameteri(e,32882,C[t.wrapR]),f.texParameteri(e,10240,A[t.magFilter]),f.texParameteri(e,10241,A[t.minFilter])):(f.texParameteri(e,10242,33071),f.texParameteri(e,10243,33071),32879!==e&&35866!==e||f.texParameteri(e,32882,33071),t.wrapS===Ce&&t.wrapT===Ce||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),f.texParameteri(e,10240,r(t.magFilter)),f.texParameteri(e,10241,r(t.minFilter)),t.minFilter!==Ae&&t.minFilter!==V&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===a.has("EXT_texture_filter_anisotropic")){const i=a.get("EXT_texture_filter_anisotropic");t.type===Xe&&!1===a.has("OES_texture_float_linear")||!1===y&&t.type===Ye&&!1===a.has("OES_texture_half_float_linear")||(1<t.anisotropy||g.get(t).__currentAnisotropy)&&(f.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,l.getMaxAnisotropy())),g.get(t).__currentAnisotropy=t.anisotropy)}}function I(e,t){void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",n),e.__webglTexture=f.createTexture(),h.memory.textures++)}function P(e,i,t){let r=3553;i.isDataTexture2DArray&&(r=35866),i.isDataTexture3D&&(r=32879),I(e,i),m.activeTexture(33984+t),m.bindTexture(r,e.__webglTexture),f.pixelStorei(37440,i.flipY),f.pixelStorei(37441,i.premultiplyAlpha),f.pixelStorei(3317,i.unpackAlignment),f.pixelStorei(37443,0);t=i;var t=!y&&(t.wrapS!==Ce||t.wrapT!==Ce||t.minFilter!==Ae&&t.minFilter!==V)&&!1===b(i.image),n=b(t=N(i,_(i.image,t,!1,B)))||y,s=v.convert(i.format,i.encoding);let a,o=v.convert(i.type),l=w(i.internalFormat,s,o,i.encoding,i.isVideoTexture);L(r,i,n);var h=i.mipmaps,u=y&&!0!==i.isVideoTexture,c=void 0===e.__version,d=S(i,t,n);if(i.isDepthTexture)l=6402,y?l=i.type===Xe?36012:i.type===qe?33190:i.type===Je?35056:33189:i.type===Xe&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===it&&6402===l&&i.type!==We&&i.type!==qe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=We,o=v.convert(i.type)),i.format===rt&&6402===l&&(l=34041,i.type!==Je)&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Je,o=v.convert(i.type)),u&&c?m.texStorage2D(3553,1,l,t.width,t.height):m.texImage2D(3553,0,l,t.width,t.height,0,s,o,null);else if(i.isDataTexture)if(0<h.length&&n){u&&c&&m.texStorage2D(3553,d,l,h[0].width,h[0].height);for(let e=0,t=h.length;e<t;e++)a=h[e],u?m.texSubImage2D(3553,0,0,0,a.width,a.height,s,o,a.data):m.texImage2D(3553,e,l,a.width,a.height,0,s,o,a.data);i.generateMipmaps=!1}else u?(c&&m.texStorage2D(3553,d,l,t.width,t.height),m.texSubImage2D(3553,0,0,0,t.width,t.height,s,o,t.data)):m.texImage2D(3553,0,l,t.width,t.height,0,s,o,t.data);else if(i.isCompressedTexture){u&&c&&m.texStorage2D(3553,d,l,h[0].width,h[0].height);for(let e=0,t=h.length;e<t;e++)a=h[e],i.format!==Le?null!==s?u?m.compressedTexSubImage2D(3553,e,0,0,a.width,a.height,s,a.data):m.compressedTexImage2D(3553,e,l,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):u?m.texSubImage2D(3553,e,0,0,a.width,a.height,s,o,a.data):m.texImage2D(3553,e,l,a.width,a.height,0,s,o,a.data)}else if(i.isDataTexture2DArray)u?(c&&m.texStorage3D(35866,d,l,t.width,t.height,t.depth),m.texSubImage3D(35866,0,0,0,0,t.width,t.height,t.depth,s,o,t.data)):m.texImage3D(35866,0,l,t.width,t.height,t.depth,0,s,o,t.data);else if(i.isDataTexture3D)u?(c&&m.texStorage3D(32879,d,l,t.width,t.height,t.depth),m.texSubImage3D(32879,0,0,0,0,t.width,t.height,t.depth,s,o,t.data)):m.texImage3D(32879,0,l,t.width,t.height,t.depth,0,s,o,t.data);else if(i.isFramebufferTexture)u&&c?m.texStorage2D(3553,d,l,t.width,t.height):m.texImage2D(3553,0,l,t.width,t.height,0,s,o,null);else if(0<h.length&&n){u&&c&&m.texStorage2D(3553,d,l,h[0].width,h[0].height);for(let e=0,t=h.length;e<t;e++)a=h[e],u?m.texSubImage2D(3553,e,0,0,s,o,a):m.texImage2D(3553,e,l,s,o,a);i.generateMipmaps=!1}else u?(c&&m.texStorage2D(3553,d,l,t.width,t.height),m.texSubImage2D(3553,0,0,0,s,o,t)):m.texImage2D(3553,0,l,s,o,t);T(i,n)&&x(r),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function R(e,t,i,r,n){var s=v.convert(i.format,i.encoding),a=v.convert(i.type),o=w(i.internalFormat,s,a,i.encoding);g.get(t).__hasExternalTextures||(32879===n||35866===n?m.texImage3D(n,0,o,t.width,t.height,t.depth,0,s,a,null):m.texImage2D(n,0,o,t.width,t.height,0,s,a,null)),m.bindFramebuffer(36160,e),t.useRenderToTexture?u.framebufferTexture2DMultisampleEXT(36160,r,n,g.get(i).__webglTexture,0,O(t)):f.framebufferTexture2D(36160,r,n,g.get(i).__webglTexture,0),m.bindFramebuffer(36160,null)}function k(t,i,r){if(f.bindRenderbuffer(36161,t),i.depthBuffer&&!i.stencilBuffer){let e=33189;if(r||i.useRenderToTexture){const t=i.depthTexture,r=(t&&t.isDepthTexture&&(t.type===Xe?e=36012:t.type===qe&&(e=33190)),O(i));i.useRenderToTexture?u.renderbufferStorageMultisampleEXT(36161,r,e,i.width,i.height):f.renderbufferStorageMultisample(36161,r,e,i.width,i.height)}else f.renderbufferStorage(36161,e,i.width,i.height);f.framebufferRenderbuffer(36160,36096,36161,t)}else if(i.depthBuffer&&i.stencilBuffer){var e=O(i);r&&i.useRenderbuffer?f.renderbufferStorageMultisample(36161,e,35056,i.width,i.height):i.useRenderToTexture?u.renderbufferStorageMultisampleEXT(36161,e,35056,i.width,i.height):f.renderbufferStorage(36161,34041,i.width,i.height),f.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===i.isWebGLMultipleRenderTargets?i.texture[0]:i.texture,n=v.convert(t.format,t.encoding),s=v.convert(t.type),a=w(t.internalFormat,n,s,t.encoding),o=O(i);r&&i.useRenderbuffer?f.renderbufferStorageMultisample(36161,o,a,i.width,i.height):i.useRenderToTexture?u.renderbufferStorageMultisampleEXT(36161,o,a,i.width,i.height):f.renderbufferStorage(36161,a,i.width,i.height)}f.bindRenderbuffer(36161,null)}function D(t){var i=g.get(t),e=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(e)throw new Error("target.depthTexture not supported in Cube render targets");var r=i.__webglFramebuffer,n=t;if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(m.bindFramebuffer(36160,r),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),E(n.depthTexture,0);var r=g.get(n.depthTexture).__webglTexture,s=O(n);if(n.depthTexture.format===it)n.useRenderToTexture?u.framebufferTexture2DMultisampleEXT(36160,36096,3553,r,0,s):f.framebufferTexture2D(36160,36096,3553,r,0);else{if(n.depthTexture.format!==rt)throw new Error("Unknown depthTexture format");n.useRenderToTexture?u.framebufferTexture2DMultisampleEXT(36160,33306,3553,r,0,s):f.framebufferTexture2D(36160,33306,3553,r,0)}}else if(e){i.__webglDepthbuffer=[];for(let e=0;e<6;e++)m.bindFramebuffer(36160,i.__webglFramebuffer[e]),i.__webglDepthbuffer[e]=f.createRenderbuffer(),k(i.__webglDepthbuffer[e],t,!1)}else m.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=f.createRenderbuffer(),k(i.__webglDepthbuffer,t,!1);m.bindFramebuffer(36160,null)}function O(e){return y&&(e.useRenderbuffer||e.useRenderToTexture)?Math.min(F,e.samples):0}function N(e,t){var i=e.encoding,r=e.format,n=e.type;return!0!==e.isCompressedTexture&&!0!==e.isVideoTexture&&e.format!==Wt&&i!==Ft&&(i===G?!1===y?!0===a.has("EXT_sRGB")&&r===Le?(e.format=Wt,e.minFilter=V,e.generateMipmaps=!1):t=di.sRGBToLinear(t):r===Le&&n===ze||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),t}let H=!1,z=!1;this.allocateTextureUnit=function(){var e=p;return e>=t&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+t),p+=1,e},this.resetTextureUnits=function(){p=0},this.setTexture2D=E,this.setTexture2DArray=function(e,t){var i=g.get(e);0<e.version&&i.__version!==e.version?P(i,e,t):(m.activeTexture(33984+t),m.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=g.get(e);0<e.version&&i.__version!==e.version?P(i,e,t):(m.activeTexture(33984+t),m.bindTexture(32879,i.__webglTexture))},this.setTextureCube=M,this.rebindTextures=function(e,t,i){var r=g.get(e);void 0!==t&&R(r.__webglFramebuffer,e,e.texture,36064,3553),void 0!==i&&D(e)},this.setupRenderTarget=function(i){var t=i.texture,r=g.get(i),n=g.get(t),e=(i.addEventListener("dispose",d),!0!==i.isWebGLMultipleRenderTargets&&(void 0===n.__webglTexture&&(n.__webglTexture=f.createTexture()),n.__version=t.version,h.memory.textures++),!0===i.isWebGLCubeRenderTarget),s=!0===i.isWebGLMultipleRenderTargets,a=t.isDataTexture3D||t.isDataTexture2DArray,o=b(i)||y;if(e){r.__webglFramebuffer=[];for(let e=0;e<6;e++)r.__webglFramebuffer[e]=f.createFramebuffer()}else if(r.__webglFramebuffer=f.createFramebuffer(),s)if(l.drawBuffers){const m=i.texture;for(let e=0,t=m.length;e<t;e++){const l=g.get(m[e]);void 0===l.__webglTexture&&(l.__webglTexture=f.createTexture(),h.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(i.useRenderbuffer)if(y){r.__webglMultisampledFramebuffer=f.createFramebuffer(),r.__webglColorRenderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(36161,r.__webglColorRenderbuffer);const g=v.convert(t.format,t.encoding),l=v.convert(t.type),h=w(t.internalFormat,g,l,t.encoding),y=O(i);f.renderbufferStorageMultisample(36161,y,h,i.width,i.height),m.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),f.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),f.bindRenderbuffer(36161,null),i.depthBuffer&&(r.__webglDepthRenderbuffer=f.createRenderbuffer(),k(r.__webglDepthRenderbuffer,i,!0)),m.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(e){m.bindTexture(34067,n.__webglTexture),L(34067,t,o);for(let e=0;e<6;e++)R(r.__webglFramebuffer[e],i,t,36064,34069+e);T(t,o)&&x(34067)}else if(s){const f=i.texture;for(let e=0,t=f.length;e<t;e++){const v=f[e],h=g.get(v);m.bindTexture(3553,h.__webglTexture),L(3553,v,o),R(r.__webglFramebuffer,i,v,36064+e,3553),T(v,o)&&x(3553)}}else{let e=3553;a&&(y?e=t.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),m.bindTexture(e,n.__webglTexture),L(e,t,o),R(r.__webglFramebuffer,i,t,36064,e),T(t,o)&&x(e)}m.unbindTexture(),i.depthBuffer&&D(i)},this.updateRenderTargetMipmap=function(i){const r=b(i)||y,n=!0===i.isWebGLMultipleRenderTargets?i.texture:[i.texture];for(let e=0,t=n.length;e<t;e++){var s=n[e];if(T(s,r)){const r=i.isWebGLCubeRenderTarget?34067:3553,n=g.get(s).__webglTexture;m.bindTexture(r,n),x(r),m.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.useRenderbuffer)if(y){var i=t.width,r=t.height;let e=16384;const y=[36064],s=t.stencilBuffer?33306:36096;t.depthBuffer&&y.push(s),t.ignoreDepthForMultisampleCopy||(t.depthBuffer&&(e|=256),t.stencilBuffer&&(e|=1024));var n=g.get(t);m.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),m.bindFramebuffer(36009,n.__webglFramebuffer),t.ignoreDepthForMultisampleCopy&&(f.invalidateFramebuffer(36008,[s]),f.invalidateFramebuffer(36009,[s])),f.blitFramebuffer(0,0,i,r,0,0,i,r,e,9728),f.invalidateFramebuffer(36008,y),m.bindFramebuffer(36008,null),m.bindFramebuffer(36009,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=D,this.setupFrameBufferTexture=R,this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===H&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),H=!0),e=e.texture),E(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),M(e,t)}}function Wa(e,r,t){const n=t.isWebGL2;return{convert:function(e,t=null){let i;if(e===ze)return 5121;if(e===$e)return 32819;if(e===Ke)return 32820;if(e===Ve)return 5120;if(e===Ge)return 5122;if(e===We)return 5123;if(e===je)return 5124;if(e===qe)return 5125;if(e===Xe)return 5126;if(e===Ye)return n?5131:null!==(i=r.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(e===Ze)return 6406;if(e===Le)return 6408;if(e===et)return 6409;if(e===tt)return 6410;if(e===it)return 6402;if(e===rt)return 34041;if(e===nt)return 6403;if(e===Qe)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(e===Wt)return null!==(i=r.get("EXT_sRGB"))?i.SRGB_ALPHA_EXT:null;if(e===st)return 36244;if(e===at)return 33319;if(e===ot)return 33320;if(e===lt)return 36249;if(e===ht||e===ut||e===ct||e===dt)if(t===G){if(null===(i=r.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(e===ht)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===ut)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===ct)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===dt)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(i=r.get("WEBGL_compressed_texture_s3tc")))return null;if(e===ht)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ut)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ct)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===dt)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===pt||e===ft||e===mt||e===gt){if(null===(i=r.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===pt)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===ft)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===mt)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===gt)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===vt)return null!==(i=r.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null;if(e===yt||e===_t){if(null===(i=r.get("WEBGL_compressed_texture_etc")))return null;if(e===yt)return t===G?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===_t)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(e===bt||e===Tt||e===xt||e===wt||e===St||e===Et||e===Mt||e===Ct||e===At||e===Lt||e===It||e===Pt||e===Rt||e===kt){if(null===(i=r.get("WEBGL_compressed_texture_astc")))return null;if(e===bt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===Tt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===xt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===wt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===St)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===Et)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Mt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===Ct)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===At)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Lt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===It)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Pt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Rt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===kt)return t===G?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===Dt){if(null===(i=r.get("EXT_texture_compression_bptc")))return null;if(e===Dt)return t===G?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}return e===Je?n?34042:null!==(i=r.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}class ja extends D{constructor(e=[]){super(),this.cameras=e}}ja.prototype.isArrayCamera=!0;class qa extends a{constructor(){super(),this.type="Group"}}qa.prototype.isGroup=!0;const Xa={type:"move"};class Ya{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new qa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new qa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Pe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Pe),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new qa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Pe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Pe),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,n=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&null!==(r=t.getPose(e.targetRaySpace,i))&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Xa)),l&&e.hand){s=!0;for(const r of e.hand.values()){const e=t.getJointPose(r,i);if(void 0===l.joints[r.jointName]){const e=new qa;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[r.jointName]=e,l.add(e)}const n=l.joints[r.jointName];null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.jointRadius=e.radius),n.visible=null!==e}const r=l.joints["index-finger-tip"],n=l.joints["thumb-tip"],a=r.position.distanceTo(n.position),o=.02;l.inputState.pinching&&.025<a?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&null!==(n=t.getPose(e.gripSpace,i))&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1);return null!==a&&(a.visible=null!==r),null!==o&&(o.visible=null!==n),null!==l&&(l.visible=null!==s),this}}class $a extends u{constructor(e,t,i,r,n,s,a,o,l,h){if((h=void 0!==h?h:it)!==it&&h!==rt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,n,s,a,o,h,i=void 0===(i=void 0===i&&h===it?We:i)&&h===rt?Je:i,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:Ae,this.minFilter=void 0!==o?o:Ae,this.flipY=!1,this.generateMipmaps=!1}}$a.prototype.isDepthTexture=!0;class Ka extends jt{constructor(a,n){super();const t=this;let f=null,s=1,i=null,o="local-floor";const l=a.extensions.has("WEBGL_multisampled_render_to_texture");let e,h=null,u=null,c=null,d,p=null;const m=n.getContextAttributes();let g=null,v=null;const y=[],_=new Map,b=new D,T=(b.layers.enable(1),b.viewport=new Ie,new D),x=(T.layers.enable(2),T.viewport=new Ie,[b,T]),w=new ja;w.layers.enable(1),w.layers.enable(2);let S=null,E=null;function M(e){var t=_.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function C(){_.forEach(function(e,t){e.disconnect(t)}),_.clear(),S=null,E=null,a.setRenderTarget(g),c=null,u=null,h=null,f=null,v=null,k.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}function A(t){var i=f.inputSources;for(let e=0;e<y.length;e++)_.set(i[e],y[e]);for(let e=0;e<t.removed.length;e++){const r=t.removed[e],f=_.get(r);f&&(f.dispatchEvent({type:"disconnected",data:r}),_.delete(r))}for(let e=0;e<t.added.length;e++){const n=t.added[e],f=_.get(n);f&&f.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new Ya,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new Ya,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new Ya,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){s=e,!0===t.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===t.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return i},this.getBaseLayer=function(){return null!==u?u:c},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return f},this.setSession=async function(r){if(null!==(f=r)){if(g=a.getRenderTarget(),f.addEventListener("select",M),f.addEventListener("selectstart",M),f.addEventListener("selectend",M),f.addEventListener("squeeze",M),f.addEventListener("squeezestart",M),f.addEventListener("squeezeend",M),f.addEventListener("end",C),f.addEventListener("inputsourceschange",A),!0!==m.xrCompatible&&await n.makeXRCompatible(),void 0===f.renderState.layers||!1===a.capabilities.isWebGL2){const t={antialias:void 0!==f.renderState.layers||m.antialias,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};c=new XRWebGLLayer(f,n,t),f.updateRenderState({baseLayer:c}),v=new mi(c.framebufferWidth,c.framebufferHeight,{format:Le,type:ze,encoding:a.outputEncoding})}else{d=m.antialias;let e=null,t=null,i=null;m.depth&&(i=m.stencil?35056:33190,e=m.stencil?rt:it,t=m.stencil?Je:We);const r={colorFormat:a.outputEncoding===G?35907:32856,depthFormat:i,scaleFactor:s};h=new XRWebGLBinding(f,n),u=h.createProjectionLayer(r),f.updateRenderState({layers:[u]}),v=d?new gi(u.textureWidth,u.textureHeight,{format:Le,type:ze,depthTexture:new $a(u.textureWidth,u.textureHeight,t,void 0,void 0,void 0,void 0,void 0,void 0,e),stencilBuffer:m.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:l,encoding:a.outputEncoding}):new mi(u.textureWidth,u.textureHeight,{format:Le,type:ze,depthTexture:new $a(u.textureWidth,u.textureHeight,t,void 0,void 0,void 0,void 0,void 0,void 0,e),stencilBuffer:m.stencil,ignoreDepth:u.ignoreDepthValues,encoding:a.outputEncoding})}v.isXRRenderTarget=!0,this.setFoveation(1),i=await f.requestReferenceSpace(o),k.setContext(f),k.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}};const L=new Pe,I=new Pe;function P(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null!==f){w.near=T.near=b.near=e.near,w.far=T.far=b.far=e.far,S===w.near&&E===w.far||(f.updateRenderState({depthNear:w.near,depthFar:w.far}),S=w.near,E=w.far);var t=e.parent,i=w.cameras;P(w,t);for(let e=0;e<i.length;e++)P(i[e],t);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),e.position.copy(w.position),e.quaternion.copy(w.quaternion),e.scale.copy(w.scale),e.matrix.copy(w.matrix),e.matrixWorld.copy(w.matrixWorld);var r,n,s,a,o,l,h,u,c,d,p=e.children;for(let e=0,t=p.length;e<t;e++)p[e].updateMatrixWorld(!0);2===i.length?(e=w,r=b,n=T,L.setFromMatrixPosition(r.matrixWorld),I.setFromMatrixPosition(n.matrixWorld),s=L.distanceTo(I),a=r.projectionMatrix.elements,n=n.projectionMatrix.elements,o=a[14]/(a[10]-1),l=a[14]/(a[10]+1),h=(a[9]+1)/a[5],u=(a[9]-1)/a[5],a=(a[8]-1)/a[0],n=(n[8]+1)/n[0],c=o*a,d=o*n,a=(n=s/(n-a))*-a,r.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(a),e.translateZ(n),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),r=o+n,o=l+n,e.projectionMatrix.makePerspective(c-a,s-a+d,h*l/o*r,u*l/o*r,r,o)):w.projectionMatrix.copy(b.projectionMatrix)}},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==c?c.fixedFoveation:void 0},this.setFoveation=function(e){null!==u&&(u.fixedFoveation=e),null!==c&&void 0!==c.fixedFoveation&&(c.fixedFoveation=e)};let R=null;const k=new yn;k.setAnimationLoop(function(r,t){if(e=t.getViewerPose(i),p=t,null!==e){const r=e.views;null!==c&&(a.setRenderTargetFramebuffer(v,c.framebuffer),a.setRenderTarget(v));let i=!1;r.length!==w.cameras.length&&(w.cameras.length=0,i=!0);for(let t=0;t<r.length;t++){const s=r[t];let e=null;if(null!==c)e=c.getViewport(s);else{const r=h.getViewSubImage(u,s);e=r.viewport,0===t&&(a.setRenderTargetTextures(v,r.colorTexture,u.ignoreDepthValues?void 0:r.depthStencilTexture),a.setRenderTarget(v))}var n=x[t];n.matrix.fromArray(s.transform.matrix),n.projectionMatrix.fromArray(s.projectionMatrix),n.viewport.set(e.x,e.y,e.width,e.height),0===t&&w.matrix.copy(n.matrix),!0===i&&w.cameras.push(n)}}const s=f.inputSources;for(let e=0;e<y.length;e++){const r=y[e],f=s[e];r.update(f,t,i)}R&&R(r,t),p=null}),this.setAnimationLoop=function(e){R=e},this.dispose=function(){}}}function Ja(s){function d(e,t){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),0<t.alphaTest&&(e.alphaTest.value=t.alphaTest);var i=s.get(t).envMap;let r,n;i&&(e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=t.reflectivity,e.ior.value=t.ior,e.refractionRatio.value=t.refractionRatio),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap?r=t.emissiveMap:t.clearcoatMap?r=t.clearcoatMap:t.clearcoatNormalMap?r=t.clearcoatNormalMap:t.clearcoatRoughnessMap?r=t.clearcoatRoughnessMap:t.specularIntensityMap?r=t.specularIntensityMap:t.specularColorMap?r=t.specularColorMap:t.transmissionMap?r=t.transmissionMap:t.thicknessMap?r=t.thicknessMap:t.sheenColorMap?r=t.sheenColorMap:t.sheenRoughnessMap&&(r=t.sheenRoughnessMap),void 0!==r&&(!0===(r=r.isWebGLRenderTarget?r.texture:r).matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),t.aoMap?n=t.aoMap:t.lightMap&&(n=t.lightMap),void 0!==n&&(!0===(n=n.isWebGLRenderTarget?n.texture:n).matrixAutoUpdate&&n.updateMatrix(),e.uv2Transform.value.copy(n.matrix))}function p(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Me)&&(e.bumpScale.value*=-1),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Me)&&e.normalScale.value.negate(),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),s.get(t).envMap&&(e.envMapIntensity.value=t.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(t,i,r,n,s){if(i.isMeshBasicMaterial)d(t,i);else if(i.isMeshLambertMaterial)d(t,i),c=t,i.emissiveMap&&(c.emissiveMap.value=i.emissiveMap);else if(i.isMeshToonMaterial)d(t,i),c=t,(u=i).gradientMap&&(c.gradientMap.value=u.gradientMap),u.emissiveMap&&(c.emissiveMap.value=u.emissiveMap),u.bumpMap&&(c.bumpMap.value=u.bumpMap,c.bumpScale.value=u.bumpScale,u.side===Me)&&(c.bumpScale.value*=-1),u.normalMap&&(c.normalMap.value=u.normalMap,c.normalScale.value.copy(u.normalScale),u.side===Me)&&c.normalScale.value.negate(),u.displacementMap&&(c.displacementMap.value=u.displacementMap,c.displacementScale.value=u.displacementScale,c.displacementBias.value=u.displacementBias);else if(i.isMeshPhongMaterial)d(t,i),u=i,(h=t).specular.value.copy(u.specular),h.shininess.value=Math.max(u.shininess,1e-4),u.emissiveMap&&(h.emissiveMap.value=u.emissiveMap),u.bumpMap&&(h.bumpMap.value=u.bumpMap,h.bumpScale.value=u.bumpScale,u.side===Me)&&(h.bumpScale.value*=-1),u.normalMap&&(h.normalMap.value=u.normalMap,h.normalScale.value.copy(u.normalScale),u.side===Me)&&h.normalScale.value.negate(),u.displacementMap&&(h.displacementMap.value=u.displacementMap,h.displacementScale.value=u.displacementScale,h.displacementBias.value=u.displacementBias);else if(i.isMeshStandardMaterial)d(t,i),i.isMeshPhysicalMaterial?(h=s,p(s=t,l=i),s.ior.value=l.ior,0<l.sheen&&(s.sheenColor.value.copy(l.sheenColor).multiplyScalar(l.sheen),s.sheenRoughness.value=l.sheenRoughness,l.sheenColorMap&&(s.sheenColorMap.value=l.sheenColorMap),l.sheenRoughnessMap)&&(s.sheenRoughnessMap.value=l.sheenRoughnessMap),0<l.clearcoat&&(s.clearcoat.value=l.clearcoat,s.clearcoatRoughness.value=l.clearcoatRoughness,l.clearcoatMap&&(s.clearcoatMap.value=l.clearcoatMap),l.clearcoatRoughnessMap&&(s.clearcoatRoughnessMap.value=l.clearcoatRoughnessMap),l.clearcoatNormalMap)&&(s.clearcoatNormalScale.value.copy(l.clearcoatNormalScale),s.clearcoatNormalMap.value=l.clearcoatNormalMap,l.side===Me)&&s.clearcoatNormalScale.value.negate(),0<l.transmission&&(s.transmission.value=l.transmission,s.transmissionSamplerMap.value=h.texture,s.transmissionSamplerSize.value.set(h.width,h.height),l.transmissionMap&&(s.transmissionMap.value=l.transmissionMap),s.thickness.value=l.thickness,l.thicknessMap&&(s.thicknessMap.value=l.thicknessMap),s.attenuationDistance.value=l.attenuationDistance,s.attenuationColor.value.copy(l.attenuationColor)),s.specularIntensity.value=l.specularIntensity,s.specularColor.value.copy(l.specularColor),l.specularIntensityMap&&(s.specularIntensityMap.value=l.specularIntensityMap),l.specularColorMap&&(s.specularColorMap.value=l.specularColorMap)):p(t,i);else if(i.isMeshMatcapMaterial)d(t,i),s=t,(l=i).matcap&&(s.matcap.value=l.matcap),l.bumpMap&&(s.bumpMap.value=l.bumpMap,s.bumpScale.value=l.bumpScale,l.side===Me)&&(s.bumpScale.value*=-1),l.normalMap&&(s.normalMap.value=l.normalMap,s.normalScale.value.copy(l.normalScale),l.side===Me)&&s.normalScale.value.negate(),l.displacementMap&&(s.displacementMap.value=l.displacementMap,s.displacementScale.value=l.displacementScale,s.displacementBias.value=l.displacementBias);else if(i.isMeshDepthMaterial)d(t,i),s=t,(o=i).displacementMap&&(s.displacementMap.value=o.displacementMap,s.displacementScale.value=o.displacementScale,s.displacementBias.value=o.displacementBias);else if(i.isMeshDistanceMaterial)d(t,i),s=t,(o=i).displacementMap&&(s.displacementMap.value=o.displacementMap,s.displacementScale.value=o.displacementScale,s.displacementBias.value=o.displacementBias),s.referencePosition.value.copy(o.referencePosition),s.nearDistance.value=o.nearDistance,s.farDistance.value=o.farDistance;else if(i.isMeshNormalMaterial)d(t,i),s=t,(e=i).bumpMap&&(s.bumpMap.value=e.bumpMap,s.bumpScale.value=e.bumpScale,e.side===Me)&&(s.bumpScale.value*=-1),e.normalMap&&(s.normalMap.value=e.normalMap,s.normalScale.value.copy(e.normalScale),e.side===Me)&&s.normalScale.value.negate(),e.displacementMap&&(s.displacementMap.value=e.displacementMap,s.displacementScale.value=e.displacementScale,s.displacementBias.value=e.displacementBias);else if(i.isLineBasicMaterial)s=i,(e=t).diffuse.value.copy(s.color),e.opacity.value=s.opacity,i.isLineDashedMaterial&&(s=i,(a=t).dashSize.value=s.dashSize,a.totalSize.value=s.dashSize+s.gapSize,a.scale.value=s.scale);else if(i.isPointsMaterial){s=i;let e;(a=t).diffuse.value.copy(s.color),a.opacity.value=s.opacity,a.size.value=s.size*r,a.scale.value=.5*n,s.map&&(a.map.value=s.map),s.alphaMap&&(a.alphaMap.value=s.alphaMap),0<s.alphaTest&&(a.alphaTest.value=s.alphaTest),s.map?e=s.map:s.alphaMap&&(e=s.alphaMap),void 0!==e&&(!0===e.matrixAutoUpdate&&e.updateMatrix(),a.uvTransform.value.copy(e.matrix))}else if(i.isSpriteMaterial){n=i;let e;(r=t).diffuse.value.copy(n.color),r.opacity.value=n.opacity,r.rotation.value=n.rotation,n.map&&(r.map.value=n.map),n.alphaMap&&(r.alphaMap.value=n.alphaMap),0<n.alphaTest&&(r.alphaTest.value=n.alphaTest),n.map?e=n.map:n.alphaMap&&(e=n.alphaMap),void 0!==e&&(!0===e.matrixAutoUpdate&&e.updateMatrix(),r.uvTransform.value.copy(e.matrix))}else i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1);var a,e,o,l,h,u,c}}}function i(e={}){const n=void 0!==e.canvas?e.canvas:((j=ni("canvas")).style.display="block",j),_=void 0!==e.context?e.context:null,b=void 0!==e.alpha&&e.alpha,B=void 0===e.depth||e.depth,F=void 0===e.stencil||e.stencil,H=void 0!==e.antialias&&e.antialias,z=void 0===e.premultipliedAlpha||e.premultipliedAlpha,V=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,G=void 0!==e.powerPreference?e.powerPreference:"default",W=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;var j;let u=null,T=null;const t=[],s=[],x=(this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ft,this.physicallyCorrectLights=!1,this.toneMapping=Ne,this.toneMappingExposure=1,this);let q=!1,X=0,Y=0,w=null,S=-1,E=null;const c=new Ie,$=new Ie;let K=null,r=n.width,M=n.height,C=1,J=null,Z=null;const o=new Ie(0,0,r,M),l=new Ie(0,0,r,M);let Q=!1;const ee=new vn;let te=!1,ie=!1,A=null;const re=new Re,L=new Pe,ne={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function se(){return null===w?C:1}let d,I,P,p,R,k,D,O,ae,oe,f,m,le,he,ue,N,a,h,ce,de,pe,v,g,U=_;function fe(t,i){for(let e=0;e<t.length;e++){var r=t[e],r=n.getContext(r,i);if(null!==r)return r}return null}try{const e={alpha:!0,depth:B,stencil:F,antialias:H,premultipliedAlpha:z,preserveDrawingBuffer:V,powerPreference:G,failIfMajorPerformanceCaveat:W};if("setAttribute"in n&&n.setAttribute("data-engine","three.js r"+ke),n.addEventListener("webglcontextlost",ge,!1),n.addEventListener("webglcontextrestored",ve,!1),null===U){const n=["webgl2","webgl","experimental-webgl"];if(!0===x.isWebGL1Renderer&&n.shift(),null===(U=fe(n,e)))throw fe(n)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===U.getShaderPrecisionFormat&&(U.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function me(){d=new Yn(U),I=new En(U,d,e),d.init(I),v=new Wa(U,d,I),P=new Va(U,d,I),p=new Jn(U),R=new Ma,k=new Ga(U,d,P,R,I,v,p),D=new Cn(x),O=new Xn(x),ae=new _n(U,I),g=new wn(U,d,ae,I),oe=new $n(U,ae,p,g),f=new rs(U,oe,ae,p),ce=new is(U,I,k),N=new Mn(R),m=new Ea(x,D,O,d,I,g,N),le=new Ja(R),he=new Ia,ue=new Na(d,I),h=new xn(x,D,P,f,b,z),a=new za(x,f,I),de=new Sn(U,d,p,I),pe=new Kn(U,d,p,I),p.programs=m.programs,x.capabilities=I,x.extensions=d,x.properties=R,x.renderLists=he,x.shadowMap=a,x.state=P,x.info=p}me();const y=new Ka(x,U);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;var e=p.autoReset,t=a.enabled,i=a.autoUpdate,r=a.needsUpdate,n=a.type;me(),p.autoReset=e,a.enabled=t,a.autoUpdate=i,a.needsUpdate=r,a.type=n}function ye(e){var t,i,e=e.target;e.removeEventListener("dispose",ye),t=e=e,void 0!==(i=R.get(t).programs)&&(i.forEach(function(e){m.releaseProgram(e)}),t.isShaderMaterial)&&m.releaseShaderCache(t),R.remove(e)}this.xr=y,this.getContext=function(){return U},this.getContextAttributes=function(){return U.getContextAttributes()},this.forceContextLoss=function(){var e=d.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=d.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(e){void 0!==e&&(C=e,this.setSize(r,M,!1))},this.getSize=function(e){return e.set(r,M)},this.setSize=function(e,t,i){y.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(r=e,M=t,n.width=Math.floor(e*C),n.height=Math.floor(t*C),!1!==i&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(r*C,M*C).floor()},this.setDrawingBufferSize=function(e,t,i){r=e,M=t,C=i,n.width=Math.floor(e*i),n.height=Math.floor(t*i),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(c)},this.getViewport=function(e){return e.copy(o)},this.setViewport=function(e,t,i,r){e.isVector4?o.set(e.x,e.y,e.z,e.w):o.set(e,t,i,r),P.viewport(c.copy(o).multiplyScalar(C).floor())},this.getScissor=function(e){return e.copy(l)},this.setScissor=function(e,t,i,r){e.isVector4?l.set(e.x,e.y,e.z,e.w):l.set(e,t,i,r),P.scissor($.copy(l).multiplyScalar(C).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(e){P.setScissorTest(Q=e)},this.setOpaqueSort=function(e){J=e},this.setTransparentSort=function(e){Z=e},this.getClearColor=function(e){return e.copy(h.getClearColor())},this.setClearColor=function(){h.setClearColor.apply(h,arguments)},this.getClearAlpha=function(){return h.getClearAlpha()},this.setClearAlpha=function(){h.setClearAlpha.apply(h,arguments)},this.clear=function(e,t,i){let r=0;void 0!==e&&!e||(r|=16384),void 0!==t&&!t||(r|=256),void 0!==i&&!i||(r|=1024),U.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ge,!1),n.removeEventListener("webglcontextrestored",ve,!1),he.dispose(),ue.dispose(),R.dispose(),D.dispose(),O.dispose(),f.dispose(),g.dispose(),m.dispose(),y.dispose(),y.removeEventListener("sessionstart",be),y.removeEventListener("sessionend",Te),A&&(A.dispose(),A=null),i.stop()},this.renderBufferDirect=function(e,t,i,r,n,s){null===t&&(t=ne);var a=n.isMesh&&n.matrixWorld.determinant()<0,e=function(e,t,i,r,n){!0!==t.isScene&&(t=ne),k.resetTextureUnits();var s=t.fog,a=r.isMeshStandardMaterial?t.environment:null,o=null===w?x.outputEncoding:!0===w.isXRRenderTarget?w.texture.encoding:Ft,a=(r.isMeshStandardMaterial?O:D).get(r.envMap||a),l=!0===r.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,h=!!r.normalMap&&!!i.attributes.tangent,u=!!i.morphAttributes.position,c=!!i.morphAttributes.normal,d=i.morphAttributes.position?i.morphAttributes.position.length:0,p=r.toneMapped?x.toneMapping:Ne,f=R.get(r),m=T.state.lights;if(!0===te&&(!0===ie||e!==E)){const t=e===E&&r.id===S;N.setState(r,e,t)}let g=!1,v=(r.version===f.__version?(f.needsLights&&f.lightsStateVersion!==m.state.version||f.outputEncoding!==o||n.isInstancedMesh&&!1===f.instancing||!n.isInstancedMesh&&!0===f.instancing||n.isSkinnedMesh&&!1===f.skinning||!n.isSkinnedMesh&&!0===f.skinning||f.envMap!==a||r.fog&&f.fog!==s||void 0!==f.numClippingPlanes&&(f.numClippingPlanes!==N.numPlanes||f.numIntersection!==N.numIntersection)||f.vertexAlphas!==l||f.vertexTangents!==h||f.morphTargets!==u||f.morphNormals!==c||f.toneMapping!==p||!0===I.isWebGL2&&f.morphTargetsCount!==d)&&(g=!0):(g=!0,f.__version=r.version),f.currentProgram),y=!1,_=!1,b=!1;m=(v=!0===g?Se(r,t,n):v).getUniforms(),o=f.uniforms;if(P.useProgram(v.program)&&(y=!0,_=!0,b=!0),r.id!==S&&(S=r.id,_=!0),y||E!==e){if(m.setValue(U,"projectionMatrix",e.projectionMatrix),I.logarithmicDepthBuffer&&m.setValue(U,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),E!==e&&(E=e,_=!0,b=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=m.map.cameraPosition;void 0!==t&&t.setValue(U,L.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&m.setValue(U,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||n.isSkinnedMesh)&&m.setValue(U,"viewMatrix",e.matrixWorldInverse)}if(n.isSkinnedMesh){m.setOptional(U,n,"bindMatrix"),m.setOptional(U,n,"bindMatrixInverse");const e=n.skeleton;e&&(I.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),m.setValue(U,"boneTexture",e.boneTexture,k),m.setValue(U,"boneTextureSize",e.boneTextureSize)):m.setOptional(U,e,"boneMatrices"))}return!i||void 0===i.morphAttributes.position&&void 0===i.morphAttributes.normal||ce.update(n,i,r,v),!_&&f.receiveShadow===n.receiveShadow||(f.receiveShadow=n.receiveShadow,m.setValue(U,"receiveShadow",n.receiveShadow)),_&&(m.setValue(U,"toneMappingExposure",x.toneMappingExposure),f.needsLights&&(a=b,(l=o).ambientLightColor.needsUpdate=a,l.lightProbe.needsUpdate=a,l.directionalLights.needsUpdate=a,l.directionalLightShadows.needsUpdate=a,l.pointLights.needsUpdate=a,l.pointLightShadows.needsUpdate=a,l.spotLights.needsUpdate=a,l.spotLightShadows.needsUpdate=a,l.rectAreaLights.needsUpdate=a,l.hemisphereLights.needsUpdate=a),s&&r.fog&&le.refreshFogUniforms(o,s),le.refreshMaterialUniforms(o,r,C,M,A),sa.upload(U,f.uniformsList,o,k)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(sa.upload(U,f.uniformsList,o,k),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&m.setValue(U,"center",n.center),m.setValue(U,"modelViewMatrix",n.modelViewMatrix),m.setValue(U,"normalMatrix",n.normalMatrix),m.setValue(U,"modelMatrix",n.matrixWorld),v}(e,t,i,r,n);P.setMaterial(r,a);let o=i.index;t=i.attributes.position;if(null===o){if(void 0===t||0===t.count)return}else if(0===o.count)return;let l,h=1,u=(!0===r.wireframe&&(o=oe.getWireframeAttribute(i),h=2),g.setup(n,r,e,i,o),de);null!==o&&(l=ae.get(o),(u=pe).setIndex(l));var a=(null!==o?o:t).count,e=i.drawRange.start*h,t=i.drawRange.count*h,c=null!==s?s.start*h:0,s=null!==s?s.count*h:1/0,d=Math.max(e,c),a=Math.min(a,e+t,c+s)-1,t=Math.max(0,a-d+1);if(0!==t){if(n.isMesh)!0===r.wireframe?(P.setLineWidth(r.wireframeLinewidth*se()),u.setMode(1)):u.setMode(4);else if(n.isLine){let e=r.linewidth;void 0===e&&(e=1),P.setLineWidth(e*se()),n.isLineSegments?u.setMode(1):n.isLineLoop?u.setMode(2):u.setMode(3)}else n.isPoints?u.setMode(0):n.isSprite&&u.setMode(4);if(n.isInstancedMesh)u.renderInstances(d,t,n.count);else if(i.isInstancedBufferGeometry){const e=Math.min(i.instanceCount,i._maxInstanceCount);u.renderInstances(d,t,e)}else u.render(d,t)}},this.compile=function(r,t){(T=ue.get(r)).init(),s.push(T),r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(T.pushLight(e),e.castShadow)&&T.pushShadow(e)}),T.setupLights(x.physicallyCorrectLights),r.traverse(function(t){var i=t.material;if(i)if(Array.isArray(i))for(let e=0;e<i.length;e++)Se(i[e],r,t);else Se(i,r,t)}),s.pop(),T=null};let _e=null;function be(){i.stop()}function Te(){i.start()}const i=new yn;function xe(e,t,i,r){var n=e.opaque,s=e.transmissive,e=e.transparent;if(T.setupLightsView(i),0<s.length){var a=n,o=t,l=i;if(null===A){const a=!0===H&&!0===I.isWebGL2;A=new(a?gi:mi)(1024,1024,{generateMipmaps:!0,type:null!==v.convert(Ye)?Ye:ze,minFilter:He,magFilter:Ae,wrapS:Ce,wrapT:Ce,useRenderToTexture:d.has("WEBGL_multisampled_render_to_texture")})}var h=x.getRenderTarget(),u=(x.setRenderTarget(A),x.clear(),x.toneMapping);x.toneMapping=Ne,we(a,o,l),x.toneMapping=u,k.updateMultisampleRenderTarget(A),k.updateRenderTargetMipmap(A),x.setRenderTarget(h)}r&&P.viewport(c.copy(r)),0<n.length&&we(n,t,i),0<s.length&&we(s,t,i),0<e.length&&we(e,t,i)}function we(i,r,n){var s,a,o=!0===r.isScene?r.overrideMaterial:null;for(let e=0,t=i.length;e<t;e++){var l=i[e],h=l.object,u=l.geometry,c=null===o?l.material:o,l=l.group;h.layers.test(n.layers)&&(s=r,a=n,u=u,c=c,l=l,(h=h).onBeforeRender(x,s,a,u,c,l),h.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,h.matrixWorld),h.normalMatrix.getNormalMatrix(h.modelViewMatrix),c.onBeforeRender(x,s,a,u,h,l),!0===c.transparent&&c.side===Oe?(c.side=Me,c.needsUpdate=!0,x.renderBufferDirect(a,s,u,c,h,l),c.side=De,c.needsUpdate=!0,x.renderBufferDirect(a,s,u,c,h,l),c.side=Oe):x.renderBufferDirect(a,s,u,c,h,l),h.onAfterRender(x,s,a,u,c,l))}}function Se(e,t,i){!0!==t.isScene&&(t=ne);var r=R.get(e),n=T.state.lights,s=T.state.shadowsArray,a=n.state.version,s=m.getParameters(e,n.state,s,t,i),o=m.getProgramCacheKey(s);let l=r.programs,h=(r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?O:D).get(e.envMap||r.environment),void 0===l&&(e.addEventListener("dispose",ye),l=new Map,r.programs=l),l.get(o));if(void 0!==h){if(r.currentProgram===h&&r.lightsStateVersion===a)return Ee(e,s),h}else s.uniforms=m.getUniforms(e),e.onBuild(i,s,x),e.onBeforeCompile(s,x),h=m.acquireProgram(s,o),l.set(o,h),r.uniforms=s.uniforms;t=r.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(t.clippingPlanes=N.uniform),Ee(e,s),r.needsLights=e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights,r.lightsStateVersion=a,r.needsLights&&(t.ambientLightColor.value=n.state.ambient,t.lightProbe.value=n.state.probe,t.directionalLights.value=n.state.directional,t.directionalLightShadows.value=n.state.directionalShadow,t.spotLights.value=n.state.spot,t.spotLightShadows.value=n.state.spotShadow,t.rectAreaLights.value=n.state.rectArea,t.ltc_1.value=n.state.rectAreaLTC1,t.ltc_2.value=n.state.rectAreaLTC2,t.pointLights.value=n.state.point,t.pointLightShadows.value=n.state.pointShadow,t.hemisphereLights.value=n.state.hemi,t.directionalShadowMap.value=n.state.directionalShadowMap,t.directionalShadowMatrix.value=n.state.directionalShadowMatrix,t.spotShadowMap.value=n.state.spotShadowMap,t.spotShadowMatrix.value=n.state.spotShadowMatrix,t.pointShadowMap.value=n.state.pointShadowMap,t.pointShadowMatrix.value=n.state.pointShadowMatrix),i=h.getUniforms(),o=sa.seqWithValue(i.seq,t);return r.currentProgram=h,r.uniformsList=o,h}function Ee(e,t){e=R.get(e);e.outputEncoding=t.outputEncoding,e.instancing=t.instancing,e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.morphTargetsCount=t.morphTargetsCount,e.numClippingPlanes=t.numClippingPlanes,e.numIntersection=t.numClipIntersection,e.vertexAlphas=t.vertexAlphas,e.vertexTangents=t.vertexTangents,e.toneMapping=t.toneMapping}i.setAnimationLoop(function(e){_e&&_e(e)}),"undefined"!=typeof window&&i.setContext(window),this.setAnimationLoop=function(e){_e=e,y.setAnimationLoop(e),null===e?i.stop():i.start()},y.addEventListener("sessionstart",be),y.addEventListener("sessionend",Te),this.render=function(i,e){if(void 0!==e&&!0!==e.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!0!==q){!0===i.autoUpdate&&i.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===y.enabled&&!0===y.isPresenting&&(!0===y.cameraAutoUpdate&&y.updateCamera(e),e=y.getCamera()),!0===i.isScene&&i.onBeforeRender(x,i,e,w),(T=ue.get(i,s.length)).init(),s.push(T),re.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ee.setFromProjectionMatrix(re),ie=this.localClippingEnabled,te=N.init(this.clippingPlanes,ie,e),(u=he.get(i,t.length)).init(),t.push(u),function i(r,n,s,a){if(!1!==r.visible){if(r.layers.test(n.layers))if(r.isGroup)s=r.renderOrder;else if(r.isLOD)!0===r.autoUpdate&&r.update(n);else if(r.isLight)T.pushLight(r),r.castShadow&&T.pushShadow(r);else if(r.isSprite){if(!r.frustumCulled||ee.intersectsSprite(r)){a&&L.setFromMatrixPosition(r.matrixWorld).applyMatrix4(re);const n=f.update(r),h=r.material;h.visible&&u.push(r,n,h,s,L.z,null)}}else if((r.isMesh||r.isLine||r.isPoints)&&(r.isSkinnedMesh&&r.skeleton.frame!==p.render.frame&&(r.skeleton.update(),r.skeleton.frame=p.render.frame),!r.frustumCulled||ee.intersectsObject(r))){a&&L.setFromMatrixPosition(r.matrixWorld).applyMatrix4(re);const n=f.update(r),h=r.material;if(Array.isArray(h)){const a=n.groups;for(let e=0,t=a.length;e<t;e++){var o=a[e],l=h[o.materialIndex];l&&l.visible&&u.push(r,n,l,s,L.z,o)}}else h.visible&&u.push(r,n,h,s,L.z,null)}const h=r.children;for(let e=0,t=h.length;e<t;e++)i(h[e],n,s,a)}}(i,e,0,x.sortObjects),u.finish(),!0===x.sortObjects&&u.sort(J,Z),!0===te&&N.beginShadows();const n=T.state.shadowsArray;if(a.render(n,i,e),!0===te&&N.endShadows(),!0===this.info.autoReset&&this.info.reset(),h.render(u,i),T.setupLights(x.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,t=n.length;e<t;e++){var r=n[e];xe(u,i,r,r.viewport)}}else xe(u,i,e);null!==w&&(k.updateMultisampleRenderTarget(w),k.updateRenderTargetMipmap(w)),!0===i.isScene&&i.onAfterRender(x,i,e),P.buffers.depth.setTest(!0),P.buffers.depth.setMask(!0),P.buffers.color.setMask(!0),P.setPolygonOffset(!1),g.resetDefaultState(),S=-1,E=null,s.pop(),T=0<s.length?s[s.length-1]:null,t.pop(),u=0<t.length?t[t.length-1]:null}},this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return Y},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,i){R.get(e.texture).__webglTexture=t,R.get(e.depthTexture).__webglTexture=i;t=R.get(e);t.__hasExternalTextures=!0,t.__hasExternalTextures&&(t.__autoAllocateDepthBuffer=void 0===i,t.__autoAllocateDepthBuffer||e.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),e.useRenderToTexture=!1,e.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(e,t){e=R.get(e);e.__webglFramebuffer=t,e.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,i=0){w=e,X=t,Y=i;let r=!0;if(e){const t=R.get(e);void 0!==t.__useDefaultFramebuffer?(P.bindFramebuffer(36160,null),r=!1):void 0===t.__webglFramebuffer?k.setupRenderTarget(e):t.__hasExternalTextures&&k.rebindTextures(e,R.get(e.texture).__webglTexture,R.get(e.depthTexture).__webglTexture)}let n=null,s=!1,a=!1;if(e){const i=e.texture,r=((i.isDataTexture3D||i.isDataTexture2DArray)&&(a=!0),R.get(e).__webglFramebuffer);e.isWebGLCubeRenderTarget?(n=r[t],s=!0):n=e.useRenderbuffer?R.get(e).__webglMultisampledFramebuffer:r,c.copy(e.viewport),$.copy(e.scissor),K=e.scissorTest}else c.copy(o).multiplyScalar(C).floor(),$.copy(l).multiplyScalar(C).floor(),K=Q;if(P.bindFramebuffer(36160,n)&&I.drawBuffers&&r&&P.drawBuffers(e,n),P.viewport(c),P.scissor($),P.setScissorTest(K),s){const r=R.get(e.texture);U.framebufferTexture2D(36160,36064,34069+t,r.__webglTexture,i)}else if(a){const r=R.get(e.texture),n=t||0;U.framebufferTextureLayer(36160,36064,r.__webglTexture,i||0,n)}S=-1},this.readRenderTargetPixels=function(t,i,r,n,s,a,o){if(t&&t.isWebGLRenderTarget){let e=R.get(t).__webglFramebuffer;if(e=t.isWebGLCubeRenderTarget&&void 0!==o?e[o]:e){P.bindFramebuffer(36160,e);try{const o=t.texture,e=o.format,h=o.type;var l;e!==Le&&v.convert(e)!==U.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):(l=h===Ye&&(d.has("EXT_color_buffer_half_float")||I.isWebGL2&&d.has("EXT_color_buffer_float")),h===ze||v.convert(h)===U.getParameter(35738)||h===Xe&&(I.isWebGL2||d.has("OES_texture_float")||d.has("WEBGL_color_buffer_float"))||l?36053===U.checkFramebufferStatus(36160)?0<=i&&i<=t.width-n&&0<=r&&r<=t.height-s&&U.readPixels(i,r,n,s,v.convert(e),v.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type."))}finally{const t=null!==w?R.get(w).__webglFramebuffer:null;P.bindFramebuffer(36160,t)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,i=0){var r,n;!0!==t.isFramebufferTexture?console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture."):(n=Math.pow(2,-i),r=Math.floor(t.image.width*n),n=Math.floor(t.image.height*n),k.setTexture2D(t,0),U.copyTexSubImage2D(3553,i,0,0,e.x,e.y,r,n),P.unbindTexture())},this.copyTextureToTexture=function(e,t,i,r=0){var n=t.image.width,s=t.image.height,a=v.convert(i.format),o=v.convert(i.type);k.setTexture2D(i,0),U.pixelStorei(37440,i.flipY),U.pixelStorei(37441,i.premultiplyAlpha),U.pixelStorei(3317,i.unpackAlignment),t.isDataTexture?U.texSubImage2D(3553,r,e.x,e.y,n,s,a,o,t.image.data):t.isCompressedTexture?U.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):U.texSubImage2D(3553,r,e.x,e.y,a,o,t.image),0===r&&i.generateMipmaps&&U.generateMipmap(3553),P.unbindTexture()},this.copyTextureToTexture3D=function(t,i,r,n,s=0){if(x.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,l=t.max.z-t.min.z+1,h=v.convert(n.format),u=v.convert(n.type);let e;if(n.isDataTexture3D)k.setTexture3D(n,0),e=32879;else{if(!n.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");k.setTexture2DArray(n,0),e=35866}U.pixelStorei(37440,n.flipY),U.pixelStorei(37441,n.premultiplyAlpha),U.pixelStorei(3317,n.unpackAlignment);var c=U.getParameter(3314),d=U.getParameter(32878),p=U.getParameter(3316),f=U.getParameter(3315),m=U.getParameter(32877),g=r.isCompressedTexture?r.mipmaps[0]:r.image;U.pixelStorei(3314,g.width),U.pixelStorei(32878,g.height),U.pixelStorei(3316,t.min.x),U.pixelStorei(3315,t.min.y),U.pixelStorei(32877,t.min.z),r.isDataTexture||r.isDataTexture3D?U.texSubImage3D(e,s,i.x,i.y,i.z,a,o,l,h,u,g.data):r.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),U.compressedTexSubImage3D(e,s,i.x,i.y,i.z,a,o,l,h,g.data)):U.texSubImage3D(e,s,i.x,i.y,i.z,a,o,l,h,u,g),U.pixelStorei(3314,c),U.pixelStorei(32878,d),U.pixelStorei(3316,p),U.pixelStorei(3315,f),U.pixelStorei(32877,m),0===s&&n.generateMipmaps&&U.generateMipmap(e),P.unbindTexture()}},this.initTexture=function(e){k.setTexture2D(e,0),P.unbindTexture()},this.resetState=function(){X=0,Y=0,w=null,P.reset(),g.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}i.prototype.isWebGLRenderer=!0;(class Kh{constructor(e,t=25e-5){this.name="",this.color=new m(e),this.density=t}clone(){return new Kh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}).prototype.isFogExp2=class extends i{}.prototype.isWebGL1Renderer=!0;class Za{constructor(e,t=1,i=1e3){this.name="",this.color=new m(e),this.near=t,this.far=i}clone(){return new Za(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Za.prototype.isFog=!0;class Qa extends a{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){e=super.toJSON(e);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}Qa.prototype.isScene=!0;class eo{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=$t()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(i,r,n){i*=this.stride,n*=r.stride;for(let e=0,t=this.stride;e<t;e++)this.array[i+e]=r.array[n+e];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);e=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),e=new this.constructor(e,this.stride);return e.setUsage(this.usage),e}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=$t()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}eo.prototype.isInterleavedBuffer=!0;const l=new Pe;class to{constructor(e,t,i,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(i){for(let e=0,t=this.data.count;e<t;e++)l.x=this.getX(e),l.y=this.getY(e),l.z=this.getZ(e),l.applyMatrix4(i),this.setXYZ(e,l.x,l.y,l.z);return this}applyNormalMatrix(i){for(let e=0,t=this.count;e<t;e++)l.x=this.getX(e),l.y=this.getY(e),l.z=this.getZ(e),l.applyNormalMatrix(i),this.setXYZ(e,l.x,l.y,l.z);return this}transformDirection(i){for(let e=0,t=this.count;e<t;e++)l.x=this.getX(e),l.y=this.getY(e),l.z=this.getZ(e),l.transformDirection(i),this.setXYZ(e,l.x,l.y,l.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=n,this}clone(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new to(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){var i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return new E(new this.array.constructor(t),this.itemSize,this.normalized)}}toJSON(t){if(void 0!==t)return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){var i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}}to.prototype.isInterleavedBufferAttribute=!0;class io extends e{constructor(e){super(),this.type="SpriteMaterial",this.color=new m(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let ro;io.prototype.isSpriteMaterial=!0;const no=new Pe,so=new Pe,ao=new Pe,oo=new W,lo=new W,ho=new Re,uo=new Pe,co=new Pe,po=new Pe,fo=new W,mo=new W,go=new W;function vo(e,t,i,r,n,s){oo.subVectors(e,i).addScalar(.5).multiply(r),void 0!==n?(lo.x=s*oo.x-n*oo.y,lo.y=n*oo.x+s*oo.y):lo.copy(oo),e.copy(t),e.x+=lo.x,e.y+=lo.y,e.applyMatrix4(ho)}(class extends a{constructor(e){if(super(),this.type="Sprite",void 0===ro){ro=new w;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new eo(e,5);ro.setIndex([0,1,2,0,2,3]),ro.setAttribute("position",new to(t,3,0,!1)),ro.setAttribute("uv",new to(t,2,3,!1))}this.geometry=ro,this.material=void 0!==e?e:new io,this.center=new W(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),so.setFromMatrixScale(this.matrixWorld),ho.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ao.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&so.multiplyScalar(-ao.z);var i=this.material.rotation;let r,n;0!==i&&(n=Math.cos(i),r=Math.sin(i));var i=this.center,s=(vo(uo.set(-.5,-.5,0),ao,i,so,r,n),vo(co.set(.5,-.5,0),ao,i,so,r,n),vo(po.set(.5,.5,0),ao,i,so,r,n),fo.set(0,0),mo.set(1,0),go.set(1,1),e.ray.intersectTriangle(uo,co,po,!1,no));null===s&&(vo(co.set(-.5,.5,0),ao,i,so,r,n),mo.set(0,1),null===(s=e.ray.intersectTriangle(uo,po,co,!1,no)))||(i=e.ray.origin.distanceTo(no))<e.near||i>e.far||t.push({distance:i,point:no.clone(),uv:p.getUV(no,uo,co,po,fo,mo,go,new W),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const yo=new Pe,_o=new Ie,bo=new Ie,To=new Pe,xo=new Re;class wo extends S{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Re,this.bindMatrixInverse=new Re}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){var i=new Ie,r=this.geometry.attributes.skinWeight;for(let e=0,t=r.count;e<t;e++){i.x=r.getX(e),i.y=r.getY(e),i.z=r.getZ(e),i.w=r.getW(e);var n=1/i.manhattanLength();n!=1/0?i.multiplyScalar(n):i.set(1,0,0,0),r.setXYZW(e,i.x,i.y,i.z,i.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;_o.fromBufferAttribute(r.attributes.skinIndex,e),bo.fromBufferAttribute(r.attributes.skinWeight,e),yo.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const r=bo.getComponent(e);var n;0!==r&&(n=_o.getComponent(e),xo.multiplyMatrices(i.bones[n].matrixWorld,i.boneInverses[n]),t.addScaledVector(To.copy(yo).applyMatrix4(xo),r))}return t.applyMatrix4(this.bindMatrixInverse)}}wo.prototype.isSkinnedMesh=!0;class So extends a{constructor(){super(),this.type="Bone"}}So.prototype.isBone=!0;class Eo extends u{constructor(e=null,t=1,i=1,r,n,s,a,o,l=Ae,h=Ae,u,c){super(null,s,a,o,l,h,r,n,u,c),this.image={data:e,width:t,height:i},this.magFilter=l,this.minFilter=h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Eo.prototype.isDataTexture=!0;const Mo=new Re,Co=new Re;class Ao{constructor(e=[],t=[]){this.uuid=$t(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Re)}}calculateInverses(){for(let e=this.boneInverses.length=0,t=this.bones.length;e<t;e++){var i=new Re;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){var i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){var r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){var i=this.bones,r=this.boneInverses,n=this.boneMatrices,e=this.boneTexture;for(let e=0,t=i.length;e<t;e++){var s=i[e]?i[e].matrixWorld:Co;Mo.multiplyMatrices(s,r[e]),Mo.toArray(n,16*e)}null!==e&&(e.needsUpdate=!0)}clone(){return new Ao(this.bones,this.boneInverses)}computeBoneTexture(){var e=ei(Math.sqrt(4*this.bones.length)),t=(e=Math.max(e,4),new Float32Array(e*e*4)),i=(t.set(this.boneMatrices),new Eo(t,e,e,Le,Xe));return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(i){for(let e=0,t=this.bones.length;e<t;e++){var r=this.bones[e];if(r.name===i)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(i,r){this.uuid=i.uuid;for(let t=0,e=i.bones.length;t<e;t++){var n=i.bones[t];let e=r[n];void 0===e&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),e=new So),this.bones.push(e),this.boneInverses.push((new Re).fromArray(i.boneInverses[t]))}return this.init(),this}toJSON(){var i={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]},r=(i.uuid=this.uuid,this.bones),n=this.boneInverses;for(let e=0,t=r.length;e<t;e++){var s=r[e],s=(i.bones.push(s.uuid),n[e]);i.boneInverses.push(s.toArray())}return i}}class Lo extends E{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){var e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Lo.prototype.isInstancedBufferAttribute=!0;const Io=new Re,Po=new Re,Ro=[],ko=new S;(class extends S{constructor(e,t,i){super(e,t),this.instanceMatrix=new Lo(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,r){const n=this.matrixWorld,t=this.count;if(ko.geometry=this.geometry,ko.material=this.material,void 0!==ko.material)for(let i=0;i<t;i++){this.getMatrixAt(i,Io),Po.multiplyMatrices(n,Io),ko.matrixWorld=Po,ko.raycast(e,Ro);for(let e=0,t=Ro.length;e<t;e++){const n=Ro[e];n.instanceId=i,n.object=this,r.push(n)}Ro.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Lo(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class Do extends e{constructor(e){super(),this.type="LineBasicMaterial",this.color=new m(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Do.prototype.isLineBasicMaterial=!0;const Oo=new Pe,No=new Pe,Uo=new Re,Bo=new qi,Fo=new Bi;class Ho extends a{constructor(e=new w,t=new Do){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){var i=e.attributes.position,r=[0];for(let e=1,t=i.count;e<t;e++)Oo.fromBufferAttribute(i,e-1),No.fromBufferAttribute(i,e),r[e]=r[e-1],r[e]+=Oo.distanceTo(No);e.setAttribute("lineDistance",new y(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(i,r){const e=this.geometry,n=this.matrixWorld,s=i.params.Line.threshold,a=e.drawRange;if(null===e.boundingSphere&&e.computeBoundingSphere(),Fo.copy(e.boundingSphere),Fo.applyMatrix4(n),Fo.radius+=s,!1!==i.ray.intersectsSphere(Fo)){Uo.copy(n).invert(),Bo.copy(i.ray).applyMatrix4(Uo);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,h=new Pe,u=new Pe,c=new Pe,d=new Pe,p=this.isLineSegments?2:1;if(e.isBufferGeometry){const n=e.index,s=e.attributes.position;if(null!==n)for(let e=Math.max(0,a.start),t=Math.min(n.count,a.start+a.count)-1;e<t;e+=p){const a=n.getX(e),o=n.getX(e+1);if(h.fromBufferAttribute(s,a),u.fromBufferAttribute(s,o),!(Bo.distanceSqToSegment(h,u,d,c)>l)){d.applyMatrix4(this.matrixWorld);const p=i.ray.origin.distanceTo(d);p<i.near||p>i.far||r.push({distance:p,point:c.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}else for(let e=Math.max(0,a.start),t=Math.min(s.count,a.start+a.count)-1;e<t;e+=p)if(h.fromBufferAttribute(s,e),u.fromBufferAttribute(s,e+1),!(Bo.distanceSqToSegment(h,u,d,c)>l)){d.applyMatrix4(this.matrixWorld);const n=i.ray.origin.distanceTo(d);n<i.near||n>i.far||r.push({distance:n,point:c.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}else e.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){var e=i.morphAttributes,t=Object.keys(e);if(0<t.length){const i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){var r=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}}}else{e=i.morphTargets;void 0!==e&&0<e.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Ho.prototype.isLine=!0;const zo=new Pe,Vo=new Pe;class Go extends Ho{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){var i=e.attributes.position,r=[];for(let e=0,t=i.count;e<t;e+=2)zo.fromBufferAttribute(i,e),Vo.fromBufferAttribute(i,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+zo.distanceTo(Vo);e.setAttribute("lineDistance",new y(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Go.prototype.isLineSegments=!0;class Wo extends Ho{constructor(e,t){super(e,t),this.type="LineLoop"}}Wo.prototype.isLineLoop=!0;class jo extends e{constructor(e){super(),this.type="PointsMaterial",this.color=new m(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}jo.prototype.isPointsMaterial=!0;const qo=new Re,Xo=new qi,Yo=new Bi,$o=new Pe;class Ko extends a{constructor(e=new w,t=new jo){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(i,r){const e=this.geometry,n=this.matrixWorld,s=i.params.Points.threshold,a=e.drawRange;if(null===e.boundingSphere&&e.computeBoundingSphere(),Yo.copy(e.boundingSphere),Yo.applyMatrix4(n),Yo.radius+=s,!1!==i.ray.intersectsSphere(Yo)){qo.copy(n).invert(),Xo.copy(i.ray).applyMatrix4(qo);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o;if(e.isBufferGeometry){const s=e.index,o=e.attributes.position;if(null!==s)for(let e=Math.max(0,a.start),t=Math.min(s.count,a.start+a.count);e<t;e++){const a=s.getX(e);$o.fromBufferAttribute(o,a),Jo($o,a,l,n,i,r,this)}else for(let e=Math.max(0,a.start),t=Math.min(o.count,a.start+a.count);e<t;e++)$o.fromBufferAttribute(o,e),Jo($o,e,l,n,i,r,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}updateMorphTargets(){const i=this.geometry;if(i.isBufferGeometry){var e=i.morphAttributes,t=Object.keys(e);if(0<t.length){const i=e[t[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=i.length;e<t;e++){var r=i[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}}}else{e=i.morphTargets;void 0!==e&&0<e.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Jo(e,t,i,r,n,s,a){var o=Xo.distanceSqToPoint(e);if(o<i){const i=new Pe;Xo.closestPointToPoint(e,i),i.applyMatrix4(r);e=n.ray.origin.distanceTo(i);e<n.near||e>n.far||s.push({distance:e,distanceToRay:Math.sqrt(o),point:i,index:t,face:null,object:a})}}Ko.prototype.isPoints=!0,class extends u{constructor(t,e,i,r,n,s,a,o,l){super(t,e,i,r,n,s,a,o,l),this.minFilter=void 0!==s?s:V,this.magFilter=void 0!==n?n:V,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function e(){h.needsUpdate=!0,t.requestVideoFrameCallback(e)})}clone(){return new this.constructor(this.image).copy(this)}update(){var e=this.image;0=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class extends u{constructor(e,t,i){super({width:e,height:t}),this.format=i,this.magFilter=Ae,this.minFilter=Ae,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0,class extends u{constructor(e,t,i,r,n,s,a,o,l,h,u,c){super(null,s,a,o,l,h,r,n,u,c),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isCompressedTexture=!0,class extends u{constructor(e,t,i,r,n,s,a,o,l){super(e,t,i,r,n,s,a,o,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new Pe,new Pe,new Pe,new p;class Zo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){e=this.getUtoTmapping(e);return this.getPoint(e,t)}getPoints(t=5){var i=[];for(let e=0;e<=t;e++)i.push(this.getPoint(e/t));return i}getSpacedPoints(t=5){var i=[];for(let e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i}getLength(){var e=this.getLengths();return e[e.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i=[];let r,n=this.getPoint(0),s=0;i.push(0);for(let e=1;e<=t;e++)r=this.getPoint(e/t),s+=r.distanceTo(n),i.push(s),n=r;return this.cacheArcLengths=i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){var i=this.getLengths();let r=0;var n=i.length,s=t||e*i[n-1];let a,o=0,l=n-1;for(;o<=l;)if((a=i[r=Math.floor(o+(l-o)/2)]-s)<0)o=r+1;else{if(!(0<a)){l=r;break}l=r-1}return i[r=l]===s?r/(n-1):(t=i[r],(r+(s-t)/(i[r+1]-t))/(n-1))}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),1<r&&(r=1);var e=this.getPoint(i),n=this.getPoint(r),t=t||new(e.isVector2?W:Pe);return t.copy(n).sub(e).normalize(),t}getTangentAt(e,t){e=this.getUtoTmapping(e);return this.getTangent(e,t)}computeFrenetFrames(i,e){const t=new Pe,r=[],n=[],s=[],a=new Pe,o=new Re;for(let e=0;e<=i;e++){const t=e/i;r[e]=this.getTangentAt(t,new Pe)}n[0]=new Pe,s[0]=new Pe;let l=Number.MAX_VALUE;var h=Math.abs(r[0].x),u=Math.abs(r[0].y),c=Math.abs(r[0].z);h<=l&&(l=h,t.set(1,0,0)),u<=l&&(l=u,t.set(0,1,0)),c<=l&&t.set(0,0,1),a.crossVectors(r[0],t).normalize(),n[0].crossVectors(r[0],a),s[0].crossVectors(r[0],n[0]);for(let e=1;e<=i;e++){if(n[e]=n[e-1].clone(),s[e]=s[e-1].clone(),a.crossVectors(r[e-1],r[e]),a.length()>Number.EPSILON){a.normalize();const i=Math.acos(Kt(r[e-1].dot(r[e]),-1,1));n[e].applyMatrix4(o.makeRotationAxis(a,i))}s[e].crossVectors(r[e],n[e])}if(!0===e){let t=Math.acos(Kt(n[0].dot(n[i]),-1,1));t/=i,0<r[0].dot(a.crossVectors(n[0],n[i]))&&(t=-t);for(let e=1;e<=i;e++)n[e].applyMatrix4(o.makeRotationAxis(r[e],t*e)),s[e].crossVectors(r[e],n[e])}return{tangents:r,normals:n,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Qo extends Zo{constructor(e=0,t=0,i=1,r=1,n=0,s=2*Math.PI,a=!1,o=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){const i=t||new W,r=2*Math.PI;let n=this.aEndAngle-this.aStartAngle;for(t=Math.abs(n)<Number.EPSILON;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=t?0:r),!0!==this.aClockwise||t||(n===r?n=-r:n-=r);t=this.aStartAngle+e*n;let s=this.aX+this.xRadius*Math.cos(t),a=this.aY+this.yRadius*Math.sin(t);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),i=s-this.aX,r=a-this.aY;s=i*e-r*t+this.aX,a=i*t+r*e+this.aY}return i.set(s,a)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){var e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Qo.prototype.isEllipseCurve=!0;class el extends Qo{constructor(e,t,i,r,n,s){super(e,t,i,i,r,n,s),this.type="ArcCurve"}}function tl(){let n=0,s=0,a=0,o=0;function l(e,t,i,r){n=e,s=i,a=-3*e+3*t-2*i-r,o=2*e-2*t+i+r}return{initCatmullRom:function(e,t,i,r,n){l(t,i,n*(i-e),n*(r-t))},initNonuniformCatmullRom:function(e,t,i,r,n,s,a){e=(t-e)/n-(i-e)/(n+s)+(i-t)/s,n=(i-t)/s-(r-t)/(s+a)+(r-i)/a;l(t,i,e*=s,n*=s)},calc:function(e){var t=e*e;return n+s*e+a*t+o*(t*e)}}}el.prototype.isArcCurve=!0;const il=new Pe,rl=new tl,nl=new tl,sl=new tl;class al extends Zo{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(r,e=new Pe){var t=this.points,i=t.length,r=(i-(this.closed?0:1))*r;let n,s,a=Math.floor(r),o=r-a;this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/i)+1)*i:0===o&&a===i-1&&(a=i-2,o=1),n=this.closed||0<a?t[(a-1)%i]:(il.subVectors(t[0],t[1]).add(t[0]),il);var l=t[a%i],h=t[(a+1)%i];if(s=this.closed||a+2<i?t[(a+2)%i]:(il.subVectors(t[i-1],t[i-2]).add(t[i-1]),il),"centripetal"===this.curveType||"chordal"===this.curveType){const r="chordal"===this.curveType?.5:.25;let e=Math.pow(n.distanceToSquared(l),r),t=Math.pow(l.distanceToSquared(h),r),i=Math.pow(h.distanceToSquared(s),r);t<1e-4&&(t=1),e<1e-4&&(e=t),i<1e-4&&(i=t),rl.initNonuniformCatmullRom(n.x,l.x,h.x,s.x,e,t,i),nl.initNonuniformCatmullRom(n.y,l.y,h.y,s.y,e,t,i),sl.initNonuniformCatmullRom(n.z,l.z,h.z,s.z,e,t,i)}else"catmullrom"===this.curveType&&(rl.initCatmullRom(n.x,l.x,h.x,s.x,this.tension),nl.initCatmullRom(n.y,l.y,h.y,s.y,this.tension),sl.initCatmullRom(n.z,l.z,h.z,s.z,this.tension));return e.set(rl.calc(o),nl.calc(o),sl.calc(o)),e}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){var r=i.points[e];this.points.push(r.clone())}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}toJSON(){var i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){var r=this.points[e];i.points.push(r.toArray())}return i.closed=this.closed,i.curveType=this.curveType,i.tension=this.tension,i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){var r=i.points[e];this.points.push((new Pe).fromArray(r))}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}}function ol(e,t,i,r,n){var t=.5*(r-t),n=.5*(n-i),s=e*e;return e*s*(2*i-2*r+t+n)+(-3*i+3*r-2*t-n)*s+t*e+i}function ll(e,t,i,r){return(n=1-e)*n*t+2*(1-e)*e*i+e*e*r;var n}function hl(e,t,i,r,n){return(s=1-e)*s*s*t+3*(s=1-e)*s*e*i+3*(1-e)*e*e*r+e*e*e*n;var s}class ul extends Zo{constructor(e=new W,t=new W,i=new W,r=new W){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new W){var i=this.v0,r=this.v1,n=this.v2,s=this.v3;return t.set(hl(e,i.x,r.x,n.x,s.x),hl(e,i.y,r.y,n.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}ul.prototype.isCubicBezierCurve=al.prototype.isCatmullRomCurve3=!0;class cl extends Zo{constructor(e=new Pe,t=new Pe,i=new Pe,r=new Pe){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Pe){var i=this.v0,r=this.v1,n=this.v2,s=this.v3;return t.set(hl(e,i.x,r.x,n.x,s.x),hl(e,i.y,r.y,n.y,s.y),hl(e,i.z,r.z,n.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class dl extends Zo{constructor(e=new W,t=new W){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new W){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){t=t||new W;return t.copy(this.v2).sub(this.v1).normalize(),t}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}dl.prototype.isLineCurve=cl.prototype.isCubicBezierCurve3=!0;class pl extends Zo{constructor(e=new W,t=new W,i=new W){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new W){var i=this.v0,r=this.v1,n=this.v2;return t.set(ll(e,i.x,r.x,n.x),ll(e,i.y,r.y,n.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}pl.prototype.isQuadraticBezierCurve=!0;class fl extends Zo{constructor(e=new Pe,t=new Pe,i=new Pe){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Pe){var i=this.v0,r=this.v1,n=this.v2;return t.set(ll(e,i.x,r.x,n.x),ll(e,i.y,r.y,n.y),ll(e,i.z,r.z,n.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ml extends Zo{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new W){var i=this.points,e=(i.length-1)*e,r=Math.floor(e),e=e-r,n=i[0===r?r:r-1],s=i[r],a=i[r>i.length-2?i.length-1:r+1],i=i[r>i.length-3?i.length-1:r+2];return t.set(ol(e,n.x,s.x,a.x,i.x),ol(e,n.y,s.y,a.y,i.y)),t}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){var r=i.points[e];this.points.push(r.clone())}return this}toJSON(){var i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){var r=this.points[e];i.points.push(r.toArray())}return i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){var r=i.points[e];this.points.push((new W).fromArray(r))}return this}}ml.prototype.isSplineCurve=fl.prototype.isQuadraticBezierCurve3=!0;var gl=Object.freeze({__proto__:null,ArcCurve:el,CatmullRomCurve3:al,CubicBezierCurve:ul,CubicBezierCurve3:cl,EllipseCurve:Qo,LineCurve:dl,LineCurve3:class extends Zo{constructor(e=new Pe,t=new Pe){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Pe){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:pl,QuadraticBezierCurve3:fl,SplineCurve:ml});class vl extends Zo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new dl(t,e))}getPoint(e,t){var i=e*this.getLength(),r=this.getCurveLengths();let n=0;for(;n<r.length;){if(r[n]>=i){const e=r[n]-i,s=this.curves[n],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}n++}return null}getLength(){var e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var i=[];let r=0;for(let e=0,t=this.curves.length;e<t;e++)r+=this.curves[e].getLength(),i.push(r);return this.cacheLengths=i}getSpacedPoints(t=40){var i=[];for(let e=0;e<=t;e++)i.push(this.getPoint(e/t));return this.autoClose&&i.push(i[0]),i}getPoints(i=12){var r=[];let n;for(let e=0,t=this.curves;e<t.length;e++){var s=t[e],a=s&&s.isEllipseCurve?2*i:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?i*s.points.length:i,o=s.getPoints(a);for(let e=0;e<o.length;e++){var l=o[e];n&&n.equals(l)||(r.push(l),n=l)}}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(i){super.copy(i),this.curves=[];for(let e=0,t=i.curves.length;e<t;e++){var r=i.curves[e];this.curves.push(r.clone())}return this.autoClose=i.autoClose,this}toJSON(){var i=super.toJSON();i.autoClose=this.autoClose,i.curves=[];for(let e=0,t=this.curves.length;e<t;e++){var r=this.curves[e];i.curves.push(r.toJSON())}return i}fromJSON(i){super.fromJSON(i),this.autoClose=i.autoClose,this.curves=[];for(let e=0,t=i.curves.length;e<t;e++){var r=i.curves[e];this.curves.push((new gl[r.type]).fromJSON(r))}return this}}class yl extends vl{constructor(e){super(),this.type="Path",this.currentPoint=new W,e&&this.setFromPoints(e)}setFromPoints(i){this.moveTo(i[0].x,i[0].y);for(let e=1,t=i.length;e<t;e++)this.lineTo(i[e].x,i[e].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){var i=new dl(this.currentPoint.clone(),new W(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){e=new pl(this.currentPoint.clone(),new W(e,t),new W(i,r));return this.curves.push(e),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,n,s){e=new ul(this.currentPoint.clone(),new W(e,t),new W(i,r),new W(n,s));return this.curves.push(e),this.currentPoint.set(n,s),this}splineThru(e){var t=[this.currentPoint.clone()].concat(e),t=new ml(t);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,n,s){var a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,i,r,n,s),this}absarc(e,t,i,r,n,s){return this.absellipse(e,t,i,i,r,n,s),this}ellipse(e,t,i,r,n,s,a,o){var l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+l,t+h,i,r,n,s,a,o),this}absellipse(e,t,i,r,n,s,a,o){t=new Qo(e,t,i,r,n,s,a,o);if(0<this.curves.length){const e=t.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(t);e=t.getPoint(1);return this.currentPoint.copy(e),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){var e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class _l extends yl{constructor(e){super(e),this.uuid=$t(),this.type="Shape",this.holes=[]}getPointsHoles(i){var r=[];for(let e=0,t=this.holes.length;e<t;e++)r[e]=this.holes[e].getPoints(i);return r}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(i){super.copy(i),this.holes=[];for(let e=0,t=i.holes.length;e<t;e++){var r=i.holes[e];this.holes.push(r.clone())}return this}toJSON(){var i=super.toJSON();i.uuid=this.uuid,i.holes=[];for(let e=0,t=this.holes.length;e<t;e++){var r=this.holes[e];i.holes.push(r.toJSON())}return i}fromJSON(i){super.fromJSON(i),this.uuid=i.uuid,this.holes=[];for(let e=0,t=i.holes.length;e<t;e++){var r=i.holes[e];this.holes.push((new yl).fromJSON(r))}return this}}function bl(e,a,t,i,r){let n,s;if(r===0<function(i,r,n){let s=0;for(let e=a,t=r-n;e<r;e+=n)s+=(i[t]-i[e])*(i[e+1]+i[t+1]),t=e;return s}(e,t,i))for(n=a;n<t;n+=i)s=kl(n,e[n],e[n+1],s);else for(n=t-i;n>=a;n-=i)s=kl(n,e[n],e[n+1],s);return s&&Cl(s,s.next)&&(Dl(s),s=s.next),s}function Tl(e,t){if(!e)return e;t=t||e;let i,r=e;do{if(i=!1,r.steiner||!Cl(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(Dl(r),(r=t=r.prev)===r.next)break;i=!0}}while(i||r!==t);return t}function xl(r,n,s,a,o,l,h){if(r){if(!h&&l){var u=r;var c=a;var d=o;var p=l;let h=u;for(;null===h.z&&(h.z=El(h.x,h.y,c,d,p)),h.prevZ=h.prev,h.nextZ=h.next,(h=h.next)!==u;);h.prevZ.nextZ=null,h.prevZ=null;{var f=h;let e,t,i,r,n,s,a,o,l=1;do{for(t=f,f=null,n=null,s=0;t;){for(s++,i=t,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(o=l;0<a||0<o&&i;)0!==a&&(0===o||!i||t.z<=i.z)?(t=(r=t).nextZ,a--):(i=(r=i).nextZ,o--),n?n.nextZ=r:f=r,r.prevZ=n,n=r;t=i}}while(n.nextZ=null,l*=2,1<s)}}let e,t,i=r;for(;r.prev!==r.next;)if(e=r.prev,t=r.next,l?function(e,t,i,r){var n=e.prev,s=e,a=e.next;if(0<=g(n,s,a))return;var o=(n.x<s.x?n.x<a.x?n:a:s.x<a.x?s:a).x,l=(n.y<s.y?n.y<a.y?n:a:s.y<a.y?s:a).y,h=(n.x>s.x?n.x>a.x?n:a:s.x>a.x?s:a).x,u=(n.y>s.y?n.y>a.y?n:a:s.y>a.y?s:a).y,c=El(o,l,t,i,r),d=El(h,u,t,i,r);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=c&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&Ml(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&0<=g(p.prev,p,p.next))return;if(p=p.prevZ,f!==e.prev&&f!==e.next&&Ml(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&0<=g(f.prev,f,f.next))return;f=f.nextZ}for(;p&&p.z>=c;){if(p!==e.prev&&p!==e.next&&Ml(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&0<=g(p.prev,p,p.next))return;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&Ml(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&0<=g(f.prev,f,f.next))return;f=f.nextZ}return 1}(r,a,o,l):function(e){var t=e.prev,i=e,r=e.next;if(0<=g(t,i,r))return;let n=e.next.next;for(;n!==e.prev;){if(Ml(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&0<=g(n.prev,n,n.next))return;n=n.next}return 1}(r))n.push(e.i/s),n.push(r.i/s),n.push(t.i/s),Dl(r),r=t.next,i=t.next;else if((r=t)===i){h?1===h?xl(r=function(e,t,i){let r=e;do{var n=r.prev,s=r.next.next;!Cl(n,s)&&Al(n,r,r.next,s)&&Pl(n,s)&&Pl(s,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(s.i/i),Dl(r),Dl(r.next),r=e=s),r=r.next}while(r!==e);return Tl(r)}(Tl(r),n,s),n,s,a,o,l,2):2===h&&function(e,t,i,r,n,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){var o;if(a.i!==e.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Al(i,i.next,e,t))return 1}while((i=i.next)!==e)}(e,t)&&(Pl(e,t)&&Pl(t,e)&&function(e,t){let i=e,r=!1;for(var n=(e.x+t.x)/2,s=(e.y+t.y)/2;i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),(i=i.next)!==e;);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||Cl(e,t)&&0<g(e.prev,e,e.next)&&0<g(t.prev,t,t.next))}(a,e))return o=Rl(a,e),a=Tl(a,a.next),o=Tl(o,o.next),xl(a,t,i,r,n,s),xl(o,t,i,r,n,s);e=e.next}}while(a=a.next,a!==e)}(r,n,s,a,o,l):xl(Tl(r),n,s,a,o,l,1);break}}}function wl(e,t){return e.x-t.x}function Sl(e,t){(t=function(i,e){let r=e;var n=i.x,s=i.y;let a,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const i=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(i<=n&&i>o){if((o=i)===n){if(s===r.y)return r;if(s===r.next.y)return r.next}a=r.x<r.next.x?r:r.next}}}while((r=r.next)!==e);if(!a)return null;if(n!==o){var l,h,u=a,c=a.x,d=a.y;let e,t=1/0;for(r=a;n>=r.x&&r.x>=c&&n!==r.x&&Ml(s<d?n:o,s,c,d,s<d?o:n,s,r.x,r.y)&&(e=Math.abs(s-r.y)/(n-r.x),Pl(r,i))&&(e<t||e===t&&(r.x>a.x||r.x===a.x&&(l=a,h=r,g(l.prev,l,h.prev)<0)&&g(h.next,l,l.next)<0))&&(a=r,t=e),(r=r.next)!==u;);}return a}(e,t))&&(e=Rl(t,e),Tl(t,t.next),Tl(e,e.next))}function El(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ml(e,t,i,r,n,s,a,o){return 0<=(n-a)*(t-o)-(e-a)*(s-o)&&0<=(e-a)*(r-o)-(i-a)*(t-o)&&0<=(i-a)*(s-o)-(n-a)*(r-o)}function g(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Cl(e,t){return e.x===t.x&&e.y===t.y}function Al(e,t,i,r){var n=Il(g(e,t,i)),s=Il(g(e,t,r)),a=Il(g(i,r,e)),o=Il(g(i,r,t));return n!==s&&a!==o||0===n&&Ll(e,i,t)||0===s&&Ll(e,r,t)||0===a&&Ll(i,e,r)||0===o&&Ll(i,t,r)}function Ll(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Il(e){return 0<e?1:e<0?-1:0}function Pl(e,t){return g(e.prev,e,e.next)<0?0<=g(e,t,e.next)&&0<=g(e,e.prev,t):g(e,t,e.prev)<0||g(e,e.next,t)<0}function Rl(e,t){var i=new Ol(e.i,e.x,e.y),r=new Ol(t.i,t.x,t.y),n=e.next,s=t.prev;return(e.next=t).prev=e,(i.next=n).prev=i,(r.next=i).prev=r,(s.next=r).prev=s,r}function kl(e,t,i,r){e=new Ol(e,t,i);return r?(e.next=r.next,(e.prev=r).next.prev=e,r.next=e):(e.prev=e).next=e,e}function Dl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ol(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Nl{static area(i){var r=i.length;let n=0;for(let e=r-1,t=0;t<r;e=t++)n+=i[e].x*i[t].y-i[t].x*i[e].y;return.5*n}static isClockWise(e){return Nl.area(e)<0}static triangulateShape(e,t){var i=[],r=[],n=[];Ul(e),Bl(i,e);let s=e.length;t.forEach(Ul);for(let e=0;e<t.length;e++)r.push(s),s+=t[e].length,Bl(i,t[e]);var a=function(o,l){var h=l&&l.length,u=h?2*l[0]:o.length;let c=bl(o,0,u,2,!0);var d=[];if(c&&c.next!==c.prev){let t,i,r,n,s,a,e;if(h&&(c=function(e,t,i){var r=[];let n,s,a,o,l;for(n=0,s=t.length;n<s;n++)a=2*t[n],o=n<s-1?2*t[n+1]:e.length,(l=bl(e,a,o,2,!1))===l.next&&(l.steiner=!0),r.push(function(e){let t=e,i=e;for(;(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),(t=t.next)!==e;);return i}(l));for(r.sort(wl),n=0;n<r.length;n++)Sl(r[n],i),i=Tl(i,i.next);return i}(o,l,c)),160<o.length){t=r=o[0],i=n=o[1];for(let e=2;e<u;e+=2)s=o[e],a=o[e+1],s<t&&(t=s),a<i&&(i=a),s>r&&(r=s),a>n&&(n=a);e=0!==(e=Math.max(r-t,n-i))?1/e:0}xl(c,d,2,t,i,e)}return d}(i,r);for(let e=0;e<a.length;e+=3)n.push(a.slice(e,e+3));return n}}function Ul(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Bl(t,i){for(let e=0;e<i.length;e++)t.push(i[e].x),t.push(i[e].y)}class Fl extends w{constructor(i=new _l([new W(.5,.5),new W(-.5,.5),new W(-.5,-.5),new W(.5,-.5)]),B={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:i,options:B},i=Array.isArray(i)?i:[i];const F=this,H=[],z=[];for(let e=0,t=i.length;e<t;e++)!function(e){const r=[],N=void 0!==B.curveSegments?B.curveSegments:12,c=void 0!==B.steps?B.steps:1;let i=void 0!==B.depth?B.depth:1,n=void 0===B.bevelEnabled||B.bevelEnabled,t=void 0!==B.bevelThickness?B.bevelThickness:.2,s=void 0!==B.bevelSize?B.bevelSize:t-.1,a=void 0!==B.bevelOffset?B.bevelOffset:0,d=void 0!==B.bevelSegments?B.bevelSegments:3;const o=B.extrudePath,p=void 0!==B.UVGenerator?B.UVGenerator:Hl;void 0!==B.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),i=B.amount);let l,h,u,f,m,g=!1;o&&(l=o.getSpacedPoints(c),g=!0,n=!1,h=o.computeFrenetFrames(c,!1),u=new Pe,f=new Pe,m=new Pe),n||(d=0,t=0,s=0,a=0);e=e.extractPoints(N);let v=e.shape;const y=e.holes;if(!Nl.isClockWise(v)){v=v.reverse();for(let e=0,t=y.length;e<t;e++){const B=y[e];Nl.isClockWise(B)&&(y[e]=B.reverse())}}const _=Nl.triangulateShape(v,y),b=v;for(let e=0,t=y.length;e<t;e++){const B=y[e];v=v.concat(B)}function T(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}const x=v.length,w=_.length;function S(e,t,i){let r,n,s;const a=e.x-t.x,o=e.y-t.y,l=i.x-e.x,h=i.y-e.y,u=a*a+o*o,c=a*h-o*l;if(Math.abs(c)>Number.EPSILON){const c=Math.sqrt(u),d=Math.sqrt(l*l+h*h),p=t.x-o/c,f=t.y+a/c,m=((i.x-h/d-p)*h-(i.y+l/d-f)*l)/(a*h-o*l);r=p+a*m-e.x,n=f+o*m-e.y;t=r*r+n*n;if(t<=2)return new W(r,n);s=Math.sqrt(t/2)}else{let e=!1;a>Number.EPSILON?l>Number.EPSILON&&(e=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(h)&&(e=!0),s=e?(r=-o,n=a,Math.sqrt(u)):(r=a,n=o,Math.sqrt(u/2))}return new W(r/s,n/s)}var E=[];for(let e=0,t=b.length,i=t-1,r=e+1;e<t;e++,i++,r++)i===t&&(i=0),r===t&&(r=0),E[e]=S(b[e],b[i],b[r]);var M=[];let C,A=E.concat();for(let e=0,t=y.length;e<t;e++){const B=y[e];C=[];for(let e=0,t=B.length,i=t-1,r=e+1;e<t;e++,i++,r++)i===t&&(i=0),r===t&&(r=0),C[e]=S(B[e],B[i],B[r]);M.push(C),A=A.concat(C)}for(let e=0;e<d;e++){const B=e/d,F=t*Math.cos(B*Math.PI/2),H=s*Math.sin(B*Math.PI/2)+a;for(let e=0,t=b.length;e<t;e++){const B=T(b[e],E[e],H);I(B.x,B.y,-F)}for(let e=0,t=y.length;e<t;e++){const B=y[e];C=M[e];for(let e=0,t=B.length;e<t;e++){const z=T(B[e],C[e],H);I(z.x,z.y,-F)}}}var L=s+a;for(let e=0;e<x;e++){const B=n?T(v[e],A[e],L):v[e];g?(f.copy(h.normals[0]).multiplyScalar(B.x),u.copy(h.binormals[0]).multiplyScalar(B.y),m.copy(l[0]).add(f).add(u),I(m.x,m.y,m.z)):I(B.x,B.y,0)}for(let t=1;t<=c;t++)for(let e=0;e<x;e++){const F=n?T(v[e],A[e],L):v[e];g?(f.copy(h.normals[t]).multiplyScalar(F.x),u.copy(h.binormals[t]).multiplyScalar(F.y),m.copy(l[t]).add(f).add(u),I(m.x,m.y,m.z)):I(F.x,F.y,i/c*t)}for(let e=d-1;0<=e;e--){const B=e/d,F=t*Math.cos(B*Math.PI/2),H=s*Math.sin(B*Math.PI/2)+a;for(let e=0,t=b.length;e<t;e++){const B=T(b[e],E[e],H);I(B.x,B.y,i+F)}for(let e=0,t=y.length;e<t;e++){const B=y[e];C=M[e];for(let e=0,t=B.length;e<t;e++){const z=T(B[e],C[e],H);g?I(z.x,z.y+l[c-1].y,l[c-1].x+F):I(z.x,z.y,i+F)}}}function U(e,r){let n=e.length;for(;0<=--n;){var s=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,t=c+2*d;e<t;e++){const n=x*e,u=x*(e+1);h=l=o=a=void 0;var a=r+s+n,o=r+i+n,l=r+i+u,h=r+s+u;R(a),R(o),R(h),R(o),R(l),R(h),a=H.length/3,k((o=p.generateSideWallUV(F,H,a-6,a-3,a-2,a-1))[0]),k(o[1]),k(o[3]),k(o[1]),k(o[2]),k(o[3])}}}function I(e,t,i){r.push(e),r.push(t),r.push(i)}function P(e,t,i){R(e),R(t),R(i);e=H.length/3,t=p.generateTopUV(F,H,e-3,e-2,e-1);k(t[0]),k(t[1]),k(t[2])}function R(e){H.push(r[3*e+0]),H.push(r[3*e+1]),H.push(r[3*e+2])}function k(e){z.push(e.x),z.push(e.y)}{e=H.length/3;if(n){let e=0,t=0*x;for(let e=0;e<w;e++){const F=_[e];P(F[2]+t,F[1]+t,F[0]+t)}e=c+2*d,t=x*e;for(let e=0;e<w;e++){const F=_[e];P(F[0]+t,F[1]+t,F[2]+t)}}else{for(let e=0;e<w;e++){var D=_[e];P(D[2],D[1],D[0])}for(let e=0;e<w;e++){var O=_[e];P(O[0]+x*c,O[1]+x*c,O[2]+x*c)}}F.addGroup(e,H.length/3-e,0)}{e=H.length/3;let i=0;U(b,i),i+=b.length;for(let e=0,t=y.length;e<t;e++){const F=y[e];U(F,i),i+=F.length}F.addGroup(e,H.length/3-e,1)}}(i[e]);this.setAttribute("position",new y(H,3)),this.setAttribute("uv",new y(z,2)),this.computeVertexNormals()}toJSON(){var e=super.toJSON(),i=this.parameters.shapes,t=this.parameters.options,r=e;if(r.shapes=[],Array.isArray(i))for(let e=0,t=i.length;e<t;e++){var n=i[e];r.shapes.push(n.uuid)}else r.shapes.push(i.uuid);return void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}static fromJSON(i,r){var n=[];for(let e=0,t=i.shapes.length;e<t;e++){var s=r[i.shapes[e]];n.push(s)}var e=i.options.extrudePath;return void 0!==e&&(i.options.extrudePath=(new gl[e.type]).fromJSON(e)),new Fl(n,i.options)}}const Hl={generateTopUV:function(e,t,i,r,n){var s=t[3*i],i=t[3*i+1],a=t[3*r],r=t[3*r+1],o=t[3*n],t=t[3*n+1];return[new W(s,i),new W(a,r),new W(o,t)]},generateSideWallUV:function(e,t,i,r,n,s){var a=t[3*i],o=t[3*i+1],i=t[3*i+2],l=t[3*r],h=t[3*r+1],r=t[3*r+2],u=t[3*n],c=t[3*n+1],n=t[3*n+2],d=t[3*s],p=t[3*s+1],t=t[3*s+2];return Math.abs(o-h)<Math.abs(a-l)?[new W(a,1-i),new W(l,1-r),new W(u,1-n),new W(d,1-t)]:[new W(o,1-i),new W(h,1-r),new W(c,1-n),new W(p,1-t)]}};class zl extends w{constructor(t=new _l([new W(0,.5),new W(-.5,-.5),new W(.5,-.5)]),a=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:a};const o=[],l=[],h=[],u=[];let i=0,c=0;if(!1===Array.isArray(t))r(t);else for(let e=0;e<t.length;e++)r(t[e]),this.addGroup(i,c,e),i+=c,c=0;function r(e){var i=l.length/3,e=e.extractPoints(a);let r=e.shape;var n=e.holes;!1===Nl.isClockWise(r)&&(r=r.reverse());for(let e=0,t=n.length;e<t;e++){const a=n[e];!0===Nl.isClockWise(a)&&(n[e]=a.reverse())}var s=Nl.triangulateShape(r,n);for(let e=0,t=n.length;e<t;e++){const a=n[e];r=r.concat(a)}for(let e=0,t=r.length;e<t;e++){const a=r[e];l.push(a.x,a.y,0),h.push(0,0,1),u.push(a.x,a.y)}for(let e=0,t=s.length;e<t;e++){const a=s[e],l=a[0]+i,h=a[1]+i,u=a[2]+i;o.push(l,h,u),c+=3}}this.setIndex(o),this.setAttribute("position",new y(l,3)),this.setAttribute("normal",new y(h,3)),this.setAttribute("uv",new y(u,2))}toJSON(){var e=super.toJSON(),i=this.parameters.shapes,r=e;if(r.shapes=[],Array.isArray(i))for(let e=0,t=i.length;e<t;e++){var n=i[e];r.shapes.push(n.uuid)}else r.shapes.push(i.uuid);return r}static fromJSON(i,r){var n=[];for(let e=0,t=i.shapes.length;e<t;e++){var s=r[i.shapes[e]];n.push(s)}return new zl(n,i.curveSegments)}}(class extends e{constructor(e){super(),this.type="ShadowMaterial",this.color=new m(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}).prototype.isShadowMaterial=!0;class Vl extends e{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new m(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zt,this.normalScale=new W(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Vl.prototype.isMeshStandardMaterial=!0;class Gl extends Vl{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new W(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Kt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new m(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new m(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new m(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){0<this._sheen!=0<e&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){0<this._clearcoat!=0<e&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){0<this._transmission!=0<e&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Gl.prototype.isMeshPhysicalMaterial=!0,class extends e{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new m(16777215),this.specular=new m(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zt,this.normalScale=new W(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=I,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}.prototype.isMeshPhongMaterial=!0,class extends e{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new m(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zt,this.normalScale=new W(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}.prototype.isMeshToonMaterial=!0,class extends e{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zt,this.normalScale=new W(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}.prototype.isMeshNormalMaterial=!0,class extends e{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new m(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new m(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=I,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}.prototype.isMeshLambertMaterial=!0,class extends e{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new m(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zt,this.normalScale=new W(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}.prototype.isMeshMatcapMaterial=!0,class extends Do{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}.prototype.isLineDashedMaterial=!0;const _={arraySlice:function(e,t,i){return _.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(i){var t=i.length,r=new Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort(function(e,t){return i[e]-i[t]}),r},sortedArray:function(i,r,n){const s=i.length,a=new i.constructor(s);for(let e=0,t=0;t!==s;++e){const s=n[e]*r;for(let e=0;e!==r;++e)a[t++]=i[s+e]}return a},flattenJSON:function(t,i,r,n){let s=1,a=t[0];for(;void 0!==a&&void 0===a[n];)a=t[s++];if(void 0!==a){let e=a[n];if(void 0!==e)if(Array.isArray(e))for(;void 0!==(e=a[n])&&(i.push(a.time),r.push.apply(r,e)),void 0!==(a=t[s++]););else if(void 0!==e.toArray)for(;void 0!==(e=a[n])&&(i.push(a.time),e.toArray(r,r.length)),void 0!==(a=t[s++]););else for(;void 0!==(e=a[n])&&(i.push(a.time),r.push(e)),void 0!==(a=t[s++]););}},subclip:function(e,i,r,n,s=30){const a=e.clone();a.name=i;var t=[];for(let e=0;e<a.tracks.length;++e){const i=a.tracks[e],o=i.getValueSize(),l=[],h=[];for(let t=0;t<i.times.length;++t){const a=i.times[t]*s;if(!(a<r||a>=n)){l.push(i.times[t]);for(let e=0;e<o;++e)h.push(i.values[t*o+e])}}0!==l.length&&(i.times=_.convertArray(l,i.times.constructor),i.values=_.convertArray(h,i.values.constructor),t.push(i))}a.tracks=t;let o=1/0;for(let e=0;e<a.tracks.length;++e)o>a.tracks[e].times[0]&&(o=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*o);return a.resetDuration(),a},makeClipAdditive:function(r,n=0,s=r,a=30){const o=s.tracks.length,l=n/(a=a<=0?30:a);for(let e=0;e<o;++e){const a=s.tracks[e],o=a.ValueTypeName;if("bool"!==o&&"string"!==o){var h=r.tracks.find(function(e){return e.name===a.name&&e.ValueTypeName===o});if(void 0!==h){let e=0;var u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(e=u/3);let t=0;var c=h.getValueSize(),d=(h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(t=c/3),a.times.length-1);let i;if(l<=a.times[0]){const r=e,n=u-e;i=_.arraySlice(a.values,r,n)}else if(l>=a.times[d]){const r=d*u+e,n=r+u-e;i=_.arraySlice(a.values,r,n)}else{const r=a.createInterpolant(),n=e,s=u-e;r.evaluate(l),i=_.arraySlice(r.resultBuffer,n,s)}"quaternion"===o&&(new f).fromArray(i).normalize().conjugate().toArray(i);var p=h.times.length;for(let e=0;e<p;++e){const n=e*c+t;if("quaternion"===o)f.multiplyQuaternionsFlat(h.values,n,i,0,h.values,n);else{const r=c-2*t;for(let e=0;e<r;++e)h.values[n+e]-=i[e]}}}}}return r.blendMode=2501,r}};class Wl{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){var i=this.parameterPositions;let r=this._cachedIndex,n=i[r],s=i[r-1];e:{t:{let e;i:{r:if(!(t<n)){for(var a=r+2;;){if(void 0===n){if(t<s)break r;return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,t,s)}if(r===a)break;if(s=n,t<(n=i[++r]))break t}e=i.length;break i}if(t>=s)break e;var o=i[1];t<o&&(r=2,s=o);for(var l=r-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===l)break;if(n=s,t>=(s=i[--r-1]))break t}e=r,r=0}for(;r<e;){const n=r+e>>>1;t<i[n]?e=n:r=1+n}if(n=i[r],void 0===(s=i[r-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return r=i.length,this._cachedIndex=r,this.afterEnd_(r-1,s,t)}this._cachedIndex=r,this.intervalChanged_(r,s,n)}return this.interpolate_(r,s,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){var t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=e*r;for(let e=0;e!==r;++e)t[e]=i[n+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Wl.prototype.beforeStart_=Wl.prototype.copySampleValue_,Wl.prototype.afterEnd_=Wl.prototype.copySampleValue_;class jl extends Wl{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){var r=this.parameterPositions;let n=e-2,s=e+1,a=r[n],o=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:n=e,a=2*t-i;break;case 2402:n=r.length-2,a=t+r[n]-r[n+1];break;default:n=e,a=i}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:s=e,o=2*i-t;break;case 2402:s=1,o=i+r[1]-r[0];break;default:s=e-1,o=t}var l=.5*(i-t),h=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-i),this._offsetPrev=n*h,this._offsetNext=s*h}interpolate_(e,t,i,r){var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,h=this._offsetPrev,u=this._offsetNext,e=this._weightPrev,c=this._weightNext,i=(i-t)/(r-t),r=i*i,t=r*i,d=-e*t+2*e*r-e*i,p=(1+e)*t+(-1.5-2*e)*r+(-.5+e)*i+1,f=(-1-c)*t+(1.5+c)*r+.5*i,m=c*t-c*r;for(let e=0;e!==a;++e)n[e]=d*s[h+e]+p*s[l+e]+f*s[o+e]+m*s[u+e];return n}}class ql extends Wl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,h=(i-t)/(r-t),u=1-h;for(let e=0;e!==a;++e)n[e]=s[l+e]*u+s[o+e]*h;return n}}class Xl extends Wl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Yl{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_.convertArray(t,this.TimeBufferType),this.values=_.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:_.convertArray(e.times,Array),values:_.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(i.interpolation=t)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Xl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ql(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new jl(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ot:t=this.InterpolantFactoryMethodDiscrete;break;case Nt:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",t)}else this.createInterpolant=t;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ot;case this.InterpolantFactoryMethodLinear:return Nt;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(i){if(0!==i){var r=this.times;for(let e=0,t=r.length;e!==t;++e)r[e]+=i}return this}scale(i){if(1!==i){var r=this.times;for(let e=0,t=r.length;e!==t;++e)r[e]*=i}return this}trim(e,t){var i=this.times,r=i.length;let n=0,s=r-1;for(;n!==r&&i[n]<e;)++n;for(;-1!==s&&i[s]>t;)--s;if(++s,0!==n||s!==r){n>=s&&(s=Math.max(s,1),n=s-1);const e=this.getValueSize();this.times=_.arraySlice(i,n,s),this.values=_.arraySlice(this.values,n*e,s*e)}return this}validate(){let i=!0;var e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),i=!1);const r=this.times,n=this.values,t=r.length;0===t&&(console.error("THREE.KeyframeTrack: Track is empty.",this),i=!1);let s=null;for(let e=0;e!==t;e++){const n=r[e];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,n),i=!1;break}if(null!==s&&s>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,n,s),i=!1;break}s=n}if(void 0!==n&&_.isTypedArray(n))for(let e=0,t=n.length;e!==t;++e){const r=n[e];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,r),i=!1;break}}return i}optimize(){const i=_.arraySlice(this.times),r=_.arraySlice(this.values),n=this.getValueSize(),s=2302===this.getInterpolation(),a=i.length-1;let o=1;for(let e=1;e<a;++e){let t=!1;var l=i[e];if(l!==i[e+1]&&(1!==e||l!==i[0]))if(s)t=!0;else{const i=e*n,s=i-n,o=i+n;for(let e=0;e!==n;++e){const n=r[i+e];if(n!==r[s+e]||n!==r[o+e]){t=!0;break}}}if(t){if(e!==o){i[o]=i[e];const s=e*n,a=o*n;for(let e=0;e!==n;++e)r[a+e]=r[s+e]}++o}}if(0<a){i[o]=i[a];for(let e=a*n,t=o*n,i=0;i!==n;++i)r[t+i]=r[e+i];++o}return o!==i.length?(this.times=_.arraySlice(i,0,o),this.values=_.arraySlice(r,0,o*n)):(this.times=i,this.values=r),this}clone(){var e=_.arraySlice(this.times,0),t=_.arraySlice(this.values,0),e=new this.constructor(this.name,e,t);return e.createInterpolant=this.createInterpolant,e}}Yl.prototype.TimeBufferType=Float32Array,Yl.prototype.ValueBufferType=Float32Array,Yl.prototype.DefaultInterpolation=Nt;class $l extends Yl{}$l.prototype.ValueTypeName="bool",$l.prototype.ValueBufferType=Array,$l.prototype.DefaultInterpolation=Ot,$l.prototype.InterpolantFactoryMethodLinear=void 0,$l.prototype.InterpolantFactoryMethodSmooth=void 0;class Kl extends Yl{}Kl.prototype.ValueTypeName="color";class Jl extends Yl{}Jl.prototype.ValueTypeName="number";class Zl extends Wl{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){var n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-t)/(r-t);let l=e*a;for(var h=l+a;l!==h;l+=4)f.slerpFlat(n,0,s,l-a,s,l,o);return n}}class Ql extends Yl{InterpolantFactoryMethodLinear(e){return new Zl(this.times,this.values,this.getValueSize(),e)}}Ql.prototype.ValueTypeName="quaternion",Ql.prototype.DefaultInterpolation=Nt,Ql.prototype.InterpolantFactoryMethodSmooth=void 0;class eh extends Yl{}eh.prototype.ValueTypeName="string",eh.prototype.ValueBufferType=Array,eh.prototype.DefaultInterpolation=Ot,eh.prototype.InterpolantFactoryMethodLinear=void 0,eh.prototype.InterpolantFactoryMethodSmooth=void 0;class th extends Yl{}class ih{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=$t(),this.duration<0&&this.resetDuration()}static parse(e){var i=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,t=r.length;e!==t;++e)i.push(function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Jl;case"vector":case"vector2":case"vector3":case"vector4":return th;case"color":return Kl;case"quaternion":return Ql;case"bool":case"boolean":return $l;case"string":return eh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],i=[];_.flattenJSON(e.keys,t,i,"value"),e.times=t,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}(r[e]).scale(n));var t=new this(e.name,e.duration,i,e.blendMode);return t.uuid=e.uuid,t}static toJSON(e){var i=[],r=e.tracks,e={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,t=r.length;e!==t;++e)i.push(Yl.toJSON(r[e]));return e}static CreateFromMorphTargetSequence(e,r,n,s){var a=r.length,o=[];for(let i=0;i<a;i++){let e=[],t=[];e.push((i+a-1)%a,i,(i+1)%a),t.push(0,1,0);var l=_.getKeyframeOrder(e);e=_.sortedArray(e,1,l),t=_.sortedArray(t,1,l),s||0!==e[0]||(e.push(a),t.push(t[0])),o.push(new Jl(".morphTargetInfluences["+r[i].name+"]",e,t).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const t=e;i=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<i.length;e++)if(i[e].name===t)return i[e];return null}static CreateClipsFromMorphTargetSequences(i,e,r){var n={},s=/^([\w-]*?)([\d]+)$/;for(let e=0,t=i.length;e<t;e++){const r=i[e],a=r.name.match(s);if(a&&1<a.length){const i=a[1];let e=n[i];e||(n[i]=e=[]),e.push(r)}}const a=[];for(const i in n)a.push(this.CreateFromMorphTargetSequence(i,n[i],e,r));return a}static parseAnimation(i,t){if(!i)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(e,t,i,r,n){var s,a;0!==i.length&&(s=[],a=[],_.flattenJSON(i,s,a,r),0!==s.length)&&n.push(new e(t,s,a))},n=[],s=i.name||"default",a=i.fps||30,e=i.blendMode;let o=i.length||-1;var l=i.hierarchy||[];for(let e=0;e<l.length;e++){const s=l[e].keys;if(s&&0!==s.length)if(s[0].morphTargets){const i={};let t;for(t=0;t<s.length;t++)if(s[t].morphTargets)for(let e=0;e<s[t].morphTargets.length;e++)i[s[t].morphTargets[e]]=-1;for(const r in i){const i=[],a=[];for(let e=0;e!==s[t].morphTargets.length;++e){const n=s[t];i.push(n.time),a.push(n.morphTarget===r?1:0)}n.push(new Jl(".morphTargetInfluence["+r+"]",i,a))}o=i.length*(a||1)}else{const a=".bones["+t[e].name+"]";r(th,a+".position",s,"pos",n),r(Ql,a+".quaternion",s,"rot",n),r(th,a+".scale",s,"scl",n)}}return 0===n.length?null:new this(s,o,n,e)}resetDuration(){let i=0;for(let e=0,t=this.tracks.length;e!==t;++e){var r=this.tracks[e];i=Math.max(i,r.times[r.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){var t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const rh={enabled:!(th.prototype.ValueTypeName="vector"),files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},nh=new class{constructor(e,t,i){const r=this;let n,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){o++,!1===s&&void 0!==r.onStart&&r.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(s=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){e=l.indexOf(e);return-1!==e&&l.splice(e,2),this},this.getHandler=function(i){for(let e=0,t=l.length;e<t;e+=2){var r=l[e],n=l[e+1];if(r.global&&(r.lastIndex=0),r.test(i))return n}return null}}};class sh{constructor(e){this.manager=void 0!==e?e:nh,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(i,r){const n=this;return new Promise(function(e,t){n.load(i,e,r,t)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const ah={};class oh extends sh{constructor(e){super(e)}load(l,e,t,i){void 0===l&&(l=""),void 0!==this.path&&(l=this.path+l),l=this.manager.resolveURL(l);const r=rh.get(l);if(void 0!==r)return this.manager.itemStart(l),setTimeout(()=>{e&&e(r),this.manager.itemEnd(l)},0),r;if(void 0!==ah[l])ah[l].push({onLoad:e,onProgress:t,onError:i});else{ah[l]=[],ah[l].push({onLoad:e,onProgress:t,onError:i});const n=new Request(l,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,a=this.responseType;fetch(n).then(e=>{if(200!==e.status&&0!==e.status)throw Error(`fetch for "${e.url}" responded with ${e.status}: `+e.statusText);{if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body.getReader)return e;const s=ah[l],i=e.body.getReader(),t=e.headers.get("Content-Length"),a=t?parseInt(t):0,o=0!==a;let n=0;e=new ReadableStream({start(t){!function r(){i.read().then(({done:i,value:e})=>{if(i)t.close();else{n+=e.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:n,total:a});for(let e=0,t=s.length;e<t;e++){const r=s[e];r.onProgress&&r.onProgress(i)}t.enqueue(e),r()}})}()}});return new Response(e)}}).then(e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,s));case"json":return e.json();default:if(void 0===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),i=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(i);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(i=>{rh.add(l,i);var r=ah[l];delete ah[l];for(let e=0,t=r.length;e<t;e++){var n=r[e];n.onLoad&&n.onLoad(i)}}).catch(i=>{var r=ah[l];if(void 0===r)throw this.manager.itemError(l),i;delete ah[l];for(let e=0,t=r.length;e<t;e++){var n=r[e];n.onError&&n.onError(i)}this.manager.itemError(l)}).finally(()=>{this.manager.itemEnd(l)}),this.manager.itemStart(l)}}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class lh extends sh{constructor(e){super(e)}load(t,e,i,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const n=this,s=rh.get(t);if(void 0!==s)return n.manager.itemStart(t),setTimeout(function(){e&&e(s),n.manager.itemEnd(t)},0),s;const a=ni("img");function o(){h(),rh.add(t,this),e&&e(this),n.manager.itemEnd(t)}function l(e){h(),r&&r(e),n.manager.itemError(t),n.manager.itemEnd(t)}function h(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(t),a.src=t,a}}class hh extends sh{constructor(e){super(e)}load(i,r,e,n){const s=new hn,a=new lh(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;for(let e=0;e<i.length;++e)!function(t){a.load(i[t],function(e){s.images[t]=e,6===++o&&(s.needsUpdate=!0,r)&&r(s)},void 0,n)}(e);return s}}class uh extends sh{constructor(e){super(e)}load(e,t,i,r){const n=new u,s=new lh(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(e){n.image=e,n.needsUpdate=!0,void 0!==t&&t(n)},i,r),n}}class ch extends a{constructor(e,t=1){super(),this.type="Light",this.color=new m(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){e=super.toJSON(e);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}ch.prototype.isLight=!0;class dh extends ch{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(a.DefaultUp),this.updateMatrix(),this.groundColor=new m(t)}copy(e){return ch.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}dh.prototype.isHemisphereLight=!0;const ph=new Re,fh=new Pe,mh=new Pe;class gh{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new W(512,512),this.map=null,this.mapPass=null,this.matrix=new Re,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vn,this._frameExtents=new W(1,1),this._viewportCount=1,this._viewports=[new Ie(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){var t=this.camera,i=this.matrix;fh.setFromMatrixPosition(e.matrixWorld),t.position.copy(fh),mh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(mh),t.updateMatrixWorld(),ph.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ph),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vh extends gh{constructor(){super(new D(50,1,.5,500)),this.focus=1}updateMatrices(e){var t=this.camera,i=2*Yt*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;i===t.fov&&r===t.aspect&&n===t.far||(t.fov=i,t.aspect=r,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}vh.prototype.isSpotLightShadow=!0;class yh extends ch{constructor(e,t,i=0,r=Math.PI/3,n=0,s=1){super(e,t),this.type="SpotLight",this.position.copy(a.DefaultUp),this.updateMatrix(),this.target=new a,this.distance=i,this.angle=r,this.penumbra=n,this.decay=s,this.shadow=new vh}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}yh.prototype.isSpotLight=!0;const _h=new Re,bh=new Pe,Th=new Pe;class xh extends gh{constructor(){super(new D(90,1,.5,500)),this._frameExtents=new W(4,2),this._viewportCount=6,this._viewports=[new Ie(2,1,1,1),new Ie(0,1,1,1),new Ie(3,1,1,1),new Ie(1,1,1,1),new Ie(3,0,1,1),new Ie(1,0,1,1)],this._cubeDirections=[new Pe(1,0,0),new Pe(-1,0,0),new Pe(0,0,1),new Pe(0,0,-1),new Pe(0,1,0),new Pe(0,-1,0)],this._cubeUps=[new Pe(0,1,0),new Pe(0,1,0),new Pe(0,1,0),new Pe(0,1,0),new Pe(0,0,1),new Pe(0,0,-1)]}updateMatrices(e,t=0){var i=this.camera,r=this.matrix,n=e.distance||i.far;n!==i.far&&(i.far=n,i.updateProjectionMatrix()),bh.setFromMatrixPosition(e.matrixWorld),i.position.copy(bh),Th.copy(i.position),Th.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Th),i.updateMatrixWorld(),r.makeTranslation(-bh.x,-bh.y,-bh.z),_h.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_h)}}xh.prototype.isPointLightShadow=!0;class wh extends ch{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new xh}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}wh.prototype.isPointLight=!0;class Sh extends gh{constructor(){super(new An(-5,5,5,-5,.5,500))}}Sh.prototype.isDirectionalLightShadow=!0;class Eh extends ch{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(a.DefaultUp),this.updateMatrix(),this.target=new a,this.shadow=new Sh}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Eh.prototype.isDirectionalLight=!0;class Mh extends ch{constructor(e,t){super(e,t),this.type="AmbientLight"}}Mh.prototype.isAmbientLight=!0;class Ch{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Pe)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){var i=e.x,r=e.y,e=e.z,n=this.coefficients;return t.copy(n[0]).multiplyScalar(.282095),t.addScaledVector(n[1],.488603*r),t.addScaledVector(n[2],.488603*e),t.addScaledVector(n[3],.488603*i),t.addScaledVector(n[4],i*r*1.092548),t.addScaledVector(n[5],r*e*1.092548),t.addScaledVector(n[6],.315392*(3*e*e-1)),t.addScaledVector(n[7],i*e*1.092548),t.addScaledVector(n[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){var i=e.x,r=e.y,e=e.z,n=this.coefficients;return t.copy(n[0]).multiplyScalar(.886227),t.addScaledVector(n[1],1.023328*r),t.addScaledVector(n[2],1.023328*e),t.addScaledVector(n[3],1.023328*i),t.addScaledVector(n[4],.858086*i*r),t.addScaledVector(n[5],.858086*r*e),t.addScaledVector(n[6],.743125*e*e-.247708),t.addScaledVector(n[7],.858086*i*e),t.addScaledVector(n[8],.429043*(i*i-r*r)),t}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,i){for(let e=0;e<9;e++)this.coefficients[e].addScaledVector(t.coefficients[e],i);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,i){for(let e=0;e<9;e++)this.coefficients[e].lerp(t.coefficients[e],i);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,i=0){var r=this.coefficients;for(let e=0;e<9;e++)r[e].fromArray(t,i+3*e);return this}toArray(t=[],i=0){var r=this.coefficients;for(let e=0;e<9;e++)r[e].toArray(t,i+3*e);return t}static getBasisAt(e,t){var i=e.x,r=e.y,e=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*e,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*i*e,t[8]=.546274*(i*i-r*r)}}Ch.prototype.isSphericalHarmonics3=class extends ch{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){e=super.toJSON(e);return e.object.width=this.width,e.object.height=this.height,e}}.prototype.isRectAreaLight=!0;class Ah extends ch{constructor(e=new Ch,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){e=super.toJSON(e);return e.object.sh=this.sh.toArray(),e}}Ah.prototype.isLightProbe=!0;class Lh{static decodeText(i){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(i);let r="";for(let e=0,t=i.length;e<t;e++)r+=String.fromCharCode(i[e]);try{return decodeURIComponent(escape(r))}catch(i){return r}}static extractUrlBase(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}(class extends w{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){var e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0;class Ih extends sh{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(t,i,e,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const n=this,s=rh.get(t);if(void 0!==s)return n.manager.itemStart(t),setTimeout(function(){i&&i(s),n.manager.itemEnd(t)},0),s;var a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(e){rh.add(t,e),i&&i(e),n.manager.itemEnd(t)}).catch(function(e){r&&r(e),n.manager.itemError(t),n.manager.itemEnd(t)}),n.manager.itemStart(t)}}let Ph;Ih.prototype.isImageBitmapLoader=!0;class Rh extends sh{constructor(e){super(e)}load(t,i,e,r){const n=this,s=new oh(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(e){try{const t=e.slice(0);(Ph=void 0===Ph?new(window.AudioContext||window.webkitAudioContext):Ph).decodeAudioData(t,function(e){i(e)})}catch(e){r?r(e):console.error(e),n.manager.itemError(t)}},e,r)}}(class extends Ah{constructor(e,t=1){super(void 0,t);t=(new m).set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}}).prototype.isAmbientLightProbe=class extends Ah{constructor(e,t,i=1){super(void 0,i);var i=(new m).set(e),e=(new m).set(t),t=new Pe(i.r,i.g,i.b),i=new Pe(e.r,e.g,e.b),e=Math.sqrt(Math.PI),r=e*Math.sqrt(.75);this.sh.coefficients[0].copy(t).add(i).multiplyScalar(e),this.sh.coefficients[1].copy(t).sub(i).multiplyScalar(r)}}.prototype.isHemisphereLightProbe=!0;class kh{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Dh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;var t;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=Dh(),e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}function Dh(){return("undefined"==typeof performance?Date:performance).now()}class Oh{constructor(e,t,i){let r,n,s;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){var i=this.buffer,r=this.valueSize,n=e*r+r;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==r;++e)i[n+e]=i[e];s=t}else{const e=t/(s+=t);this._mixBufferRegion(i,n,0,e,r)}this.cumulativeWeight=s}accumulateAdditive(e){var t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){var i=this.valueSize,r=this.buffer,n=e*i+i,t=this.cumulativeWeight,e=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,t<1){const e=i*this._origIndex;this._mixBufferRegion(r,n,e,1-t,i)}0<e&&this._mixBufferRegionAdditive(r,n,this._addIndex*i,1,i);for(let e=i,t=i+i;e!==t;++e)if(r[e]!==r[e+i]){s.setValue(r,n);break}}saveOriginalState(){var e=this.binding,i=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(i,n);for(let e=r,t=n;e!==t;++e)i[e]=i[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){var t=this._addIndex*this.valueSize,i=t+this.valueSize;for(let e=t;e<i;e++)this.buffer[e]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){var t=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let e=0;e<this.valueSize;e++)this.buffer[i+e]=this.buffer[t+e]}_select(t,i,r,e,n){if(.5<=e)for(let e=0;e!==n;++e)t[i+e]=t[r+e]}_slerp(e,t,i,r){f.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,n){n=this._workIndex*n;f.multiplyQuaternionsFlat(e,n,e,t,e,i),f.slerpFlat(e,t,e,t,e,n,r)}_lerp(t,i,r,n,s){var a=1-n;for(let e=0;e!==s;++e){const s=i+e;t[s]=t[s]*a+t[r+e]*n}}_lerpAdditive(t,i,r,n,s){for(let e=0;e!==s;++e){const s=i+e;t[s]=t[s]+t[r+e]*n}}}const Nh="\\[\\]\\.:\\/",Uh=new RegExp("["+Nh+"]","g"),Bh="[^"+Nh+"]",Fh="[^"+Nh.replace("\\.","")+"]",Hh=/((?:WC+[\/:])*)/.source.replace("WC",Bh),zh=/(WCOD+)?/.source.replace("WCOD",Fh),Vh=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Bh),Gh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Bh),Wh=new RegExp("^"+Hh+zh+Vh+Gh+"$"),jh=["material","materials","bones"];class c{constructor(e,t,i){this.path=t,this.parsedPath=i||c.parseTrackName(t),this.node=c.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return new(e&&e.isAnimationObjectGroup?c.Composite:c)(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Uh,"")}static parseTrackName(e){var t=Wh.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=t.nodeName&&t.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=t.nodeName.substring(i+1);-1!==jh.indexOf(e)&&(t.nodeName=t.nodeName.substring(0,i),t.objectName=e)}if(null===t.propertyName||0===t.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t}static findNode(e,r){if(!r||""===r||"."===r||-1===r||r===e.name||r===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(r);if(void 0!==t)return t}if(e.children){const n=function(t){for(let e=0;e<t.length;e++){var i=t[e];if(i.name===r||i.uuid===r)return i;i=n(i.children);if(i)return i}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(i,r){var n=this.resolvedProperty;for(let e=0,t=n.length;e!==t;++e)i[r++]=n[e]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(i,r){var n=this.resolvedProperty;for(let e=0,t=n.length;e!==t;++e)n[e]=i[r++]}_setValue_array_setNeedsUpdate(i,r){var n=this.resolvedProperty;for(let e=0,t=n.length;e!==t;++e)n[e]=i[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(i,r){var n=this.resolvedProperty;for(let e=0,t=n.length;e!==t;++e)n[e]=i[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let i=this.node;const e=this.parsedPath,r=e.objectName,n=e.propertyName;let s=e.propertyIndex;if(i||(i=c.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=i),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,i){if(r){let t=e.objectIndex;switch(r){case"materials":if(!i.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!i.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);i=i.material.materials;break;case"bones":if(!i.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);i=i.skeleton.bones;for(let e=0;e<i.length;e++)if(i[e].name===t){t=e;break}break;default:if(void 0===i[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);i=i[r]}if(void 0!==t){if(void 0===i[t])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,i);i=i[t]}}var a=i[n];if(void 0===a){const r=e.nodeName;void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+n+" but it wasn't found.",i)}else{let e=this.Versioning.None,t=(void 0!==(this.targetObject=i).needsUpdate?e=this.Versioning.NeedsUpdate:void 0!==i.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate),this.BindingType.Direct);if(void 0!==s){if("morphTargetInfluences"===n){if(!i.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!i.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!i.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==i.morphTargetDictionary[s]&&(s=i.morphTargetDictionary[s])}t=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else void 0!==a.fromArray&&void 0!==a.toArray?(t=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(t=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[t],this.setValue=this.SetterByBindingTypeAndVersioning[t][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}c.Composite=class{constructor(e,t,i){i=i||c.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,i=this._bindings[i];void 0!==i&&i.getValue(e,t)}setValue(i,r){var n=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=n.length;e!==t;++e)n[e].setValue(i,r)}bind(){var i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].bind()}unbind(){var i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].unbind()}},c.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},c.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},c.prototype.GetterByBindingType=[c.prototype._getValue_direct,c.prototype._getValue_array,c.prototype._getValue_arrayElement,c.prototype._getValue_toArray],c.prototype.SetterByBindingTypeAndVersioning=[[c.prototype._setValue_direct,c.prototype._setValue_direct_setNeedsUpdate,c.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[c.prototype._setValue_array,c.prototype._setValue_array_setNeedsUpdate,c.prototype._setValue_array_setMatrixWorldNeedsUpdate],[c.prototype._setValue_arrayElement,c.prototype._setValue_arrayElement_setNeedsUpdate,c.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[c.prototype._setValue_fromArray,c.prototype._setValue_fromArray_setNeedsUpdate,c.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class qh{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;var n=t.tracks,s=n.length,a=new Array(s),o={endingStart:2400,endingEnd:2400};for(let e=0;e!==s;++e){const t=n[e].createInterpolant(null);(a[e]=t).settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const i=this._clip.duration,r=e._clip.duration,n=r/i,s=i/r;e.warp(1,n,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){var r=this._mixer,n=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var r=a.parameterPositions,o=a.sampleValues;return r[0]=n,r[1]=n+i,o[0]=e/s,o[1]=t/s,this}stopWarping(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,r,e,n){if(this.enabled){var t=this._startTime;if(null!==t){const n=(i-t)*e;if(n<0||0===e)return;this._startTime=null,r=e*n}r*=this._updateTimeScale(i);var s=this._updateTime(r),a=this._updateWeight(i);if(0<a){const i=this._interpolants,r=this._propertyBindings;if(2501===this.blendMode)for(let e=0,t=i.length;e!==t;++e)i[e].evaluate(s),r[e].accumulateAdditive(a);else for(let e=0,t=i.length;e!==t;++e)i[e].evaluate(s),r[e].accumulate(n,a)}}else this._updateWeight(i)}_updateWeight(e){let t=0;var i,r;return this.enabled&&(t=this.weight,null!==(i=this._weightInterpolant))&&(r=i.evaluate(e)[0],t*=r,e>i.parameterPositions[1])&&(this.stopFading(),0===r)&&(this.enabled=!1),this._effectiveWeight=t}_updateTimeScale(e){let t=0;var i;return this.paused||(t=this.timeScale,null!==(i=this._timeScaleInterpolant)&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1])&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)),this._effectiveTimeScale=t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,n=this._loopCount;var s=2202===i;if(0===e)return-1!==n&&s&&1==(1&n)?t-r:r;if(2200===i){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===n&&(0<=e?(n=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=t||r<0){const i=Math.floor(r/t);r-=t*i,n+=Math.abs(i);var a=this.repetitions-n;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=0<e?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1==a){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=r;if(s&&1==(1&n))return t-r}return r}_setEndings(e,t,i){var r=this._interpolantSettings;i?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(e,t,i){var r=this._mixer,n=r.time;let s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);var r=s.parameterPositions,a=s.sampleValues;return r[0]=n,a[0]=t,r[1]=n+e,a[1]=i,this}}(class extends jt{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const r=e._localRoot||this._root,n=e._clip.tracks,s=n.length,a=e._propertyBindings,o=e._interpolants,l=r.uuid,h=this._bindingsByRootAndName;let u=h[l];void 0===u&&(u={},h[l]=u);for(let t=0;t!==s;++t){const s=n[t],h=s.name;let e=u[h];if(void 0!==e)++e.referenceCount;else{if(void 0!==(e=a[t])){null===e._cacheIndex&&(++e.referenceCount,this._addInactiveBinding(e,l,h));continue}const n=i&&i._propertyBindings[t].binding.parsedPath;++(e=new Oh(c.create(r,h,n),s.ValueTypeName,s.getValueSize())).referenceCount,this._addInactiveBinding(e,l,h)}a[t]=e,o[t].resultBuffer=e.buffer}}_activateAction(e){if(!this._isActiveAction(e)){null===e._cacheIndex&&(t=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i],this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,t));var t,i,r,n=e._propertyBindings;for(let e=0,t=n.length;e!==t;++e){var s=n[e];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){var i=e._propertyBindings;for(let e=0,t=i.length;e!==t;++e){var r=i[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){e=e._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(e,t,i){var r=this._actions,n=this._actionsByClip;let s=n[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){var t=this._actions,i=t[t.length-1],r=e._cacheIndex,r=(t[i._cacheIndex=r]=i,t.pop(),e._cacheIndex=null,e._clip.uuid),i=this._actionsByClip,t=i[r],n=t.knownActions,s=n[n.length-1],a=e._byClipCacheIndex;n[s._byClipCacheIndex=a]=s,n.pop(),e._byClipCacheIndex=null,delete t.actionByRoot[(e._localRoot||this._root).uuid],0===n.length&&delete i[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){var i=e._propertyBindings;for(let e=0,t=i.length;e!==t;++e){var r=i[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){var t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,n=t[r];t[e._cacheIndex=r]=e,t[n._cacheIndex=i]=n}_takeBackAction(e){var t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,n=t[r];t[e._cacheIndex=r]=e,t[n._cacheIndex=i]=n}_addInactiveBinding(e,t,i){var r=this._bindingsByRootAndName,n=this._bindings;let s=r[t];void 0===s&&(s={},r[t]=s),(s[i]=e)._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){var t=this._bindings,i=e.binding,r=i.rootNode.uuid,i=i.path,n=this._bindingsByRootAndName,s=n[r],a=t[t.length-1],e=e._cacheIndex;t[a._cacheIndex=e]=a,t.pop(),delete s[i],0===Object.keys(s).length&&delete n[r]}_lendBinding(e){var t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,n=t[r];t[e._cacheIndex=r]=e,t[n._cacheIndex=i]=n}_takeBackBinding(e){var t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,n=t[r];t[e._cacheIndex=r]=e,t[n._cacheIndex=i]=n}_lendControlInterpolant(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(e[(i=new ql(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=i),i}_takeBackControlInterpolant(e){var t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,n=t[r];t[e.__cacheIndex=r]=e,t[n.__cacheIndex=i]=n}clipAction(e,t,i){var r=t||this._root,n=r.uuid;let s="string"==typeof e?ih.findByName(r,e):e;var r=null!==s?s.uuid:e,a=this._actionsByClip[r];let o=null;if(void 0===i&&(i=null!==s?s.blendMode:2500),void 0!==a){const e=a.actionByRoot[n];if(void 0!==e&&e.blendMode===i)return e;o=a.knownActions[0],null===s&&(s=o._clip)}return null===s?null:(e=new qh(this,s,t,i),this._bindAction(e,o),this._addInactiveAction(e,r,n),e)}existingAction(e,t){var t=t||this._root,i=t.uuid,t="string"==typeof e?ih.findByName(t,e):e,t=t?t.uuid:e,e=this._actionsByClip[t];return void 0!==e&&e.actionByRoot[i]||null}stopAllAction(){var t=this._actions;for(let e=this._nActiveActions-1;0<=e;--e)t[e].stop();return this}update(t){t*=this.timeScale;var i=this._actions,r=this._nActiveActions,n=this.time+=t,s=Math.sign(t),a=this._accuIndex^=1;for(let e=0;e!==r;++e)i[e]._update(n,t,s,a);var o=this._bindings,l=this._nActiveBindings;for(let e=0;e!==l;++e)o[e].apply(a);return this}setTime(e){for(let e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(i){const r=this._actions,e=i.uuid,n=this._actionsByClip,s=n[e];if(void 0!==s){const i=s.knownActions;for(let e=0,t=i.length;e!==t;++e){const n=i[e],s=(this._deactivateAction(n),n._cacheIndex),a=r[r.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=s,r[s]=a,r.pop(),this._removeInactiveBindingsForAction(n)}delete n[e]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const e in i){const r=i[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const e in r){const t=r[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){e=this.existingAction(e,t);null!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);(class extends eo{constructor(e,t,i=1){super(e,t),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){e=super.clone(e);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(e){e=super.toJSON(e);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;new W;const Xh=new Pe,Yh=new Re,$h=new Re;T=new Float32Array(1);new Int32Array(T.buffer),Zo.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Zo.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},yl.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},class extends Go{constructor(e=10,r=10,n=4473924,s=8947848){n=new m(n),s=new m(s);var a=r/2,o=e/r,l=e/2,h=[],u=[];for(let e=0,t=0,i=-l;e<=r;e++,i+=o){h.push(-l,0,i,l,0,i),h.push(i,0,-l,i,0,l);const r=e===a?n:s;r.toArray(u,t),t+=3,r.toArray(u,t),t+=3,r.toArray(u,t),t+=3,r.toArray(u,t),t+=3}e=new w;e.setAttribute("position",new y(h,3)),e.setAttribute("color",new y(u,3)),super(e,new Do({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Go{constructor(e){const t=function t(i){var r=[];i&&i.isBone&&r.push(i);for(let e=0;e<i.children.length;e++)r.push.apply(r,t(i.children[e]));return r}(e),i=new w,r=[],n=[],s=new m(0,0,1),a=new m(0,1,0);for(let e=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),n.push(s.r,s.g,s.b),n.push(a.r,a.g,a.b))}i.setAttribute("position",new y(r,3)),i.setAttribute("color",new y(n,3)),super(i,new Do({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){var i=this.bones,t=this.geometry,r=t.getAttribute("position");$h.copy(this.root.matrixWorld).invert();for(let e=0,t=0;e<i.length;e++){var n=i[e];n.parent&&n.parent.isBone&&(Yh.multiplyMatrices($h,n.matrixWorld),Xh.setFromMatrixPosition(Yh),r.setXYZ(t,Xh.x,Xh.y,Xh.z),Yh.multiplyMatrices($h,n.parent.matrixWorld),Xh.setFromMatrixPosition(Yh),r.setXYZ(t+1,Xh.x,Xh.y,Xh.z),t+=2)}t.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},sh.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Lh.extractUrlBase(e)},sh.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},_i.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},_i.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},_i.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},_i.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},_i.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Bi.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},vn.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},v.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},v.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},v.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},v.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},v.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},v.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Re.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Re.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Re.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Pe).setFromMatrixColumn(this,3)},Re.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Re.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Re.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Re.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Re.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Re.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Re.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Re.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Re.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Re.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Re.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Re.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Re.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Re.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Re.prototype.makeFrustum=function(e,t,i,r,n,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,i,n,s)},Re.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},fn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},f.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},f.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},qi.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},qi.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},qi.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},p.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},p.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},p.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},p.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},p.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},p.barycoordFromPoint=function(e,t,i,r,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),p.getBarycoord(e,t,i,r,n)},p.normal=function(e,t,i,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),p.getNormal(e,t,i,r)},_l.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},_l.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Fl(this,e)},_l.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new zl(this,e)},W.prototype.fromAttribute=function(e,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},W.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},W.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Pe.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Pe.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Pe.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Pe.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Pe.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Pe.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Pe.prototype.fromAttribute=function(e,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},Pe.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Pe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ie.prototype.fromAttribute=function(e,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},Ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},a.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},a.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},a.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},a.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},a.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(a.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),S.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(S.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),wo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},D.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(ch.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(E.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),E.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},E.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},E.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},w.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},w.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new E(t,arguments[2])))},w.prototype.addDrawCall=function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},w.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},w.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},w.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},w.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(w.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),eo.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},eo.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Fl.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Fl.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Fl.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Qa.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},class Jh{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Jh(void 0===this.value.clone?this.value:this.value.clone())}}.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(e.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new m}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(an.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),i.prototype.clearTarget=function(e,t,i,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,i,r)},i.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},i.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},i.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},i.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},i.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},i.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},i.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},i.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},i.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},i.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},i.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},i.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},i.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},i.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},i.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},i.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},i.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},i.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},i.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},i.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},i.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},i.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},i.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},i.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(i.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?G:Ft}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(za.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(mi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),class extends a{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+e,(e=this.context.createBufferSource()).buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e=e||[],!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new Rh).load(e,function(e){t.setBuffer(e)}),this},ln.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},ln.prototype.clear=function(e,t,i,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,i,r)},di.crossOrigin=void 0,di.loadTexture=function(e,t,i,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new uh,n=(n.setCrossOrigin(this.crossOrigin),n.load(e,i,void 0,r));return t&&(n.mapping=t),n},di.loadTextureCube=function(e,t,i,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new hh,n=(n.setCrossOrigin(this.crossOrigin),n.load(e,i,void 0,r));return t&&(n.mapping=t),n},di.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},di.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ke}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ke)},5682:(e,t,i)=>{"use strict";i.d(t,{C:()=>r});var n=i(4599);class r extends n.xsS{constructor(){super();var e=new n.DvJ,t=(e.deleteAttribute("uv"),new n.Wid({side:n._Li})),i=new n.Wid,r=new n.cek(16777215,5,28,2),r=(r.position.set(.418,16.199,.3),this.add(r),new n.Kj0(e,t)),t=(r.position.set(-.757,13.219,.717),r.scale.set(31.713,28.305,28.591),this.add(r),new n.Kj0(e,i)),r=(t.position.set(-10.906,2.009,1.846),t.rotation.set(0,-.195,0),t.scale.set(2.328,7.905,4.651),this.add(t),new n.Kj0(e,i)),t=(r.position.set(-5.607,-.754,-.758),r.rotation.set(0,.994,0),r.scale.set(1.97,1.534,3.955),this.add(r),new n.Kj0(e,i)),r=(t.position.set(6.167,.857,7.803),t.rotation.set(0,.561,0),t.scale.set(3.927,6.285,3.687),this.add(t),new n.Kj0(e,i)),t=(r.position.set(-2.017,.018,6.124),r.rotation.set(0,.333,0),r.scale.set(2.002,4.566,2.064),this.add(r),new n.Kj0(e,i)),r=(t.position.set(2.291,-.756,-2.621),t.rotation.set(0,-.286,0),t.scale.set(1.546,1.552,1.496),this.add(t),new n.Kj0(e,i)),t=(r.position.set(-2.193,-.369,-5.547),r.rotation.set(0,.516,0),r.scale.set(3.875,3.487,2.986),this.add(r),new n.Kj0(e,s(50))),i=(t.position.set(-16.116,14.37,8.208),t.scale.set(.1,2.428,2.739),this.add(t),new n.Kj0(e,s(50))),r=(i.position.set(-16.109,18.021,-8.207),i.scale.set(.1,2.425,2.751),this.add(i),new n.Kj0(e,s(17))),t=(r.position.set(14.904,12.198,-1.832),r.scale.set(.15,4.265,6.331),this.add(r),new n.Kj0(e,s(43))),i=(t.position.set(-.462,8.89,14.52),t.scale.set(4.38,5.441,.088),this.add(t),new n.Kj0(e,s(20))),r=(i.position.set(3.235,11.486,-12.541),i.scale.set(2.5,2,.1),this.add(i),new n.Kj0(e,s(100)));r.position.set(0,20,0),r.scale.set(1,.1,1),this.add(r)}}function s(e){var t=new n.vBJ;return t.color.setScalar(e),t}},7428:(e,t,i)=>{"use strict";i.d(t,{_:()=>r});var a=i(4599);const o=new WeakMap;class r extends a.aNw{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,i,t,r){var n=new a.hH6(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,e=>{var t={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,t).then(i).catch(r)},t,r)}decodeDracoFile(e,t,i,r){r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,r).then(t)}decodeGeometry(i,r){for(const i in r.attributeTypes){const e=r.attributeTypes[i];void 0!==e.BYTES_PER_ELEMENT&&(r.attributeTypes[i]=e.name)}const e=JSON.stringify(r);if(o.has(i)){const r=o.get(i);if(r.key===e)return r.promise;if(0===i.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const s=this.workerNextTaskID++,t=i.byteLength,a=this._getWorker(s,t).then(e=>(n=e,new Promise((e,t)=>{n._callbacks[s]={resolve:e,reject:t},n.postMessage({type:"decode",id:s,taskConfig:r,buffer:i},[i])}))).then(e=>this._createGeometry(e.geometry));return a.catch(()=>!0).then(()=>{n&&s&&this._releaseTask(n,s)}),o.set(i,{key:e,promise:a}),a}_createGeometry(t){var i=new a.u9r;t.index&&i.setIndex(new a.TlE(t.index.array,1));for(let e=0;e<t.attributes.length;e++){var r=t.attributes[e],n=r.name,s=r.array,r=r.itemSize;i.setAttribute(n,new a.TlE(s,r))}return i}_loadLibrary(i,e){const r=new a.hH6(this.manager);return r.setPath(this.decoderPath),r.setResponseType(e),r.setWithCredentials(this.withCredentials),new Promise((e,t)=>{r.load(i,e,void 0,t)})}preload(){return this._initDecoder(),this}_initDecoder(){if(!this.decoderPending){const i="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,e=[];i?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(e=>{var t=e[0],e=(i||(this.decoderConfig.wasmBinary=e[1]),function(){let e,t;onmessage=function(n){const s=n.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":const n=s.buffer,a=s.taskConfig;t.then(e=>{var t=e.draco,i=new t.Decoder,r=new t.DecoderBuffer;r.Init(new Int8Array(n),n.byteLength);try{const e=function(i,r,n,s){var a=s.attributeIDs,o=s.attributeTypes;let l,h;var e=r.GetEncodedGeometryType(n);if(e===i.TRIANGULAR_MESH)l=new i.Mesh,h=r.DecodeBufferToMesh(n,l);else{if(e!==i.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");l=new i.PointCloud,h=r.DecodeBufferToPointCloud(n,l)}if(!h.ok()||0===l.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+h.error_msg());var u,c,d,p,f,m,g,v,y,_,b,t,T,x,w,S={index:null,attributes:[]};for(const n in a){const h=self[o[n]];let e,t;if(s.useUniqueIDs)t=a[n],e=r.GetAttributeByUniqueId(l,t);else{if(-1===(t=r.GetAttributeId(l,i[a[n]])))continue;e=r.GetAttribute(l,t)}S.attributes.push((u=i,c=r,d=l,p=n,f=h,m=e,b=_=y=v=g=void 0,g=m.num_components(),v=d.num_points()*g,y=v*f.BYTES_PER_ELEMENT,_=function(e){switch(f){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(u),b=u._malloc(y),c.GetAttributeDataArrayForAllPoints(d,m,_,y,b),c=new f(u.HEAPF32.buffer,b,v).slice(),u._free(b),{name:p,array:c,itemSize:g}))}return e===i.TRIANGULAR_MESH&&(S.index=(n=i,e=r,t=l,T=3*t.num_faces(),x=4*T,w=n._malloc(x),e.GetTrianglesUInt32Array(t,x,w),e=new Uint32Array(n.HEAPF32.buffer,w,T).slice(),n._free(w),{array:e,itemSize:1})),i.destroy(l),S}(t,i,r,a),n=e.attributes.map(e=>e.array.buffer);e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},n)}catch(e){console.error(e),self.postMessage({type:"error",id:s.id,error:e.message})}finally{t.destroy(r),t.destroy(i)}})}}}.toString()),t=["/* draco decoder */",t,"","/* worker */",e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([t]))})}return this.decoderPending}_getWorker(i,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(e){var t=e.data;switch(t.type){case"decode":i._callbacks[t.id].resolve(t);break;case"error":i._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});var e=this.workerPool[this.workerPool.length-1];return e._taskCosts[i]=t,e._taskLoad+=t,e})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}},3306:(N,e,t)=>{"use strict";t.d(e,{E:()=>i});var v=t(4599);class i extends v.aNw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new s(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new a(e)}),this.register(function(e){return new o(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new c(e)}),this.register(function(e){return new d(e)}),this.register(function(e){return new n(e)}),this.register(function(e){return new m(e)})}load(t,i,e,r){const n=this;let s;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:v.Zp0.extractUrlBase(t),this.manager.itemStart(t);function a(e){r?r(e):console.error(e),n.manager.itemError(t),n.manager.itemEnd(t)}const o=new v.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(e){try{n.parse(e,s,function(e){i(e),n.manager.itemEnd(t)},a)}catch(e){a(e)}},e,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let n;var s={},a={};if("string"==typeof e)n=e;else if(v.Zp0.decodeText(new Uint8Array(e,0,4))===g){try{s[u.KHR_BINARY_GLTF]=new y(e)}catch(e){return void(r&&r(e))}n=s[u.KHR_BINARY_GLTF].content}else n=v.Zp0.decodeText(new Uint8Array(e));var o=JSON.parse(n);if(void 0===o.asset||o.asset.version[0]<2)r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new z(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](l);s[(a[t.name]=t).name]=!0}if(o.extensionsUsed)for(let e=0;e<o.extensionsUsed.length;++e){const t=o.extensionsUsed[e],i=o.extensionsRequired||[];switch(t){case u.KHR_MATERIALS_UNLIT:s[t]=new h;break;case u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[t]=new x;break;case u.KHR_DRACO_MESH_COMPRESSION:s[t]=new _(o,this.dracoLoader);break;case u.KHR_TEXTURE_TRANSFORM:s[t]=new b;break;case u.KHR_MESH_QUANTIZATION:s[t]=new U;break;default:0<=i.indexOf(t)&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(i,r)}}parseAsync(i,r){const n=this;return new Promise(function(e,t){n.parse(i,r,e,t)})}}function r(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const u={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class n{constructor(e){this.parser=e,this.name=u.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){var i=this.parser,r=this.parser.json.nodes||[];for(let e=0,t=r.length;e<t;e++){var n=r[e];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&i._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(t){var i=this.parser,r="light:"+t,n=i.cache.get(r);if(!n){var s=i.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[t];let e;var o=new v.Ilk(16777215),l=(void 0!==a.color&&o.fromArray(a.color),void 0!==a.range?a.range:0);switch(a.type){case"directional":(e=new v.Ox3(o)).target.position.set(0,0,-1),e.add(e.target);break;case"point":(e=new v.cek(o)).distance=l;break;case"spot":(e=new v.PMe(o)).distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,e.angle=a.spot.outerConeAngle,e.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,e.target.position.set(0,0,-1),e.add(e.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}e.position.set(0,0,0),e.decay=2,void 0!==a.intensity&&(e.intensity=a.intensity),e.name=i.createUniqueName(a.name||"light_"+t),n=Promise.resolve(e),i.cache.add(r,n)}return n}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],n=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(e){return i._getNodeRef(t.cache,n,e)})}}class h{constructor(){this.name=u.KHR_MATERIALS_UNLIT}getMaterialType(){return v.vBJ}extendParams(e,t,i){var r=[],n=(e.color=new v.Ilk(1,1,1),e.opacity=1,t.pbrMetallicRoughness);if(n){if(Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==n.baseColorTexture&&r.push(i.assignTexture(e,"map",n.baseColorTexture))}return Promise.all(r)}}class s{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var i=this.parser,e=i.json.materials[e];if(!e.extensions||!e.extensions[this.name])return Promise.resolve();var r=[],n=e.extensions[this.name];if(void 0!==n.clearcoatFactor&&(t.clearcoat=n.clearcoatFactor),void 0!==n.clearcoatTexture&&r.push(i.assignTexture(t,"clearcoatMap",n.clearcoatTexture)),void 0!==n.clearcoatRoughnessFactor&&(t.clearcoatRoughness=n.clearcoatRoughnessFactor),void 0!==n.clearcoatRoughnessTexture&&r.push(i.assignTexture(t,"clearcoatRoughnessMap",n.clearcoatRoughnessTexture)),void 0!==n.clearcoatNormalTexture&&(r.push(i.assignTexture(t,"clearcoatNormalMap",n.clearcoatNormalTexture)),void 0!==n.clearcoatNormalTexture.scale)){const e=n.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new v.FM8(e,e)}return Promise.all(r)}}class a{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_SHEEN}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var i,r=this.parser,e=r.json.materials[e];return e.extensions&&e.extensions[this.name]?(i=[],t.sheenColor=new v.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1,void 0!==(e=e.extensions[this.name]).sheenColorFactor&&t.sheenColor.fromArray(e.sheenColorFactor),void 0!==e.sheenRoughnessFactor&&(t.sheenRoughness=e.sheenRoughnessFactor),void 0!==e.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",e.sheenColorTexture)),void 0!==e.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",e.sheenRoughnessTexture)),Promise.all(i)):Promise.resolve()}}class o{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var i,r=this.parser,e=r.json.materials[e];return e.extensions&&e.extensions[this.name]?(i=[],void 0!==(e=e.extensions[this.name]).transmissionFactor&&(t.transmission=e.transmissionFactor),void 0!==e.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",e.transmissionTexture)),Promise.all(i)):Promise.resolve()}}class l{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_VOLUME}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var i,r=this.parser,e=r.json.materials[e];return e.extensions&&e.extensions[this.name]?(i=[],e=e.extensions[this.name],t.thickness=void 0!==e.thicknessFactor?e.thicknessFactor:0,void 0!==e.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",e.thicknessTexture)),t.attenuationDistance=e.attenuationDistance||0,r=e.attenuationColor||[1,1,1],t.attenuationColor=new v.Ilk(r[0],r[1],r[2]),Promise.all(i)):Promise.resolve()}}class c{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_IOR}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]&&(e=e.extensions[this.name],t.ior=void 0!==e.ior?e.ior:1.5),Promise.resolve()}}class d{constructor(e){this.parser=e,this.name=u.KHR_MATERIALS_SPECULAR}getMaterialType(e){e=this.parser.json.materials[e];return e.extensions&&e.extensions[this.name]?v.EJi:null}extendMaterialParams(e,t){var i,r,n=this.parser,e=n.json.materials[e];return e.extensions&&e.extensions[this.name]?(i=[],e=e.extensions[this.name],t.specularIntensity=void 0!==e.specularFactor?e.specularFactor:1,void 0!==e.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",e.specularTexture)),r=e.specularColorFactor||[1,1,1],t.specularColor=new v.Ilk(r[0],r[1],r[2]),void 0!==e.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",e.specularColorTexture).then(function(e){e.encoding=v.knz})),Promise.all(i)):Promise.resolve()}}class p{constructor(e){this.parser=e,this.name=u.KHR_TEXTURE_BASISU}loadTexture(e){var t=this.parser,i=t.json,r=i.textures[e];if(r.extensions&&r.extensions[this.name]){var r=r.extensions[this.name],r=i.images[r.source],n=t.options.ktx2Loader;if(n)return t.loadTextureImage(e,r,n);if(i.extensionsRequired&&0<=i.extensionsRequired.indexOf(this.name))throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return null}}class f{constructor(e){this.parser=e,this.name=u.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const i=this.name,r=this.parser,n=r.json,e=n.textures[t];if(!e.extensions||!e.extensions[i])return null;const s=e.extensions[i],a=n.images[s.source];let o=r.textureLoader;if(a.uri){const t=r.options.manager.getHandler(a.uri);null!==t&&(o=t)}return this.detectSupport().then(function(e){if(e)return r.loadTextureImage(t,a,o);if(n.extensionsRequired&&0<=n.extensionsRequired.indexOf(i))throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(t)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class m{constructor(e){this.name=u.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(a){var e=this.parser.json,t=e.bufferViews[a];if(t.extensions&&t.extensions[this.name]){const a=t.extensions[this.name],i=this.parser.getDependency("buffer",a.buffer),o=this.parser.options.meshoptDecoder;if(o&&o.supported)return Promise.all([i,o.ready]).then(function(e){var t=a.byteOffset||0,i=a.byteLength||0,r=a.count,n=a.byteStride,s=new ArrayBuffer(r*n),e=new Uint8Array(e[0],t,i);return o.decodeGltfBuffer(new Uint8Array(s),r,n,e,a.mode,a.filter),s});if(e.extensionsRequired&&0<=e.extensionsRequired.indexOf(this.name))throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return null}}const g="glTF";class y{constructor(e){this.name=u.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:v.Zp0.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==g)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,r=new DataView(e,12);let n=0;for(;n<i;){const t=r.getUint32(n,!0),i=(n+=4,r.getUint32(n,!0));if(n+=4,1313821514===i){const i=new Uint8Array(e,12+n,t);this.content=v.Zp0.decodeText(i)}else if(5130562===i){const i=12+n;this.body=e.slice(i,i+t)}n+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class _{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=u.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},o={},l={};for(const e in s){const t=A[e]||e.toLowerCase();a[t]=s[e]}for(const t in e.attributes){const n=A[t]||t.toLowerCase();if(void 0!==s[t]){const r=i.accessors[e.attributes[t]],s=S[r.componentType];l[n]=s,o[n]=!0===r.normalized}}return t.getDependency("bufferView",r).then(function(e){return new Promise(function(r){n.decodeDracoFile(e,function(e){for(const r in e.attributes){var t=e.attributes[r],i=o[r];void 0!==i&&(t.normalized=i)}r(e)},a,l)})})}}class b{constructor(){this.name=u.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class T extends v.Wid{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),n=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new v.Ilk).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(const t in a)e.uniforms[t]=a[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",n).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){(a.specularMap.value=e)?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){(a.glossinessMap.value=e)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class x{constructor(){this.name=u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return T}extendParams(e,t,i){var r=t.extensions[this.name],n=(e.color=new v.Ilk(1,1,1),e.opacity=1,[]);if(Array.isArray(r.diffuseFactor)){const t=r.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==r.diffuseTexture&&n.push(i.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new v.Ilk(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new v.Ilk(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const t=r.specularGlossinessTexture;n.push(i.assignTexture(e,"glossinessMap",t)),n.push(i.assignTexture(e,"specularMap",t))}return Promise.all(n)}createMaterial(e){var t=new T(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=v.IOt,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}class U{constructor(){this.name=u.KHR_MESH_QUANTIZATION}}class w extends v._C8{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){var t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=e*r*3+r;for(let e=0;e!==r;e++)t[e]=i[n+e];return t}}w.prototype.beforeStart_=w.prototype.copySampleValue_,w.prototype.afterEnd_=w.prototype.copySampleValue_,w.prototype.interpolate_=function(e,t,i,r){const n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,h=r-t,u=(i-t)/h,c=u*u,d=c*u,p=e*l,f=p-l,m=-2*d+3*c,g=d-c,v=1-m,y=g-c+u;for(let e=0;e!==a;e++){const t=s[f+e+a],i=s[f+e+o]*h,r=s[p+e+a],l=s[p+e]*h;n[e]=v*t+y*i+m*r+g*l}return n};const B=new v._fP;class F extends w{interpolate_(e,t,i,r){e=super.interpolate_(e,t,i,r);return B.fromArray(e).normalize().toArray(e),e}}const S={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},E={9728:v.TyD,9729:v.wem,9984:v.YLQ,9985:v.qyh,9986:v.aH4,9987:v.D1R},M={33071:v.uWy,33648:v.OoA,10497:v.rpg},C={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:v.NMF,STEP:v.Syv};function I(e,t,i){for(const r in i.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=i.extensions[r])}function P(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function R(i){let r="";var n=Object.keys(i).sort();for(let e=0,t=n.length;e<t;e++)r+=n[e]+":"+i[n[e]]+";";return r}function k(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class z{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new r,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.textureLoader=new v.QRU(this.options.manager):this.textureLoader=new v.dpR(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new v.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(i,e){const r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(e){const t={scene:e[0][n.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:n.asset,parser:r,userData:{}};I(s,t,n),P(t,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(t)})).then(function(){i(t)})}).catch(e)}_markDefs(){var i=this.json.nodes||[],r=this.json.skins||[],n=this.json.meshes||[];for(let e=0,t=r.length;e<t;e++){var s=r[e].joints;for(let e=0,t=s.length;e<t;e++)i[s[e]].isBone=!0}for(let e=0,t=i.length;e<t;e++){var a=i[e];void 0!==a.mesh&&(this._addNodeRef(this.meshCache,a.mesh),void 0!==a.skin)&&(n[a.mesh].isSkinnedMesh=!0),void 0!==a.camera&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),n=(e,t)=>{const i=this.associations.get(e);null!=i&&this.associations.set(t,i);for(const[i,r]of e.children.entries())n(r,t.children[i])};return n(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(t){var i=Object.values(this.plugins);i.push(this);for(let e=0;e<i.length;e++){var r=t(i[e]);if(r)return r}return null}_invokeAll(t){var i=Object.values(this.plugins),r=(i.unshift(this),[]);for(let e=0;e<i.length;e++){var n=t(i[e]);n&&r.push(n)}return r}getDependency(e,t){var i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(i){let e=this.cache.get(i);if(!e){const r=this,t=this.json[i+("mesh"===i?"es":"s")]||[];e=Promise.all(t.map(function(e,t){return r.getDependency(i,t)})),this.cache.add(i,e)}return e}loadBuffer(e){const i=this.json.buffers[e],r=this.fileLoader;if(i.type&&"arraybuffer"!==i.type)throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(void 0===i.uri&&0===e)return Promise.resolve(this.extensions[u.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(e,t){r.load(v.Zp0.resolveURL(i.uri,n.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(e){const r=this.json.bufferViews[e];return this.getDependency("buffer",r.buffer).then(function(e){var t=r.byteLength||0,i=r.byteOffset||0;return e.slice(i,i+t)})}loadAccessor(e){const c=this,d=this.json,p=this.json.accessors[e];return void 0===p.bufferView&&void 0===p.sparse?Promise.resolve(null):(e=[],void 0!==p.bufferView?e.push(this.getDependency("bufferView",p.bufferView)):e.push(null),void 0!==p.sparse&&(e.push(this.getDependency("bufferView",p.sparse.indices.bufferView)),e.push(this.getDependency("bufferView",p.sparse.values.bufferView))),Promise.all(e).then(function(t){const i=t[0],r=C[p.type],n=S[p.componentType],s=n.BYTES_PER_ELEMENT,e=s*r,a=p.byteOffset||0,o=void 0!==p.bufferView?d.bufferViews[p.bufferView].byteStride:void 0,l=!0===p.normalized;let h,u;if(o&&o!==e){const t=Math.floor(a/o),d="InterleavedBuffer:"+p.bufferView+":"+p.componentType+":"+t+":"+p.count;let e=c.cache.get(d);e||(h=new n(i,t*o,p.count*o/s),e=new v.vpT(h,o/s),c.cache.add(d,e)),u=new v.kB5(e,r,a%o/s,l)}else h=null===i?new n(p.count*r):new n(i,a,p.count*r),u=new v.TlE(h,r,l);if(void 0!==p.sparse){const c=C.SCALAR,d=S[p.sparse.indices.componentType],s=p.sparse.indices.byteOffset||0,e=p.sparse.values.byteOffset||0,a=new d(t[1],s,p.sparse.count*c),o=new n(t[2],e,p.sparse.count*r);null!==i&&(u=new v.TlE(u.array.slice(),u.itemSize,u.normalized));for(let e=0,t=a.length;e<t;e++){const c=a[e];if(u.setX(c,o[e*r]),2<=r&&u.setY(c,o[e*r+1]),3<=r&&u.setZ(c,o[e*r+2]),4<=r&&u.setW(c,o[e*r+3]),5<=r)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return u}))}loadTexture(e){var t=this.json,i=this.options,r=t.textures[e],t=t.images[r.source];let n=this.textureLoader;if(t.uri){const e=i.manager.getHandler(t.uri);null!==e&&(n=e)}return this.loadTextureImage(e,t,n)}loadTextureImage(i,t,n){const r=this,s=this.json,a=this.options,o=s.textures[i],e=(t.uri||t.bufferView)+":"+o.sampler;if(this.textureCache[e])return this.textureCache[e];const l=self.URL||self.webkitURL;let h=t.uri||"",u=!1;if(void 0!==t.bufferView)h=r.getDependency("bufferView",t.bufferView).then(function(e){u=!0;e=new Blob([e],{type:t.mimeType});return h=l.createObjectURL(e)});else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+i+" is missing URI and bufferView");var c=Promise.resolve(h).then(function(r){return new Promise(function(t,e){let i=t;!0===n.isImageBitmapLoader&&(i=function(e){e=new v.xEZ(e);e.needsUpdate=!0,t(e)}),n.load(v.Zp0.resolveURL(r,a.path),i,void 0,e)})}).then(function(e){!0===u&&l.revokeObjectURL(h),e.flipY=!1,o.name&&(e.name=o.name);var t=(s.samplers||{})[o.sampler]||{};return e.magFilter=E[t.magFilter]||v.wem,e.minFilter=E[t.minFilter]||v.D1R,e.wrapS=M[t.wrapS]||v.rpg,e.wrapT=M[t.wrapT]||v.rpg,r.associations.set(e,{textures:i}),e}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",h),null});return this.textureCache[e]=c}assignTexture(t,i,r){const n=this;return this.getDependency("texture",r.index).then(function(e){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===i&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+i+" not yet supported."),n.extensions[u.KHR_TEXTURE_TRANSFORM]){const t=void 0!==r.extensions?r.extensions[u.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const i=n.associations.get(e);e=n.extensions[u.KHR_TEXTURE_TRANSFORM].extendTexture(e,t),n.associations.set(e,i)}}return t[i]=e})}assignFinalMaterial(t){var e=t.geometry;let i=t.material;var r=void 0===e.attributes.tangent,n=void 0!==e.attributes.color,s=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+i.uuid;let e=this.cache.get(t);e||(e=new v.UY4,v.F5T.prototype.copy.call(e,i),e.color.copy(i.color),e.map=i.map,e.sizeAttenuation=!1,this.cache.add(t,e)),i=e}else if(t.isLine){const t="LineBasicMaterial:"+i.uuid;let e=this.cache.get(t);e||(e=new v.nls,v.F5T.prototype.copy.call(e,i),e.color.copy(i.color),this.cache.add(t,e)),i=e}if(r||n||s){let e="ClonedMaterial:"+i.uuid+":",t=(i.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),r&&(e+="derivative-tangents:"),n&&(e+="vertex-colors:"),s&&(e+="flat-shading:"),this.cache.get(e));t||(t=i.clone(),n&&(t.vertexColors=!0),s&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale)&&(t.clearcoatNormalScale.y*=-1),this.cache.add(e,t),this.associations.set(t,this.associations.get(i))),i=t}i.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=i}getMaterialType(){return v.Wid}loadMaterial(t){const i=this,e=this.json,r=this.extensions,n=e.materials[t];let s;const a={},o=n.extensions||{},l=[];if(o[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const t=r[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=t.getMaterialType(),l.push(t.extendParams(a,n,i))}else if(o[u.KHR_MATERIALS_UNLIT]){const t=r[u.KHR_MATERIALS_UNLIT];s=t.getMaterialType(),l.push(t.extendParams(a,n,i))}else{const e=n.pbrMetallicRoughness||{};if(a.color=new v.Ilk(1,1,1),a.opacity=1,Array.isArray(e.baseColorFactor)){const t=e.baseColorFactor;a.color.fromArray(t),a.opacity=t[3]}void 0!==e.baseColorTexture&&l.push(i.assignTexture(a,"map",e.baseColorTexture)),a.metalness=void 0!==e.metallicFactor?e.metallicFactor:1,a.roughness=void 0!==e.roughnessFactor?e.roughnessFactor:1,void 0!==e.metallicRoughnessTexture&&(l.push(i.assignTexture(a,"metalnessMap",e.metallicRoughnessTexture)),l.push(i.assignTexture(a,"roughnessMap",e.metallicRoughnessTexture))),s=this._invokeOne(function(e){return e.getMaterialType&&e.getMaterialType(t)}),l.push(Promise.all(this._invokeAll(function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)})))}!0===n.doubleSided&&(a.side=v.ehD);var h=n.alphaMode||"OPAQUE";if("BLEND"===h?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===h&&(a.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&s!==v.vBJ&&(l.push(i.assignTexture(a,"normalMap",n.normalTexture)),a.normalScale=new v.FM8(1,1),void 0!==n.normalTexture.scale)){const t=n.normalTexture.scale;a.normalScale.set(t,t)}return void 0!==n.occlusionTexture&&s!==v.vBJ&&(l.push(i.assignTexture(a,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength)&&(a.aoMapIntensity=n.occlusionTexture.strength),void 0!==n.emissiveFactor&&s!==v.vBJ&&(a.emissive=(new v.Ilk).fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&s!==v.vBJ&&l.push(i.assignTexture(a,"emissiveMap",n.emissiveTexture)),Promise.all(l).then(function(){var e=s===T?r[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new s(a);return n.name&&(e.name=n.name),e.map&&(e.map.encoding=v.knz),e.emissiveMap&&(e.emissiveMap.encoding=v.knz),P(e,n),i.associations.set(e,{materials:t}),n.extensions&&I(r,e,n),e})}createUniqueName(e){var t=v.iUV.sanitizeNodeName(e||"");let i=t;for(let e=1;this.nodeNamesUsed[i];++e)i=t+"_"+e;return this.nodeNamesUsed[i]=!0,i}loadGeometries(i){const r=this,n=this.extensions,s=this.primitiveCache;var a=[];for(let e=0,t=i.length;e<t;e++){var o=i[e],l=(l=void 0,(l=(h=o).extensions&&h.extensions[u.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+R(l.attributes):h.indices+":"+R(h.attributes)+":"+h.mode),h=s[l];h?a.push(h.promise):(h=o.extensions&&o.extensions[u.KHR_DRACO_MESH_COMPRESSION]?function(t){return n[u.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,r).then(function(e){return D(e,t,r)})}(o):D(new v.u9r,o,r),s[l]={primitive:o,promise:h},a.push(h))}return Promise.all(a)}loadMesh(c){const d=this,e=this.json,p=this.extensions,f=e.meshes[c],m=f.primitives,i=[];for(let e=0,t=m.length;e<t;e++){const d=void 0===m[e].material?(void 0===(r=this.cache).DefaultMaterial&&(r.DefaultMaterial=new v.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:v.Wl3})),r.DefaultMaterial):this.getDependency("material",m[e].material);i.push(d)}var r;return i.push(d.loadGeometries(m)),Promise.all(i).then(function(e){var i=e.slice(0,e.length-1),r=e[e.length-1],n=[];for(let t=0,e=r.length;t<e;t++){const h=r[t],u=m[t];let e;var s=i[t];if(4===u.mode||5===u.mode||6===u.mode||void 0===u.mode)!0!==(e=new(!0===f.isSkinnedMesh?v.TUv:v.Kj0)(h,s)).isSkinnedMesh||e.geometry.attributes.skinWeight.normalized||e.normalizeSkinWeights(),5===u.mode?e.geometry=O(e.geometry,v.UlW):6===u.mode&&(e.geometry=O(e.geometry,v.z$h));else if(1===u.mode)e=new v.ejS(h,s);else if(3===u.mode)e=new v.x12(h,s);else if(2===u.mode)e=new v.blk(h,s);else{if(0!==u.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);e=new v.woe(h,s)}if(0<Object.keys(e.geometry.morphAttributes).length){a=void 0;o=void 0;l=void 0;var a=e;var o=f;if(a.updateMorphTargets(),void 0!==o.weights)for(let e=0,t=o.weights.length;e<t;e++)a.morphTargetInfluences[e]=o.weights[e];if(o.extras&&Array.isArray(o.extras.targetNames)){var l=o.extras.targetNames;if(a.morphTargetInfluences.length===l.length){a.morphTargetDictionary={};for(let e=0,t=l.length;e<t;e++)a.morphTargetDictionary[l[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}e.name=d.createUniqueName(f.name||"mesh_"+c),P(e,f),u.extensions&&I(p,e,u),d.assignFinalMaterial(e),n.push(e)}for(let e=0,t=n.length;e<t;e++)d.associations.set(n[e],{meshes:c,primitives:e});if(1===n.length)return n[0];const h=new v.ZAu;d.associations.set(h,{meshes:c});for(let e=0,t=n.length;e<t;e++)h.add(n[e]);return h})}loadCamera(e){let t;var e=this.json.cameras[e],i=e[e.type];if(i)return"perspective"===e.type?t=new v.cPb(v.M8C.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===e.type&&(t=new v.iKG(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),e.name&&(t.name=this.createUniqueName(e.name)),P(t,e),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return i.inverseBindMatrices=e,i})}loadAnimation(m){const g=this.json.animations[m],i=[],r=[],n=[],s=[],a=[];for(let e=0,t=g.channels.length;e<t;e++){const v=g.channels[e],o=g.samplers[v.sampler],l=v.target,h=void 0!==l.node?l.node:l.id,u=void 0!==g.parameters?g.parameters[o.input]:o.input,c=void 0!==g.parameters?g.parameters[o.output]:o.output;i.push(this.getDependency("node",h)),r.push(this.getDependency("accessor",u)),n.push(this.getDependency("accessor",c)),s.push(o),a.push(l)}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(n),Promise.all(s),Promise.all(a)]).then(function(n){var i=n[0],r=n[1],s=n[2],a=n[3],o=n[4],l=[];for(let e=0,t=i.length;e<t;e++){const g=i[e],n=r[e],h=s[e],u=a[e],c=o[e];if(void 0!==g){let i;switch(g.updateMatrix(),g.matrixAutoUpdate=!0,L[c.path]){case L.weights:i=v.dUE;break;case L.rotation:i=v.iLg;break;default:i=v.yC1}const d=g.name||g.uuid,p=void 0!==u.interpolation?H[u.interpolation]:v.NMF,f=[];L[c.path]===L.weights?g.traverse(function(e){e.morphTargetInfluences&&f.push(e.name||e.uuid)}):f.push(d);let r=h.array;if(h.normalized){const m=k(r.constructor),g=new Float32Array(r.length);for(let e=0,t=r.length;e<t;e++)g[e]=r[e]*m;r=g}for(let e=0,t=f.length;e<t;e++){const g=new i(f[e]+"."+L[c.path],n.array,r,p);"CUBICSPLINE"===u.interpolation&&(g.createInterpolant=function(e){return new(this instanceof v.iLg?F:w)(this.times,this.values,this.getValueSize()/3,e)},g.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(g)}}}const h=g.name||"animation_"+m;return new v.m7l(h,void 0,l)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(e){e=i._getNodeRef(i.meshCache,r.mesh,e);return void 0!==r.weights&&e.traverse(function(i){if(i.isMesh)for(let e=0,t=r.weights.length;e<t;e++)i.morphTargetInfluences[e]=r.weights[e]}),e})}loadNode(n){const e=this.json,t=this.extensions,s=this,a=e.nodes[n],o=a.name?s.createUniqueName(a.name):"";return function(){const t=[],e=s._invokeOne(function(e){return e.createNodeMesh&&e.createNodeMesh(n)});return e&&t.push(e),void 0!==a.camera&&t.push(s.getDependency("camera",a.camera).then(function(e){return s._getNodeRef(s.cameraCache,a.camera,e)})),s._invokeAll(function(e){return e.createNodeAttachment&&e.createNodeAttachment(n)}).forEach(function(e){t.push(e)}),Promise.all(t)}().then(function(i){var r=!0===a.isBone?new v.N$j:1<i.length?new v.ZAu:1===i.length?i[0]:new v.Tme;if(r!==i[0])for(let e=0,t=i.length;e<t;e++)r.add(i[e]);if(a.name&&(r.userData.name=a.name,r.name=o),P(r,a),a.extensions&&I(t,r,a),void 0!==a.matrix){const n=new v.yGw;n.fromArray(a.matrix),r.applyMatrix4(n)}else void 0!==a.translation&&r.position.fromArray(a.translation),void 0!==a.rotation&&r.quaternion.fromArray(a.rotation),void 0!==a.scale&&r.scale.fromArray(a.scale);return s.associations.has(r)||s.associations.set(r,{}),s.associations.get(r).nodes=n,r})}loadScene(e){const i=this.json,t=this.extensions,r=this.json.scenes[e],n=this,s=new v.ZAu;r.name&&(s.name=n.createUniqueName(r.name)),P(s,r),r.extensions&&I(t,s,r);var a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(function s(e,a,o,l){const t=o.nodes[e];return l.getDependency("node",e).then(function(e){if(void 0===t.skin)return e;let a;return l.getDependency("skin",t.skin).then(function(e){a=e;const i=[];for(let e=0,t=a.joints.length;e<t;e++)i.push(l.getDependency("node",a.joints[e]));return Promise.all(i)}).then(function(s){return e.traverse(function(e){if(e.isMesh){const i=[],r=[];for(let e=0,t=s.length;e<t;e++){const n=s[e];if(n){i.push(n);const s=new v.yGw;void 0!==a.inverseBindMatrices&&s.fromArray(a.inverseBindMatrices.array,16*e),r.push(s)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',a.joints[e])}e.bind(new v.OdW(i,r),e.matrixWorld)}}),e})}).then(function(i){a.add(i);const r=[];if(t.children){const a=t.children;for(let e=0,t=a.length;e<t;e++){const n=a[e];r.push(s(n,i,o,l))}}return Promise.all(r)})}(a[e],s,i,n));return Promise.all(o).then(function(){return n.associations=(e=>{const i=new Map;for(const[e,t]of n.associations)(e instanceof v.F5T||e instanceof v.xEZ)&&i.set(e,t);return e.traverse(e=>{var t=n.associations.get(e);null!=t&&i.set(e,t)}),i})(s),s})}}function D(u,e,c){var t=e.attributes,i=[];function r(e,t){return c.getDependency("accessor",e).then(function(e){u.setAttribute(t,e)})}for(const e in t){const c=A[e]||e.toLowerCase();c in u.attributes||i.push(r(t[e],c))}if(void 0!==e.indices&&!u.index){const v=c.getDependency("accessor",e.indices).then(function(e){u.setIndex(e)});i.push(v)}return P(u,e),function(i,r,n){const s=r.attributes,a=new v.ZzF;if(void 0!==s.POSITION){{const i=n.json.accessors[s.POSITION],r=i.min,o=i.max;if(void 0===r||void 0===o)return console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(a.set(new v.Pa4(r[0],r[1],r[2]),new v.Pa4(o[0],o[1],o[2])),i.normalized){const r=k(S[i.componentType]);a.min.multiplyScalar(r),a.max.multiplyScalar(r)}}const o=r.targets;if(void 0!==o){const i=new v.Pa4,r=new v.Pa4;for(let e=0,t=o.length;e<t;e++){const s=o[e];if(void 0!==s.POSITION){const v=n.json.accessors[s.POSITION],a=v.min,o=v.max;if(void 0!==a&&void 0!==o){if(r.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),r.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),r.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),v.normalized){const i=k(S[v.componentType]);r.multiplyScalar(i)}i.max(r)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(i)}i.boundingBox=a;r=new v.aLr;a.getCenter(r.center),r.radius=a.min.distanceTo(a.max)/2,i.boundingSphere=r}}(u,e,c),Promise.all(i).then(function(){if(void 0===e.targets)return u;{var n=u,s=e.targets,a=c;let i=!1,r=!1;for(let e=0,t=s.length;e<t;e++){const a=s[e];if(void 0!==a.POSITION&&(i=!0),void 0!==a.NORMAL&&(r=!0),i&&r)break}if(!i&&!r)return Promise.resolve(n);var o=[],l=[];for(let e=0,t=s.length;e<t;e++){var h=s[e];if(i){const s=void 0!==h.POSITION?a.getDependency("accessor",h.POSITION):n.attributes.position;o.push(s)}if(r){const s=void 0!==h.NORMAL?a.getDependency("accessor",h.NORMAL):n.attributes.normal;l.push(s)}}return Promise.all([Promise.all(o),Promise.all(l)]).then(function(e){var t=e[0],e=e[1];return i&&(n.morphAttributes.position=t),r&&(n.morphAttributes.normal=e),n.morphTargetsRelative=!0,n})}})}function O(e,t){let i=e.getIndex();if(null===i){const t=[],v=e.getAttribute("position");if(void 0===v)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<v.count;e++)t.push(e);e.setIndex(t),i=e.getIndex()}var r=i.count-2,n=[];if(t===v.z$h)for(let e=1;e<=r;e++)n.push(i.getX(0)),n.push(i.getX(e)),n.push(i.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(n.push(i.getX(e)),n.push(i.getX(e+1)),n.push(i.getX(e+2))):(n.push(i.getX(e+2)),n.push(i.getX(e+1)),n.push(i.getX(e)));n.length/3!=r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");t=e.clone();return t.setIndex(n),t}}}]);